{"version":3,"file":"bestMileageCards-DyLSqlAr.js","sources":["../../../src/components/ClipList.vue","../../../src/views/projects/BestMileageCards/CreditCard/modules/Reward.ts","../../../src/views/projects/BestMileageCards/CreditCard/modules/Plan.ts","../../../src/views/projects/BestMileageCards/CreditCard/modules/type.ts","../../../src/views/projects/BestMileageCards/CreditCard/modules/Card.ts","../../../src/views/projects/BestMileageCards/CreditCard/modules/PointExchange.ts","../../../src/views/projects/BestMileageCards/CreditCard/createCard.ts","../../../src/views/projects/BestMileageCards/configs/defaultCards/utils.ts","../../../src/views/projects/BestMileageCards/configs/defaultCards/cathay.ts","../../../src/views/projects/BestMileageCards/configs/defaultCards/esunbank.ts","../../../src/views/projects/BestMileageCards/configs/defaultCards/hsbc.ts","../../../src/views/projects/BestMileageCards/configs/defaultCards/index.ts","../../../src/views/projects/BestMileageCards/configs/storeAliases.ts","../../../src/views/projects/BestMileageCards/utils.ts","../../../src/views/projects/BestMileageCards/store.ts","../../../src/views/projects/BestMileageCards/containers/CommonSettings.vue","../../../src/utils/cloneDeep.ts","../../../src/components/CardList.vue","../../../src/components/FullscreenDialog.vue","../../../src/components/NumberField.vue","../../../src/components/TextFiled.vue","../../../src/views/projects/BestMileageCards/containers/CreditCardManagement.vue","../../../src/views/projects/BestMileageCards/containers/SearchReward.vue","../../../src/views/projects/BestMileageCards/containers/StoreAliasManagement.vue","../../../src/views/projects/BestMileageCards/App.vue","../../../src/views/projects/BestMileageCards/main.ts"],"sourcesContent":["<template>\n  <v-combobox\n    v-if=\"addable\"\n    ref=\"comboboxComponent\"\n    :model-value=\"modelValue\"\n    :items=\"itemList\"\n    :label=\"label\"\n    hint=\"可新增內容\"\n    multiple\n    persistent-hint\n    :hide-details=\"hideDetails\"\n    :hide-selected=\"!showSelected\"\n    @update:model-value=\"updateModelValue\"\n    @update:menu=\"closeKeyboard(comboboxComponent)\"\n  >\n    <template #selection=\"{ item }\">\n      <v-chip closable @click:close=\"remove(item.value)\">\n        {{ item.value }}\n      </v-chip>\n    </template>\n    <template v-if=\"modelValue.length !== 0\" #details>\n      <p class=\"cursor-pointer text-red\" @click=\"clearList\">全部刪除</p>\n    </template>\n  </v-combobox>\n  <v-autocomplete\n    v-else-if=\"searchable\"\n    ref=\"autocompleteComponent\"\n    :model-value=\"modelValue\"\n    :items=\"itemList\"\n    :hide-details=\"hideDetails\"\n    :label=\"label\"\n    multiple\n    :hide-selected=\"!showSelected\"\n    clear-on-select\n    @update:model-value=\"updateModelValue\"\n    @update:menu=\"closeKeyboard(autocompleteComponent)\"\n  >\n    <template #selection=\"{ item }\">\n      <v-chip closable @click:close=\"remove(item.value)\">\n        {{ item.value }}\n      </v-chip>\n    </template>\n    <template v-if=\"modelValue.length !== 0\" #details>\n      <p class=\"cursor-pointer text-red\" @click=\"clearList\">全部刪除</p>\n    </template>\n  </v-autocomplete>\n  <v-select\n    v-else\n    ref=\"selectComponent\"\n    :model-value=\"modelValue\"\n    :items=\"itemList\"\n    :hide-details=\"hideDetails\"\n    :label=\"label\"\n    multiple\n    :hide-selected=\"!showSelected\"\n    @update:model-value=\"updateModelValue\"\n    @update:menu=\"closeKeyboard(selectComponent)\"\n  >\n    <template #selection=\"{ item }\">\n      <v-chip closable @click:close=\"remove(item.value)\">\n        {{ item.value }}\n      </v-chip>\n    </template>\n    <template v-if=\"modelValue.length !== 0\" #details>\n      <p class=\"cursor-pointer text-red\" @click=\"clearList\">全部刪除</p>\n    </template>\n  </v-select>\n</template>\n<script lang=\"ts\" generic=\"Item extends string\" setup>\nimport { computed, useTemplateRef } from 'vue'\n\nimport { sortList } from '@/utils/sorts'\n\nconst comboboxComponent = useTemplateRef<HTMLElement>('comboboxComponent')\nconst autocompleteComponent = useTemplateRef<HTMLElement>('autocompleteComponent')\nconst selectComponent = useTemplateRef<HTMLElement>('selectComponent')\n\nconst {\n  modelValue = [],\n  list,\n  label,\n  searchable = false,\n  addable = false,\n  showSelected = false,\n  hideDetails = false,\n} = defineProps<{\n  modelValue: readonly Item[] | undefined\n  list: readonly Item[]\n  label: string\n  message?: string\n  searchable?: boolean\n  addable?: boolean\n  /** 如果不顯示勾選框，會隱藏掉已經選擇的選項 */\n  showSelected?: boolean\n  hideDetails?: boolean\n}>()\n\nconst emits = defineEmits<{\n  'update:model-value': [newValue: Item[]]\n}>()\n\nconst itemList = computed(() => sortList(list, 'asc'))\n\nfunction remove(removeItem: Item): void {\n  const newList = modelValue.filter((item) => item !== removeItem)\n  updateModelValue(newList)\n}\n\nfunction updateModelValue([...newValue]: readonly Item[]): void {\n  emits('update:model-value', newValue)\n}\n\nfunction closeKeyboard(element: HTMLElement | null): (status: boolean) => void {\n  return function (status: boolean): void {\n    if (!status && element !== null) {\n      element.blur()\n    }\n  }\n}\n\nfunction clearList(): void {\n  updateModelValue([])\n}\n</script>\n","import { floorByDigits, roundByDigits } from '@/utils'\n\nconst floorBy0 = floorByDigits(0)\nconst roundBy0 = roundByDigits(0)\nconst roundBy2 = roundByDigits(2)\n\ninterface RateItem {\n  rate: number\n  limit?: number | null\n}\n\ninterface BaseRewardStrategyParams<Type extends RewardType> {\n  /** 回饋名稱 */\n  name: string | null\n  /** 點數累積類型 */\n  type: Type\n}\nabstract class BaseRewardStrategy<Type extends RewardType> {\n  /** 回饋名稱 */\n  protected readonly _name: string | null\n  /** 點數累積類型 */\n  protected readonly _type: Type\n\n  public constructor({ type, name }: BaseRewardStrategyParams<Type>) {\n    this._type = type\n    this._name = name\n  }\n\n  /** 回饋名稱 */\n  public get name(): string | null {\n    return this._name\n  }\n  /** 點數累積類型 */\n  public get type(): Type {\n    return this._type\n  }\n  public abstract get description(): string\n\n  // TODO: 標準成本 baselineCostPerMile\n  // TODO: 最優成本 bestCaseCostPerMile\n  // TODO: 最差成本 maximumCostPerMile\n\n  /**\n   * @param amount 金額\n   * @returns 回饋點數\n   */\n  public abstract calculatePoints(amount: number): number\n  public calculateRangePointsCost(\n    minAmount: number,\n    maxAmount: number,\n  ): { max: number; min: number; average: number } {\n    const list: number[] = []\n    for (let amount = minAmount; amount <= maxAmount; amount++) {\n      const data = roundBy2(amount / this.calculatePoints(amount))\n      if (isNaN(data) || data === Infinity || data === -Infinity) {\n        continue\n      }\n      list.push(data)\n    }\n    list.sort((a, b) => a - b)\n    const max = list[list.length - 1]\n    const min = list[0]\n    if (max === undefined || min === undefined) {\n      throw new Error('cannot be calculated')\n    }\n    const average =\n      list.reduce((previousValue, currentValue) => previousValue + currentValue, 0) / list.length\n    return {\n      max,\n      min,\n      average: roundBy2(average),\n    }\n  }\n  public abstract toJSON(): RewardConfig\n}\n\n/** 點數回饋 (N%回饋點數，四捨五入) */\nexport class RoundedPercentageReward<\n  Type extends 'RoundedPercentageReward',\n> extends BaseRewardStrategy<Type> {\n  /** N% 回饋（四捨五入） */\n  private readonly _pointBackRates: RateItem[]\n\n  public constructor({\n    pointBackRates,\n    ...superParams\n  }: {\n    /** N% 回饋（四捨五入） */\n    pointBackRates: RateItem[]\n  } & BaseRewardStrategyParams<Type>) {\n    super(superParams)\n    this._pointBackRates = pointBackRates\n  }\n  private get _maxRete(): number {\n    return this._pointBackRates.reduce((total, { rate }) => total + rate, 0)\n  }\n  public get pointBackRates(): RateItem[] {\n    return this._pointBackRates\n  }\n  public get description(): string {\n    return `消費${this._pointBackRates.length > 1 ? '最高' : ''}${this._maxRete.toString()}%回饋點數(四捨五入)`\n  }\n\n  public calculatePoints(amount: number): number {\n    let points = 0\n    for (const { rate, limit } of this._pointBackRates) {\n      points += Math.min(roundBy0(amount * (rate / 100)), limit ?? Infinity)\n    }\n    return points\n  }\n\n  public toJSON(): RewardConfig {\n    return {\n      name: this._name,\n      type: this._type,\n      pointBackRates: this._pointBackRates,\n    }\n  }\n}\n\n/** 點數回饋 (N%回饋點數，無條件捨去) */\nexport class TruncatedPercentageReward<\n  Type extends 'TruncatedPercentageReward',\n> extends BaseRewardStrategy<Type> {\n  /** N% 回饋（無條件捨去） */\n  private readonly _pointBackRates: RateItem[]\n\n  public constructor({\n    pointBackRates,\n    ...superParams\n  }: {\n    /** N% 回饋（無條件捨去） */\n    pointBackRates: RateItem[]\n  } & BaseRewardStrategyParams<Type>) {\n    super(superParams)\n    this._pointBackRates = pointBackRates\n  }\n  private get _maxRete(): number {\n    return this._pointBackRates.reduce((total, { rate }) => total + rate, 0)\n  }\n  public get pointBackRates(): RateItem[] {\n    return this._pointBackRates\n  }\n  public get description(): string {\n    return `消費${this._pointBackRates.length > 1 ? '最高' : ''}${this._maxRete.toString()}%回饋點數(無條件捨去)`\n  }\n\n  public calculatePoints(amount: number): number {\n    let points = 0\n    for (const { rate, limit } of this._pointBackRates) {\n      points += Math.min(floorBy0(amount * (rate / 100)), limit ?? Infinity)\n    }\n    return points\n  }\n\n  public toJSON(): RewardConfig {\n    return {\n      name: this._name,\n      type: this._type,\n      pointBackRates: this._pointBackRates,\n    }\n  }\n}\n\n/** 哩程回饋 (消費 N 元取得一點，小數會累計) */\nexport class AccumulatedPointsReward<\n  Type extends 'AccumulatedPointsReward',\n> extends BaseRewardStrategy<Type> {\n  /** N 元一哩 */\n  private readonly _spendingPerPoint: number\n\n  public constructor({\n    spendingPerPoint,\n    ...superParams\n  }: {\n    /** N 元一哩 */\n    spendingPerPoint: number\n  } & BaseRewardStrategyParams<Type>) {\n    super({ ...superParams })\n    this._spendingPerPoint = spendingPerPoint\n  }\n\n  /** N 元一哩 */\n  public get spendingPerPoint(): number {\n    return this._spendingPerPoint\n  }\n  public get description(): string {\n    return `每消費${this._spendingPerPoint.toString()}元累積1點 (小數會累計)`\n  }\n\n  public calculatePoints(amount: number): number {\n    return roundBy2(amount / this._spendingPerPoint)\n  }\n\n  public toJSON(): RewardConfig {\n    return {\n      name: this._name,\n      type: this._type,\n      spendingPerPoint: this._spendingPerPoint,\n    }\n  }\n}\n\n/** 哩程回饋 (消費 N 元取得一點) */\nexport class FixedRatePointsReward<\n  Type extends 'FixedRatePointsReward',\n> extends BaseRewardStrategy<Type> {\n  /** N 元一哩 */\n  private readonly _spendingPerPoint: number\n\n  public constructor({\n    spendingPerPoint,\n    ...superParams\n  }: {\n    /** N 元一哩 */\n    spendingPerPoint: number\n  } & BaseRewardStrategyParams<Type>) {\n    super({ ...superParams })\n    this._spendingPerPoint = spendingPerPoint\n  }\n\n  /** N 元一哩 */\n  public get spendingPerPoint(): number {\n    return this._spendingPerPoint\n  }\n  public get description(): string {\n    return `每消費${this._spendingPerPoint.toString()}元累積1點 (小數不累計)`\n  }\n\n  public calculatePoints(amount: number): number {\n    return floorBy0(amount / this._spendingPerPoint)\n  }\n\n  public toJSON(): RewardConfig {\n    return {\n      name: this._name,\n      type: this._type,\n      spendingPerPoint: this._spendingPerPoint,\n    }\n  }\n}\n\nconst rewards = {\n  RoundedPercentageReward,\n  TruncatedPercentageReward,\n  AccumulatedPointsReward,\n  FixedRatePointsReward,\n} as const\nexport type RewardType = keyof typeof rewards\nexport type Reward<Type extends RewardType> = InstanceType<(typeof rewards)[Type]>\nexport type RewardConfig = ConstructorParameters<(typeof rewards)[RewardType]>[0]\n\nexport function rewardStrategyFactory<Type extends RewardType>(\n  params: RewardConfig & { type: Type },\n): Reward<Type> {\n  // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n  // @ts-expect-error\n  // eslint-disable-next-line @typescript-eslint/no-unsafe-return\n  return new rewards[params.type](params)\n}\n","import { removeDuplicates } from '@/utils'\n\nimport { type Reward, type RewardType } from './Reward'\nimport type {\n  Payment,\n  TransactionInfo,\n  RewardInfo,\n  TransactionType,\n  PlanConfig,\n  ConditionType,\n  RewardRuleConfig,\n} from './type'\n\ninterface PlanReward {\n  readonly rewardStrategy: Reward<RewardType>\n  readonly stores: ReadonlySet<string>\n  readonly storeBlackList: ReadonlySet<string>\n  readonly payments: ReadonlySet<Payment>\n  readonly paymentBlackList: ReadonlySet<Payment>\n  readonly transactionType: TransactionType | null\n  readonly condition: ConditionType | null\n}\n\nexport class Plan {\n  private readonly _name: string | null\n  private readonly _description: string | null\n  private readonly _rewards: readonly PlanReward[]\n  private readonly _condition: ConditionType | null\n\n  public constructor(\n    name: string | null,\n    description: string | null,\n    condition: ConditionType | null,\n    rewards: PlanReward[],\n  ) {\n    this._name = name\n    this._description = description\n    this._condition = condition\n    if (rewards.length === 0) {\n      throw new Error(`Plan \"${name ?? 'unknown'}\" must have at least one reward rule.`)\n    }\n    this._rewards = rewards\n  }\n\n  public get name(): string | null {\n    return this._name\n  }\n  public get description(): string | null {\n    return this._description\n  }\n  /** 方便在前端做選單或 autocomplete 用的 */\n  public get storeList(): string[] {\n    return removeDuplicates(\n      this._rewards.flatMap((reward) => [...reward.stores, ...reward.storeBlackList]),\n    )\n  }\n\n  public checkPlanIsVisible(currentConditions: ConditionType[] | null): boolean {\n    return this._condition === null || Boolean(currentConditions?.includes(this._condition))\n  }\n\n  public getApplicableReward({\n    transactionStore = null,\n    acceptedPayments = [],\n    transactionAttributesType,\n    currentConditions = null,\n  }: {\n    transactionStore?: string | null | undefined\n    acceptedPayments?: Payment[] | undefined\n    transactionAttributesType: TransactionType\n    currentConditions?: ConditionType[] | null | undefined\n  }): PlanReward | null {\n    if (this._condition !== null && !currentConditions?.includes(this._condition)) {\n      return null\n    }\n    return (\n      this._rewards.find(\n        ({\n          stores,\n          payments,\n          transactionType,\n          paymentBlackList,\n          storeBlackList,\n          condition,\n        }: PlanReward): boolean => {\n          const isStoreValid =\n            transactionStore === null || stores.size === 0 || stores.has(transactionStore)\n          const isStoreNotBlackListed =\n            transactionStore === null ||\n            storeBlackList.size === 0 ||\n            !storeBlackList.has(transactionStore)\n\n          const isPaymentValid =\n            acceptedPayments.length === 0 ||\n            payments.size === 0 ||\n            acceptedPayments.some((payment) => payments.has(payment))\n          const isPaymentNotBlackListed =\n            acceptedPayments.length === 0 ||\n            paymentBlackList.size === 0 ||\n            acceptedPayments.some((item) => !paymentBlackList.has(item))\n\n          const isTransactionTypeMatch =\n            transactionType === null || transactionAttributesType === transactionType\n          const conditionValid =\n            condition === null || Boolean(currentConditions?.includes(condition))\n\n          return (\n            isStoreValid &&\n            isStoreNotBlackListed &&\n            isPaymentValid &&\n            isPaymentNotBlackListed &&\n            isTransactionTypeMatch &&\n            conditionValid\n          )\n        },\n      ) ?? null\n    )\n  }\n\n  public getRewardMiles({\n    transactionStore,\n    acceptedPayments,\n    amount,\n    transactionAttributesType,\n    currentConditions,\n  }: TransactionInfo): Pick<\n    RewardInfo,\n    'rewardName' | 'rewardPoints' | 'payments' | 'rewardStrategy'\n  > | null {\n    const reward = this.getApplicableReward({\n      acceptedPayments,\n      transactionStore,\n      transactionAttributesType,\n      currentConditions,\n    })\n    if (reward === null) {\n      return null\n    }\n    const payments =\n      acceptedPayments === undefined\n        ? [...reward.payments.values()]\n        : acceptedPayments.filter((item) => reward.payments.has(item))\n    const rewardPoints = reward.rewardStrategy.calculatePoints(amount)\n    if (rewardPoints === 0) {\n      return null\n    }\n    return {\n      rewardName: reward.rewardStrategy.name,\n      rewardPoints: reward.rewardStrategy.calculatePoints(amount),\n      payments: payments.filter((payment) => !reward.paymentBlackList.has(payment)),\n      rewardStrategy: reward.rewardStrategy,\n    }\n  }\n\n  public toJSON(): Required<PlanConfig> & { rewards: Required<RewardRuleConfig>[] } {\n    return {\n      name: this._name,\n      description: this._description,\n      condition: this._condition,\n      rewards: this._rewards.map(\n        ({\n          rewardStrategy,\n          stores,\n          payments,\n          transactionType,\n          paymentBlackList,\n          storeBlackList,\n          condition,\n        }) => ({\n          rewardStrategy: rewardStrategy.toJSON(),\n          stores: [...stores],\n          storeBlackList: [...storeBlackList],\n          payments: [...payments],\n          paymentBlackList: [...paymentBlackList],\n          transactionType,\n          condition,\n        }),\n      ),\n    }\n  }\n}\n","import type { DateISOString, UUID } from '@/types'\n\nimport type { PointExchangeConfig, PointExchangeStrategy } from './PointExchange'\nimport type { Reward, RewardConfig, RewardType } from './Reward'\n\nexport const Payment = [\n  '信用卡',\n  'Apple Pay',\n  'Samsung Pay',\n  'Google Pay',\n  'Line Pay',\n  'Fitbit Pay',\n  'Garmin Pay',\n  'Hami Pay',\n  '街口支付',\n  '全盈+PAY',\n  '全支付',\n  'Pi錢包',\n  '橘子支付',\n  '歐付寶',\n  'icash pay',\n  'OPEN錢包',\n  'My FamiPay',\n  '悠遊付',\n  'ezPay',\n  'GOMAJI Pay',\n  'friday wallet',\n  'PayPal',\n  'PX Pay',\n  '中油Pay',\n  '台灣Pay',\n  '支付寶',\n] as const\nexport type Payment = (typeof Payment)[number]\nexport type TransactionType = 'Domestic' | 'Foreign'\nexport const ConditionType = ['Birthday'] as const\nexport type ConditionType = (typeof ConditionType)[number]\n\n/** input 的交易資料 */\nexport interface TransactionInfo {\n  /** 消費店家 */\n  transactionStore?: string\n  /** 支援的交易方式 */\n  acceptedPayments?: Payment[]\n  /** 交易屬性（國內交易、國外交易） */\n  transactionAttributesType: TransactionType\n  currentConditions?: ConditionType[]\n  amount: number\n}\n\n/** 回饋哩程資訊 */\nexport interface RewardInfo {\n  readonly planId: UUID\n  readonly planName: string | null\n  readonly payments: readonly Payment[]\n  readonly rewardName: string | null\n  readonly rewardStrategy: Reward<RewardType> | null\n  readonly rewardPoints: number\n  readonly pointExchangeName: string\n  readonly pointExchangeStrategy: PointExchangeStrategy\n  readonly airlineCode: string\n  readonly miles: number\n}\n\nexport interface RewardRuleConfig {\n  rewardStrategy: RewardConfig\n  transactionType?: TransactionType | null\n  stores?: string[]\n  storeBlackList?: string[]\n  payments?: Payment[]\n  paymentBlackList?: Payment[]\n  condition?: ConditionType | null\n}\nexport interface PlanConfig {\n  name: string | null\n  description?: string | null\n  /** 回饋列表會有順序問題，前面的達成後就不會往下搜索，所以需要注意順序 */\n  rewards: RewardRuleConfig[]\n  condition?: ConditionType | null\n}\nexport interface CardConfig {\n  name: string\n  description?: string | null\n  cardUrl: string | null\n  storeBlackList?: string[]\n  paymentBlackList?: Payment[]\n  selectedPlanId?: UUID\n  plans: { id: UUID; config: PlanConfig }[]\n  /** 最後更新卡片權益的時間 */\n  updateAt: DateISOString\n  selectedPointExchangeId?: UUID\n  pointExchanges: { id: UUID; config: PointExchangeConfig }[]\n}\n","import type { UUID } from '@/types'\nimport { removeDuplicates } from '@/utils'\n\nimport { Plan } from './Plan'\nimport type { PointExchangeStrategy } from './PointExchange'\nimport { type TransactionInfo, type RewardInfo, type CardConfig, Payment } from './type'\n\ninterface CardParams {\n  /** 卡片名稱 */\n  readonly name: string\n  readonly description: string | null\n  /** 全部的方案 (如果像旅人卡那樣，只有一種回饋方式這邊選項就會只有一個) */\n  readonly plans: ReadonlyMap<UUID, Plan>\n  /** 信用卡網頁 */\n  readonly cardUrl: string | null\n  /** 不回饋商店清單 */\n  readonly storeBlackList: ReadonlySet<string>\n  /** 不回饋支付方式清單 */\n  readonly paymentBlackList: ReadonlySet<Payment>\n  /** 最後更新卡片回饋設定日期（不包含切換方案等使用者設定） */\n  readonly updateAt: Date\n  /** 點數交換策略 */\n  readonly pointExchanges: ReadonlyMap<UUID, PointExchangeStrategy>\n  readonly selectedPlanId: UUID | null\n  readonly selectedPointExchangeId: UUID | null\n}\n\n// TODO\n// 之後要再想看看能怎麼實作讓 card 這邊可以吃 type, pointsPerMile, milesPerUnit 這些資料\n// 目前放在 reward 裡面可能不是好方法（畢竟目前已知的卡片都是固定回饋方式的）\nexport class CreditCard {\n  /** 當前選擇的方案 */\n  private _selectedPlanId: UUID\n  /** 當前選擇的交換方式 */\n  private _selectedPointExchangeId: UUID\n  /** 卡片名稱 */\n  private readonly _name: string\n  private readonly _description: string | null\n  /** 全部的方案 (如果像旅人卡那樣，只有一種回饋方式這邊選項就會只有一個) */\n  private readonly _plans: ReadonlyMap<UUID, Plan>\n  /** 信用卡的銀行網頁 */\n  private readonly _cardUrl: string | null\n  /** 不回饋商店清單 */\n  private readonly _storeBlackList: ReadonlySet<string>\n  /** 不回饋支付方式清單 */\n  private readonly _paymentBlackList: ReadonlySet<Payment>\n  /** 最後更新卡片回饋設定日期（不包含切換方案等使用者設定） */\n  private readonly _updateAt: Date\n  /** 點數交換策略 */\n  private readonly _pointExchanges: ReadonlyMap<UUID, PointExchangeStrategy>\n\n  public constructor({\n    name,\n    description,\n    plans,\n    storeBlackList,\n    paymentBlackList,\n    cardUrl,\n    updateAt,\n    pointExchanges,\n    selectedPlanId,\n    selectedPointExchangeId,\n  }: CardParams) {\n    this._name = name\n    this._description = description\n    this._plans = plans\n    this._cardUrl = cardUrl\n    this._storeBlackList = storeBlackList\n    this._paymentBlackList = paymentBlackList\n    this._updateAt = updateAt\n    this._pointExchanges = pointExchanges\n\n    const planId = selectedPlanId ?? this._plans.keys().next().value ?? null\n    if (planId === null) {\n      throw new Error(`this plan id ${planId} not found`)\n    }\n    this._selectedPlanId = planId\n\n    const pointExchangeId =\n      selectedPointExchangeId ?? this._pointExchanges.keys().next().value ?? null\n    if (pointExchangeId === null) {\n      throw new Error(`this point exchange id ${pointExchangeId} not found`)\n    }\n    this._selectedPointExchangeId = pointExchangeId\n  }\n\n  /** 卡片名稱 */\n  public get name(): string {\n    return this._name\n  }\n  public get description(): string | null {\n    return this._description\n  }\n  public get selectedPlanId(): UUID {\n    return this._selectedPlanId\n  }\n  public get selectedPlan(): Plan {\n    return this._getPlan(this._selectedPlanId)\n  }\n  public get selectedPointExchangeId(): UUID {\n    return this._selectedPointExchangeId\n  }\n  public get selectedPointExchange(): PointExchangeStrategy {\n    return this._getPointExchangeStrategy(this._selectedPointExchangeId)\n  }\n  /** 回傳 uuid 跟 plan name */\n  public get selectablePlan(): { id: UUID; name: string | null; description: string | null }[] {\n    // TODO: 要過濾 conditions\n    return [...this._plans.entries()].map(([id, { name, description }]) => ({\n      id,\n      name,\n      description,\n    }))\n  }\n  public get selectablePointExchange(): {\n    id: UUID\n    name: string\n    description: string\n  }[] {\n    return [...this._pointExchanges.entries()].map(([id, { name, description }]) => ({\n      id,\n      name,\n      description,\n    }))\n  }\n  /** 方便在前端做選單或 autocomplete 用的 */\n  public get storeList(): string[] {\n    return removeDuplicates([\n      ...[...this._plans.values()].flatMap((plan) => plan.storeList),\n      ...this._storeBlackList,\n    ])\n  }\n  public get cardUrl(): string | null {\n    return this._cardUrl\n  }\n\n  private _getPlan(id: UUID): Plan {\n    const plan = this._plans.get(id)\n    if (plan === undefined) {\n      throw new Error(\n        `plan id ${id} not found. Available plans: ${[...this._plans.keys()].join(', ')}`,\n      )\n    }\n    return plan\n  }\n  private _getPointExchangeStrategy(id: UUID): PointExchangeStrategy {\n    const pointExchangeStrategy = this._pointExchanges.get(id)\n    if (pointExchangeStrategy === undefined) {\n      throw new Error(\n        `pointExchangeStrategy id ${id} not found. Available pointExchanges: ${[...this._plans.keys()].join(', ')}`,\n      )\n    }\n    return pointExchangeStrategy\n  }\n  private _rewardMilesWithPlan(\n    planId: UUID,\n    pointExchangeStrategyId: UUID,\n    paymentInfo: TransactionInfo,\n  ): RewardInfo {\n    const plan = this._getPlan(planId)\n    const pointExchangeStrategy = this._getPointExchangeStrategy(pointExchangeStrategyId)\n    const noneMatchRewardInfo: RewardInfo = {\n      planId,\n      planName: plan.name,\n      rewardName: null,\n      rewardPoints: 0,\n      payments: [],\n      rewardStrategy: null,\n      pointExchangeStrategy,\n      pointExchangeName: pointExchangeStrategy.name,\n      airlineCode: pointExchangeStrategy.airlineCode,\n      miles: 0,\n    }\n    const inStoreBlackList =\n      paymentInfo.transactionStore !== undefined &&\n      this._storeBlackList.has(paymentInfo.transactionStore)\n    const inPaymentBlackList = paymentInfo.acceptedPayments?.some((payment) =>\n      this._paymentBlackList.has(payment),\n    )\n    if (inStoreBlackList || inPaymentBlackList) {\n      return noneMatchRewardInfo\n    }\n    const rewardInfo = plan.getRewardMiles(paymentInfo)\n    if (rewardInfo === null) {\n      return noneMatchRewardInfo\n    }\n    return {\n      planId,\n      planName: plan.name,\n      pointExchangeStrategy,\n      pointExchangeName: pointExchangeStrategy.name,\n      miles: pointExchangeStrategy.calculateMiles(rewardInfo.rewardPoints),\n      airlineCode: pointExchangeStrategy.airlineCode,\n      ...rewardInfo,\n    }\n  }\n\n  public getRewardInfos(\n    paymentInfo: TransactionInfo,\n    {\n      onlyCurrentPlan = false,\n      onlyCurrentExchangeStrategy = false,\n    }: { onlyCurrentPlan?: boolean; onlyCurrentExchangeStrategy?: boolean } = {},\n  ): RewardInfo[] {\n    const plans: [UUID, Plan][] = onlyCurrentPlan\n      ? [[this._selectedPlanId, this.selectedPlan]]\n      : [...this._plans.entries()]\n    const exchangeIds: UUID[] = onlyCurrentExchangeStrategy\n      ? [this._selectedPointExchangeId]\n      : [...this._pointExchanges.keys()]\n    const rewardInfos: RewardInfo[] = []\n    for (const [planId, plan] of plans) {\n      const planIsVisible = plan.checkPlanIsVisible(paymentInfo.currentConditions ?? null)\n      if (!planIsVisible) {\n        continue\n      }\n      for (const pointExchangeStrategyId of exchangeIds) {\n        const rewardInfo = this._rewardMilesWithPlan(planId, pointExchangeStrategyId, paymentInfo)\n        rewardInfos.push(rewardInfo)\n      }\n    }\n    return rewardInfos\n  }\n  public toJSON(): Required<Required<CardConfig>> {\n    return {\n      name: this._name,\n      description: this._description,\n      cardUrl: this._cardUrl,\n      storeBlackList: [...this._storeBlackList],\n      paymentBlackList: [...this._paymentBlackList],\n      selectedPlanId: this._selectedPlanId,\n      plans: [...this._plans].map(([id, plan]) => ({ id, config: plan.toJSON() })),\n      updateAt: this._updateAt.toISOString(),\n      selectedPointExchangeId: this._selectedPointExchangeId,\n      pointExchanges: [...this._pointExchanges].map(([id, strategy]) => ({\n        id,\n        config: strategy.toJSON(),\n      })),\n    }\n  }\n}\n","import { roundByDigits } from '@/utils'\n\nconst roundBy2 = roundByDigits(2)\n\nexport class PointExchangeStrategy {\n  /** 點數交換名稱 */\n  private readonly _name: string\n  /** 航空代碼 */\n  private readonly _airlineCode: string\n  /** N 點可以換里程 */\n  private readonly _pointsPerMile: number\n  /** 可以換 M 哩里程 */\n  private readonly _milesPerUnit: number\n\n  public constructor({\n    name,\n    airlineCode,\n    pointsPerMile,\n    milesPerUnit,\n  }: {\n    /** 點數交換名稱 */\n    name: string\n    /** 航空代碼 */\n    airlineCode: string\n    /** N 點可以換里程 */\n    pointsPerMile: number\n    /** 可以換 M 哩里程 */\n    milesPerUnit: number\n  }) {\n    this._name = name\n    this._airlineCode = airlineCode\n    this._pointsPerMile = pointsPerMile\n    this._milesPerUnit = milesPerUnit\n  }\n\n  /** 點數交換名稱 */\n  public get name(): string {\n    return this._name\n  }\n  public get description(): string {\n    return `${this._pointsPerMile}點可以交換${this._milesPerUnit}哩程`\n  }\n  /** 航空代碼 */\n  public get airlineCode(): string {\n    return this._airlineCode\n  }\n  /** N 點可以換里程 */\n  public get pointsPerMile(): number {\n    return this._pointsPerMile\n  }\n  /** 可以換 M 哩里程 */\n  public get milesPerUnit(): number {\n    return this._milesPerUnit\n  }\n\n  /** input: 點數, output: 哩程 */\n  public calculateMiles(points: number): number {\n    return roundBy2((points * this._milesPerUnit) / this._pointsPerMile)\n  }\n\n  public toJSON(): PointExchangeConfig {\n    return {\n      name: this._name,\n      airlineCode: this._airlineCode,\n      pointsPerMile: this._pointsPerMile,\n      milesPerUnit: this._milesPerUnit,\n    }\n  }\n}\n\nexport type PointExchangeConfig = ConstructorParameters<typeof PointExchangeStrategy>[0]\n","import typia from 'typia'\n\nimport type { UUID } from '@/types'\nimport {\n  PointExchangeStrategy,\n  type PointExchangeConfig,\n} from '@/views/projects/BestMileageCards/CreditCard/modules/PointExchange'\n\nimport { CreditCard } from './modules/Card'\nimport { Plan } from './modules/Plan'\nimport { rewardStrategyFactory } from './modules/Reward'\nimport type { CardConfig, PlanConfig } from './modules/type'\n\nexport function createCard({\n  name,\n  description,\n  storeBlackList,\n  paymentBlackList,\n  cardUrl,\n  plans: planConfigs,\n  updateAt,\n  pointExchanges,\n  selectedPlanId,\n  selectedPointExchangeId,\n}: CardConfig): CreditCard {\n  const plans = new Map<UUID, Plan>(\n    planConfigs.map(({ id, config: { name, description, condition, rewards } }) => [\n      id,\n      new Plan(\n        name,\n        description ?? null,\n        condition ?? null,\n        rewards.map(\n          ({\n            stores,\n            payments,\n            transactionType,\n            rewardStrategy,\n            paymentBlackList,\n            storeBlackList,\n            condition,\n          }) => ({\n            rewardStrategy: rewardStrategyFactory(rewardStrategy),\n            stores: new Set(stores),\n            storeBlackList: new Set(storeBlackList),\n            payments: new Set(payments),\n            paymentBlackList: new Set(paymentBlackList),\n            transactionType: transactionType ?? null,\n            condition: condition ?? null,\n          }),\n        ),\n      ),\n    ]),\n  )\n  return new CreditCard({\n    name,\n    description: description ?? null,\n    plans,\n    storeBlackList: new Set(storeBlackList),\n    paymentBlackList: new Set(paymentBlackList),\n    cardUrl,\n    updateAt: new Date(updateAt),\n    selectedPlanId: selectedPlanId ?? null,\n    selectedPointExchangeId: selectedPointExchangeId ?? null,\n    pointExchanges: new Map(\n      pointExchanges.map(({ id, config }) => [id, new PointExchangeStrategy(config)]),\n    ),\n  })\n}\n\nexport const isCardConfig = typia.createIs<CardConfig>()\nexport const isCardPlanConfig = typia.createIs<PlanConfig>()\nexport const isCardPointExchangeConfig = typia.createIs<PointExchangeConfig>()\n","import { format } from 'date-fns'\n\nimport type { DateString } from '@/types/date'\n\nexport const cardDescription = getRewardDescription('2025/6/30')\n\nexport function getRewardDescription(end: DateString, start?: DateString): string {\n  if (start === undefined) {\n    return `權益 ~${format(end, 'yyyy/M/d')}`\n  }\n  if (format(start, 'yyyy') === format(end, 'yyyy')) {\n    return `權益 ${format(start, 'yyyy/M/d')}~${format(end, 'M/d')}`\n  }\n  return `權益 ${format(start, 'yyyy/M/d')}~${format(end, 'yyyy/M/d')}`\n}\n","import { generateUuid } from '@/utils'\n\nimport type { CardConfig, Payment } from '../../CreditCard'\nimport { cardDescription, getRewardDescription } from './utils'\n\nconst storeBlackList: string[] = ['分期付款']\nconst paymentBlackList: Payment[] = []\n\nconst payments: Payment[] = [\n  '信用卡',\n  'Apple Pay',\n  'Samsung Pay',\n  'Google Pay',\n  'Fitbit Pay',\n  'Garmin Pay',\n  'Hami Pay',\n]\n\nfunction cubePlanSettings(defaultBackRete: number): CardConfig['plans'] {\n  const baseReward: CardConfig['plans'][number]['config']['rewards'][number] = {\n    rewardStrategy: {\n      type: 'RoundedPercentageReward',\n      name: null,\n      pointBackRates: [{ rate: 0.3 }],\n    },\n  }\n\n  return [\n    {\n      id: generateUuid(),\n      config: {\n        name: '集精選',\n        description: '量販超市, 指定加油, 指定超商, 生活家居',\n        rewards: [\n          {\n            rewardStrategy: {\n              type: 'RoundedPercentageReward',\n              name: null,\n              pointBackRates: [{ rate: 2 }],\n            },\n            stores: [\n              '家樂福',\n              'LOPIA台灣',\n              '全聯福利中心',\n              '台灣中油-直營',\n              '7-ELEVEN',\n              '全家便利商店',\n              'IKEA',\n            ],\n            payments: [...payments, 'PX Pay', 'My FamiPay', 'OPEN錢包'],\n          },\n          baseReward,\n        ],\n      },\n    },\n    {\n      id: generateUuid(),\n      config: {\n        name: '玩數位',\n        description: '數位/串流平台, 網購平台, 國際電商, 辦公神器',\n        rewards: [\n          {\n            rewardStrategy: {\n              type: 'RoundedPercentageReward',\n              name: null,\n              pointBackRates: [{ rate: defaultBackRete }],\n            },\n            stores: [\n              'App Store',\n              'Apple Music',\n              'iCloud',\n              'Apple TV+',\n              'Apple Arcade',\n              'Apple One',\n              'iTunes',\n              'Google Play',\n              'Disney+',\n              'Netflix',\n              'Spotify',\n              'KKBOX',\n              'YouTube Premium',\n              'Max',\n              '蝦皮購物',\n              'momo購物網',\n              'PChome 24h購物(不含儲值及電子票券)',\n              '小樹購',\n              'Coupang 酷澎(台灣)',\n              '淘寶/天貓',\n              // 目前只公告到 2025/3/31\n              'ChatGPT',\n              'Dropbox',\n              'Surfshark',\n              'NordVPN',\n              'McAfee',\n              'Microsoft',\n              'LinkedIn',\n              'Whoscall',\n              'Zoom',\n            ],\n            paymentBlackList: ['Line Pay', '街口支付'],\n          },\n          { ...baseReward, storeBlackList: ['全聯福利中心'] },\n        ],\n      },\n    },\n    {\n      id: generateUuid(),\n      config: {\n        name: '樂饗購',\n        description: '國內指定百貨, 國內外送平台, 國內餐飲, 國內藥妝',\n        rewards: [\n          {\n            rewardStrategy: {\n              type: 'RoundedPercentageReward',\n              name: null,\n              pointBackRates: [{ rate: defaultBackRete }],\n            },\n            stores: [\n              '遠東SOGO百貨',\n              '遠東Garden City',\n              '太平洋百貨',\n              '新光三越',\n              'SKM Park',\n              'BELLAVITA',\n              '微風廣場',\n              '遠東百貨',\n              'Big City遠東巨城購物中心',\n              '誠品生活',\n              '環球購物中心',\n              'CITYLINK',\n              '統一時代',\n              '台北101',\n              'ATT 4 FUN',\n              '明曜百貨',\n              '京站',\n              '美麗華',\n              '大葉高島屋',\n              '比漾廣場',\n              '大江國際購物中心',\n              '中友百貨',\n              '廣三SOGO',\n              'Tiger City',\n              '勤美誠品綠園道',\n              '大魯閣新時代',\n              '耐斯廣場',\n              '南紡購物中心',\n              '夢時代',\n              '漢神百貨',\n              '漢神巨蛋',\n              'MITSUI OUTLET PARK 林口',\n              'MITSUI OUTLET PARK 台中港',\n              'MITSUI OUTLET PARK 台南',\n              'Mitsui Shopping Park LaLaport 台中',\n              '義大世界購物廣場',\n              '華泰名品城',\n              '義享天地',\n              '麗寶OUTLET Mall',\n              '秀泰生活',\n              '台茂購物中心',\n              '新月廣場',\n              '三創生活',\n              '宏匯廣場',\n              'NOKE忠泰樂生活',\n              'Uber Eats',\n              'foodpanda',\n              'foodomo',\n              '國內餐飲(不含餐券)',\n              '麥當勞',\n              '康是美',\n              '屈臣氏',\n            ],\n            payments,\n          },\n          { ...baseReward, storeBlackList: ['全聯福利中心'] },\n        ],\n      },\n    },\n    {\n      id: generateUuid(),\n      config: {\n        name: '趣旅行',\n        description:\n          '指定海外消費, 日本指定遊樂園, 國內外交通, 指定航空公司, 指定飯店住宿, 旅遊/訂房平台, 指定旅行社',\n        rewards: [\n          {\n            rewardStrategy: {\n              type: 'RoundedPercentageReward',\n              name: null,\n              pointBackRates: [{ rate: defaultBackRete }],\n            },\n            stores: [\n              '海外實體消費',\n              '東京迪士尼樂園',\n              '東京華納兄弟哈利波特影城',\n              '大阪環球影城(USJ)',\n              'Apple Wallet SUICA',\n              'Apple Wallet PASMO',\n              'Apple Wallet ICOCA',\n              'Uber',\n              'Grab',\n              '台灣高鐵',\n              'yoxi',\n              '台灣大車隊',\n              'iRent',\n              '和運租車',\n              '格上租車',\n              '中華航空',\n              '長榮航空',\n              '星宇航空',\n              '台灣虎航',\n              '國泰航空',\n              '樂桃航空',\n              '阿聯酋航空',\n              '酷航',\n              '捷星航空',\n              '日本航空',\n              '亞洲航空',\n              '聯合航空',\n              'ANA全日空',\n              '新加坡航空',\n              '越捷航空',\n              '大韓航空',\n              '達美航空',\n              '土耳其航空',\n              '卡達航空',\n              '法國航空',\n              '國內飯店住宿',\n              '星野集團',\n              '全球迪士尼飯店',\n              '東橫INN',\n              'KKday',\n              'Agoda',\n              'Klook',\n              'Airbnb',\n              'Hotels.com',\n              'Expedia',\n              'Booking.com',\n              'Trip.com',\n              'AsiaYo',\n              'ezTravel易遊網',\n              '雄獅旅遊',\n              '可樂旅遊',\n              '東南旅遊',\n              '五福旅遊',\n              '燦星旅遊',\n              '山富旅遊',\n              '長汎假期',\n              '鳳凰旅行社',\n              'Ezfly易飛網',\n              '理想旅遊',\n              '永利旅行社',\n              '三賀旅行社',\n            ],\n            payments,\n          },\n          { ...baseReward, storeBlackList: ['全聯福利中心'] },\n        ],\n      },\n    },\n    {\n      id: generateUuid(),\n      config: {\n        name: '來支付',\n        description: 'LINE Pay消費',\n        rewards: [\n          {\n            rewardStrategy: {\n              type: 'RoundedPercentageReward',\n              name: null,\n              pointBackRates: [{ rate: 2 }],\n            },\n            payments: ['Line Pay'],\n          },\n          { ...baseReward, storeBlackList: ['全聯福利中心'] },\n        ],\n      },\n    },\n    {\n      id: generateUuid(),\n      config: {\n        name: '慶生月',\n        description:\n          '指定百貨/休閒娛樂/國內外送平台 3.5%, 國外精選遊樂園實體消費/國內人氣樂園/指定蛋糕甜點店/指定咖啡廳/指定國內餐廳/KTV/派對/電玩 10%',\n        condition: 'Birthday',\n        rewards: [\n          {\n            rewardStrategy: {\n              type: 'RoundedPercentageReward',\n              name: null,\n              pointBackRates: [{ rate: 10 }],\n            },\n            stores: [\n              '東京迪士尼樂園',\n              '大阪環球影城(USJ)',\n              '名古屋樂高樂園',\n              '紅葉蛋糕官方網站',\n              '法朋烘焙甜點坊',\n              '興波咖啡 華山旗艦店',\n              '海底撈火鍋',\n              '輕井澤鍋物',\n              '老四川巴蜀麻辣燙',\n              '二本松涮涮屋',\n              '橋山.壽喜燒',\n              'Umai屋馬燒肉',\n              '老井極上燒肉',\n              '燒肉中山(台中大墩)',\n              '藏壽司台灣',\n              '貳樓',\n              '膳馨民間創作料理',\n              '馨苑小料理',\n              '雅室牛排 仁愛圓環店',\n              'ABV餐飲集團',\n              'WAT',\n              '臺虎精釀(信義 | 西門 | 臺中 | 啜飲室大安)',\n              'BAR Bodega',\n              'BAR MED',\n              'JiN Her 今鶴',\n              '錢櫃KTV',\n              '好樂迪KTV',\n              '星聚點KTV',\n              '享溫馨KTV',\n              'Nintendo',\n              '巴哈姆特動畫瘋',\n              '閃動格子CyberCube',\n            ],\n          },\n          {\n            rewardStrategy: {\n              type: 'RoundedPercentageReward',\n              name: null,\n              pointBackRates: [{ rate: 3.5 }],\n            },\n            stores: [\n              '新光三越',\n              'Uber Eats (不含 Uber One)',\n              'Agoda',\n              'Trip.com',\n              'Klook',\n              '國內飯店住宿',\n              '星野集團',\n              '全球迪士尼飯店',\n              '東橫INN',\n            ],\n          },\n          { ...baseReward, storeBlackList: ['全聯福利中心'] },\n        ],\n      },\n    },\n  ]\n}\n\nconst cubePointExchanges: CardConfig['pointExchanges'] = [\n  {\n    id: generateUuid(),\n    config: {\n      name: '長榮航空哩程',\n      airlineCode: 'EVA',\n      pointsPerMile: 360,\n      milesPerUnit: 1000,\n    },\n  },\n  {\n    id: generateUuid(),\n    config: {\n      name: '長榮航空哩程 + 長榮世界卡',\n      airlineCode: 'EVA',\n      pointsPerMile: 300,\n      milesPerUnit: 1000,\n    },\n  },\n]\n\nexport const cubeConfigs: CardConfig[] = [\n  {\n    name: 'Cube 卡',\n    description: `Cube 卡 (Level 1) 回饋方案 (${cardDescription})`,\n    cardUrl: 'https://www.cathaybk.com.tw/cathaybk/personal/product/credit-card/cards/cube/',\n    storeBlackList,\n    paymentBlackList,\n    updateAt: '2024-12-01T00:00:00.000Z',\n    plans: cubePlanSettings(2),\n    pointExchanges: cubePointExchanges,\n  },\n  {\n    name: 'Cube 卡',\n    description: `Cube 卡 (Level 2) 回饋方案 (${cardDescription})`,\n    cardUrl: 'https://www.cathaybk.com.tw/cathaybk/personal/product/credit-card/cards/cube/',\n    storeBlackList,\n    paymentBlackList,\n    updateAt: '2024-12-01T00:00:00.000Z',\n    plans: cubePlanSettings(3),\n    pointExchanges: cubePointExchanges,\n  },\n  {\n    name: 'Cube 卡',\n    description: `Cube 卡 (Level 3) 回饋方案 (${cardDescription})`,\n    cardUrl: 'https://www.cathaybk.com.tw/cathaybk/personal/product/credit-card/cards/cube/',\n    storeBlackList,\n    paymentBlackList,\n    updateAt: '2024-12-01T00:00:00.000Z',\n    plans: cubePlanSettings(3.3),\n    pointExchanges: cubePointExchanges,\n  },\n]\n\n// eslint-disable-next-line @typescript-eslint/no-non-null-assertion\nexport const exampleCubeConfig: CardConfig = cubeConfigs[1]!\n\nfunction evaPlanSettings(defaultSpendingPerPoint: number): CardConfig['plans'] {\n  return [\n    {\n      id: generateUuid(),\n      config: {\n        name: null,\n        description: '部分回饋需要另外登錄',\n        rewards: [\n          // TODO: 有空再想想要怎麼分開做要登錄跟不用登錄的計算\n          {\n            rewardStrategy: {\n              type: 'FixedRatePointsReward',\n              name: `Expedia專屬網頁線上訂房 ${getRewardDescription('2025/12/31')}`,\n              spendingPerPoint: 8,\n            },\n            stores: ['Expedia'],\n            payments: [\n              'Apple Pay',\n              'Samsung Pay',\n              'Google Pay',\n              'Fitbit Pay',\n              'Garmin Pay',\n              'Hami Pay',\n            ],\n          },\n          {\n            rewardStrategy: {\n              type: 'FixedRatePointsReward',\n              name: '長榮官網購票/機上免稅品',\n              spendingPerPoint: 10,\n            },\n            stores: ['長榮機上免稅品', '長榮官網購票'],\n          },\n          {\n            rewardStrategy: {\n              type: 'FixedRatePointsReward',\n              name: '海外消費',\n              spendingPerPoint: 10,\n            },\n            transactionType: 'Foreign',\n          },\n          {\n            rewardStrategy: {\n              type: 'FixedRatePointsReward',\n              name: '國內旅行社 (需登錄) 銀行並未公告符合商家',\n              spendingPerPoint: 10,\n            },\n            transactionType: 'Domestic',\n            stores: [\n              '雄獅旅遊',\n              '可樂旅遊',\n              '東南旅遊',\n              '五福旅遊',\n              '燦星旅遊',\n              '山富旅遊',\n              '長汎假期',\n              '鳳凰旅行社',\n              'Ezfly易飛網',\n              '理想旅遊',\n              '永利旅行社',\n              '三賀旅行社',\n            ],\n          },\n          {\n            rewardStrategy: {\n              type: 'FixedRatePointsReward',\n              name: '國外自由行、團體旅遊 (需登錄) 銀行並未公告符合商家',\n              spendingPerPoint: 10,\n            },\n            transactionType: 'Foreign',\n          },\n          {\n            rewardStrategy: {\n              type: 'FixedRatePointsReward',\n              name: '一般消費',\n              spendingPerPoint: defaultSpendingPerPoint,\n            },\n          },\n        ],\n      },\n    },\n  ]\n}\n\nconst evaPointExchanges: CardConfig['pointExchanges'] = [\n  {\n    id: generateUuid(),\n    config: {\n      name: '長榮航空哩程 (每1000哩為單位自動轉換至哩程帳戶)',\n      airlineCode: 'EVA',\n      pointsPerMile: 1000,\n      milesPerUnit: 1000,\n    },\n  },\n]\n\nconst evaCardDescription = getRewardDescription('2025/3/31')\nexport const evaConfigs: CardConfig[] = [\n  {\n    name: '長榮極致無限卡',\n    cardUrl: 'https://www.cathaybk.com.tw/cathaybk/personal/product/credit-card/cards/eva/',\n    description: evaCardDescription,\n    updateAt: '2024-12-29T00:00:00.000Z',\n    plans: evaPlanSettings(20),\n    pointExchanges: evaPointExchanges,\n  },\n  {\n    name: '長榮無限卡',\n    cardUrl: 'https://www.cathaybk.com.tw/cathaybk/personal/product/credit-card/cards/eva/',\n    description: evaCardDescription,\n    updateAt: '2024-12-29T00:00:00.000Z',\n    plans: evaPlanSettings(22),\n    pointExchanges: evaPointExchanges,\n  },\n  {\n    name: '長榮極致御璽卡',\n    cardUrl: 'https://www.cathaybk.com.tw/cathaybk/personal/product/credit-card/cards/eva/',\n    description: evaCardDescription,\n    updateAt: '2024-12-29T00:00:00.000Z',\n    plans: evaPlanSettings(30),\n    pointExchanges: evaPointExchanges,\n  },\n  {\n    name: '長榮御璽卡',\n    cardUrl: 'https://www.cathaybk.com.tw/cathaybk/personal/product/credit-card/cards/eva/',\n    description: evaCardDescription,\n    updateAt: '2024-12-29T00:00:00.000Z',\n    plans: [\n      {\n        id: generateUuid(),\n        config: {\n          name: null,\n          description: null,\n          rewards: [\n            {\n              rewardStrategy: {\n                type: 'FixedRatePointsReward',\n                name: '一般消費',\n                spendingPerPoint: 30,\n              },\n            },\n          ],\n        },\n      },\n    ],\n    pointExchanges: evaPointExchanges,\n  },\n]\n\n// eslint-disable-next-line @typescript-eslint/no-non-null-assertion\nexport const exampleEvaConfig: CardConfig = evaConfigs[1]!\n","import { generateUuid } from '@/utils'\n\nimport { Payment, type CardConfig } from '../../CreditCard'\nimport { getRewardDescription, cardDescription } from './utils'\n\nconst storeBlackList: string[] = [\n  '政府稅款',\n  '公共事業代扣繳',\n  '交通違規罰鍰',\n  '分期付款',\n  '全聯福利中心',\n  '7-ELEVEN',\n  '全家便利商店',\n]\nconst paymentBlackList: Payment[] = []\n\nfunction getStarLuxSpecifyReward(\n  spendingPerPoint: number,\n): CardConfig['plans'][number]['config']['rewards'][number] {\n  return {\n    rewardStrategy: {\n      type: 'FixedRatePointsReward',\n      name: '指定通路里程加速',\n      spendingPerPoint,\n    },\n    transactionType: 'Domestic',\n    stores: [\n      '星宇航空官方網站/App購票',\n      '星宇航空形象門市',\n      'béshopping',\n      '星宇航空國際航線機上免稅品',\n    ],\n  }\n}\n\nexport const starLuxConfigs: CardConfig[] = [\n  {\n    name: '星宇世界卡',\n    description: getRewardDescription('2025/2/28'),\n    cardUrl:\n      'https://www.esunbank.com/zh-tw/personal/credit-card/intro/co-branded-card/starlux-card',\n    storeBlackList,\n    paymentBlackList,\n    pointExchanges: [\n      {\n        id: generateUuid(),\n        config: {\n          name: '星宇航空哩程',\n          airlineCode: 'SJX',\n          pointsPerMile: 1,\n          milesPerUnit: 1,\n        },\n      },\n    ],\n    plans: [\n      {\n        id: generateUuid(),\n        config: {\n          name: null,\n          rewards: [\n            {\n              rewardStrategy: {\n                type: 'FixedRatePointsReward',\n                name: '國外消費 (生日兩倍)',\n                spendingPerPoint: 5,\n              },\n              transactionType: 'Foreign',\n              condition: 'Birthday',\n            },\n            getStarLuxSpecifyReward(5),\n            {\n              rewardStrategy: {\n                type: 'FixedRatePointsReward',\n                name: '國外消費',\n                spendingPerPoint: 10,\n              },\n              transactionType: 'Foreign',\n            },\n            {\n              rewardStrategy: {\n                type: 'FixedRatePointsReward',\n                name: '國內消費',\n                spendingPerPoint: 20,\n              },\n              transactionType: 'Domestic',\n            },\n          ],\n        },\n      },\n    ],\n    updateAt: new Date('2025/01/12 22:00:00').toISOString(),\n  },\n  {\n    name: '星宇商務鈦金卡',\n    description: getRewardDescription('2025/2/28'),\n    cardUrl:\n      'https://www.esunbank.com/zh-tw/personal/credit-card/intro/co-branded-card/starlux-card',\n    storeBlackList,\n    paymentBlackList,\n    pointExchanges: [\n      {\n        id: generateUuid(),\n        config: {\n          name: '星宇航空哩程',\n          airlineCode: 'SJX',\n          pointsPerMile: 1,\n          milesPerUnit: 1,\n        },\n      },\n    ],\n    plans: [\n      {\n        id: generateUuid(),\n        config: {\n          name: null,\n          rewards: [\n            {\n              rewardStrategy: {\n                type: 'FixedRatePointsReward',\n                name: '國外消費',\n                spendingPerPoint: 7.5,\n              },\n              transactionType: 'Foreign',\n              condition: 'Birthday',\n            },\n            getStarLuxSpecifyReward(7.5),\n            {\n              rewardStrategy: {\n                type: 'FixedRatePointsReward',\n                name: '國外消費',\n                spendingPerPoint: 15,\n              },\n              transactionType: 'Foreign',\n            },\n            {\n              rewardStrategy: {\n                type: 'FixedRatePointsReward',\n                name: '國內消費',\n                spendingPerPoint: 25,\n              },\n              transactionType: 'Domestic',\n            },\n          ],\n        },\n      },\n    ],\n    updateAt: new Date('2025/01/12 22:00:00').toISOString(),\n  },\n  {\n    name: '星宇鈦金卡',\n    description: getRewardDescription('2025/2/28'),\n    cardUrl:\n      'https://www.esunbank.com/zh-tw/personal/credit-card/intro/co-branded-card/starlux-card',\n    storeBlackList,\n    paymentBlackList,\n    pointExchanges: [\n      {\n        id: generateUuid(),\n        config: {\n          name: '星宇航空哩程',\n          airlineCode: 'SJX',\n          pointsPerMile: 1,\n          milesPerUnit: 1,\n        },\n      },\n    ],\n    plans: [\n      {\n        id: generateUuid(),\n        config: {\n          name: null,\n          rewards: [\n            getStarLuxSpecifyReward(10),\n            {\n              rewardStrategy: {\n                type: 'FixedRatePointsReward',\n                name: '國外消費',\n                spendingPerPoint: 20,\n              },\n              transactionType: 'Foreign',\n            },\n            {\n              rewardStrategy: {\n                type: 'FixedRatePointsReward',\n                name: '國內消費',\n                spendingPerPoint: 28,\n              },\n              transactionType: 'Domestic',\n            },\n          ],\n        },\n      },\n    ],\n    updateAt: new Date('2025/01/12 22:00:00').toISOString(),\n  },\n]\n\nconst uniCardStoreList = [\n  '台灣中油',\n  '台灣大車隊',\n  '台鐵',\n  '台灣高鐵',\n  'UBER',\n  'Yoxi',\n  '桃園機場捷運',\n  '新光三越',\n  '遠東百貨',\n  '遠東SOGO百貨',\n  'Big City遠東巨城購物中心',\n  '漢神百貨',\n  '微風廣場',\n  '微風信義',\n  '微風南京',\n  '微風南山',\n  '微風台北車站',\n  '台北101',\n  '華泰名品城',\n  'MITSUI OUTLET PARK 林口',\n  'MITSUI OUTLET PARK 台中港',\n  'MITSUI OUTLET PARK 台南',\n  '京站',\n  '美麗華',\n  '誠品生活',\n  '秀泰生活',\n  'Mitsui Shopping Park LaLaport 台中',\n  '統領廣場',\n  '太平洋百貨',\n  '統一時代百貨(台北店)',\n  '昇恆昌',\n  '采盟',\n  'Uber Eats',\n  'foodpanda',\n  'EZTABLE',\n  '王品瘋美食',\n  '摩斯漢堡',\n  '漢來美食',\n  '饗Joy',\n  '饗食天堂',\n  '果然匯',\n  '小福利',\n  '饗饗',\n  '旭集',\n  '開飯',\n  '饗泰多',\n  '真珠',\n  '瓦城',\n  '非常泰',\n  '大心',\n  '1010',\n  '時時香',\n  'BOBO',\n  '乾杯集團',\n  '路易莎',\n  '中華航空',\n  '長榮航空',\n  '日本航空',\n  '台灣虎航',\n  '樂桃航空',\n  '酷航',\n  '立榮航空',\n  '華信航空',\n  'Trip.com',\n  'booking.com',\n  'Hotels.com',\n  'AsiaYo',\n  'Expedia',\n  'KKday',\n  'Klook',\n  '雄獅旅遊',\n  '可樂旅遊',\n  '東南旅行社',\n  'Apple直營店',\n  '小米台灣',\n  '全國電子',\n  '燦坤',\n  '迪卡儂',\n  '寵物公園',\n  '家家樂',\n  '屈臣氏',\n  '特力屋',\n  '特力和樂',\n  'UNIQLO',\n  'NET',\n  '大樹藥局',\n  '丁丁藥妝',\n  'momo購物網',\n  '蝦皮購物',\n  '淘寶網',\n  'Coupang酷澎',\n  '東森購物',\n  '博客來',\n  '日本實體店',\n  '韓國實體店',\n  '泰國實體店',\n  '越南實體店',\n  '新加坡實體店',\n  '馬來西亞實體店',\n  '菲律賓實體店',\n  '中國實體店',\n  '香港實體店',\n  '澳門實體店',\n  '美國實體店',\n  '加拿大實體店',\n  '英國實體店',\n  '法國實體店',\n  '德國實體店',\n  '義大利實體店',\n  '澳洲實體店',\n  '玉山Wallet愛心捐款-單筆捐款',\n  '玉山Wallet愛心捐款-定期定額',\n  '特斯拉',\n  'Gogoro電池資費',\n  'YouBike 2.0',\n]\nconst uniCardSpecifyPayment: Payment[] = [\n  'Line Pay',\n  '街口支付',\n  '悠遊付',\n  '全盈+PAY',\n  '全支付',\n  '橘子支付',\n]\nconst uniCardBaseReward: CardConfig['plans'][number]['config']['rewards'][number] = {\n  rewardStrategy: {\n    type: 'TruncatedPercentageReward',\n    name: null,\n    pointBackRates: [{ rate: 0.3 }, { rate: 0.7 }],\n  },\n}\nexport const uniCardConfigs: CardConfig[] = [\n  {\n    name: 'UniCard 卡',\n    description: cardDescription,\n    cardUrl: 'https://www.esunbank.com/zh-tw/personal/credit-card/intro/bank-card/unicard',\n    storeBlackList,\n    paymentBlackList,\n    pointExchanges: [\n      {\n        id: generateUuid(),\n        config: {\n          name: '長榮航空哩程',\n          airlineCode: 'EVA',\n          pointsPerMile: 200,\n          milesPerUnit: 300,\n        },\n      },\n    ],\n    plans: [\n      {\n        id: generateUuid(),\n        config: {\n          name: '任意選 (需要切換店家)',\n          description: '玉山Wallet設定8家特店',\n          rewards: [\n            {\n              rewardStrategy: {\n                type: 'TruncatedPercentageReward',\n                name: null,\n                pointBackRates: [{ rate: 0.3 }, { rate: 0.7 }, { rate: 2.5, limit: 500 }],\n              },\n              stores: uniCardStoreList,\n              payments: ['信用卡', 'Apple Pay', 'Samsung Pay', 'Google Pay'],\n            },\n            {\n              rewardStrategy: {\n                type: 'TruncatedPercentageReward',\n                name: null,\n                pointBackRates: [{ rate: 0.3 }, { rate: 0.7 }, { rate: 2.5, limit: 500 }],\n              },\n              payments: uniCardSpecifyPayment,\n            },\n            uniCardBaseReward,\n          ],\n        },\n      },\n      {\n        id: generateUuid(),\n        config: {\n          name: '簡單選',\n          rewards: [\n            {\n              rewardStrategy: {\n                type: 'TruncatedPercentageReward',\n                name: null,\n                pointBackRates: [{ rate: 0.3 }, { rate: 0.7 }, { rate: 2, limit: 500 }],\n              },\n              stores: uniCardStoreList,\n              payments: ['信用卡', 'Apple Pay', 'Samsung Pay', 'Google Pay'],\n            },\n            {\n              rewardStrategy: {\n                type: 'TruncatedPercentageReward',\n                name: null,\n                pointBackRates: [{ rate: 0.3 }, { rate: 0.7 }, { rate: 2, limit: 500 }],\n              },\n              payments: uniCardSpecifyPayment,\n            },\n            uniCardBaseReward,\n          ],\n        },\n      },\n      {\n        id: generateUuid(),\n        config: {\n          name: 'UP選',\n          description: '完成指定任務或99點玉山e point訂閱',\n          rewards: [\n            {\n              rewardStrategy: {\n                type: 'TruncatedPercentageReward',\n                name: null,\n                pointBackRates: [{ rate: 0.3 }, { rate: 0.7 }, { rate: 3.5, limit: 2000 }],\n              },\n              stores: uniCardStoreList,\n              payments: ['信用卡', 'Apple Pay', 'Samsung Pay', 'Google Pay'],\n            },\n            {\n              rewardStrategy: {\n                type: 'TruncatedPercentageReward',\n                name: null,\n                pointBackRates: [{ rate: 0.3 }, { rate: 0.7 }, { rate: 3.5, limit: 2000 }],\n              },\n              payments: uniCardSpecifyPayment,\n            },\n            uniCardBaseReward,\n          ],\n        },\n      },\n    ],\n    updateAt: new Date('2025/01/12 22:00:00').toISOString(),\n  },\n]\n\n// eslint-disable-next-line @typescript-eslint/no-non-null-assertion\nexport const exampleUniCardConfig: CardConfig = uniCardConfigs[0]!\n","import { generateUuid } from '@/utils'\n\nimport type { CardConfig, Payment } from '../../CreditCard'\nimport { cardDescription } from './utils'\n\nconst storeBlackList: string[] = ['政府稅款', '公共事業代扣繳', '交通違規罰鍰', '分期付款']\nconst paymentBlackList: Payment[] = ['全盈+PAY', 'icash pay', 'OPEN錢包', 'My FamiPay']\n\nexport const travelConfigs: CardConfig[] = [\n  {\n    name: '旅人無限卡',\n    description: cardDescription,\n    cardUrl: 'https://www.hsbc.com.tw/credit-cards/products/travel/visa-infinite/',\n    storeBlackList,\n    paymentBlackList,\n    pointExchanges: [\n      {\n        id: generateUuid(),\n        config: {\n          name: '長榮航空哩程',\n          airlineCode: 'EVA',\n          pointsPerMile: 1,\n          milesPerUnit: 1,\n        },\n      },\n    ],\n    plans: [\n      {\n        id: generateUuid(),\n        config: {\n          name: null,\n          rewards: [\n            {\n              rewardStrategy: {\n                type: 'AccumulatedPointsReward',\n                name: '國外消費',\n                spendingPerPoint: 10,\n              },\n              transactionType: 'Foreign',\n            },\n            {\n              rewardStrategy: {\n                type: 'AccumulatedPointsReward',\n                name: '國內消費',\n                spendingPerPoint: 18,\n              },\n              transactionType: 'Domestic',\n            },\n          ],\n        },\n      },\n    ],\n    updateAt: new Date('2024/12/01 00:00:00').toISOString(),\n  },\n  {\n    name: '旅人御璽卡',\n    description: cardDescription,\n    cardUrl: 'https://www.hsbc.com.tw/credit-cards/products/travel/visa-signature/',\n    storeBlackList,\n    paymentBlackList,\n    pointExchanges: [\n      {\n        id: generateUuid(),\n        config: {\n          name: '長榮航空哩程',\n          airlineCode: 'EVA',\n          pointsPerMile: 1,\n          milesPerUnit: 1,\n        },\n      },\n    ],\n    plans: [\n      {\n        id: generateUuid(),\n        config: {\n          name: null,\n          rewards: [\n            {\n              rewardStrategy: {\n                type: 'AccumulatedPointsReward',\n                name: '國外消費',\n                spendingPerPoint: 15,\n              },\n              transactionType: 'Foreign',\n            },\n            {\n              rewardStrategy: {\n                type: 'AccumulatedPointsReward',\n                name: '國內消費',\n                spendingPerPoint: 18,\n              },\n              transactionType: 'Domestic',\n            },\n          ],\n        },\n      },\n    ],\n    updateAt: new Date('2024/12/01 00:00:00').toISOString(),\n  },\n  {\n    name: '旅人輕旅卡',\n    description: cardDescription,\n    cardUrl: 'https://www.hsbc.com.tw/credit-cards/products/travel/visa-light/',\n    storeBlackList,\n    paymentBlackList,\n    pointExchanges: [\n      {\n        id: generateUuid(),\n        config: {\n          name: '長榮航空哩程',\n          airlineCode: 'EVA',\n          pointsPerMile: 1,\n          milesPerUnit: 1,\n        },\n      },\n    ],\n    plans: [\n      {\n        id: generateUuid(),\n        config: {\n          name: null,\n          rewards: [\n            {\n              rewardStrategy: {\n                type: 'AccumulatedPointsReward',\n                name: '國外消費',\n                spendingPerPoint: 20,\n              },\n              transactionType: 'Foreign',\n            },\n            {\n              rewardStrategy: {\n                type: 'AccumulatedPointsReward',\n                name: '國內消費',\n                spendingPerPoint: 20,\n              },\n              transactionType: 'Domestic',\n            },\n          ],\n        },\n      },\n    ],\n    updateAt: new Date('2024/12/01 00:00:00').toISOString(),\n  },\n]\n\n// eslint-disable-next-line @typescript-eslint/no-non-null-assertion\nexport const exampleTravelConfig: CardConfig = travelConfigs[2]!\n","import type { CardConfig } from '../../CreditCard'\nimport { cubeConfigs, evaConfigs, exampleCubeConfig, exampleEvaConfig } from './cathay'\nimport { exampleUniCardConfig, starLuxConfigs, uniCardConfigs } from './esunbank'\nimport { exampleTravelConfig, travelConfigs } from './hsbc'\n\nexport const exampleCardConfigs: CardConfig[] = [\n  exampleEvaConfig,\n  exampleCubeConfig,\n  exampleTravelConfig,\n  exampleUniCardConfig,\n]\n\nexport const defaultCardConfigs: CardConfig[] = [\n  ...evaConfigs,\n  ...cubeConfigs,\n  ...travelConfigs,\n  ...starLuxConfigs,\n  ...uniCardConfigs,\n]\n","import typia from 'typia'\n\nexport type StoreAliases = [string, string[]]\nexport const isStoreAliasesList = typia.createIs<StoreAliases[]>()\n\nexport const defaultStoreAliases: readonly [string, readonly string[]][] = [\n  ['7-ELEVEN', ['7-11', 'Seven Eleven', '統一超商', '小7']],\n  ['ANA全日空', ['ANA', '全日空', 'All Nippon Airways', 'NH']],\n  ['ATT 4 FUN', ['ATT4FUN', 'ATT信義']],\n  ['App Store', ['蘋果應用商店']],\n  ['Apple Arcade', ['蘋果遊戲訂閱服務']],\n  ['Apple Music', ['蘋果音樂', 'Apple音樂']],\n  ['Apple One', ['蘋果One訂閱']],\n  ['Apple TV+', ['Apple TV Plus']],\n  ['Apple Wallet ICOCA', ['ICOCA電子票', 'Apple錢包ICOCA']],\n  ['Apple Wallet PASMO', ['PASMO電子票', 'Apple錢包PASMO']],\n  ['Apple Wallet SUICA', ['SUICA電子票', 'Apple錢包SUICA']],\n  ['CITYLINK', ['City Link']],\n  ['Disney+', ['Disney Plus', '迪士尼+']],\n  ['Google Play', ['Google應用商店']],\n  ['Grab', ['Grab Taxi', 'Grab叫車']],\n  ['MITSUI OUTLET PARK 台中港', ['三井台中港', '三井OUTLET台中']],\n  ['MITSUI OUTLET PARK 台南', ['三井台南', '三井OUTLET台南']],\n  ['MITSUI OUTLET PARK 林口', ['三井林口', '三井OUTLET林口']],\n  ['Mitsui Shopping Park LaLaport 台中', ['LaLaport台中', '三井LaLaport台中']],\n  ['Netflix', ['網飛']],\n  ['Nintendo', ['任天堂', 'Switch', '老任']],\n  ['PChome 24h購物(不含儲值及電子票券)', ['PChome', 'PChome購物']],\n  ['Tiger City', ['老虎城', 'Tiger City購物中心']],\n  ['Trip.com', ['攜程']],\n  ['Uber Eats (不含 Uber One)', ['優步外送']],\n  ['foodpanda', ['熊貓外送', 'Food Panda']],\n  ['iCloud', ['蘋果雲端', 'iCloud雲端']],\n  ['iRent', ['i Rent']],\n  ['iTunes', ['蘋果iTunes']],\n  ['中友百貨', ['中友']],\n  ['中華航空', ['China Airlines', 'CAL', 'CI', '華航']],\n  ['亞洲航空', ['AirAsia', '亞航', 'AXM', 'AK']],\n  ['京站', ['Q Square', '京站商場']],\n  ['全家便利商店', ['FamilyMart', '全家']],\n  ['全球迪士尼飯店', ['Disney Hotels']],\n  ['全聯福利中心', ['PX Mart']],\n  ['南紡購物中心', ['Tainan Spinnery Mall', '南紡']],\n  ['博客來', ['Books.com.tw']],\n  ['卡達航空', ['Qatar Airways', '卡航', 'QTR', 'QR']],\n  ['可樂旅遊', ['Cola Travel', '可樂旅行社']],\n  ['台北101', ['Taipei 101', '101大樓']],\n  ['台灣中油-直營', ['中油直營', '直營中油']],\n  ['台灣大車隊', ['Taiwan Taxi', '大車隊']],\n  ['台灣虎航', ['Tigerair Taiwan', '台虎', 'TWA', 'IT']],\n  ['台灣高鐵', ['Taiwan High Speed Rail']],\n  ['台茂購物中心', ['TaiMall']],\n  ['吉卜力公園', ['Ghibli Park']],\n  ['國泰航空', ['Cathay Pacific', '國泰', 'CPA', 'CX', 'Cathay Pacific Airways']],\n  ['土耳其航空', ['Turkish Airlines', '土航', 'THY', 'TK']],\n  ['夢時代', ['Dream Mall']],\n  ['大阪環球影城(USJ)', ['Universal Studios Japan']],\n  ['大韓航空', ['Korean Air', '韓航', 'KAL', 'KE']],\n  ['大魯閣新時代', ['Taroko Mall', '大魯閣']],\n  ['太平洋百貨', ['Pacific Department Store', '太平洋']],\n  ['好樂迪KTV', ['Holiday']],\n  ['家樂福', ['Carrefour']],\n  ['屈臣氏', ['Watsons']],\n  ['康是美', ['Cosmed']],\n  ['捷星航空', ['JST', 'JQ', 'Jetstar Airways']],\n  ['新加坡航空', ['SIA', 'SQ', 'Singapore Airlines']],\n  ['日本航空', ['JAL', 'JL', 'Japan Airlines']],\n  ['星宇航空', ['starlux', 'SJX', 'JX', 'STARLUX Airlines']],\n  ['樂桃航空', ['APJ', 'MM', 'Peach Aviation']],\n  ['法國航空', ['AFR', 'AF', 'Air France']],\n  ['聯合航空', ['UAL', 'UA', 'United Airlines']],\n  ['蝦皮購物', ['shopee']],\n  ['越捷航空', ['VJC', 'VJ', 'VietJet Air']],\n  ['達美航空', ['DAL', 'DL', 'Delta Air Lines']],\n  ['遠東百貨', ['遠百']],\n  ['酷航', ['SCO', 'TR', 'Scoot']],\n  ['長榮航空', ['EVA', 'BR', 'EVA Airlines', 'EVA Air']],\n  ['阿聯酋航空', ['UAE', 'EK', 'Emirates']],\n  ['麥當勞', [\"McDonald's\"]],\n  ['IKEA', ['宜家家居']],\n  ['星巴克', ['starbucks']],\n] satisfies StoreAliases[]\n","import typia from 'typia'\n\nimport { CustomStorageManager } from '@/utils/StorageManager'\n\nimport { isStoreAliasesList, type StoreAliases } from './configs/storeAliases'\nimport { type CardConfig, type ConditionType, type Payment } from './CreditCard'\n\nexport const storageManager = new CustomStorageManager<{\n  onlyShowCurrentPlan: boolean\n  onlyShowCurrentPointExchange: boolean\n  commonPaymentMethods: Payment[]\n  cardConfigs: CardConfig[]\n  conditionTypes: ConditionType[]\n  aliasType: AliasType\n  customAliases: StoreAliases[]\n  acceptedPaymentsWithStore: [string, Payment[]][]\n}>(\n  localStorage,\n  {\n    onlyShowCurrentPlan: typia.createIs<boolean>(),\n    onlyShowCurrentPointExchange: typia.createIs<boolean>(),\n    commonPaymentMethods: typia.createIs<Payment[]>(),\n    cardConfigs: typia.createIs<CardConfig[]>(),\n    conditionTypes: typia.createIs<ConditionType[]>(),\n    aliasType: typia.createIs<AliasType>(),\n    customAliases: isStoreAliasesList,\n    acceptedPaymentsWithStore: typia.createIs<[string, Payment[]][]>(),\n  },\n  'bestMileageCards',\n)\n\nexport const aliasTypeList = ['default', 'additional', 'custom'] as const\nexport type AliasType = (typeof aliasTypeList)[number]\n","import { defineStore } from 'pinia'\nimport { computed, onMounted, readonly, ref } from 'vue'\n\nimport type { UUID } from '@/types'\nimport { generateUuid, removeDuplicates } from '@/utils'\nimport { sortList } from '@/utils/sorts'\n\nimport { exampleCardConfigs } from './configs/defaultCards'\nimport { defaultStoreAliases, type StoreAliases } from './configs/storeAliases'\nimport { createCard, CreditCard, Payment, type CardConfig } from './CreditCard'\nimport type { ConditionType } from './CreditCard/modules/type'\nimport { aliasTypeList, storageManager, type AliasType } from './utils'\n\nexport interface DialogItem {\n  text: string\n  events: {\n    text: string\n    event?: () => Promise<void> | void\n    class?: string\n  }[]\n}\n\nexport const useBestMileageCardsStore = defineStore('BestMileageCards', () => {\n  const dialog = ref<DialogItem | null>(null)\n  function openDialog(item: DialogItem): void {\n    dialog.value = item\n  }\n  function closeDialog(): void {\n    dialog.value = null\n  }\n\n  onMounted(() => {\n    const configs = storageManager.get('cardConfigs') ?? []\n    cardConfigs.value = new Map(configs.map((config) => [generateUuid(), config]))\n    acceptedPaymentsWithStore.value = new Map(storageManager.get('acceptedPaymentsWithStore'))\n  })\n\n  const onlyShowCurrentPlan = ref<boolean>(storageManager.get('onlyShowCurrentPlan') ?? false)\n  function updateOnlyShowCurrentPlan(status: boolean): void {\n    storageManager.set('onlyShowCurrentPlan', status)\n    onlyShowCurrentPlan.value = status\n  }\n\n  const onlyShowCurrentPointExchange = ref<boolean>(\n    storageManager.get('onlyShowCurrentPointExchange') ?? false,\n  )\n  function updateOnlyShowCurrentPointExchange(status: boolean): void {\n    storageManager.set('onlyShowCurrentPointExchange', status)\n    onlyShowCurrentPointExchange.value = status\n  }\n\n  const commonPaymentMethods = ref<Payment[]>(\n    storageManager.get('commonPaymentMethods') ?? ['信用卡', 'Apple Pay', 'Line Pay', '街口支付'],\n  )\n  function updateCommonPaymentMethods(payments: Payment[]): void {\n    payments = [...new Set(payments)]\n    storageManager.set('commonPaymentMethods', payments)\n    commonPaymentMethods.value = payments\n  }\n\n  // TODO: 有空要再確認看看有沒有必要做 cache 避免浪費效能\n  const cardConfigs = ref(new Map<UUID, CardConfig>())\n  /** 使用者的卡片資料 */\n  const cards = computed((): Map<UUID, CreditCard> => {\n    return new Map([...cardConfigs.value.entries()].map(([id, config]) => [id, createCard(config)]))\n  })\n  /** 要顯示的卡片資料，當沒有卡片資料的時候會顯示預設值 */\n  const showCards = computed((): CreditCard[] => {\n    if (cards.value.size === 0) {\n      return exampleCardConfigs.map((config) => createCard(config))\n    }\n    return [...cards.value.values()]\n  })\n  function updateCardConfig(id: UUID, config: CardConfig): void {\n    cardConfigs.value.set(id, config)\n    storageManager.set('cardConfigs', [...cardConfigs.value.values()])\n  }\n  function deleteCardConfig(id: UUID): void {\n    cardConfigs.value.delete(id)\n    storageManager.set('cardConfigs', [...cardConfigs.value.values()])\n  }\n  function updatePlan(id: UUID, planId: UUID): boolean {\n    const config = cardConfigs.value.get(id)\n    if (config === undefined) {\n      return false\n    }\n    try {\n      cardConfigs.value.set(id, { ...config, selectedPlanId: planId })\n    } catch {\n      return false\n    }\n    storageManager.set('cardConfigs', [...cardConfigs.value.values()])\n    return true\n  }\n  function updatePointExchange(id: UUID, pointExchangeId: UUID): boolean {\n    const config = cardConfigs.value.get(id)\n    if (config === undefined) {\n      return false\n    }\n    try {\n      cardConfigs.value.set(id, { ...config, selectedPointExchangeId: pointExchangeId })\n    } catch {\n      return false\n    }\n    storageManager.set('cardConfigs', [...cardConfigs.value.values()])\n    return true\n  }\n  const storeList = computed(() => {\n    return sortList(removeDuplicates(showCards.value.flatMap((card) => card.storeList)), 'asc')\n  })\n\n  const conditionTypes = ref<ConditionType[]>(storageManager.get('conditionTypes') ?? [])\n  function updateConditionTypes([...types]: readonly ConditionType[]): void {\n    conditionTypes.value = types\n    storageManager.set('conditionTypes', types)\n  }\n\n  const acceptedPaymentsWithStore = ref(new Map<string, Payment[]>())\n  function updateAcceptedPaymentsWithStore(store: string, payments: Payment[]): void {\n    if (payments.length === 0) {\n      acceptedPaymentsWithStore.value.delete(store)\n    } else {\n      acceptedPaymentsWithStore.value.set(store, payments)\n    }\n    storageManager.set('acceptedPaymentsWithStore', [...acceptedPaymentsWithStore.value.entries()])\n  }\n\n  const aliasType = ref<AliasType>(storageManager.get('aliasType') ?? 'default')\n  function updateAliasType(type: AliasType): void {\n    if (aliasTypeList.includes(type)) {\n      aliasType.value = type\n      storageManager.set('aliasType', type)\n    }\n  }\n\n  const customAliases = ref(new Map<string, string[]>(storageManager.get('customAliases') ?? []))\n  function updateCustomAliases(store: string, aliases: string[]): void {\n    if (aliases.length === 0) {\n      customAliases.value.delete(store)\n    } else {\n      customAliases.value.set(store, aliases)\n    }\n    storageManager.set('customAliases', [...customAliases.value])\n  }\n  function updateAllCustomAliases(list: StoreAliases[]): void {\n    customAliases.value = new Map(list)\n    storageManager.set('customAliases', list)\n  }\n\n  const storeAliases = computed(() => {\n    const list: [string, readonly string[]][] = []\n    if (['default', 'additional'].includes(aliasType.value)) {\n      list.push(...defaultStoreAliases)\n    }\n    if (['additional', 'custom'].includes(aliasType.value)) {\n      list.push(...customAliases.value)\n    }\n\n    const storeAliasesMap = new Map<string, Set<string>>()\n    for (const [store, aliases] of list) {\n      const item = storeAliasesMap.get(store) ?? new Set<string>()\n      for (const alias of aliases) {\n        item.add(alias)\n      }\n      storeAliasesMap.set(store, item)\n    }\n    return storeAliasesMap\n  })\n\n  return {\n    dialog: readonly(dialog),\n    openDialog,\n    closeDialog,\n    onlyShowCurrentPlan: readonly(onlyShowCurrentPlan),\n    updateOnlyShowCurrentPlan,\n    onlyShowCurrentPointExchange: readonly(onlyShowCurrentPointExchange),\n    updateOnlyShowCurrentPointExchange,\n    commonPaymentMethods: readonly(commonPaymentMethods),\n    updateCommonPaymentMethods,\n    cardConfigs: readonly(cardConfigs),\n    cards,\n    showCards,\n    updateCardConfig,\n    deleteCardConfig,\n    updatePlan,\n    updatePointExchange,\n    storeList: readonly(storeList),\n    conditionTypes: readonly(conditionTypes),\n    updateConditionTypes,\n    aliasType: readonly(aliasType),\n    storeAliases,\n    updateAliasType,\n    customAliases: readonly(customAliases),\n    updateCustomAliases,\n    updateAllCustomAliases,\n    acceptedPaymentsWithStore: readonly(acceptedPaymentsWithStore),\n    updateAcceptedPaymentsWithStore,\n  }\n})\n","<template>\n  <div class=\"flex-col gap-24px my-16px\">\n    <div class=\"gap-8px flex justify-around\">\n      <v-switch\n        :model-value=\"onlyShowCurrentPlan\"\n        hide-details\n        color=\"blue\"\n        @update:model-value=\"\n          (data) => data !== null && bestMileageCardsStore.updateOnlyShowCurrentPlan(data)\n        \"\n      >\n        <template #label>\n          <p class=\"text-0.75rem\">只顯示當前方案</p>\n        </template>\n      </v-switch>\n      <v-switch\n        :model-value=\"onlyShowCurrentPointExchange\"\n        hide-details\n        color=\"blue\"\n        @update:model-value=\"\n          (data) => data !== null && bestMileageCardsStore.updateOnlyShowCurrentPointExchange(data)\n        \"\n      >\n        <template #label>\n          <p class=\"text-0.75rem\">只顯示當前交換方式</p>\n        </template>\n      </v-switch>\n    </div>\n    <ClipList\n      label=\"使用中的付款方式\"\n      :model-value=\"commonPaymentMethods\"\n      :list=\"Payment\"\n      hide-details\n      show-selected\n      @update:model-value=\"bestMileageCardsStore.updateCommonPaymentMethods\"\n    />\n    <div>\n      <v-label text=\"其他設定\" />\n      <div class=\"flex mx-16px\">\n        <v-switch\n          :model-value=\"conditionTypes\"\n          label=\"生日中\"\n          value=\"Birthday\"\n          hide-details\n          color=\"blue\"\n          @update:model-value=\"\n            (list) => list !== null && bestMileageCardsStore.updateConditionTypes(list)\n          \"\n        />\n      </div>\n    </div>\n  </div>\n</template>\n<script lang=\"ts\" setup>\nimport { storeToRefs } from 'pinia'\n\nimport ClipList from '@/components/ClipList.vue'\n\nimport { Payment } from '../CreditCard'\nimport { useBestMileageCardsStore } from '../store'\n\nconst bestMileageCardsStore = useBestMileageCardsStore()\nconst { onlyShowCurrentPlan, onlyShowCurrentPointExchange, commonPaymentMethods, conditionTypes } =\n  storeToRefs(bestMileageCardsStore)\n</script>\n","/* eslint-disable @eslint-community/eslint-comments/disable-enable-pair, @typescript-eslint/no-unsafe-function-type, @typescript-eslint/no-explicit-any, @typescript-eslint/no-unsafe-return, @typescript-eslint/no-unsafe-assignment, security/detect-object-injection, @typescript-eslint/no-unsafe-member-access */\ntype DeepWritable<T> = T extends Function\n  ? T\n  : T extends readonly (infer U)[]\n    ? DeepWritable<U>[]\n    : T extends ReadonlyMap<infer K, infer V>\n      ? Map<DeepWritable<K>, DeepWritable<V>>\n      : T extends ReadonlySet<infer U>\n        ? Set<DeepWritable<U>>\n        : T extends object\n          ? { -readonly [K in keyof T]: DeepWritable<T[K]> }\n          : T\n\n/** 複製內容的同時清除掉 readonly 元素 */\n// eslint-disable-next-line @typescript-eslint/no-unnecessary-type-parameters\nexport function cloneDeep<Input, Output = DeepWritable<Input>>(item: Input): Output {\n  if (item === null || typeof item !== 'object') {\n    // 基本類型直接返回\n    return item as unknown as Output\n  }\n\n  if (Array.isArray(item)) {\n    // 處理 ReadonlyArray 或 Array 型別\n    return item.map((i) => cloneDeep(i)) as Output\n  }\n\n  if (item instanceof Map) {\n    // 處理 ReadonlyMap 或 Map 型別\n    return new Map(\n      Array.from(item.entries()).map(([key, value]) => [cloneDeep(key), cloneDeep(value)]),\n    ) as Output\n  }\n\n  if (item instanceof Set) {\n    // 處理 ReadonlySet 或 Set 型別\n    return new Set(Array.from(item.values()).map((value) => cloneDeep(value))) as Output\n  }\n\n  if (item instanceof Date) {\n    // 處理 Date 型別\n    return new Date(item.getTime()) as Output\n  }\n\n  if (item instanceof RegExp) {\n    // 處理 RegExp 型別\n    return new RegExp(item.source, item.flags) as Output\n  }\n\n  // 處理普通物件，遞迴拷貝每個屬性\n  const result: any = {}\n  Object.keys(item).forEach((key) => {\n    result[key] = cloneDeep((item as any)[key])\n  })\n\n  return result as Output\n}\n","<template>\n  <div class=\"flex-col gap-8px\">\n    <v-label v-if=\"$slots['label'] || label\" class=\"flex-shrink-0 w-full\">\n      <slot v-if=\"$slots['label']\" name=\"label\" />\n      <p v-else>{{ label }}</p>\n    </v-label>\n\n    <div ref=\"cardListContainer\" class=\"flex-col gap-8px\" @dragleave=\"handleDragLeave\">\n      <div v-for=\"(item, index) in cacheList\" ref=\"cardItem\" :key=\"index\">\n        <v-card\n          density=\"compact\"\n          class=\"mx-auto w-full flex-shrink-0 card-item\"\n          :class=\"{\n            'drag-over': dragOverIndex === index || (touchStartIndex === index && isLongPress),\n          }\"\n          variant=\"outlined\"\n        >\n          <v-card-text class=\"!p-0\">\n            <div class=\"flex min-h-1rem items-stretch\">\n              <!-- 拖曳區域 -->\n              <div\n                v-if=\"draggable\"\n                draggable=\"true\"\n                class=\"flex-center pl-0.5rem pr-0.25rem cursor-ns-resize\"\n                @dragover.prevent=\"handleDragOver($event, index)\"\n                @dragstart=\"handleDragStart($event, index)\"\n                @dragend=\"handleDragEnd\"\n                @touchstart=\"handleTouchStart($event, index)\"\n                @touchmove.prevent=\"handleTouchMove($event)\"\n                @touchend=\"handleTouchEnd\"\n              >\n                <span class=\"mdi text-24px mdi-drag\" />\n              </div>\n\n              <!-- 內容區域 -->\n              <div\n                class=\"flex-grow min-h-20px flex items-center py-1rem cursor-pointer\"\n                :class=\"{ 'pl-1rem': !draggable, 'pr-1rem': !deletable }\"\n                @click=\"emitClickItem(item, index)\"\n              >\n                <slot v-bind=\"item\" />\n              </div>\n\n              <!-- 刪除按鈕 -->\n              <p\n                v-if=\"deletable\"\n                class=\"flex-center pl-0.25rem pr-0.5rem cursor-pointer\"\n                @click=\"emitDeleteItem(item, index)\"\n              >\n                <span class=\"mdi mdi-delete text-24px\" />\n              </p>\n            </div>\n          </v-card-text>\n        </v-card>\n      </div>\n    </div>\n\n    <!-- 新增按鈕 -->\n    <v-card\n      v-if=\"addable\"\n      density=\"compact\"\n      class=\"mx-auto w-full flex-shrink-0\"\n      variant=\"outlined\"\n      @click=\"$emit('addItem')\"\n    >\n      <v-card-text>\n        <div class=\"flex items-center justify-center min-h-1rem\">\n          <span class=\"mdi mdi-plus text-24px\" />\n        </div>\n      </v-card-text>\n    </v-card>\n  </div>\n</template>\n\n<script setup lang=\"ts\" generic=\"Item extends object\">\nimport { onMounted, useTemplateRef, shallowRef, watch } from 'vue'\n\nimport { cloneDeep } from '@/utils/cloneDeep'\n\nconst props = defineProps<{\n  list: Item[]\n  label?: string | null\n  addable?: boolean\n  draggable?: boolean\n  deletable?: boolean\n}>()\n\nconst emits = defineEmits<{\n  clickItem: [item: Item, index: number]\n  deleteItem: [item: Item, index: number]\n  addItem: []\n  'update:list': [Item[]]\n}>()\n\nconst cardListContainer = useTemplateRef<HTMLElement>('cardListContainer')\nconst cardItemElements = useTemplateRef<HTMLElement[]>('cardItem')\nconst cacheList = shallowRef<Item[]>([])\nconst draggedIndex = shallowRef<number | null>(null)\nconst dragOverIndex = shallowRef<number | null>(null)\nconst touchStartIndex = shallowRef<number | null>(null)\nconst touchStartY = shallowRef<number | null>(null)\nconst isLongPress = shallowRef<boolean>(false)\nlet longPressTimer: number | null = null\n\nonMounted((): void => {\n  updateList()\n})\n\nwatch(() => props.list, updateList, { deep: true })\n\nfunction updateList(): void {\n  cacheList.value = cloneDeep(props.list)\n}\n\nfunction handleDragStart(event: DragEvent, index: number): void {\n  if (!event.dataTransfer) {\n    return // 如果 dataTransfer 為 null，提前 return 避免錯誤\n  }\n  draggedIndex.value = index\n  event.dataTransfer.setData('text/plain', index.toString())\n  event.dataTransfer.effectAllowed = 'move'\n  const emptyImg = new Image()\n  emptyImg.src = 'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw=='\n  event.dataTransfer.setDragImage(emptyImg, 0, 0)\n}\n\nfunction handleTouchStart(event: TouchEvent, index: number): void {\n  const touch = event.touches[0] ?? null\n  if (!touch) {\n    return // 如果沒有觸控點，提前 return\n  }\n\n  touchStartIndex.value = index\n  touchStartY.value = touch.clientY\n  isLongPress.value = false\n\n  // 設置長按事件，為了觸發拖曳事件\n  longPressTimer = window.setTimeout(() => {\n    isLongPress.value = true\n  }, 400)\n}\n\nfunction handleTouchMove(event: TouchEvent): void {\n  if (!isLongPress.value || touchStartIndex.value === null || touchStartY.value === null) {\n    return\n  }\n\n  const touch = event.touches[0] ?? null\n  if (!touch) {\n    return\n  }\n\n  const deltaY = touch.clientY - touchStartY.value\n\n  const changeItem = checkTouchOver(touchStartIndex.value, deltaY)\n  if (changeItem) {\n    const targetIndex = touchStartIndex.value + (deltaY > 0 ? 1 : -1)\n    if (targetIndex < 0 || targetIndex >= cacheList.value.length) {\n      return\n    }\n\n    const draggedItem = cacheList.value[touchStartIndex.value]\n    if (!draggedItem) {\n      return\n    }\n\n    cacheList.value.splice(touchStartIndex.value, 1)\n    cacheList.value.splice(targetIndex, 0, draggedItem)\n    touchStartIndex.value = targetIndex\n    touchStartY.value = touch.clientY // 更新起始 Y 位置，避免快速連續移動錯位\n  }\n}\n\nfunction handleTouchEnd(): void {\n  // 清除長按計時器\n  if (longPressTimer !== null) {\n    clearTimeout(longPressTimer)\n    longPressTimer = null\n  }\n\n  touchStartIndex.value = null\n  touchStartY.value = null\n  isLongPress.value = false\n  emits('update:list', cacheList.value)\n}\n\nfunction handleDragOver(event: DragEvent, index: number): void {\n  event.preventDefault()\n  if (draggedIndex.value === index || draggedIndex.value === null) {\n    return\n  }\n\n  const draggedItem = cacheList.value[draggedIndex.value]\n  if (!draggedItem) {\n    return\n  }\n\n  cacheList.value.splice(draggedIndex.value, 1)\n  cacheList.value.splice(index, 0, draggedItem)\n  dragOverIndex.value = index\n  draggedIndex.value = index\n}\n\nfunction handleDragLeave(event: DragEvent): void {\n  const relatedTarget = event.relatedTarget\n  if (relatedTarget !== null && cardListContainer.value?.contains(relatedTarget as Node)) {\n    return\n  }\n  dragOverIndex.value = null\n}\n\nfunction handleDragEnd(): void {\n  draggedIndex.value = null\n  dragOverIndex.value = null\n  emits('update:list', cacheList.value)\n}\n\nfunction emitClickItem(item: Item, index: number): void {\n  emits('clickItem', item, index)\n}\n\nfunction emitDeleteItem(item: Item, index: number): void {\n  emits('deleteItem', item, index)\n}\n\nfunction checkTouchOver(touchStartIndex: number, deltaY: number): boolean {\n  // 這邊故意省去 gap 8px 的高度，至少讓他不需要位移那麼遠就可以交換元素，另外這邊計算是模糊計算，所以並不一定準確 QQ，要在想看看怎麼計算比較實際\n  const calculateCardItemHeight =\n    cardItemElements.value?.map((item) => item.getBoundingClientRect().height) ?? []\n  const currentItemHeight = calculateCardItemHeight[touchStartIndex]\n  if (deltaY > 0) {\n    const nextItemHeight = calculateCardItemHeight[touchStartIndex + 1]\n    if (currentItemHeight === undefined || nextItemHeight === undefined) {\n      return false\n    }\n    const targetHeight = currentItemHeight / 2 + nextItemHeight / 2\n    return deltaY >= targetHeight\n  } else {\n    const previousItemHeight = calculateCardItemHeight[touchStartIndex - 1]\n    if (currentItemHeight === undefined || previousItemHeight === undefined) {\n      return false\n    }\n    const targetHeight = currentItemHeight / 2 + previousItemHeight / 2\n    return Math.abs(deltaY) >= targetHeight\n  }\n}\n</script>\n\n<style scoped>\n* {\n  user-select: none;\n  -webkit-user-select: none;\n}\n\n.drag-over {\n  border: 1px dashed #007bff;\n  background-color: #f0f8ff;\n}\n\n/** 隱藏掉 vuetify card hover 的事件，因為搭配上拖曳事件，會變得很奇怪，拖曳中底色會影響到不該影響的內容 */\n.card-item :deep(.v-ripple__container) {\n  display: none !important;\n}\n</style>\n","<template>\n  <v-dialog :model-value=\"Boolean(modelValue)\" fullscreen @update:model-value=\"closeDialog\">\n    <v-card>\n      <v-toolbar>\n        <v-btn icon=\"mdi-close\" @click=\"closeDialog\" />\n        <v-toolbar-title>{{ title ?? '' }}</v-toolbar-title>\n        <v-toolbar-items>\n          <v-btn\n            :class=\"{\n              'text-red': warningSaveText,\n            }\"\n            :text=\"btnTitle\"\n            @click=\"saveAndCloneDialog\"\n          />\n        </v-toolbar-items>\n      </v-toolbar>\n      <div v-if=\"modelValue\" class=\"overflow-y-auto p-16px pb-40px\">\n        <slot :data=\"modelValue\" :update-data=\"updateData\" />\n      </div>\n    </v-card>\n  </v-dialog>\n</template>\n<script lang=\"ts\" generic=\"Data extends Object\" setup>\nimport { ref } from 'vue'\n\nconst { modelValue, title, btnTitle, btnEvent } = defineProps<{\n  modelValue: Data | null\n  title?: string\n  btnTitle: string\n  btnEvent: ((value: Data) => Promise<boolean> | boolean) | ((value: Data) => Promise<void> | void)\n}>()\n\nconst emits = defineEmits<{\n  'update:model-value': [Data: Data | null]\n}>()\n\nfunction closeDialog(): void {\n  emits('update:model-value', null)\n}\n\nfunction updateData(newData: Data): void {\n  emits('update:model-value', newData)\n}\n\nconst warningSaveText = ref(false)\nasync function saveAndCloneDialog(): Promise<void> {\n  if (modelValue === null) {\n    return\n  }\n  const status = await btnEvent(modelValue)\n  if (status !== false) {\n    closeDialog()\n  } else {\n    warningSaveText.value = true\n    window.setTimeout(() => {\n      warningSaveText.value = false\n    }, 3000)\n  }\n}\n</script>\n","<template>\n  <div>\n    <v-text-field\n      :rules=\"rules\"\n      :inputmode=\"isFloat ? 'decimal' : 'numeric'\"\n      :model-value=\"modelValue\"\n      :clearable=\"clearable && modelValue !== 0\"\n      :prefix=\"prefix\"\n      :suffix=\"suffix\"\n      :messages=\"messages\"\n      @update:model-value=\"updateModelValue\"\n      @click:control=\"setFocusIndex\"\n    >\n      <template v-if=\"label !== null\" #label>\n        <p class=\"relative\">\n          {{ label }}\n          <span v-if=\"required\" class=\"text-red ml-2px\">*</span>\n        </p>\n      </template>\n    </v-text-field>\n  </div>\n</template>\n<script lang=\"ts\" setup>\nimport { computed } from 'vue'\n\nconst {\n  modelValue = 0,\n  required = false,\n  label = null,\n  isFloat = false,\n  prefix,\n  suffix,\n  clearable = false,\n  messages = '',\n} = defineProps<{\n  modelValue: number | undefined\n  required?: boolean\n  label?: string | null\n  isFloat?: boolean\n  prefix?: string\n  suffix?: string\n  clearable?: boolean\n  messages?: string\n}>()\n\nconst emits = defineEmits<{\n  'update:model-value': [newValue: number]\n}>()\n\ntype Rule = (value: string) => boolean | string\n\nfunction checkNumber(value: string): number | null {\n  const newNumber = isFloat ? parseFloat(value) : parseInt(value)\n  return isNaN(newNumber) ? null : newNumber\n}\n\nconst rules = computed(() => {\n  const rules: Rule[] = []\n  if (required) {\n    rules.push((text: string): boolean | string => Boolean(checkNumber(text)) || '此欄位為必填')\n  }\n  return rules\n})\n\nfunction updateModelValue(newValue: string): void {\n  const newNumber = checkNumber(newValue)\n  emits('update:model-value', newNumber ?? 0)\n}\n\n/** 為了讓每次指標都從後面開始，每次 focus 的時候就觸發這邊 */\nfunction setFocusIndex(event: MouseEvent): void {\n  if (event.target instanceof HTMLInputElement) {\n    const currentValue = event.target.defaultValue\n    event.target.setSelectionRange(currentValue.length, currentValue.length)\n  }\n}\n</script>\n","<template>\n  <v-text-field\n    clearable\n    :rules=\"rules\"\n    :model-value=\"modelValue\"\n    @update:model-value=\"updateModelValue\"\n  >\n    <template #label>\n      <p class=\"relative\">\n        {{ label }}\n        <span v-if=\"required\" class=\"text-red ml-2px\">*</span>\n      </p>\n    </template>\n  </v-text-field>\n</template>\n<script lang=\"ts\" setup>\nimport { computed } from 'vue'\n\nimport { isTruthyString } from '@/utils'\n\nconst {\n  modelValue = null,\n  required = false,\n  label,\n  isUrl = false,\n} = defineProps<{\n  modelValue: string | null | undefined\n  required?: boolean\n  label: string\n  isUrl?: boolean\n}>()\n\nconst emits = defineEmits<{\n  'update:model-value': [newValue: string | null]\n}>()\n\ntype Rule = (value: string | null) => boolean | string\n\nconst rules = computed(() => {\n  const rules: Rule[] = []\n  if (required) {\n    rules.push((text: string | null): boolean | string => !!text || '此欄位為必填')\n  }\n  if (isUrl) {\n    rules.push((text: string | null): boolean | string => {\n      return (\n        Boolean(text === null || text === '' || text.startsWith('https://')) ||\n        '請填寫正確的網址 (需為 https:// 開頭)'\n      )\n    })\n  }\n  return rules\n})\n\nfunction updateModelValue(newValue: string | null): void {\n  newValue = newValue?.trim() ?? null\n  emits('update:model-value', isTruthyString(newValue) ? newValue : null)\n}\n</script>\n","<template>\n  <div class=\"flex-col gap-4px h-full overflow-hidden\">\n    <div class=\"flex\">\n      <v-label class=\"ml-4px flex-grow !text-0.9rem\">\n        點擊\n        <span class=\"mdi mdi-pencil mx-4px\" />\n        編輯卡片，點擊卡片切換方案\n      </v-label>\n      <v-btn text=\"匯入\" @click=\"() => (needImportCardConfigs = [])\" />\n    </div>\n    <div class=\"flex-1 gap-8px flex-col overflow-y-auto py-8px\">\n      <v-card\n        v-for=\"([id, config], index) of cardConfigs.entries()\"\n        :key=\"index\"\n        density=\"compact\"\n        class=\"mx-auto w-full flex-shrink-0\"\n        variant=\"outlined\"\n        :title=\"config.name\"\n        :text=\"config.description ?? ''\"\n        @click=\"() => (switchPlanWithCardId = id)\"\n      >\n        <template #title>\n          <div class=\"flex items-center justify-between\">\n            {{ config.name }}\n            <span\n              class=\"mdi mdi-pencil absolute top-0 py-0.625rem px-1rem right-0\"\n              @click.stop=\"() => (editCard = { id, config: cloneDeep(config) })\"\n            />\n          </div>\n        </template>\n      </v-card>\n    </div>\n  </div>\n  <FullscreenDialog\n    v-model=\"editCard\"\n    title=\"編輯卡片\"\n    btn-title=\"儲存\"\n    :btn-event=\"saveCardConfig\"\n  >\n    <template #default=\"{ data }\">\n      <div class=\"flex-col gap-2\">\n        <TextField v-model=\"data.config.name\" label=\"卡片名稱\" required />\n        <TextField v-model=\"data.config.description\" label=\"卡片描述\" />\n        <TextField v-model=\"data.config.cardUrl\" is-url label=\"信用卡網頁\" />\n        <!-- TODO: 可以加上 Create XXX 顯示這樣最好了 -->\n        <ClipList\n          v-model=\"data.config.storeBlackList\"\n          addable\n          label=\"卡片不回饋清單\"\n          :list=\"store.storeList\"\n        />\n        <ClipList\n          v-model=\"data.config.paymentBlackList\"\n          label=\"卡片不回饋支付方式\"\n          show-selected\n          :list=\"Payment\"\n        />\n        <CardList\n          :list=\"data.config.plans\"\n          class=\"mb-8\"\n          label=\"方案設定 (點擊卡片進行編輯)\"\n          addable\n          draggable\n          deletable\n          @update:list=\"(list) => (data.config.plans = list)\"\n          @click-item=\"(item) => (editCardPlan = cloneDeep(item))\"\n          @add-item=\"editCardPlan = generateEmptyCardPlanConfig()\"\n          @delete-item=\"\n            (item, index) =>\n              store.openDialog({\n                text: `確定要刪除'${item.config.name ?? '此'}'方案嗎？`,\n                events: [\n                  {\n                    text: '取消',\n                  },\n                  {\n                    text: '刪除',\n                    event: () => {\n                      data.config.plans.splice(index, 1)\n                    },\n                    class: 'text-red',\n                  },\n                ],\n              })\n          \"\n        >\n          <template #default=\"item\">\n            {{ item.config.name ?? '(空)' }}\n          </template>\n        </CardList>\n        <CardList\n          :list=\"data.config.pointExchanges\"\n          class=\"mb-8\"\n          addable\n          draggable\n          deletable\n          label=\"點數交換方式 (點擊卡片進行編輯)\"\n          @update:list=\"(list) => (data.config.pointExchanges = list)\"\n          @click-item=\"(item) => (editCardPointExchange = cloneDeep(item))\"\n          @add-item=\"editCardPointExchange = generateEmptyCardPointExchangeConfig()\"\n          @delete-item=\"\n            (item, index) =>\n              store.openDialog({\n                text: `確定要刪除'${item.config.name ?? '此'}'點數交換方式嗎？`,\n                events: [\n                  {\n                    text: '取消',\n                  },\n                  {\n                    text: '刪除',\n                    event: () => {\n                      data.config.pointExchanges.splice(index, 1)\n                    },\n                    class: 'text-red',\n                  },\n                ],\n              })\n          \"\n        >\n          <template #default=\"item\">\n            {{ item.config.name ?? '(空)' }}\n          </template>\n        </CardList>\n        <v-btn\n          text=\"更新設定檔\"\n          @click=\"\n            () => {\n              if (editCard !== null) {\n                importCurrentCardConfig = JSON.stringify(editCard.config, null, 2)\n              }\n            }\n          \"\n        />\n        <v-btn\n          class=\"text-red\"\n          text=\"刪除\"\n          @click=\"\n            store.openDialog({\n              text: '確定要刪除嗎？',\n              events: [\n                {\n                  text: '取消',\n                },\n                {\n                  text: '刪除',\n                  event: deleteCardConfig,\n                  class: 'text-red',\n                },\n              ],\n            })\n          \"\n        />\n      </div>\n    </template>\n  </FullscreenDialog>\n  <FullscreenDialog\n    v-model=\"editCardPlan\"\n    title=\"編輯方案\"\n    btn-title=\"儲存\"\n    :btn-event=\"saveCardConfigPlan\"\n  >\n    <template #default=\"{ data }\">\n      <TextField v-model=\"data.config.name\" label=\"方案名稱\" />\n      <v-textarea\n        label=\"方案描述\"\n        :model-value=\"data.config.description\"\n        auto-grow\n        clearable\n        @update:model-value=\"\n          (value) => (data.config.description = isTruthyString(value) ? value : null)\n        \"\n      />\n      <CardList\n        :list=\"data.config.rewards\"\n        addable\n        draggable\n        deletable\n        @update:list=\"(list) => (data.config.rewards = list)\"\n        @add-item=\"\n          () => {\n            editRewardWithCardPlan = generateEmptyCardPlanRewardConfig()\n            editRewardWithCardPlanIndex = data.config.rewards.length\n          }\n        \"\n        @click-item=\"\n          (item, index) => {\n            editRewardWithCardPlan = cloneDeep(item)\n            editRewardWithCardPlanIndex = index\n          }\n        \"\n        @delete-item=\"\n          (_item, index) =>\n            store.openDialog({\n              text: '確定要刪除嗎？',\n              events: [\n                {\n                  text: '取消',\n                },\n                {\n                  text: '刪除',\n                  event: () => {\n                    data.config.rewards.splice(index, 1)\n                  },\n                  class: 'text-red',\n                },\n              ],\n            })\n        \"\n      >\n        <template #label>\n          <p class=\"flex-col\">\n            回饋清單 (點擊卡片進行編輯)\n            <span class=\"text-0.75em\"> 依回饋排序檢查規則，符合即計算回饋，不再檢查後續項目 </span>\n          </p>\n        </template>\n        <template #default=\"item\">\n          <p class=\"flex-col gap-4px\">\n            {{ item.rewardStrategy.name ?? '(空)' }}\n            <span class=\"text-0.9em\">\n              {{ rewardStrategyFactory(item.rewardStrategy).description }}\n            </span>\n          </p>\n        </template>\n      </CardList>\n    </template>\n  </FullscreenDialog>\n  <FullscreenDialog\n    v-model=\"editCardPointExchange\"\n    title=\"編輯交換方式\"\n    btn-title=\"儲存\"\n    :btn-event=\"saveCardConfigPointExchange\"\n  >\n    <template #default=\"{ data }\">\n      <TextField v-model=\"data.config.name\" label=\"名稱\" required />\n      <TextField v-model=\"data.config.airlineCode\" label=\"目標里程\" required />\n      <div class=\"flex gap-4px items-center justify-center\">\n        <NumberField\n          v-model=\"data.config.pointsPerMile\"\n          class=\"flex-1\"\n          label=\"points\"\n          required\n          clearable\n        />\n        <span class=\"mdi mdi-arrow-right-thick text-24px mb-16px\" />\n        <NumberField\n          v-model=\"data.config.milesPerUnit\"\n          class=\"flex-1\"\n          :label=\"`${data.config.airlineCode} 哩程`\"\n          required\n          clearable\n        />\n      </div>\n    </template>\n  </FullscreenDialog>\n  <FullscreenDialog\n    v-model=\"editRewardWithCardPlan\"\n    title=\"編輯回饋\"\n    btn-title=\"儲存\"\n    :btn-event=\"saveRewardWithCardPlan\"\n  >\n    <template #default=\"{ data }\">\n      <div class=\"flex-col gap-8px\">\n        <TextField v-model=\"data.rewardStrategy.name\" label=\"回饋名稱\" />\n        <v-select\n          label=\"回饋方式\"\n          :items=\"rewardStrategyType\"\n          :model-value=\"data.rewardStrategy.type\"\n          @update:model-value=\"(type) => (data.rewardStrategy.type = type)\"\n        />\n        <template\n          v-if=\"\n            data.rewardStrategy.type === 'RoundedPercentageReward' ||\n            data.rewardStrategy.type === 'TruncatedPercentageReward'\n          \"\n        >\n          <div\n            v-for=\"(item, index) of data.rewardStrategy.pointBackRates\"\n            :key=\"index\"\n            class=\"flex gap-4px\"\n          >\n            <!-- TODO: 有空要想想 vuetify css 要怎麼比較漂亮的設定 padding 小一點 -->\n            <NumberField\n              v-model=\"item.rate\"\n              :messages=\"item.rate === 0 ? '0% 回饋儲存時會移除' : ''\"\n              class=\"flex-1\"\n              prefix=\"消費\"\n              suffix=\"%回饋\"\n              is-float\n            />\n            <NumberField\n              :model-value=\"item.limit ?? 0\"\n              class=\"flex-1\"\n              prefix=\"上限\"\n              suffix=\"點\"\n              messages=\"0 表示沒回饋上限\"\n              @update:model-value=\"(data) => (item.limit = data === 0 ? null : data)\"\n            />\n          </div>\n          <v-btn @click=\"data.rewardStrategy.pointBackRates.push({ rate: 0 })\">\n            <span class=\"mdi mdi-plus text-24px\" />\n          </v-btn>\n        </template>\n        <template\n          v-else-if=\"\n            data.rewardStrategy.type === 'FixedRatePointsReward' ||\n            data.rewardStrategy.type === 'AccumulatedPointsReward'\n          \"\n        >\n          <NumberField\n            v-model=\"data.rewardStrategy.spendingPerPoint\"\n            prefix=\"每消費\"\n            suffix=\"元累積一點\"\n          />\n        </template>\n        <v-label text=\"回饋規則\" />\n        <div class=\"gap-8px flex-center\">\n          <v-label text=\"交易類型\" />\n          <v-radio-group\n            :model-value=\"data.transactionType ?? null\"\n            hide-details\n            inline\n            @update:model-value=\"(type) => (data.transactionType = type)\"\n          >\n            <v-radio density=\"compact\" label=\"國內交易\" value=\"Domestic\" />\n            <v-radio density=\"compact\" label=\"國外交易\" value=\"Foreign\" />\n            <v-radio density=\"compact\" label=\"不限\" :value=\"null\" />\n          </v-radio-group>\n        </div>\n        <ClipList v-model=\"data.payments\" label=\"限制回饋支付方式\" show-selected :list=\"Payment\" />\n        <ClipList\n          v-model=\"data.paymentBlackList\"\n          label=\"不回饋支付方式\"\n          show-selected\n          :list=\"Payment\"\n        />\n        <ClipList v-model=\"data.stores\" addable label=\"限制回饋清單/商店\" :list=\"store.storeList\" />\n        <ClipList\n          v-model=\"data.storeBlackList\"\n          addable\n          label=\"不回饋清單\"\n          :list=\"store.storeList\"\n        />\n        <v-label text=\"其他設定\" />\n        <v-switch\n          :model-value=\"data.condition ?? null\"\n          label=\"生日中\"\n          value=\"Birthday\"\n          hide-details\n          color=\"blue\"\n          @update:model-value=\"(item) => (data.condition = item ?? null)\"\n        />\n      </div>\n    </template>\n  </FullscreenDialog>\n  <v-dialog\n    :model-value=\"Boolean(switchPlanWithCardId)\"\n    @update:model-value=\"switchPlanWithCardId = null\"\n  >\n    <v-card min-width=\"100%\">\n      <v-card-text class=\"overflow-hidden flex max-h-80dvh !p-0\">\n        <div class=\"overflow-y-auto w-full p-24px\">\n          <div v-if=\"currentCardWithSwitchPlan !== null\" class=\"flex-col gap-8px\">\n            切換方案\n            <v-card\n              v-for=\"(plan, index) of currentCardWithSwitchPlan.selectablePlan ?? []\"\n              :key=\"index\"\n              density=\"compact\"\n              class=\"mx-auto w-full flex-shrink-0\"\n              variant=\"outlined\"\n              @click=\"\n                () =>\n                  switchPlanWithCardId &&\n                  currentCardWithSwitchPlan &&\n                  plan.id !== currentCardWithSwitchPlan.selectedPlanId &&\n                  store.updatePlan(switchPlanWithCardId, plan.id)\n              \"\n            >\n              <v-card-text>\n                <div class=\"flex items-center justify-between gap-4px min-h-1rem\">\n                  <p class=\"flex-col gap-1\">\n                    {{ plan.name ?? '(空)' }}\n                    <span v-if=\"plan.description\" class=\"opacity-50 text-0.75rem\">\n                      {{ plan.description }}\n                    </span>\n                  </p>\n                  <span\n                    v-if=\"plan.id === currentCardWithSwitchPlan.selectedPlanId\"\n                    class=\"mdi text-24px mdi-check-circle\"\n                  />\n                </div>\n              </v-card-text>\n            </v-card>\n            切換點數交換方式\n            <v-card\n              v-for=\"(exchange, index) of currentCardWithSwitchPlan.selectablePointExchange ?? []\"\n              :key=\"index\"\n              density=\"compact\"\n              class=\"mx-auto w-full flex-shrink-0\"\n              variant=\"outlined\"\n              @click=\"\n                () =>\n                  switchPlanWithCardId &&\n                  currentCardWithSwitchPlan &&\n                  exchange.id !== currentCardWithSwitchPlan.selectedPointExchangeId &&\n                  store.updatePointExchange(switchPlanWithCardId, exchange.id)\n              \"\n            >\n              <v-card-text>\n                <div class=\"flex items-center justify-between min-h-1rem gap-4px\">\n                  <p class=\"flex-col gap-4px\">\n                    {{ exchange.name }}\n                    <span class=\"opacity-50 text-0.75rem\">{{ exchange.description }}</span>\n                  </p>\n                  <span\n                    v-if=\"exchange.id === currentCardWithSwitchPlan.selectedPointExchangeId\"\n                    class=\"mdi mdi-check-circle text-24px\"\n                  />\n                </div>\n              </v-card-text>\n            </v-card>\n          </div>\n        </div>\n      </v-card-text>\n      <v-card-actions>\n        <v-btn class=\"ms-auto\" text=\"Close\" @click=\"switchPlanWithCardId = null\" />\n      </v-card-actions>\n    </v-card>\n  </v-dialog>\n  <FullscreenDialog\n    v-model=\"needImportCardConfigs\"\n    title=\"請選擇卡片\"\n    btn-title=\"匯入\"\n    :btn-event=\"importCardConfigs\"\n  >\n    <template #default=\"{ data, updateData }\">\n      <div class=\"flex-col gap-2\">\n        <v-checkbox\n          v-for=\"(item, index) of defaultCardConfigs\"\n          :key=\"index\"\n          :model-value=\"data\"\n          :value=\"item\"\n          hide-details\n          color=\"blue\"\n          density=\"comfortable\"\n          class=\"import-card-checkbox\"\n          @update:model-value=\"(newData) => newData && updateData(newData)\"\n        >\n          <template #label>\n            <div class=\"flex-col\">\n              <p class=\"text-1rem\">\n                {{ item.name }}\n              </p>\n              <p class=\"text-0.75rem\">\n                {{ item.description }}\n              </p>\n            </div>\n          </template>\n        </v-checkbox>\n      </div>\n    </template>\n  </FullscreenDialog>\n  <FullscreenDialog\n    v-model=\"importCurrentCardConfig\"\n    title=\"匯入設定檔\"\n    btn-title=\"匯入\"\n    :btn-event=\"\n      (configString) => {\n        const config = checkConfig(configString)\n        if (editCard !== null && config !== null) {\n          editCard.config = config\n          configIsValid = false\n          return true\n        }\n        return false\n      }\n    \"\n  >\n    <template #default=\"{ data, updateData }\">\n      <v-textarea\n        :model-value=\"data\"\n        :error-messages=\"configIsValid ? '' : 'json 無效'\"\n        label=\"設定檔\"\n        :rows=\"20\"\n        @update:model-value=\"updateData\"\n      />\n    </template>\n  </FullscreenDialog>\n</template>\n<script lang=\"ts\" setup>\nimport { storeToRefs } from 'pinia'\nimport { ref, computed, type UnwrapRef, watch } from 'vue'\n\nimport CardList from '@/components/CardList.vue'\nimport ClipList from '@/components/ClipList.vue'\nimport FullscreenDialog from '@/components/FullscreenDialog.vue'\nimport NumberField from '@/components/NumberField.vue'\nimport TextField from '@/components/TextFiled.vue'\nimport type { UUID } from '@/types'\nimport { generateUuid, isTruthyString } from '@/utils'\nimport { cloneDeep } from '@/utils/cloneDeep'\n\nimport { defaultCardConfigs } from '../configs/defaultCards'\nimport { isCardConfig, Payment, rewardStrategyFactory, type CardConfig } from '../CreditCard'\nimport { isCardPlanConfig, isCardPointExchangeConfig } from '../CreditCard/createCard'\nimport { useBestMileageCardsStore } from '../store'\n\nconst rewardStrategyType = [\n  {\n    title: '消費N%回饋點數(四捨五入)',\n    value: 'RoundedPercentageReward',\n  },\n  {\n    title: '消費N%回饋點數(無條件捨去)',\n    value: 'TruncatedPercentageReward',\n  },\n  {\n    title: '每消費N元累積1點 (小數不累計)',\n    value: 'FixedRatePointsReward',\n  },\n  {\n    title: '每消費N元累積1點 (小數會累計)',\n    value: 'AccumulatedPointsReward',\n  },\n]\nconst store = useBestMileageCardsStore()\nconst { cardConfigs, cards } = storeToRefs(store)\nconst editCard = ref<{ id: UUID; config: CardConfig } | null>(null)\nconst editCardPlan = ref<CardConfig['plans'][number] | null>(null)\nconst editCardPointExchange = ref<CardConfig['pointExchanges'][number] | null>(null)\nconst editRewardWithCardPlan = ref<CardConfig['plans'][number]['config']['rewards'][number] | null>(\n  null,\n)\nconst editRewardWithCardPlanIndex = ref<number | null>(null)\nconst switchPlanWithCardId = ref<UUID | null>(null)\nconst currentCardWithSwitchPlan = computed(() => {\n  const card =\n    switchPlanWithCardId.value === null\n      ? null\n      : (cards.value.get(switchPlanWithCardId.value) ?? null)\n  if (card === null) {\n    return null\n  }\n  return card\n})\nconst importCurrentCardConfig = ref<string | null>(null)\n\nconst needImportCardConfigs = ref<CardConfig[] | null>(null)\nfunction importCardConfigs(list: CardConfig[]): void {\n  for (const item of list) {\n    store.updateCardConfig(generateUuid(), item)\n  }\n}\n\nfunction saveCardConfig({ id, config }: Exclude<UnwrapRef<typeof editCard>, null>): boolean {\n  if (!isCardConfig(config)) {\n    alert('儲存失敗')\n    return false\n  }\n  store.updateCardConfig(id, config)\n  return true\n}\n\nfunction generateEmptyCardPlanConfig(): Exclude<UnwrapRef<typeof editCardPlan>, null> {\n  return {\n    id: generateUuid(),\n    config: {\n      name: null,\n      description: null,\n      rewards: [],\n    },\n  }\n}\n\nfunction generateEmptyCardPlanRewardConfig(): Exclude<\n  UnwrapRef<typeof editRewardWithCardPlan>,\n  null\n> {\n  return {\n    rewardStrategy: {\n      name: '',\n      type: 'RoundedPercentageReward',\n      pointBackRates: [],\n    },\n  }\n}\n\nfunction saveRewardWithCardPlan(\n  config: Exclude<UnwrapRef<typeof editRewardWithCardPlan>, null>,\n): void {\n  if (\n    config.rewardStrategy.type === 'RoundedPercentageReward' ||\n    config.rewardStrategy.type === 'TruncatedPercentageReward'\n  ) {\n    config.rewardStrategy.pointBackRates = config.rewardStrategy.pointBackRates.filter(\n      ({ rate }) => rate !== 0,\n    )\n  }\n  if (editRewardWithCardPlanIndex.value !== null && editCardPlan.value !== null) {\n    editCardPlan.value.config.rewards[editRewardWithCardPlanIndex.value] = config\n  }\n  editRewardWithCardPlanIndex.value = null\n}\n\nfunction saveCardConfigPlan({\n  id,\n  config,\n}: Exclude<UnwrapRef<typeof editCardPlan>, null>): boolean {\n  if (editCard.value === null || !isCardPlanConfig(config)) {\n    alert('儲存失敗')\n    return false\n  }\n  const plan = editCard.value.config.plans.find((item) => item.id === id)\n  if (plan) {\n    plan.config = config\n  } else {\n    editCard.value.config.plans.push({ id, config })\n  }\n  return true\n}\n\nfunction generateEmptyCardPointExchangeConfig(): Exclude<\n  UnwrapRef<typeof editCardPointExchange>,\n  null\n> {\n  return {\n    id: generateUuid(),\n    config: {\n      name: '',\n      airlineCode: '',\n      milesPerUnit: 0,\n      pointsPerMile: 0,\n    },\n  }\n}\n\nfunction saveCardConfigPointExchange({\n  id,\n  config,\n}: Exclude<UnwrapRef<typeof editCardPointExchange>, null>): boolean {\n  if (\n    editCard.value === null ||\n    !isCardPointExchangeConfig(config) ||\n    config.milesPerUnit === 0 ||\n    config.pointsPerMile === 0\n  ) {\n    alert('儲存失敗')\n    return false\n  }\n  const pointExchange = editCard.value.config.pointExchanges.find((item) => item.id === id)\n  if (pointExchange) {\n    pointExchange.config = config\n  } else {\n    editCard.value.config.pointExchanges.push({ id, config })\n  }\n  return true\n}\n\nfunction deleteCardConfig(): void {\n  if (editCard.value === null) {\n    return\n  }\n  store.deleteCardConfig(editCard.value.id)\n  editCard.value = null\n}\n\n// TODO: 有空再整理 import config 相關的 code 吧～～，現在有點不想理他\nconst configIsValid = ref(true)\nwatch(\n  () => importCurrentCardConfig.value,\n  (data) => {\n    configIsValid.value = Boolean(checkConfig(data))\n  },\n)\n\nfunction checkConfig(data: string | null): CardConfig | null {\n  if (data === null) {\n    return null\n  }\n  let jsonData: unknown\n  try {\n    jsonData = JSON.parse(data)\n  } catch {\n    return null\n  }\n  return isCardConfig(jsonData) ? jsonData : null\n}\n</script>\n<style scoped>\n.import-card-checkbox:deep(.v-label--clickable) {\n  @apply w-full;\n}\n</style>\n","<template>\n  <div class=\"gap-8px h-full flex-col\">\n    <NumberField\n      v-model=\"amount\"\n      label=\"交易金額\"\n      class=\"flex-grow-0\"\n      density=\"comfortable\"\n      hide-details\n      clearable\n    />\n    <v-autocomplete\n      ref=\"storeAutoComplete\"\n      v-model=\"transactionStore\"\n      :custom-filter=\"customSearchStore\"\n      class=\"flex-grow-0\"\n      density=\"comfortable\"\n      hide-details\n      item-value=\"store\"\n      item-title=\"store\"\n      :items=\"searchStoreList\"\n      :clearable=\"isTruthyString(transactionStore)\"\n      placeholder=\"全部店家\"\n      @update:menu=\"(status: boolean) => !status && storeAutoCompleteElement?.blur()\"\n    />\n    <div>\n      <v-label text=\"店家可使用的付款方式\" />\n      <div class=\"flex items-center flex-wrap gap-x-8px\">\n        <v-checkbox\n          v-for=\"(payment, index) of commonPaymentMethods\"\n          :key=\"index\"\n          v-model=\"acceptedPayments\"\n          density=\"compact\"\n          :value=\"payment\"\n          hide-details\n          :label=\"payment\"\n        />\n      </div>\n    </div>\n    <div class=\"gap-8px flex-center\">\n      <v-label text=\"交易類型\" />\n      <v-radio-group v-model=\"transactionAttributesType\" hide-details inline>\n        <v-radio density=\"compact\" label=\"國內交易\" value=\"Domestic\" />\n        <v-radio density=\"compact\" label=\"國外交易\" value=\"Foreign\" />\n      </v-radio-group>\n    </div>\n    <div ref=\"rewardCardList\" class=\"flex-col gap-4px overflow-y-auto flex-grow-1\">\n      <v-card\n        v-for=\"(item, index) of rewardMilesList\"\n        :key=\"index\"\n        density=\"compact\"\n        class=\"mx-auto w-full flex-shrink-0\"\n        variant=\"outlined\"\n        @click=\"() => (selectedRewardItem = item)\"\n      >\n        <template #title>\n          <div class=\"flex items-center gap-4px overflow-hidden w-full\">\n            {{ item.miles }}\n            <p class=\"opacity-50 flex-grow-1 text-12px truncate\">\n              {{ item.airLinesCode }}\n              {{ item.payments.length === 0 ? '' : ` (限定支付: ${item.payments.join(', ')})` }}\n            </p>\n            <i v-if=\"item.isSelectedPlan\" class=\"fa-solid fa-circle-check\" />\n          </div>\n        </template>\n        <template #text>\n          <div class=\"flex-col gap-8px\">\n            <p class=\"text-0.75rem\">\n              {{\n                `${item.cardName} ${item.planName ?? ''} ${item.rewardName ?? ''} ${item.pointExchangeName}`\n              }}\n            </p>\n          </div>\n        </template>\n      </v-card>\n    </div>\n  </div>\n  <v-dialog\n    :model-value=\"Boolean(selectedRewardItem)\"\n    @update:model-value=\"selectedRewardItem = null\"\n  >\n    <v-card\n      v-if=\"selectedRewardItem\"\n      class=\"mx-auto reward-detail-dialog\"\n      min-width=\"100%\"\n      :title=\"`${selectedRewardItem.cardName} ${selectedRewardItem.planName ?? ''} ${selectedRewardItem.rewardName ?? ''}`\"\n    >\n      <template #subtitle>\n        <p class=\"text-wrap\">\n          {{ selectedRewardItem.description ?? '' }}\n        </p>\n      </template>\n      <template #text>\n        <div class=\"flex-col\">\n          <p class=\"flex justify-between\">\n            卡片說明：\n            <a\n              v-if=\"selectedRewardItem.cardUrl !== null\"\n              target=\"_blank\"\n              class=\"underline\"\n              :href=\"selectedRewardItem.cardUrl\"\n            >\n              網站\n            </a>\n          </p>\n          <p\n            v-if=\"\n              selectedRewardItem.cardDescription !== '' ||\n              selectedRewardItem.cardDescription !== null\n            \"\n          >\n            {{ selectedRewardItem.cardDescription }}\n          </p>\n          <p v-if=\"selectedRewardItem.pointExchangeName !== ''\">\n            {{ selectedRewardItem.pointExchangeName }}\n          </p>\n          <br />\n          <p>消費金額: {{ amount }}</p>\n          <p>哩程預估: {{ selectedRewardItem.miles }}&ensp;{{ selectedRewardItem.airLinesCode }}</p>\n          <br />\n          <p v-for=\"(text, index) of selectedRewardItem.calculateDetail\" :key=\"index\">\n            {{ text }}\n          </p>\n        </div>\n      </template>\n      <template #actions>\n        <v-btn class=\"ms-auto\" text=\"Close\" @click=\"selectedRewardItem = null\" />\n      </template>\n    </v-card>\n  </v-dialog>\n</template>\n<script lang=\"ts\" setup>\nimport { storeToRefs } from 'pinia'\nimport { computed, ref, useTemplateRef, watch } from 'vue'\n\nimport NumberField from '@/components/NumberField.vue'\nimport { roundByDigits, floorByDigits, isTruthyString } from '@/utils'\nimport { sortListByField } from '@/utils/sorts'\n\nimport {\n  type Payment,\n  type Reward,\n  type RewardType,\n  type TransactionInfo,\n  type TransactionType,\n  type PointExchangeStrategy,\n} from '../CreditCard'\nimport { useBestMileageCardsStore } from '../store'\n\nconst roundBy0 = roundByDigits(0)\nconst roundBy2 = roundByDigits(2)\nconst floorBy0 = floorByDigits(0)\n\ninterface RewardItem {\n  cardName: string\n  planName: string | null\n  rewardName: string | null\n  miles: number\n  isSelectedPlan: boolean\n  payments: readonly Payment[]\n  airLinesCode: string\n  calculateDetail: string[]\n  cardUrl: string | null\n  cardDescription: string | null\n  description: string | null\n  pointExchangeName: string\n}\n\nconst store = useBestMileageCardsStore()\nconst {\n  onlyShowCurrentPlan,\n  onlyShowCurrentPointExchange,\n  commonPaymentMethods,\n  showCards,\n  conditionTypes,\n  storeAliases,\n  storeList,\n  acceptedPaymentsWithStore,\n} = storeToRefs(store)\n\nconst amount = ref<number>(0)\nconst transactionStore = ref<string | null>(null)\nconst otherStore = '其他店家'\nconst transactionAttributesType = ref<TransactionType>('Domestic')\nconst acceptedPayments = ref<Payment[]>([])\nconst rewardCardListElement = useTemplateRef<HTMLElement>('rewardCardList')\nconst storeAutoCompleteElement = useTemplateRef<HTMLElement>('storeAutoComplete')\n\ninterface Item {\n  store: string\n  aliases?: string[]\n}\nconst searchStoreList = computed((): Item[] => {\n  const items = storeList.value.map((store) => ({\n    store,\n    aliases: [...(storeAliases.value.get(store) ?? [])],\n  }))\n  return [{ store: otherStore }, ...items]\n})\n\nfunction customSearchStore(\n  value: string,\n  searchQuery: string,\n  item?: { raw: Item; value: string },\n): boolean {\n  searchQuery = searchQuery.toLowerCase()\n  const list = [value, ...(item?.raw.aliases ?? [])].map((item) => item.toLowerCase())\n  return list.some((item) => item.includes(searchQuery))\n}\n\nwatch(transactionStore, () => {\n  if (transactionStore.value !== null) {\n    acceptedPayments.value = [\n      ...(acceptedPaymentsWithStore.value.get(transactionStore.value) ?? []),\n    ]\n  }\n})\n\nwatch(acceptedPayments, () => {\n  if (transactionStore.value !== null && transactionStore.value !== otherStore) {\n    store.updateAcceptedPaymentsWithStore(transactionStore.value, acceptedPayments.value)\n  }\n})\n\nconst rewardMilesList = computed((): RewardItem[] => {\n  const paymentInfo: TransactionInfo = {\n    amount: amount.value,\n    acceptedPayments: acceptedPayments.value,\n    transactionAttributesType: transactionAttributesType.value,\n    currentConditions: [...conditionTypes.value],\n  }\n  if (isTruthyString(transactionStore.value)) {\n    paymentInfo.transactionStore = transactionStore.value\n  }\n  const list: RewardItem[] = []\n  for (const card of showCards.value) {\n    const rewardMileList = card.getRewardInfos(paymentInfo, {\n      onlyCurrentPlan: onlyShowCurrentPlan.value,\n      onlyCurrentExchangeStrategy: onlyShowCurrentPointExchange.value,\n    })\n    const needShowIcon = !onlyShowCurrentPlan.value || !onlyShowCurrentPointExchange.value\n    const haveMultiplePointExchange =\n      !onlyShowCurrentPointExchange.value && card.selectablePointExchange.length > 1\n    for (const item of rewardMileList) {\n      const rewardItem: RewardItem = {\n        cardName: card.name,\n        planName: item.planName,\n        rewardName: item.rewardName,\n        miles: item.miles,\n        payments: item.payments,\n        airLinesCode: item.airlineCode,\n        isSelectedPlan: needShowIcon && item.planId === card.selectedPlanId,\n        calculateDetail: getRewardDetail(item.rewardStrategy, item.pointExchangeStrategy),\n        description:\n          item.rewardStrategy === null\n            ? null\n            : `${item.rewardStrategy.description}，${item.pointExchangeStrategy.description}`,\n        cardUrl: card.cardUrl,\n        cardDescription: card.description,\n        /** 有多組點數交換計劃出現的時候才顯示文字，避免太混亂 */\n        pointExchangeName: haveMultiplePointExchange ? item.pointExchangeName : '',\n      }\n      list.push(rewardItem)\n    }\n  }\n  rewardCardListElement.value?.scrollTo({ top: 0, behavior: 'smooth' })\n  return sortListByField(sortListByField(list, 'isSelectedPlan', 'desc'), 'miles', 'desc')\n})\n\nconst selectedRewardItem = ref<RewardItem | null>(null)\nfunction getRewardDetail(\n  reward: Reward<RewardType> | null,\n  pointExchangeStrategy: PointExchangeStrategy,\n): string[] {\n  const { pointsPerMile, milesPerUnit, airlineCode } = pointExchangeStrategy\n\n  const title = '回饋計算:'\n  switch (reward?.type) {\n    case 'RoundedPercentageReward':\n    case 'TruncatedPercentageReward': {\n      const numberFormatEvent = reward.type === 'RoundedPercentageReward' ? roundBy0 : floorBy0\n      let totalPoints = 0\n      return [\n        title,\n        ...reward.pointBackRates.map(({ rate, limit }) => {\n          const total = Math.min(numberFormatEvent((amount.value * rate) / 100), limit ?? Infinity)\n          totalPoints += total\n          const limitString = limit !== undefined ? ` (limit ${limit})` : ''\n          return `${amount.value} * ${rate}% = ${total}${limitString}`\n        }),\n        `總計 ${totalPoints} points`,\n        `${totalPoints} / ${pointsPerMile} * ${milesPerUnit} = ${pointExchangeStrategy.calculateMiles(totalPoints)} ${airlineCode}`,\n      ]\n    }\n    case 'AccumulatedPointsReward': {\n      const points = roundBy2(amount.value / reward.spendingPerPoint)\n      return [\n        title,\n        `${amount.value} / ${reward.spendingPerPoint} = ${points} points`,\n        `${points} / ${pointsPerMile} * ${milesPerUnit} = ${pointExchangeStrategy.calculateMiles(points)} ${airlineCode}`,\n      ]\n    }\n    case 'FixedRatePointsReward': {\n      const points = floorBy0(amount.value / reward.spendingPerPoint)\n      return [\n        title,\n        `${amount.value} / ${reward.spendingPerPoint} = ${points} points (小數省略)`,\n        `${points} / ${pointsPerMile} * ${milesPerUnit} = ${pointExchangeStrategy.calculateMiles(points)} ${airlineCode}`,\n      ]\n    }\n    default: {\n      return []\n    }\n  }\n}\n</script>\n\n<style scoped>\n.v-card p {\n  @apply line-height-none h-fit;\n}\n\n.reward-detail-dialog p {\n  @apply line-height-125%;\n}\n</style>\n","<template>\n  <div class=\"flex-col h-full overflow-hidden gap-8px\">\n    <div class=\"flex-shrink-0 flex-col gap-8px\">\n      <v-label text=\"別名設定\" />\n      <v-btn-toggle\n        :model-value=\"aliasType\"\n        rounded=\"0\"\n        group\n        class=\"w-full flex justify-center\"\n        :disabled=\"lockShowUISwitch\"\n        @update:model-value=\"updateAliasType\"\n      >\n        <v-btn v-for=\"(item, index) of aliasTypeList\" :key=\"index\" class=\"flex-1\" :value=\"item\">\n          <div class=\"flex-center gap-4px\">\n            <span v-if=\"aliasType === item\" class=\"mdi mdi-check-circle\" />\n            {{ aliasTypeTranslation[item] }}\n          </div>\n        </v-btn>\n      </v-btn-toggle>\n      <div v-if=\"aliasType !== 'default'\" class=\"flex justify-between items-center\">\n        <div class=\"flex gap-8px\">\n          <v-btn v-if=\"showUI\" @click=\"editStoreAlias(null)\"> Add </v-btn>\n          <v-btn v-else @click=\"saveStoreAliasesJson\"> 儲存 </v-btn>\n        </div>\n        <v-switch v-model=\"showUI\" :disabled=\"lockShowUISwitch\" hide-details label=\"圖示\" />\n      </div>\n    </div>\n    <div v-if=\"showUI\" class=\"gap-4px flex-col flex-grow-1 overflow-y-auto\">\n      <v-card\n        v-for=\"(item, index) of aliasList\"\n        :key=\"index\"\n        density=\"compact\"\n        class=\"mx-auto w-full flex-shrink-0\"\n        variant=\"outlined\"\n        @click=\"editStoreAlias(item.title)\"\n      >\n        <template #text>\n          <p class=\"text-1rem\">{{ item.title }}</p>\n          <p class=\"text-0.8rem\">\n            {{ item.aliases.join(', ') }}\n          </p>\n        </template>\n      </v-card>\n    </div>\n    <div v-else class=\"flex-grow-1\">\n      <v-textarea\n        :model-value=\"tempCustomAliases\"\n        clearable\n        auto-grow\n        :disabled=\"aliasType === 'default'\"\n        :max-rows=\"15\"\n        :messages=\"lockShowUISwitch ? '上方儲存完成後才能執行其他動作，離開這頁不會存檔' : ''\"\n        :error-messages=\"configIsValid ? '' : 'json 無效'\"\n        label=\"自定義別名設定檔\"\n        @update:model-value=\"checkAndUpdateCustomAliasesJson\"\n      />\n    </div>\n  </div>\n  <FullscreenDialog\n    v-model=\"editStoreAliasData\"\n    title=\"編輯商店別名\"\n    btn-title=\"儲存\"\n    :btn-event=\"saveStoreAlias\"\n  >\n    <template #default=\"{ data }\">\n      <div class=\"flex-col gap-24px m-8px\">\n        <v-autocomplete\n          ref=\"storeList\"\n          v-model=\"data.title\"\n          class=\"flex-grow-0\"\n          hide-details\n          label=\"目標店家\"\n          :items=\"bestMileageCardsStore.storeList\"\n          placeholder=\"選擇店家\"\n          @update:menu=\"(status: boolean) => !status && storeListElement?.blur()\"\n        />\n        <div class=\"flex-col gap-4px\">\n          <v-label text=\"自定義別名列表\" />\n          <v-text-field\n            v-for=\"(alias, index) of data.aliases\"\n            :key=\"index\"\n            hide-details\n            clearable\n            :model-value=\"alias\"\n            @update:model-value=\"(text) => updateAliases(text, index)\"\n            @click:clear=\"() => data.aliases.splice(index, 1)\"\n          />\n        </div>\n      </div>\n    </template>\n  </FullscreenDialog>\n</template>\n<script lang=\"ts\" setup>\nimport { storeToRefs } from 'pinia'\nimport { computed, onActivated, ref, useTemplateRef, watch } from 'vue'\n\nimport FullscreenDialog from '@/components/FullscreenDialog.vue'\nimport { isTruthyString } from '@/utils'\n\nimport { defaultStoreAliases, isStoreAliasesList } from '../configs/storeAliases'\nimport { useBestMileageCardsStore } from '../store'\nimport { aliasTypeList, type AliasType } from '../utils'\n\n// TODO: 後面有空再 refactor 吧，感覺沒想好設計就做事，思考很混亂，而且先做卡片意義比較大\nconst bestMileageCardsStore = useBestMileageCardsStore()\nconst { aliasType, customAliases, storeAliases } = storeToRefs(bestMileageCardsStore)\n\nconst storeListElement = useTemplateRef<HTMLElement>('storeList')\n\nconst aliasTypeTranslation: Record<AliasType, string> = {\n  default: '系統預設',\n  additional: '預設+自定義',\n  custom: '自定義',\n}\n\ninterface AliasItem {\n  title: string | null\n  aliases: string[]\n}\n\nconst showUI = ref<boolean>(true)\nconst lockShowUISwitch = ref<boolean>(false)\nconst configIsValid = ref(true)\nconst tempCustomAliases = ref<string>('[]')\nconst editStoreAliasData = ref<AliasItem | null>(null)\n\nconst aliasList = computed((): AliasItem[] => {\n  let list: readonly [string, readonly string[]][]\n  if (aliasType.value === 'default') {\n    list = defaultStoreAliases\n  } else if (aliasType.value === 'additional') {\n    list = [...storeAliases.value].map(([key, value]) => [key, [...value]])\n  } else {\n    list = [...customAliases.value]\n  }\n  return list.map(([title, aliases]) => ({ title, aliases: [...aliases] }))\n})\n\nwatch(\n  () => editStoreAliasData.value?.title,\n  (storeName) => {\n    if (storeName === undefined || storeName === null || editStoreAliasData.value === null) {\n      return\n    }\n    const aliases = [...(customAliases.value.get(storeName) ?? [])]\n    if (aliases[aliases.length - 1] !== '') {\n      aliases.push('')\n    }\n    editStoreAliasData.value.aliases = aliases\n  },\n)\nwatch(showUI, resetTempCustomAliases)\n\nonActivated(() => {\n  resetTempCustomAliases()\n  lockShowUISwitch.value = false\n  configIsValid.value = true\n  showUI.value = true\n})\n\nfunction updateAliases(text: string, index: number): void {\n  if (editStoreAliasData.value === null) {\n    return\n  }\n  let aliases = editStoreAliasData.value.aliases\n  aliases[index] = text\n  if (aliases[aliases.length - 1] !== '') {\n    aliases.push('')\n  }\n}\n\n/** UI 操作上新增或編輯別名 */\nfunction editStoreAlias(title: string | null): void {\n  if (aliasType.value === 'default') {\n    return\n  }\n  if (title === null) {\n    editStoreAliasData.value = {\n      title: null,\n      aliases: [],\n    }\n  } else {\n    const aliases = [...(customAliases.value.get(title) ?? [])]\n    if (aliases[aliases.length - 1] !== '') {\n      aliases.push('')\n    }\n    editStoreAliasData.value = {\n      title,\n      aliases,\n    }\n  }\n}\n\n/** 儲存自定義別名資料 */\nfunction saveStoreAlias({ title: storeName, aliases }: AliasItem): void {\n  if (storeName !== null) {\n    bestMileageCardsStore.updateCustomAliases(\n      storeName,\n      [...new Set(aliases)].filter(isTruthyString),\n    )\n  }\n}\n\nfunction checkAndUpdateCustomAliasesJson(str: string): void {\n  str = str.trim()\n  tempCustomAliases.value = str\n  lockShowUISwitch.value = true\n  if (str === '') {\n    configIsValid.value = true\n    return\n  }\n  try {\n    const config: unknown = JSON.parse(str)\n    configIsValid.value = isStoreAliasesList(config)\n  } catch (error) {\n    console.error(error)\n    configIsValid.value = false\n  }\n}\n\nfunction saveStoreAliasesJson(): void {\n  let status\n  if (showUI.value) {\n    status = true\n  } else {\n    if (tempCustomAliases.value === '') {\n      tempCustomAliases.value = '[]'\n    }\n    try {\n      const config: unknown = JSON.parse(tempCustomAliases.value)\n      if (isStoreAliasesList(config)) {\n        bestMileageCardsStore.updateAllCustomAliases(config)\n        status = true\n      } else {\n        status = false\n      }\n    } catch (error) {\n      console.error(error)\n      status = false\n    }\n  }\n  if (status) {\n    alert('儲存成功')\n    lockShowUISwitch.value = false\n  } else {\n    alert(`儲存失敗${!showUI.value ? '，JSON 不符合規則' : ''}`)\n  }\n}\n\nfunction resetTempCustomAliases(): void {\n  tempCustomAliases.value = JSON.stringify([...customAliases.value], null, 2)\n}\n\nfunction updateAliasType(type: AliasType): void {\n  if (lockShowUISwitch.value) {\n    return\n  }\n  if (type === 'default') {\n    showUI.value = true\n  }\n  bestMileageCardsStore.updateAliasType(type)\n}\n</script>\n","<template>\n  <v-app>\n    <v-app-bar density=\"comfortable\" :elevation=\"2\">\n      <template #prepend>\n        <v-app-bar-nav-icon @click=\"openNavigation = !openNavigation\">\n          <i class=\"fa-solid fa-bars\" />\n        </v-app-bar-nav-icon>\n        <v-app-bar-title>{{ currentPage }}</v-app-bar-title>\n      </template>\n    </v-app-bar>\n    <v-navigation-drawer v-model=\"openNavigation\">\n      <template v-for=\"(item, index) of pageList\" :key=\"index\">\n        <v-list-item\n          :title=\"item\"\n          class=\"h-48px\"\n          :class=\"{ 'text-emphasis': currentPage === item }\"\n          @click=\"\n            () => {\n              currentPage = item\n              openNavigation = false\n            }\n          \"\n        />\n        <v-divider />\n      </template>\n    </v-navigation-drawer>\n    <main style=\"height: calc(100dvh - 56px)\" class=\"overflow-hidden mt-56px p-8px\">\n      <KeepAlive>\n        <component :is=\"componentList[currentPage]\" />\n      </KeepAlive>\n    </main>\n  </v-app>\n  <v-dialog :model-value=\"Boolean(dialog)\" @update:model-value=\"store.closeDialog\">\n    <v-card v-if=\"dialog !== null\" class=\"mx-auto\" min-width=\"100%\">\n      <template #text>\n        <div class=\"w-full text-center\">{{ dialog.text }}</div>\n      </template>\n      <template #actions>\n        <div class=\"w-full flex items-center justify-between px-8px\">\n          <v-btn\n            v-for=\"(event, index) of dialog.events\"\n            :key=\"index\"\n            :text=\"event.text\"\n            :class=\"event.class\"\n            variant=\"elevated\"\n            @click=\"\n              async () => {\n                if ('event' in event) {\n                  await event.event()\n                }\n                store.closeDialog()\n              }\n            \"\n          />\n        </div>\n      </template>\n    </v-card>\n  </v-dialog>\n</template>\n<script lang=\"ts\" setup>\nimport { storeToRefs } from 'pinia'\nimport { ref } from 'vue'\n\nimport CommonSettings from './containers/CommonSettings.vue'\nimport CreditCardManagement from './containers/CreditCardManagement.vue'\nimport SearchReward from './containers/SearchReward.vue'\nimport StoreAliasManagement from './containers/StoreAliasManagement.vue'\nimport { useBestMileageCardsStore } from './store'\n\nconst store = useBestMileageCardsStore()\nconst { dialog } = storeToRefs(store)\n\nconst componentList = {\n  // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment\n  查詢回饋: SearchReward,\n  // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment\n  信用卡管理: CreditCardManagement,\n  // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment\n  商家別名: StoreAliasManagement,\n  // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment\n  喜好設定: CommonSettings,\n} as const\ntype PageList = keyof typeof componentList\nconst pageList = Object.keys(componentList) as unknown as PageList[]\n\nconst openNavigation = ref(false)\n// eslint-disable-next-line @typescript-eslint/no-non-null-assertion\nconst currentPage = ref<PageList>(pageList[0]!)\n</script>\n","import { createPinia } from 'pinia'\n\nimport { createBaseApp } from '@/base/index'\nimport { vuetify } from '@/base/vuetify'\n\nimport App from './App.vue'\n\n// eslint-disable-next-line @typescript-eslint/no-unsafe-argument\nconst app = createBaseApp(App)\n\napp.use(vuetify)\napp.use(createPinia())\n\napp.mount('#app')\n"],"names":["comboboxComponent","useTemplateRef","autocompleteComponent","selectComponent","emits","__emit","itemList","computed","sortList","__props","remove","removeItem","newList","item","updateModelValue","newValue","closeKeyboard","element","status","clearList","floorBy0","floorByDigits","roundBy0","roundByDigits","roundBy2","BaseRewardStrategy","type","name","__publicField","minAmount","maxAmount","list","amount","data","a","b","max","min","average","previousValue","currentValue","RoundedPercentageReward","pointBackRates","superParams","total","rate","points","limit","TruncatedPercentageReward","AccumulatedPointsReward","spendingPerPoint","FixedRatePointsReward","rewards","rewardStrategyFactory","params","Plan","description","condition","removeDuplicates","reward","currentConditions","transactionStore","acceptedPayments","transactionAttributesType","stores","payments","transactionType","paymentBlackList","storeBlackList","isStoreValid","isStoreNotBlackListed","isPaymentValid","payment","isPaymentNotBlackListed","isTransactionTypeMatch","conditionValid","rewardStrategy","Payment","CreditCard","plans","cardUrl","updateAt","pointExchanges","selectedPlanId","selectedPointExchangeId","planId","pointExchangeId","id","plan","pointExchangeStrategy","pointExchangeStrategyId","paymentInfo","noneMatchRewardInfo","inStoreBlackList","inPaymentBlackList","_a","rewardInfo","onlyCurrentPlan","onlyCurrentExchangeStrategy","exchangeIds","rewardInfos","strategy","PointExchangeStrategy","airlineCode","pointsPerMile","milesPerUnit","createCard","planConfigs","config","isCardConfig","_iv3","_iv10","_iv12","_io0","input","elem","_io1","_io9","_io2","_io3","_iu0","_io4","_io5","_io6","_io7","_io8","_io10","isCardPlanConfig","_iv5","_iv7","isCardPointExchangeConfig","cardDescription","getRewardDescription","end","start","format","cubePlanSettings","defaultBackRete","baseReward","generateUuid","cubePointExchanges","cubeConfigs","exampleCubeConfig","evaPlanSettings","defaultSpendingPerPoint","evaPointExchanges","evaCardDescription","evaConfigs","exampleEvaConfig","getStarLuxSpecifyReward","starLuxConfigs","uniCardStoreList","uniCardSpecifyPayment","uniCardBaseReward","uniCardConfigs","exampleUniCardConfig","travelConfigs","exampleTravelConfig","exampleCardConfigs","defaultCardConfigs","isStoreAliasesList","defaultStoreAliases","storageManager","CustomStorageManager","_iv2","_iv4","_iv11","_iv13","aliasTypeList","useBestMileageCardsStore","defineStore","dialog","ref","openDialog","closeDialog","onMounted","configs","cardConfigs","acceptedPaymentsWithStore","onlyShowCurrentPlan","updateOnlyShowCurrentPlan","onlyShowCurrentPointExchange","updateOnlyShowCurrentPointExchange","commonPaymentMethods","updateCommonPaymentMethods","cards","showCards","updateCardConfig","deleteCardConfig","updatePlan","updatePointExchange","storeList","card","conditionTypes","updateConditionTypes","types","updateAcceptedPaymentsWithStore","store","aliasType","updateAliasType","customAliases","updateCustomAliases","aliases","updateAllCustomAliases","storeAliases","storeAliasesMap","alias","readonly","bestMileageCardsStore","storeToRefs","cloneDeep","i","key","value","result","props","cardListContainer","cardItemElements","cacheList","shallowRef","draggedIndex","dragOverIndex","touchStartIndex","touchStartY","isLongPress","longPressTimer","updateList","watch","handleDragStart","event","index","emptyImg","handleTouchStart","touch","handleTouchMove","deltaY","checkTouchOver","targetIndex","draggedItem","handleTouchEnd","handleDragOver","handleDragLeave","relatedTarget","handleDragEnd","emitClickItem","emitDeleteItem","calculateCardItemHeight","currentItemHeight","nextItemHeight","targetHeight","previousItemHeight","updateData","newData","warningSaveText","saveAndCloneDialog","checkNumber","newNumber","rules","text","setFocusIndex","isTruthyString","rewardStrategyType","editCard","editCardPlan","editCardPointExchange","editRewardWithCardPlan","editRewardWithCardPlanIndex","switchPlanWithCardId","currentCardWithSwitchPlan","importCurrentCardConfig","needImportCardConfigs","importCardConfigs","saveCardConfig","generateEmptyCardPlanConfig","generateEmptyCardPlanRewardConfig","saveRewardWithCardPlan","saveCardConfigPlan","generateEmptyCardPointExchangeConfig","saveCardConfigPointExchange","pointExchange","configIsValid","checkConfig","jsonData","otherStore","rewardCardListElement","storeAutoCompleteElement","searchStoreList","items","customSearchStore","searchQuery","rewardMilesList","rewardMileList","needShowIcon","haveMultiplePointExchange","rewardItem","getRewardDetail","sortListByField","selectedRewardItem","title","numberFormatEvent","totalPoints","limitString","storeListElement","aliasTypeTranslation","showUI","lockShowUISwitch","tempCustomAliases","editStoreAliasData","aliasList","storeName","resetTempCustomAliases","onActivated","updateAliases","editStoreAlias","saveStoreAlias","checkAndUpdateCustomAliasesJson","str","error","saveStoreAliasesJson","componentList","SearchReward","CreditCardManagement","StoreAliasManagement","CommonSettings","pageList","openNavigation","currentPage","app","createBaseApp","App","vuetify","createPinia"],"mappings":"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,CACP,CACE,eAAgB,CACd,KAAM,0BACN,KAAM,KACN,eAAgB,CAAC,CAAE,KAAMF,CAAiB,CAAA,CAC5C,EACA,OAAQ,CACN,WACA,gBACA,QACA,OACA,WACA,YACA,OACA,OACA,mBACA,OACA,SACA,WACA,OACA,QACA,YACA,OACA,KACA,MACA,QACA,OACA,WACA,OACA,SACA,aACA,UACA,SACA,OACA,SACA,MACA,OACA,OACA,wBACA,yBACA,wBACA,mCACA,WACA,QACA,OACA,gBACA,OACA,SACA,OACA,OACA,OACA,YACA,YACA,YACA,UACA,aACA,MACA,MACA,KACF,EACA,SAAAxE,EACF,EACA,CAAE,GAAGyE,EAAY,eAAgB,CAAC,QAAQ,CAAE,CAAA,CAC9C,CAEJ,EACA,CACE,GAAIC,EAAa,EACjB,OAAQ,CACN,KAAM,MACN,YACE,yDACF,QAAS,CACP,CACE,eAAgB,CACd,KAAM,0BACN,KAAM,KACN,eAAgB,CAAC,CAAE,KAAMF,CAAiB,CAAA,CAC5C,EACA,OAAQ,CACN,SACA,UACA,eACA,cACA,qBACA,qBACA,qBACA,OACA,OACA,OACA,OACA,QACA,QACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,QACA,KACA,OACA,OACA,OACA,OACA,SACA,QACA,OACA,OACA,OACA,QACA,OACA,OACA,SACA,OACA,UACA,QACA,QACA,QACA,QACA,SACA,aACA,UACA,cACA,WACA,SACA,cACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,QACA,WACA,OACA,QACA,OACF,EACA,SAAAxE,EACF,EACA,CAAE,GAAGyE,EAAY,eAAgB,CAAC,QAAQ,CAAE,CAAA,CAC9C,CAEJ,EACA,CACE,GAAIC,EAAa,EACjB,OAAQ,CACN,KAAM,MACN,YAAa,aACb,QAAS,CACP,CACE,eAAgB,CACd,KAAM,0BACN,KAAM,KACN,eAAgB,CAAC,CAAE,KAAM,CAAG,CAAA,CAC9B,EACA,SAAU,CAAC,UAAU,CACvB,EACA,CAAE,GAAGD,EAAY,eAAgB,CAAC,QAAQ,CAAE,CAAA,CAC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CN,iBAAkB,GACpB,EACA,gBAAiB,UACjB,UAAW,UACb,EACAU,GAAwB,GAAG,EAC3B,CACE,eAAgB,CACd,KAAM,wBACN,KAAM,OACN,iBAAkB,EACpB,EACA,gBAAiB,SACnB,EACA,CACE,eAAgB,CACd,KAAM,wBACN,KAAM,OACN,iBAAkB,EACpB,EACA,gBAAiB,UAAA,CACnB,CACF,CACF,CAEJ,EACA,SAAU,IAAI,KAAK,qBAAqB,EAAE,YAAY,CACxD,EACA,CACE,KAAM,QACN,YAAajB,GAAqB,WAAW,EAC7C,QACE,yFAAA,eACFhE,GAAA,iBACAD,GACA,eAAgB,CACd,CACE,GAAIwE,EAAa,EACjB,OAAQ,CACN,KAAM,SACN,YAAa,MACb,cAAe,EACf,aAAc,CAAA,CAChB,CAEJ,EACA,MAAO,CACL,CACE,GAAIA,EAAa,EACjB,OAAQ,CACN,KAAM,KACN,QAAS,CACPU,GAAwB,EAAE,EAC1B,CACE,eAAgB,CACd,KAAM,wBACN,KAAM,OACN,iBAAkB,EACpB,EACA,gBAAiB,SACnB,EACA,CACE,eAAgB,CACd,KAAM,wBACN,KAAM,OACN,iBAAkB,EACpB,EACA,gBAAiB,UAAA,CACnB,CACF,CACF,CAEJ,EACA,SAAU,IAAI,KAAK,qBAAqB,EAAE,YAAY,CAAA,CAE1D,EAEME,GAAmB,CACvB,OACA,QACA,KACA,OACA,OACA,OACA,SACA,OACA,OACA,WACA,mBACA,OACA,OACA,OACA,OACA,OACA,SACA,QACA,QACA,wBACA,yBACA,wBACA,KACA,MACA,OACA,OACA,mCACA,OACA,QACA,cACA,MACA,KACA,YACA,YACA,UACA,QACA,OACA,OACA,OACA,OACA,MACA,MACA,KACA,KACA,KACA,MACA,KACA,KACA,MACA,KACA,OACA,MACA,OACA,OACA,MACA,OACA,OACA,OACA,OACA,OACA,KACA,OACA,OACA,WACA,cACA,aACA,SACA,UACA,QACA,QACA,OACA,OACA,QACA,WACA,OACA,OACA,KACA,MACA,OACA,MACA,MACA,MACA,OACA,SACA,MACA,OACA,OACA,UAC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"}