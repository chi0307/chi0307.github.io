var pt=Object.defineProperty;var mt=(d,a,n)=>a in d?pt(d,a,{enumerable:!0,configurable:!0,writable:!0,value:n}):d[a]=n;var j=(d,a,n)=>mt(d,typeof a!="symbol"?a+"":a,n);import{d as ae,e as le,c as ee,B as b,g as _,v as K,E as _e,C as w,k as v,x as p,D as H,t as $,u as C,b as D,o as Ze,f as ne,j as E,s as ce,w as Ae,G as Fe,y as Y,F as z,l as Q,z as Ge,m as me,H as yt,I as gt,J as ft,K as vt,A as Pt}from"../index-gFMtbPZa.js";import{d as ht,s as fe,c as _t}from"../pinia-DiZJYEcq.js";import{f as wt,C as xt,v as bt}from"../StorageManager-kr_YR8h9.js";import{a as Qe,b as We}from"../sorts-DmEn6gXZ.js";import{f as et,r as ye,b as Ke,g as O,a as ge}from"../index-D6lFa5lC.js";import{_ as He}from"../_plugin-vue_export-helper-DlAUqK2U.js";const se=ae({__name:"ClipList",props:{modelValue:{default:()=>[]},list:{},label:{},message:{},searchable:{type:Boolean,default:!1},addable:{type:Boolean,default:!1},showSelected:{type:Boolean,default:!1},hideDetails:{type:Boolean,default:!1}},emits:["update:model-value"],setup(d,{emit:a}){const n=le("comboboxComponent"),c=le("autocompleteComponent"),x=le("selectComponent"),u=a,f=ee(()=>Qe(d.list));function s(r){const S=d.modelValue.filter(M=>M!==r);g(S)}function g([...r]){u("update:model-value",r)}function P(r){return function(S){!S&&r!==null&&r.blur()}}function t(){g([])}return(r,S)=>{const M=b("v-chip"),G=b("v-combobox"),e=b("v-autocomplete"),y=b("v-select");return r.addable?(_(),K(G,{key:0,ref_key:"comboboxComponent",ref:n,"model-value":r.modelValue,items:f.value,label:r.label,hint:"可新增內容",multiple:"","persistent-hint":"","hide-details":r.hideDetails,"hide-selected":!r.showSelected,"onUpdate:modelValue":g,"onUpdate:menu":S[0]||(S[0]=N=>P(C(n)))},_e({selection:w(({item:N})=>[p(M,{closable:"","onClick:close":X=>s(N.value)},{default:w(()=>[H($(N.value),1)]),_:2},1032,["onClick:close"])]),_:2},[r.modelValue.length!==0?{name:"details",fn:w(()=>[v("p",{class:"cursor-pointer text-red",onClick:t},"全部刪除")]),key:"0"}:void 0]),1032,["model-value","items","label","hide-details","hide-selected"])):r.searchable?(_(),K(e,{key:1,ref_key:"autocompleteComponent",ref:c,"model-value":r.modelValue,items:f.value,"hide-details":r.hideDetails,label:r.label,multiple:"","hide-selected":!r.showSelected,"clear-on-select":"","onUpdate:modelValue":g,"onUpdate:menu":S[1]||(S[1]=N=>P(C(c)))},_e({selection:w(({item:N})=>[p(M,{closable:"","onClick:close":X=>s(N.value)},{default:w(()=>[H($(N.value),1)]),_:2},1032,["onClick:close"])]),_:2},[r.modelValue.length!==0?{name:"details",fn:w(()=>[v("p",{class:"cursor-pointer text-red",onClick:t},"全部刪除")]),key:"0"}:void 0]),1032,["model-value","items","hide-details","label","hide-selected"])):(_(),K(y,{key:2,ref_key:"selectComponent",ref:x,"model-value":r.modelValue,items:f.value,"hide-details":r.hideDetails,label:r.label,multiple:"","hide-selected":!r.showSelected,"onUpdate:modelValue":g,"onUpdate:menu":S[2]||(S[2]=N=>P(C(x)))},_e({selection:w(({item:N})=>[p(M,{closable:"","onClick:close":X=>s(N.value)},{default:w(()=>[H($(N.value),1)]),_:2},1032,["onClick:close"])]),_:2},[r.modelValue.length!==0?{name:"details",fn:w(()=>[v("p",{class:"cursor-pointer text-red",onClick:t},"全部刪除")]),key:"0"}:void 0]),1032,["model-value","items","hide-details","label","hide-selected"]))}}}),tt=et(0),At=ye(0),Je=ye(2);class ke{constructor({type:a,name:n}){j(this,"_name");j(this,"_type");this._type=a,this._name=n}get name(){return this._name}get type(){return this._type}calculateRangePointsCost(a,n){const c=[];for(let s=a;s<=n;s++){const g=Je(s/this.calculatePoints(s));isNaN(g)||g===1/0||g===-1/0||c.push(g)}c.sort((s,g)=>s-g);const x=c[c.length-1],u=c[0];if(x===void 0||u===void 0)throw new Error("cannot be calculated");const f=c.reduce((s,g)=>s+g,0)/c.length;return{max:x,min:u,average:Je(f)}}}class kt extends ke{constructor({pointBackRates:n,...c}){super(c);j(this,"_pointBackRates");this._pointBackRates=n}get _maxRete(){return this._pointBackRates.reduce((n,{rate:c})=>n+c,0)}get pointBackRates(){return this._pointBackRates}get description(){return`消費${this._pointBackRates.length>1?"最高":""}${this._maxRete.toString()}%回饋點數(四捨五入)`}calculatePoints(n){let c=0;for(const{rate:x,limit:u}of this._pointBackRates)c+=Math.min(At(n*(x/100)),u??1/0);return c}toJSON(){return{name:this._name,type:this._type,pointBackRates:this._pointBackRates}}}class Ct extends ke{constructor({pointBackRates:n,...c}){super(c);j(this,"_pointBackRates");this._pointBackRates=n}get _maxRete(){return this._pointBackRates.reduce((n,{rate:c})=>n+c,0)}get pointBackRates(){return this._pointBackRates}get description(){return`消費${this._pointBackRates.length>1?"最高":""}${this._maxRete.toString()}%回饋點數(無條件捨去)`}calculatePoints(n){let c=0;for(const{rate:x,limit:u}of this._pointBackRates)c+=Math.min(tt(n*(x/100)),u??1/0);return c}toJSON(){return{name:this._name,type:this._type,pointBackRates:this._pointBackRates}}}class St extends ke{constructor({spendingPerPoint:n,...c}){super({...c});j(this,"_spendingPerPoint");this._spendingPerPoint=n}get spendingPerPoint(){return this._spendingPerPoint}get description(){return`每消費${this._spendingPerPoint.toString()}元累積1點 (小數會累計)`}calculatePoints(n){return Je(n/this._spendingPerPoint)}toJSON(){return{name:this._name,type:this._type,spendingPerPoint:this._spendingPerPoint}}}class Rt extends ke{constructor({spendingPerPoint:n,...c}){super({...c});j(this,"_spendingPerPoint");this._spendingPerPoint=n}get spendingPerPoint(){return this._spendingPerPoint}get description(){return`每消費${this._spendingPerPoint.toString()}元累積1點 (小數不累計)`}calculatePoints(n){return tt(n/this._spendingPerPoint)}toJSON(){return{name:this._name,type:this._type,spendingPerPoint:this._spendingPerPoint}}}const Bt={RoundedPercentageReward:kt,TruncatedPercentageReward:Ct,AccumulatedPointsReward:St,FixedRatePointsReward:Rt};function at(d){return new Bt[d.type](d)}class Et{constructor(a,n,c,x){j(this,"_name");j(this,"_description");j(this,"_rewards");j(this,"_condition");if(this._name=a,this._description=n,this._condition=c,x.length===0)throw new Error(`Plan "${a??"unknown"}" must have at least one reward rule.`);this._rewards=x}get name(){return this._name}get description(){return this._description}get storeList(){return Ke(this._rewards.flatMap(a=>[...a.stores,...a.storeBlackList]))}checkPlanIsVisible(a){return this._condition===null||!!(a!=null&&a.includes(this._condition))}getApplicableReward({transactionStore:a=null,acceptedPayments:n=[],transactionAttributesType:c,currentConditions:x=null}){return this._condition!==null&&!(x!=null&&x.includes(this._condition))?null:this._rewards.find(({stores:u,payments:f,transactionType:s,paymentBlackList:g,storeBlackList:P,condition:t})=>{const r=a===null||u.size===0||u.has(a),S=a===null||P.size===0||!P.has(a),M=n.length===0||f.size===0||n.some(N=>f.has(N)),G=n.length===0||g.size===0||n.some(N=>!g.has(N)),e=s===null||c===s,y=t===null||!!(x!=null&&x.includes(t));return r&&S&&M&&G&&e&&y})??null}getRewardMiles({transactionStore:a,acceptedPayments:n,amount:c,transactionAttributesType:x,currentConditions:u}){const f=this.getApplicableReward({acceptedPayments:n,transactionStore:a,transactionAttributesType:x,currentConditions:u});if(f===null)return null;const s=n===void 0?[...f.payments.values()]:n.filter(g=>f.payments.has(g));return{rewardName:f.rewardStrategy.name,rewardPoints:f.rewardStrategy.calculatePoints(c),payments:s.filter(g=>!f.paymentBlackList.has(g)),rewardStrategy:f.rewardStrategy}}toJSON(){return{name:this._name,description:this._description,condition:this._condition,rewards:this._rewards.map(({rewardStrategy:a,stores:n,payments:c,transactionType:x,paymentBlackList:u,storeBlackList:f,condition:s})=>({rewardStrategy:a.toJSON(),stores:[...n],storeBlackList:[...f],payments:[...c],paymentBlackList:[...u],transactionType:x,condition:s}))}}}const we=["信用卡","Apple Pay","Samsung Pay","Google Pay","Line Pay","Fitbit Pay","Garmin Pay","Hami Pay","街口支付","全盈+PAY","全支付","Pi錢包","橘子支付","歐付寶","icash pay","OPEN錢包","My FamiPay","悠遊付","ezPay","GOMAJI Pay","friday wallet","PayPal","PX Pay","中油Pay","台灣Pay","支付寶"];class Tt{constructor({name:a,description:n,plans:c,storeBlackList:x,paymentBlackList:u,cardUrl:f,updateAt:s,pointExchanges:g,selectedPlanId:P,selectedPointExchangeId:t}){j(this,"_selectedPlanId");j(this,"_selectedPointExchangeId");j(this,"_name");j(this,"_description");j(this,"_plans");j(this,"_cardUrl");j(this,"_storeBlackList");j(this,"_paymentBlackList");j(this,"_updateAt");j(this,"_pointExchanges");this._name=a,this._description=n,this._plans=c,this._cardUrl=f,this._storeBlackList=x,this._paymentBlackList=u,this._updateAt=s,this._pointExchanges=g;const r=P??this._plans.keys().next().value??null;if(r===null)throw new Error(`this plan id ${r} not found`);this._selectedPlanId=r;const S=t??this._pointExchanges.keys().next().value??null;if(S===null)throw new Error(`this point exchange id ${S} not found`);this._selectedPointExchangeId=S}get name(){return this._name}get description(){return this._description}get selectedPlanId(){return this._selectedPlanId}get selectedPlan(){return this._getPlan(this._selectedPlanId)}get selectedPointExchangeId(){return this._selectedPointExchangeId}get selectedPointExchange(){return this._getPointExchangeStrategy(this._selectedPointExchangeId)}get selectablePlan(){return[...this._plans.entries()].map(([a,{name:n,description:c}])=>({id:a,name:n,description:c}))}get selectablePointExchange(){return[...this._pointExchanges.entries()].map(([a,{name:n,description:c}])=>({id:a,name:n,description:c}))}get storeList(){return Ke([...[...this._plans.values()].flatMap(a=>a.storeList),...this._storeBlackList])}get cardUrl(){return this._cardUrl}_getPlan(a){const n=this._plans.get(a);if(n===void 0)throw new Error(`plan id ${a} not found. Available plans: ${[...this._plans.keys()].join(", ")}`);return n}_getPointExchangeStrategy(a){const n=this._pointExchanges.get(a);if(n===void 0)throw new Error(`pointExchangeStrategy id ${a} not found. Available pointExchanges: ${[...this._plans.keys()].join(", ")}`);return n}_rewardMilesWithPlan(a,n,c){var t;const x=this._getPlan(a),u=this._getPointExchangeStrategy(n),f={planId:a,planName:x.name,rewardName:null,rewardPoints:0,payments:[],rewardStrategy:null,pointExchangeStrategy:u,pointExchangeName:u.name,airlineCode:u.airlineCode,miles:0},s=c.transactionStore!==void 0&&this._storeBlackList.has(c.transactionStore),g=(t=c.acceptedPayments)==null?void 0:t.some(r=>this._paymentBlackList.has(r));if(s||g)return f;const P=x.getRewardMiles(c);return P===null?f:{planId:a,planName:x.name,pointExchangeStrategy:u,pointExchangeName:u.name,miles:u.calculateMiles(P.rewardPoints),airlineCode:u.airlineCode,...P}}getRewardInfos(a,{onlyCurrentPlan:n=!1,onlyCurrentExchangeStrategy:c=!1}={}){const x=n?[[this._selectedPlanId,this.selectedPlan]]:[...this._plans.entries()],u=c?[this._selectedPointExchangeId]:[...this._pointExchanges.keys()],f=[];for(const[s,g]of x)if(g.checkPlanIsVisible(a.currentConditions??null))for(const t of u){const r=this._rewardMilesWithPlan(s,t,a);f.push(r)}return f}toJSON(){return{name:this._name,description:this._description,cardUrl:this._cardUrl,storeBlackList:[...this._storeBlackList],paymentBlackList:[...this._paymentBlackList],selectedPlanId:this._selectedPlanId,plans:[...this._plans].map(([a,n])=>({id:a,config:n.toJSON()})),updateAt:this._updateAt.toISOString(),selectedPointExchangeId:this._selectedPointExchangeId,pointExchanges:[...this._pointExchanges].map(([a,n])=>({id:a,config:n.toJSON()}))}}}const Ut=ye(2);class Vt{constructor({name:a,airlineCode:n,pointsPerMile:c,milesPerUnit:x}){j(this,"_name");j(this,"_airlineCode");j(this,"_pointsPerMile");j(this,"_milesPerUnit");this._name=a,this._airlineCode=n,this._pointsPerMile=c,this._milesPerUnit=x}get name(){return this._name}get description(){return`${this._pointsPerMile}點可以交換${this._milesPerUnit}哩程`}get airlineCode(){return this._airlineCode}get pointsPerMile(){return this._pointsPerMile}get milesPerUnit(){return this._milesPerUnit}calculateMiles(a){return Ut(a*this._milesPerUnit/this._pointsPerMile)}toJSON(){return{name:this._name,airlineCode:this._airlineCode,pointsPerMile:this._pointsPerMile,milesPerUnit:this._milesPerUnit}}}function Xe({name:d,description:a,storeBlackList:n,paymentBlackList:c,cardUrl:x,plans:u,updateAt:f,pointExchanges:s,selectedPlanId:g,selectedPointExchangeId:P}){const t=new Map(u.map(({id:r,config:{name:S,description:M,condition:G,rewards:e}})=>[r,new Et(S,M??null,G??null,e.map(({stores:y,payments:N,transactionType:X,rewardStrategy:J,paymentBlackList:h,storeBlackList:A,condition:I})=>({rewardStrategy:at(J),stores:new Set(y),storeBlackList:new Set(A),payments:new Set(N),paymentBlackList:new Set(h),transactionType:X??null,condition:I??null})))]));return new Tt({name:d,description:a??null,plans:t,storeBlackList:new Set(n),paymentBlackList:new Set(c),cardUrl:x,updateAt:new Date(f),selectedPlanId:g??null,selectedPointExchangeId:P??null,pointExchanges:new Map(s.map(({id:r,config:S})=>[r,new Vt(S)]))})}const qe=(()=>{const d=new Set(["信用卡","Apple Pay","Samsung Pay","Google Pay","Line Pay","Fitbit Pay","Garmin Pay","Hami Pay","街口支付","全盈+PAY","全支付","Pi錢包","橘子支付","歐付寶","icash pay","OPEN錢包","My FamiPay","悠遊付","ezPay","GOMAJI Pay","friday wallet","PayPal","PX Pay","中油Pay","台灣Pay","支付寶"]),a=new Set(["信用卡","Apple Pay","Samsung Pay","Google Pay","Line Pay","Fitbit Pay","Garmin Pay","Hami Pay","街口支付","全盈+PAY","全支付","Pi錢包","橘子支付","歐付寶","icash pay","OPEN錢包","My FamiPay","悠遊付","ezPay","GOMAJI Pay","friday wallet","PayPal","PX Pay","中油Pay","台灣Pay","支付寶"]),n=new Set(["信用卡","Apple Pay","Samsung Pay","Google Pay","Line Pay","Fitbit Pay","Garmin Pay","Hami Pay","街口支付","全盈+PAY","全支付","Pi錢包","橘子支付","歐付寶","icash pay","OPEN錢包","My FamiPay","悠遊付","ezPay","GOMAJI Pay","friday wallet","PayPal","PX Pay","中油Pay","台灣Pay","支付寶"]),c=e=>typeof e.name=="string"&&(e.description===null||e.description===void 0||typeof e.description=="string")&&(e.cardUrl===null||typeof e.cardUrl=="string")&&(e.storeBlackList===void 0||Array.isArray(e.storeBlackList)&&e.storeBlackList.every(y=>typeof y=="string"))&&(e.paymentBlackList===void 0||Array.isArray(e.paymentBlackList)&&e.paymentBlackList.every(y=>d.has(y)===!0))&&(e.selectedPlanId===void 0||typeof e.selectedPlanId=="string"&&RegExp(/(.*)\x2d(.*)\x2d(.*)\x2d(.*)\x2d(.*)/).test(e.selectedPlanId))&&Array.isArray(e.plans)&&e.plans.every(y=>typeof y=="object"&&y!==null&&x(y))&&typeof e.updateAt=="string"&&RegExp(/^[+-]?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?\x2d[+-]?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?\x2d[+-]?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?T[+-]?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?:[+-]?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?:[+-]?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?\.[+-]?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?Z$/).test(e.updateAt)&&(e.selectedPointExchangeId===void 0||typeof e.selectedPointExchangeId=="string"&&RegExp(/(.*)\x2d(.*)\x2d(.*)\x2d(.*)\x2d(.*)/).test(e.selectedPointExchangeId))&&Array.isArray(e.pointExchanges)&&e.pointExchanges.every(y=>typeof y=="object"&&y!==null&&S(y)),x=e=>typeof e.id=="string"&&RegExp(/(.*)\x2d(.*)\x2d(.*)\x2d(.*)\x2d(.*)/).test(e.id)&&typeof e.config=="object"&&e.config!==null&&u(e.config),u=e=>(e.name===null||typeof e.name=="string")&&(e.description===null||e.description===void 0||typeof e.description=="string")&&Array.isArray(e.rewards)&&e.rewards.every(y=>typeof y=="object"&&y!==null&&f(y))&&(e.condition===null||e.condition===void 0||e.condition==="Birthday"),f=e=>typeof e.rewardStrategy=="object"&&e.rewardStrategy!==null&&G(e.rewardStrategy)&&(e.transactionType===null||e.transactionType===void 0||e.transactionType==="Domestic"||e.transactionType==="Foreign")&&(e.stores===void 0||Array.isArray(e.stores)&&e.stores.every(y=>typeof y=="string"))&&(e.storeBlackList===void 0||Array.isArray(e.storeBlackList)&&e.storeBlackList.every(y=>typeof y=="string"))&&(e.payments===void 0||Array.isArray(e.payments)&&e.payments.every(y=>a.has(y)===!0))&&(e.paymentBlackList===void 0||Array.isArray(e.paymentBlackList)&&e.paymentBlackList.every(y=>n.has(y)===!0))&&(e.condition===null||e.condition===void 0||e.condition==="Birthday"),s=e=>Array.isArray(e.pointBackRates)&&e.pointBackRates.every(y=>typeof y=="object"&&y!==null&&g(y))&&(e.name===null||typeof e.name=="string")&&e.type==="RoundedPercentageReward",g=e=>typeof e.rate=="number"&&(e.limit===null||e.limit===void 0||typeof e.limit=="number"),P=e=>Array.isArray(e.pointBackRates)&&e.pointBackRates.every(y=>typeof y=="object"&&y!==null&&g(y))&&(e.name===null||typeof e.name=="string")&&e.type==="TruncatedPercentageReward",t=e=>typeof e.spendingPerPoint=="number"&&(e.name===null||typeof e.name=="string")&&e.type==="AccumulatedPointsReward",r=e=>typeof e.spendingPerPoint=="number"&&(e.name===null||typeof e.name=="string")&&e.type==="FixedRatePointsReward",S=e=>typeof e.id=="string"&&RegExp(/(.*)\x2d(.*)\x2d(.*)\x2d(.*)\x2d(.*)/).test(e.id)&&typeof e.config=="object"&&e.config!==null&&M(e.config),M=e=>typeof e.name=="string"&&typeof e.airlineCode=="string"&&typeof e.pointsPerMile=="number"&&typeof e.milesPerUnit=="number",G=e=>e.type==="TruncatedPercentageReward"?P(e):e.type==="RoundedPercentageReward"?s(e):e.type==="FixedRatePointsReward"?r(e):e.type==="AccumulatedPointsReward"?t(e):!1;return e=>typeof e=="object"&&e!==null&&c(e)})(),Lt=(()=>{const d=new Set(["信用卡","Apple Pay","Samsung Pay","Google Pay","Line Pay","Fitbit Pay","Garmin Pay","Hami Pay","街口支付","全盈+PAY","全支付","Pi錢包","橘子支付","歐付寶","icash pay","OPEN錢包","My FamiPay","悠遊付","ezPay","GOMAJI Pay","friday wallet","PayPal","PX Pay","中油Pay","台灣Pay","支付寶"]),a=new Set(["信用卡","Apple Pay","Samsung Pay","Google Pay","Line Pay","Fitbit Pay","Garmin Pay","Hami Pay","街口支付","全盈+PAY","全支付","Pi錢包","橘子支付","歐付寶","icash pay","OPEN錢包","My FamiPay","悠遊付","ezPay","GOMAJI Pay","friday wallet","PayPal","PX Pay","中油Pay","台灣Pay","支付寶"]),n=t=>(t.name===null||typeof t.name=="string")&&(t.description===null||t.description===void 0||typeof t.description=="string")&&Array.isArray(t.rewards)&&t.rewards.every(r=>typeof r=="object"&&r!==null&&c(r))&&(t.condition===null||t.condition===void 0||t.condition==="Birthday"),c=t=>typeof t.rewardStrategy=="object"&&t.rewardStrategy!==null&&P(t.rewardStrategy)&&(t.transactionType===null||t.transactionType===void 0||t.transactionType==="Domestic"||t.transactionType==="Foreign")&&(t.stores===void 0||Array.isArray(t.stores)&&t.stores.every(r=>typeof r=="string"))&&(t.storeBlackList===void 0||Array.isArray(t.storeBlackList)&&t.storeBlackList.every(r=>typeof r=="string"))&&(t.payments===void 0||Array.isArray(t.payments)&&t.payments.every(r=>d.has(r)===!0))&&(t.paymentBlackList===void 0||Array.isArray(t.paymentBlackList)&&t.paymentBlackList.every(r=>a.has(r)===!0))&&(t.condition===null||t.condition===void 0||t.condition==="Birthday"),x=t=>Array.isArray(t.pointBackRates)&&t.pointBackRates.every(r=>typeof r=="object"&&r!==null&&u(r))&&(t.name===null||typeof t.name=="string")&&t.type==="RoundedPercentageReward",u=t=>typeof t.rate=="number"&&(t.limit===null||t.limit===void 0||typeof t.limit=="number"),f=t=>Array.isArray(t.pointBackRates)&&t.pointBackRates.every(r=>typeof r=="object"&&r!==null&&u(r))&&(t.name===null||typeof t.name=="string")&&t.type==="TruncatedPercentageReward",s=t=>typeof t.spendingPerPoint=="number"&&(t.name===null||typeof t.name=="string")&&t.type==="AccumulatedPointsReward",g=t=>typeof t.spendingPerPoint=="number"&&(t.name===null||typeof t.name=="string")&&t.type==="FixedRatePointsReward",P=t=>t.type==="TruncatedPercentageReward"?f(t):t.type==="RoundedPercentageReward"?x(t):t.type==="FixedRatePointsReward"?g(t):t.type==="AccumulatedPointsReward"?s(t):!1;return t=>typeof t=="object"&&t!==null&&n(t)})(),It=(()=>{const d=a=>typeof a.name=="string"&&typeof a.airlineCode=="string"&&typeof a.pointsPerMile=="number"&&typeof a.milesPerUnit=="number";return a=>typeof a=="object"&&a!==null&&d(a)})(),ie=pe("2025/6/30");function pe(d,a){return`權益 ~${wt(d,"yyyy/M/d")}`}const Re=["分期付款"],Be=[],Ee=["信用卡","Apple Pay","Samsung Pay","Google Pay","Fitbit Pay","Garmin Pay","Hami Pay"];function Te(d){const a={rewardStrategy:{type:"RoundedPercentageReward",name:null,pointBackRates:[{rate:.3}]}};return[{id:O(),config:{name:"集精選",description:"量販超市, 指定加油, 指定超商, 生活家居",rewards:[{rewardStrategy:{type:"RoundedPercentageReward",name:null,pointBackRates:[{rate:2}]},stores:["家樂福","LOPIA台灣","全聯福利中心","台灣中油-直營","7-ELEVEN","全家便利商店","IKEA"],payments:[...Ee,"PX Pay","My FamiPay","OPEN錢包"]},a]}},{id:O(),config:{name:"玩數位",description:"數位/串流平台, 網購平台, 國際電商, 辦公神器",rewards:[{rewardStrategy:{type:"RoundedPercentageReward",name:null,pointBackRates:[{rate:d}]},stores:["App Store","Apple Music","iCloud","Apple TV+","Apple Arcade","Apple One","iTunes","Google Play","Disney+","Netflix","Spotify","KKBOX","YouTube Premium","Max","蝦皮購物","momo購物網","PChome 24h購物(不含儲值及電子票券)","小樹購","Coupang 酷澎(台灣)","淘寶/天貓","ChatGPT","Dropbox","Surfshark","NordVPN","McAfee","Microsoft","LinkedIn","Whoscall","Zoom"],paymentBlackList:["Line Pay","街口支付"]},{...a,storeBlackList:["全聯福利中心"]}]}},{id:O(),config:{name:"樂饗購",description:"國內指定百貨, 國內外送平台, 國內餐飲, 國內藥妝",rewards:[{rewardStrategy:{type:"RoundedPercentageReward",name:null,pointBackRates:[{rate:d}]},stores:["遠東SOGO百貨","遠東Garden City","太平洋百貨","新光三越","SKM Park","BELLAVITA","微風廣場","遠東百貨","Big City遠東巨城購物中心","誠品生活","環球購物中心","CITYLINK","統一時代","台北101","ATT 4 FUN","明曜百貨","京站","美麗華","大葉高島屋","比漾廣場","大江國際購物中心","中友百貨","廣三SOGO","Tiger City","勤美誠品綠園道","大魯閣新時代","耐斯廣場","南紡購物中心","夢時代","漢神百貨","漢神巨蛋","MITSUI OUTLET PARK 林口","MITSUI OUTLET PARK 台中港","MITSUI OUTLET PARK 台南","Mitsui Shopping Park LaLaport 台中","義大世界購物廣場","華泰名品城","義享天地","麗寶OUTLET Mall","秀泰生活","台茂購物中心","新月廣場","三創生活","宏匯廣場","NOKE忠泰樂生活","Uber Eats","foodpanda","foodomo","國內餐飲(不含餐券)","麥當勞","康是美","屈臣氏"],payments:Ee},{...a,storeBlackList:["全聯福利中心"]}]}},{id:O(),config:{name:"趣旅行",description:"指定海外消費, 日本指定遊樂園, 國內外交通, 指定航空公司, 指定飯店住宿, 旅遊/訂房平台, 指定旅行社",rewards:[{rewardStrategy:{type:"RoundedPercentageReward",name:null,pointBackRates:[{rate:d}]},stores:["海外實體消費","東京迪士尼樂園","東京華納兄弟哈利波特影城","大阪環球影城(USJ)","Apple Wallet SUICA","Apple Wallet PASMO","Apple Wallet ICOCA","Uber","Grab","台灣高鐵","yoxi","台灣大車隊","iRent","和運租車","格上租車","中華航空","長榮航空","星宇航空","台灣虎航","國泰航空","樂桃航空","阿聯酋航空","酷航","捷星航空","日本航空","亞洲航空","聯合航空","ANA全日空","新加坡航空","越捷航空","大韓航空","達美航空","土耳其航空","卡達航空","法國航空","國內飯店住宿","星野集團","全球迪士尼飯店","東橫INN","KKday","Agoda","Klook","Airbnb","Hotels.com","Expedia","Booking.com","Trip.com","AsiaYo","ezTravel易遊網","雄獅旅遊","可樂旅遊","東南旅遊","五福旅遊","燦星旅遊","山富旅遊","長汎假期","鳳凰旅行社","Ezfly易飛網","理想旅遊","永利旅行社","三賀旅行社"],payments:Ee},{...a,storeBlackList:["全聯福利中心"]}]}},{id:O(),config:{name:"來支付",description:"LINE Pay消費",rewards:[{rewardStrategy:{type:"RoundedPercentageReward",name:null,pointBackRates:[{rate:2}]},payments:["Line Pay"]},{...a,storeBlackList:["全聯福利中心"]}]}},{id:O(),config:{name:"慶生月",description:"指定百貨/休閒娛樂/國內外送平台 3.5%, 國外精選遊樂園實體消費/國內人氣樂園/指定蛋糕甜點店/指定咖啡廳/指定國內餐廳/KTV/派對/電玩 10%",condition:"Birthday",rewards:[{rewardStrategy:{type:"RoundedPercentageReward",name:null,pointBackRates:[{rate:10}]},stores:["東京迪士尼樂園","大阪環球影城(USJ)","名古屋樂高樂園","紅葉蛋糕官方網站","法朋烘焙甜點坊","興波咖啡 華山旗艦店","海底撈火鍋","輕井澤鍋物","老四川巴蜀麻辣燙","二本松涮涮屋","橋山.壽喜燒","Umai屋馬燒肉","老井極上燒肉","燒肉中山(台中大墩)","藏壽司台灣","貳樓","膳馨民間創作料理","馨苑小料理","雅室牛排 仁愛圓環店","ABV餐飲集團","WAT","臺虎精釀(信義 | 西門 | 臺中 | 啜飲室大安)","BAR Bodega","BAR MED","JiN Her 今鶴","錢櫃KTV","好樂迪KTV","星聚點KTV","享溫馨KTV","Nintendo","巴哈姆特動畫瘋","閃動格子CyberCube"]},{rewardStrategy:{type:"RoundedPercentageReward",name:null,pointBackRates:[{rate:3.5}]},stores:["新光三越","Uber Eats (不含 Uber One)","Agoda","Trip.com","Klook","國內飯店住宿","星野集團","全球迪士尼飯店","東橫INN"]},{...a,storeBlackList:["全聯福利中心"]}]}}]}const Ue=[{id:O(),config:{name:"長榮航空哩程",airlineCode:"EVA",pointsPerMile:360,milesPerUnit:1e3}},{id:O(),config:{name:"長榮航空哩程 + 長榮世界卡",airlineCode:"EVA",pointsPerMile:300,milesPerUnit:1e3}}],nt=[{name:"Cube 卡",description:`Cube 卡 (Level 1) 回饋方案 (${ie})`,cardUrl:"https://www.cathaybk.com.tw/cathaybk/personal/product/credit-card/cards/cube/",storeBlackList:Re,paymentBlackList:Be,updateAt:"2024-12-01T00:00:00.000Z",plans:Te(2),pointExchanges:Ue},{name:"Cube 卡",description:`Cube 卡 (Level 2) 回饋方案 (${ie})`,cardUrl:"https://www.cathaybk.com.tw/cathaybk/personal/product/credit-card/cards/cube/",storeBlackList:Re,paymentBlackList:Be,updateAt:"2024-12-01T00:00:00.000Z",plans:Te(3),pointExchanges:Ue},{name:"Cube 卡",description:`Cube 卡 (Level 3) 回饋方案 (${ie})`,cardUrl:"https://www.cathaybk.com.tw/cathaybk/personal/product/credit-card/cards/cube/",storeBlackList:Re,paymentBlackList:Be,updateAt:"2024-12-01T00:00:00.000Z",plans:Te(3.3),pointExchanges:Ue}],$t=nt[1];function Ve(d){return[{id:O(),config:{name:null,description:"部分回饋需要另外登錄",rewards:[{rewardStrategy:{type:"FixedRatePointsReward",name:`Expedia專屬網頁線上訂房 ${pe("2025/12/31")}`,spendingPerPoint:8},stores:["Expedia"],payments:["Apple Pay","Samsung Pay","Google Pay","Fitbit Pay","Garmin Pay","Hami Pay"]},{rewardStrategy:{type:"FixedRatePointsReward",name:"長榮官網購票/機上免稅品",spendingPerPoint:10},stores:["長榮機上免稅品","長榮官網購票"]},{rewardStrategy:{type:"FixedRatePointsReward",name:"海外消費",spendingPerPoint:10},transactionType:"Foreign"},{rewardStrategy:{type:"FixedRatePointsReward",name:"國內旅行社 (需登錄) 銀行並未公告符合商家",spendingPerPoint:10},transactionType:"Domestic",stores:["雄獅旅遊","可樂旅遊","東南旅遊","五福旅遊","燦星旅遊","山富旅遊","長汎假期","鳳凰旅行社","Ezfly易飛網","理想旅遊","永利旅行社","三賀旅行社"]},{rewardStrategy:{type:"FixedRatePointsReward",name:"國外自由行、團體旅遊 (需登錄) 銀行並未公告符合商家",spendingPerPoint:10},transactionType:"Foreign"},{rewardStrategy:{type:"FixedRatePointsReward",name:"一般消費",spendingPerPoint:d}}]}}]}const Pe=[{id:O(),config:{name:"長榮航空哩程 (每1000哩為單位自動轉換至哩程帳戶)",airlineCode:"EVA",pointsPerMile:1e3,milesPerUnit:1e3}}],he=pe("2025/3/31"),lt=[{name:"長榮極致無限卡",cardUrl:"https://www.cathaybk.com.tw/cathaybk/personal/product/credit-card/cards/eva/",description:he,updateAt:"2024-12-29T00:00:00.000Z",plans:Ve(20),pointExchanges:Pe},{name:"長榮無限卡",cardUrl:"https://www.cathaybk.com.tw/cathaybk/personal/product/credit-card/cards/eva/",description:he,updateAt:"2024-12-29T00:00:00.000Z",plans:Ve(22),pointExchanges:Pe},{name:"長榮極致御璽卡",cardUrl:"https://www.cathaybk.com.tw/cathaybk/personal/product/credit-card/cards/eva/",description:he,updateAt:"2024-12-29T00:00:00.000Z",plans:Ve(30),pointExchanges:Pe},{name:"長榮御璽卡",cardUrl:"https://www.cathaybk.com.tw/cathaybk/personal/product/credit-card/cards/eva/",description:he,updateAt:"2024-12-29T00:00:00.000Z",plans:[{id:O(),config:{name:null,description:null,rewards:[{rewardStrategy:{type:"FixedRatePointsReward",name:"一般消費",spendingPerPoint:30}}]}}],pointExchanges:Pe}],Mt=lt[1],xe=["政府稅款","公共事業代扣繳","交通違規罰鍰","分期付款","全聯福利中心","7-ELEVEN","全家便利商店"],be=[];function Le(d){return{rewardStrategy:{type:"FixedRatePointsReward",name:"指定通路里程加速",spendingPerPoint:d},transactionType:"Domestic",stores:["星宇航空官方網站/App購票","星宇航空形象門市","béshopping","星宇航空國際航線機上免稅品"]}}const Ot=[{name:"星宇世界卡",description:pe("2025/2/28"),cardUrl:"https://www.esunbank.com/zh-tw/personal/credit-card/intro/co-branded-card/starlux-card",storeBlackList:xe,paymentBlackList:be,pointExchanges:[{id:O(),config:{name:"星宇航空哩程",airlineCode:"SJX",pointsPerMile:1,milesPerUnit:1}}],plans:[{id:O(),config:{name:null,rewards:[{rewardStrategy:{type:"FixedRatePointsReward",name:"國外消費 (生日兩倍)",spendingPerPoint:5},transactionType:"Foreign",condition:"Birthday"},Le(5),{rewardStrategy:{type:"FixedRatePointsReward",name:"國外消費",spendingPerPoint:10},transactionType:"Foreign"},{rewardStrategy:{type:"FixedRatePointsReward",name:"國內消費",spendingPerPoint:20},transactionType:"Domestic"}]}}],updateAt:new Date("2025/01/12 22:00:00").toISOString()},{name:"星宇商務鈦金卡",description:pe("2025/2/28"),cardUrl:"https://www.esunbank.com/zh-tw/personal/credit-card/intro/co-branded-card/starlux-card",storeBlackList:xe,paymentBlackList:be,pointExchanges:[{id:O(),config:{name:"星宇航空哩程",airlineCode:"SJX",pointsPerMile:1,milesPerUnit:1}}],plans:[{id:O(),config:{name:null,rewards:[{rewardStrategy:{type:"FixedRatePointsReward",name:"國外消費",spendingPerPoint:7.5},transactionType:"Foreign",condition:"Birthday"},Le(7.5),{rewardStrategy:{type:"FixedRatePointsReward",name:"國外消費",spendingPerPoint:15},transactionType:"Foreign"},{rewardStrategy:{type:"FixedRatePointsReward",name:"國內消費",spendingPerPoint:25},transactionType:"Domestic"}]}}],updateAt:new Date("2025/01/12 22:00:00").toISOString()},{name:"星宇鈦金卡",description:pe("2025/2/28"),cardUrl:"https://www.esunbank.com/zh-tw/personal/credit-card/intro/co-branded-card/starlux-card",storeBlackList:xe,paymentBlackList:be,pointExchanges:[{id:O(),config:{name:"星宇航空哩程",airlineCode:"SJX",pointsPerMile:1,milesPerUnit:1}}],plans:[{id:O(),config:{name:null,rewards:[Le(10),{rewardStrategy:{type:"FixedRatePointsReward",name:"國外消費",spendingPerPoint:20},transactionType:"Foreign"},{rewardStrategy:{type:"FixedRatePointsReward",name:"國內消費",spendingPerPoint:28},transactionType:"Domestic"}]}}],updateAt:new Date("2025/01/12 22:00:00").toISOString()}],Ie=["台灣中油","台灣大車隊","台鐵","台灣高鐵","UBER","Yoxi","桃園機場捷運","新光三越","遠東百貨","遠東SOGO百貨","Big City遠東巨城購物中心","漢神百貨","微風廣場","微風信義","微風南京","微風南山","微風台北車站","台北101","華泰名品城","MITSUI OUTLET PARK 林口","MITSUI OUTLET PARK 台中港","MITSUI OUTLET PARK 台南","京站","美麗華","誠品生活","秀泰生活","Mitsui Shopping Park LaLaport 台中","統領廣場","太平洋百貨","統一時代百貨(台北店)","昇恆昌","采盟","Uber Eats","foodpanda","EZTABLE","王品瘋美食","摩斯漢堡","漢來美食","饗Joy","饗食天堂","果然匯","小福利","饗饗","旭集","開飯","饗泰多","真珠","瓦城","非常泰","大心","1010","時時香","BOBO","乾杯集團","路易莎","中華航空","長榮航空","日本航空","台灣虎航","樂桃航空","酷航","立榮航空","華信航空","Trip.com","booking.com","Hotels.com","AsiaYo","Expedia","KKday","Klook","雄獅旅遊","可樂旅遊","東南旅行社","Apple直營店","小米台灣","全國電子","燦坤","迪卡儂","寵物公園","家家樂","屈臣氏","特力屋","特力和樂","UNIQLO","NET","大樹藥局","丁丁藥妝","momo購物網","蝦皮購物","淘寶網","Coupang酷澎","東森購物","博客來","日本實體店","韓國實體店","泰國實體店","越南實體店","新加坡實體店","馬來西亞實體店","菲律賓實體店","中國實體店","香港實體店","澳門實體店","美國實體店","加拿大實體店","英國實體店","法國實體店","德國實體店","義大利實體店","澳洲實體店","玉山Wallet愛心捐款-單筆捐款","玉山Wallet愛心捐款-定期定額","特斯拉","Gogoro電池資費","YouBike 2.0"],$e=["Line Pay","街口支付","悠遊付","全盈+PAY","全支付","橘子支付"],Me={rewardStrategy:{type:"TruncatedPercentageReward",name:null,pointBackRates:[{rate:.3},{rate:.7}]}},ot=[{name:"UniCard 卡",description:ie,cardUrl:"https://www.esunbank.com/zh-tw/personal/credit-card/intro/bank-card/unicard",storeBlackList:xe,paymentBlackList:be,pointExchanges:[{id:O(),config:{name:"長榮航空哩程",airlineCode:"EVA",pointsPerMile:200,milesPerUnit:300}}],plans:[{id:O(),config:{name:"任意選 (需要切換店家)",description:"玉山Wallet設定8家特店",rewards:[{rewardStrategy:{type:"TruncatedPercentageReward",name:null,pointBackRates:[{rate:.3},{rate:.7},{rate:2.5,limit:500}]},stores:Ie,payments:["信用卡","Apple Pay","Samsung Pay","Google Pay"]},{rewardStrategy:{type:"TruncatedPercentageReward",name:null,pointBackRates:[{rate:.3},{rate:.7},{rate:2.5,limit:500}]},payments:$e},Me]}},{id:O(),config:{name:"簡單選",rewards:[{rewardStrategy:{type:"TruncatedPercentageReward",name:null,pointBackRates:[{rate:.3},{rate:.7},{rate:2,limit:500}]},stores:Ie,payments:["信用卡","Apple Pay","Samsung Pay","Google Pay"]},{rewardStrategy:{type:"TruncatedPercentageReward",name:null,pointBackRates:[{rate:.3},{rate:.7},{rate:2,limit:500}]},payments:$e},Me]}},{id:O(),config:{name:"UP選",description:"完成指定任務或99點玉山e point訂閱",rewards:[{rewardStrategy:{type:"TruncatedPercentageReward",name:null,pointBackRates:[{rate:.3},{rate:.7},{rate:3.5,limit:2e3}]},stores:Ie,payments:["信用卡","Apple Pay","Samsung Pay","Google Pay"]},{rewardStrategy:{type:"TruncatedPercentageReward",name:null,pointBackRates:[{rate:.3},{rate:.7},{rate:3.5,limit:2e3}]},payments:$e},Me]}}],updateAt:new Date("2025/01/12 22:00:00").toISOString()}],Nt=ot[0],Oe=["政府稅款","公共事業代扣繳","交通違規罰鍰","分期付款"],Ne=["全盈+PAY","icash pay","OPEN錢包","My FamiPay"],st=[{name:"旅人無限卡",description:ie,cardUrl:"https://www.hsbc.com.tw/credit-cards/products/travel/visa-infinite/",storeBlackList:Oe,paymentBlackList:Ne,pointExchanges:[{id:O(),config:{name:"長榮航空哩程",airlineCode:"EVA",pointsPerMile:1,milesPerUnit:1}}],plans:[{id:O(),config:{name:null,rewards:[{rewardStrategy:{type:"AccumulatedPointsReward",name:"國外消費",spendingPerPoint:10},transactionType:"Foreign"},{rewardStrategy:{type:"AccumulatedPointsReward",name:"國內消費",spendingPerPoint:18},transactionType:"Domestic"}]}}],updateAt:new Date("2024/12/01 00:00:00").toISOString()},{name:"旅人御璽卡",description:ie,cardUrl:"https://www.hsbc.com.tw/credit-cards/products/travel/visa-signature/",storeBlackList:Oe,paymentBlackList:Ne,pointExchanges:[{id:O(),config:{name:"長榮航空哩程",airlineCode:"EVA",pointsPerMile:1,milesPerUnit:1}}],plans:[{id:O(),config:{name:null,rewards:[{rewardStrategy:{type:"AccumulatedPointsReward",name:"國外消費",spendingPerPoint:15},transactionType:"Foreign"},{rewardStrategy:{type:"AccumulatedPointsReward",name:"國內消費",spendingPerPoint:18},transactionType:"Domestic"}]}}],updateAt:new Date("2024/12/01 00:00:00").toISOString()},{name:"旅人輕旅卡",description:ie,cardUrl:"https://www.hsbc.com.tw/credit-cards/products/travel/visa-light/",storeBlackList:Oe,paymentBlackList:Ne,pointExchanges:[{id:O(),config:{name:"長榮航空哩程",airlineCode:"EVA",pointsPerMile:1,milesPerUnit:1}}],plans:[{id:O(),config:{name:null,rewards:[{rewardStrategy:{type:"AccumulatedPointsReward",name:"國外消費",spendingPerPoint:20},transactionType:"Foreign"},{rewardStrategy:{type:"AccumulatedPointsReward",name:"國內消費",spendingPerPoint:20},transactionType:"Domestic"}]}}],updateAt:new Date("2024/12/01 00:00:00").toISOString()}],Dt=st[2],Ft=[Mt,$t,Dt,Nt],Gt=[...lt,...nt,...st,...Ot,...ot],je=d=>Array.isArray(d)&&d.every(a=>Array.isArray(a)&&a.length===2&&typeof a[0]=="string"&&Array.isArray(a[1])&&a[1].every(n=>typeof n=="string")),rt=[["7-ELEVEN",["7-11","Seven Eleven","統一超商","小7"]],["ANA全日空",["ANA","全日空","All Nippon Airways","NH"]],["ATT 4 FUN",["ATT4FUN","ATT信義"]],["App Store",["蘋果應用商店"]],["Apple Arcade",["蘋果遊戲訂閱服務"]],["Apple Music",["蘋果音樂","Apple音樂"]],["Apple One",["蘋果One訂閱"]],["Apple TV+",["Apple TV Plus"]],["Apple Wallet ICOCA",["ICOCA電子票","Apple錢包ICOCA"]],["Apple Wallet PASMO",["PASMO電子票","Apple錢包PASMO"]],["Apple Wallet SUICA",["SUICA電子票","Apple錢包SUICA"]],["CITYLINK",["City Link"]],["Disney+",["Disney Plus","迪士尼+"]],["Google Play",["Google應用商店"]],["Grab",["Grab Taxi","Grab叫車"]],["MITSUI OUTLET PARK 台中港",["三井台中港","三井OUTLET台中"]],["MITSUI OUTLET PARK 台南",["三井台南","三井OUTLET台南"]],["MITSUI OUTLET PARK 林口",["三井林口","三井OUTLET林口"]],["Mitsui Shopping Park LaLaport 台中",["LaLaport台中","三井LaLaport台中"]],["Netflix",["網飛"]],["Nintendo",["任天堂","Switch","老任"]],["PChome 24h購物(不含儲值及電子票券)",["PChome","PChome購物"]],["Tiger City",["老虎城","Tiger City購物中心"]],["Trip.com",["攜程"]],["Uber Eats (不含 Uber One)",["優步外送"]],["foodpanda",["熊貓外送","Food Panda"]],["iCloud",["蘋果雲端","iCloud雲端"]],["iRent",["i Rent"]],["iTunes",["蘋果iTunes"]],["中友百貨",["中友"]],["中華航空",["China Airlines","CAL","CI","華航"]],["亞洲航空",["AirAsia","亞航","AXM","AK"]],["京站",["Q Square","京站商場"]],["全家便利商店",["FamilyMart","全家"]],["全球迪士尼飯店",["Disney Hotels"]],["全聯福利中心",["PX Mart"]],["南紡購物中心",["Tainan Spinnery Mall","南紡"]],["博客來",["Books.com.tw"]],["卡達航空",["Qatar Airways","卡航","QTR","QR"]],["可樂旅遊",["Cola Travel","可樂旅行社"]],["台北101",["Taipei 101","101大樓"]],["台灣中油-直營",["中油直營","直營中油"]],["台灣大車隊",["Taiwan Taxi","大車隊"]],["台灣虎航",["Tigerair Taiwan","台虎","TWA","IT"]],["台灣高鐵",["Taiwan High Speed Rail"]],["台茂購物中心",["TaiMall"]],["吉卜力公園",["Ghibli Park"]],["國泰航空",["Cathay Pacific","國泰","CPA","CX","Cathay Pacific Airways"]],["土耳其航空",["Turkish Airlines","土航","THY","TK"]],["夢時代",["Dream Mall"]],["大阪環球影城(USJ)",["Universal Studios Japan"]],["大韓航空",["Korean Air","韓航","KAL","KE"]],["大魯閣新時代",["Taroko Mall","大魯閣"]],["太平洋百貨",["Pacific Department Store","太平洋"]],["好樂迪KTV",["Holiday"]],["家樂福",["Carrefour"]],["屈臣氏",["Watsons"]],["康是美",["Cosmed"]],["捷星航空",["JST","JQ","Jetstar Airways"]],["新加坡航空",["SIA","SQ","Singapore Airlines"]],["日本航空",["JAL","JL","Japan Airlines"]],["星宇航空",["starlux","SJX","JX","STARLUX Airlines"]],["樂桃航空",["APJ","MM","Peach Aviation"]],["法國航空",["AFR","AF","Air France"]],["聯合航空",["UAL","UA","United Airlines"]],["蝦皮購物",["shopee"]],["越捷航空",["VJC","VJ","VietJet Air"]],["達美航空",["DAL","DL","Delta Air Lines"]],["遠東百貨",["遠百"]],["酷航",["SCO","TR","Scoot"]],["長榮航空",["EVA","BR","EVA Airlines","EVA Air"]],["阿聯酋航空",["UAE","EK","Emirates"]],["麥當勞",["McDonald's"]],["IKEA",["宜家家居"]],["星巴克",["starbucks"]]],W=new xt(localStorage,{onlyShowCurrentPlan:d=>typeof d=="boolean",onlyShowCurrentPointExchange:d=>typeof d=="boolean",commonPaymentMethods:(()=>{const d=new Set(["信用卡","Apple Pay","Samsung Pay","Google Pay","Line Pay","Fitbit Pay","Garmin Pay","Hami Pay","街口支付","全盈+PAY","全支付","Pi錢包","橘子支付","歐付寶","icash pay","OPEN錢包","My FamiPay","悠遊付","ezPay","GOMAJI Pay","friday wallet","PayPal","PX Pay","中油Pay","台灣Pay","支付寶"]);return a=>Array.isArray(a)&&a.every(n=>d.has(n)===!0)})(),cardConfigs:(()=>{const d=new Set(["信用卡","Apple Pay","Samsung Pay","Google Pay","Line Pay","Fitbit Pay","Garmin Pay","Hami Pay","街口支付","全盈+PAY","全支付","Pi錢包","橘子支付","歐付寶","icash pay","OPEN錢包","My FamiPay","悠遊付","ezPay","GOMAJI Pay","friday wallet","PayPal","PX Pay","中油Pay","台灣Pay","支付寶"]),a=new Set(["信用卡","Apple Pay","Samsung Pay","Google Pay","Line Pay","Fitbit Pay","Garmin Pay","Hami Pay","街口支付","全盈+PAY","全支付","Pi錢包","橘子支付","歐付寶","icash pay","OPEN錢包","My FamiPay","悠遊付","ezPay","GOMAJI Pay","friday wallet","PayPal","PX Pay","中油Pay","台灣Pay","支付寶"]),n=new Set(["信用卡","Apple Pay","Samsung Pay","Google Pay","Line Pay","Fitbit Pay","Garmin Pay","Hami Pay","街口支付","全盈+PAY","全支付","Pi錢包","橘子支付","歐付寶","icash pay","OPEN錢包","My FamiPay","悠遊付","ezPay","GOMAJI Pay","friday wallet","PayPal","PX Pay","中油Pay","台灣Pay","支付寶"]),c=e=>typeof e.name=="string"&&(e.description===null||e.description===void 0||typeof e.description=="string")&&(e.cardUrl===null||typeof e.cardUrl=="string")&&(e.storeBlackList===void 0||Array.isArray(e.storeBlackList)&&e.storeBlackList.every(y=>typeof y=="string"))&&(e.paymentBlackList===void 0||Array.isArray(e.paymentBlackList)&&e.paymentBlackList.every(y=>d.has(y)===!0))&&(e.selectedPlanId===void 0||typeof e.selectedPlanId=="string"&&RegExp(/(.*)\x2d(.*)\x2d(.*)\x2d(.*)\x2d(.*)/).test(e.selectedPlanId))&&Array.isArray(e.plans)&&e.plans.every(y=>typeof y=="object"&&y!==null&&x(y))&&typeof e.updateAt=="string"&&RegExp(/^[+-]?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?\x2d[+-]?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?\x2d[+-]?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?T[+-]?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?:[+-]?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?:[+-]?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?\.[+-]?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?Z$/).test(e.updateAt)&&(e.selectedPointExchangeId===void 0||typeof e.selectedPointExchangeId=="string"&&RegExp(/(.*)\x2d(.*)\x2d(.*)\x2d(.*)\x2d(.*)/).test(e.selectedPointExchangeId))&&Array.isArray(e.pointExchanges)&&e.pointExchanges.every(y=>typeof y=="object"&&y!==null&&S(y)),x=e=>typeof e.id=="string"&&RegExp(/(.*)\x2d(.*)\x2d(.*)\x2d(.*)\x2d(.*)/).test(e.id)&&typeof e.config=="object"&&e.config!==null&&u(e.config),u=e=>(e.name===null||typeof e.name=="string")&&(e.description===null||e.description===void 0||typeof e.description=="string")&&Array.isArray(e.rewards)&&e.rewards.every(y=>typeof y=="object"&&y!==null&&f(y))&&(e.condition===null||e.condition===void 0||e.condition==="Birthday"),f=e=>typeof e.rewardStrategy=="object"&&e.rewardStrategy!==null&&G(e.rewardStrategy)&&(e.transactionType===null||e.transactionType===void 0||e.transactionType==="Domestic"||e.transactionType==="Foreign")&&(e.stores===void 0||Array.isArray(e.stores)&&e.stores.every(y=>typeof y=="string"))&&(e.storeBlackList===void 0||Array.isArray(e.storeBlackList)&&e.storeBlackList.every(y=>typeof y=="string"))&&(e.payments===void 0||Array.isArray(e.payments)&&e.payments.every(y=>a.has(y)===!0))&&(e.paymentBlackList===void 0||Array.isArray(e.paymentBlackList)&&e.paymentBlackList.every(y=>n.has(y)===!0))&&(e.condition===null||e.condition===void 0||e.condition==="Birthday"),s=e=>Array.isArray(e.pointBackRates)&&e.pointBackRates.every(y=>typeof y=="object"&&y!==null&&g(y))&&(e.name===null||typeof e.name=="string")&&e.type==="RoundedPercentageReward",g=e=>typeof e.rate=="number"&&(e.limit===null||e.limit===void 0||typeof e.limit=="number"),P=e=>Array.isArray(e.pointBackRates)&&e.pointBackRates.every(y=>typeof y=="object"&&y!==null&&g(y))&&(e.name===null||typeof e.name=="string")&&e.type==="TruncatedPercentageReward",t=e=>typeof e.spendingPerPoint=="number"&&(e.name===null||typeof e.name=="string")&&e.type==="AccumulatedPointsReward",r=e=>typeof e.spendingPerPoint=="number"&&(e.name===null||typeof e.name=="string")&&e.type==="FixedRatePointsReward",S=e=>typeof e.id=="string"&&RegExp(/(.*)\x2d(.*)\x2d(.*)\x2d(.*)\x2d(.*)/).test(e.id)&&typeof e.config=="object"&&e.config!==null&&M(e.config),M=e=>typeof e.name=="string"&&typeof e.airlineCode=="string"&&typeof e.pointsPerMile=="number"&&typeof e.milesPerUnit=="number",G=e=>e.type==="TruncatedPercentageReward"?P(e):e.type==="RoundedPercentageReward"?s(e):e.type==="FixedRatePointsReward"?r(e):e.type==="AccumulatedPointsReward"?t(e):!1;return e=>Array.isArray(e)&&e.every(y=>typeof y=="object"&&y!==null&&c(y))})(),conditionTypes:d=>Array.isArray(d)&&d.every(a=>a==="Birthday"),aliasType:d=>d==="default"||d==="additional"||d==="custom",customAliases:je},"bestMileageCards"),it=["default","additional","custom"],ve=ht("BestMileageCards",()=>{const d=D(null);function a(l){d.value=l}function n(){d.value=null}Ze(()=>{const l=W.get("cardConfigs")??[];P.value=new Map(l.map(o=>[O(),o]))});const c=D(W.get("onlyShowCurrentPlan")??!1);function x(l){W.set("onlyShowCurrentPlan",l),c.value=l}const u=D(W.get("onlyShowCurrentPointExchange")??!1);function f(l){W.set("onlyShowCurrentPointExchange",l),u.value=l}const s=D(W.get("commonPaymentMethods")??["信用卡","Apple Pay","Line Pay","街口支付"]);function g(l){l=[...new Set(l)],W.set("commonPaymentMethods",l),s.value=l}const P=D(new Map),t=ee(()=>new Map([...P.value.entries()].map(([l,o])=>[l,Xe(o)]))),r=ee(()=>t.value.size===0?Ft.map(l=>Xe(l)):[...t.value.values()]);function S(l,o){P.value.set(l,o),W.set("cardConfigs",[...P.value.values()])}function M(l){P.value.delete(l),W.set("cardConfigs",[...P.value.values()])}function G(l,o){const V=P.value.get(l);if(V===void 0)return!1;try{P.value.set(l,{...V,selectedPlanId:o})}catch{return!1}return W.set("cardConfigs",[...P.value.values()]),!0}function e(l,o){const V=P.value.get(l);if(V===void 0)return!1;try{P.value.set(l,{...V,selectedPointExchangeId:o})}catch{return!1}return W.set("cardConfigs",[...P.value.values()]),!0}const y=ee(()=>Qe(Ke(r.value.flatMap(l=>l.storeList)))),N=D(W.get("conditionTypes")??[]);function X([...l]){N.value=l,W.set("conditionTypes",l)}const J=D(W.get("aliasType")??"default");function h(l){it.includes(l)&&(J.value=l,W.set("aliasType",l))}const A=D(new Map(W.get("customAliases")??[]));function I(l,o){o.length===0?A.value.delete(l):A.value.set(l,o),W.set("customAliases",[...A.value])}function R(l){A.value=new Map(l),W.set("customAliases",l)}const k=ee(()=>{const l=[];["default","additional"].includes(J.value)&&l.push(...rt),["additional","custom"].includes(J.value)&&l.push(...A.value);const o=new Map;for(const[V,L]of l){const B=o.get(V)??new Set;for(const T of L)B.add(T);o.set(V,B)}return o});return{dialog:ne(d),openDialog:a,closeDialog:n,onlyShowCurrentPlan:ne(c),updateOnlyShowCurrentPlan:x,onlyShowCurrentPointExchange:ne(u),updateOnlyShowCurrentPointExchange:f,commonPaymentMethods:ne(s),updateCommonPaymentMethods:g,cardConfigs:ne(P),cards:t,showCards:r,updateCardConfig:S,deleteCardConfig:M,updatePlan:G,updatePointExchange:e,storeList:ne(y),conditionTypes:ne(N),updateConditionTypes:X,aliasType:ne(J),storeAliases:k,updateAliasType:h,customAliases:ne(A),updateCustomAliases:I,updateAllCustomAliases:R}}),Jt={class:"flex-col gap-24px my-16px"},jt={class:"gap-8px flex justify-around"},Kt={class:"flex mx-16px"},Ht=ae({__name:"CommonSettings",setup(d){const a=ve(),{onlyShowCurrentPlan:n,onlyShowCurrentPointExchange:c,commonPaymentMethods:x,conditionTypes:u}=fe(a);return(f,s)=>{const g=b("v-switch"),P=b("v-label");return _(),E("div",Jt,[v("div",jt,[p(g,{"model-value":C(n),"hide-details":"",color:"blue","onUpdate:modelValue":s[0]||(s[0]=t=>t!==null&&C(a).updateOnlyShowCurrentPlan(t))},{label:w(()=>s[3]||(s[3]=[v("p",{class:"text-0.75rem"},"只顯示當前方案",-1)])),_:1},8,["model-value"]),p(g,{"model-value":C(c),"hide-details":"",color:"blue","onUpdate:modelValue":s[1]||(s[1]=t=>t!==null&&C(a).updateOnlyShowCurrentPointExchange(t))},{label:w(()=>s[4]||(s[4]=[v("p",{class:"text-0.75rem"},"只顯示當前交換方式",-1)])),_:1},8,["model-value"])]),p(se,{label:"使用中的付款方式","model-value":C(x),list:C(we),"hide-details":"","show-selected":"","onUpdate:modelValue":C(a).updateCommonPaymentMethods},null,8,["model-value","list","onUpdate:modelValue"]),v("div",null,[p(P,{text:"其他設定"}),v("div",Kt,[p(g,{"model-value":C(u),label:"生日中",value:"Birthday","hide-details":"",color:"blue","onUpdate:modelValue":s[2]||(s[2]=t=>t!==null&&C(a).updateConditionTypes(t))},null,8,["model-value"])])])])}}});function te(d){if(d===null||typeof d!="object")return d;if(Array.isArray(d))return d.map(n=>te(n));if(d instanceof Map)return new Map(Array.from(d.entries()).map(([n,c])=>[te(n),te(c)]));if(d instanceof Set)return new Set(Array.from(d.values()).map(n=>te(n)));if(d instanceof Date)return new Date(d.getTime());if(d instanceof RegExp)return new RegExp(d.source,d.flags);const a={};return Object.keys(d).forEach(n=>{a[n]=te(d[n])}),a}const zt={class:"flex-col gap-8px"},Yt={key:1},Wt={class:"flex min-h-1rem items-stretch"},Xt=["onDragover","onDragstart","onTouchstart"],qt=["onClick"],Zt=["onClick"],Qt=ae({__name:"CardList",props:{list:{},label:{},addable:{type:Boolean},draggable:{type:Boolean},deletable:{type:Boolean}},emits:["clickItem","deleteItem","addItem","update:list"],setup(d,{emit:a}){const n=d,c=a,x=le("cardListContainer"),u=le("cardItem"),f=ce([]),s=ce(null),g=ce(null),P=ce(null),t=ce(null),r=ce(!1);let S=null;Ze(()=>{M()}),Ae(()=>n.list,M,{deep:!0});function M(){f.value=te(n.list)}function G(k,l){if(!k.dataTransfer)return;s.value=l,k.dataTransfer.setData("text/plain",l.toString()),k.dataTransfer.effectAllowed="move";const o=new Image;o.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==",k.dataTransfer.setDragImage(o,0,0)}function e(k,l){const o=k.touches[0]??null;o&&(P.value=l,t.value=o.clientY,r.value=!1,S=window.setTimeout(()=>{r.value=!0},400))}function y(k){if(!r.value||P.value===null||t.value===null)return;const l=k.touches[0]??null;if(!l)return;const o=l.clientY-t.value;if(R(P.value,o)){const L=P.value+(o>0?1:-1);if(L<0||L>=f.value.length)return;const B=f.value[P.value];if(!B)return;f.value.splice(P.value,1),f.value.splice(L,0,B),P.value=L,t.value=l.clientY}}function N(){S!==null&&(clearTimeout(S),S=null),P.value=null,t.value=null,r.value=!1,c("update:list",f.value)}function X(k,l){if(k.preventDefault(),s.value===l||s.value===null)return;const o=f.value[s.value];o&&(f.value.splice(s.value,1),f.value.splice(l,0,o),g.value=l,s.value=l)}function J(k){var o;const l=k.relatedTarget;l!==null&&((o=x.value)!=null&&o.contains(l))||(g.value=null)}function h(){s.value=null,g.value=null,c("update:list",f.value)}function A(k,l){c("clickItem",k,l)}function I(k,l){c("deleteItem",k,l)}function R(k,l){var L;const o=((L=u.value)==null?void 0:L.map(B=>B.getBoundingClientRect().height))??[],V=o[k];if(l>0){const B=o[k+1];if(V===void 0||B===void 0)return!1;const T=V/2+B/2;return l>=T}else{const B=o[k-1];if(V===void 0||B===void 0)return!1;const T=V/2+B/2;return Math.abs(l)>=T}}return(k,l)=>{const o=b("v-label"),V=b("v-card-text"),L=b("v-card");return _(),E("div",zt,[k.$slots.label||k.label?(_(),K(o,{key:0,class:"flex-shrink-0 w-full"},{default:w(()=>[k.$slots.label?Fe(k.$slots,"label",{key:0},void 0,!0):(_(),E("p",Yt,$(k.label),1))]),_:3})):Y("",!0),v("div",{ref_key:"cardListContainer",ref:x,class:"flex-col gap-8px",onDragleave:J},[(_(!0),E(z,null,Q(f.value,(B,T)=>(_(),E("div",{ref_for:!0,ref:"cardItem",key:T},[p(L,{density:"compact",class:me(["mx-auto w-full flex-shrink-0 card-item",{"drag-over":g.value===T||P.value===T&&r.value}]),variant:"outlined"},{default:w(()=>[p(V,{class:"!p-0"},{default:w(()=>[v("div",Wt,[k.draggable?(_(),E("div",{key:0,draggable:"true",class:"flex-center pl-0.5rem pr-0.25rem cursor-ns-resize",onDragover:Ge(F=>X(F,T),["prevent"]),onDragstart:F=>G(F,T),onDragend:h,onTouchstart:F=>e(F,T),onTouchmove:l[0]||(l[0]=Ge(F=>y(F),["prevent"])),onTouchend:N},l[2]||(l[2]=[v("span",{class:"mdi text-24px mdi-drag"},null,-1)]),40,Xt)):Y("",!0),v("div",{class:me(["flex-grow min-h-20px flex items-center py-1rem cursor-pointer",{"pl-1rem":!k.draggable,"pr-1rem":!k.deletable}]),onClick:F=>A(B,T)},[Fe(k.$slots,"default",yt({ref_for:!0},B),void 0,!0)],10,qt),k.deletable?(_(),E("p",{key:1,class:"flex-center pl-0.25rem pr-0.5rem cursor-pointer",onClick:F=>I(B,T)},l[3]||(l[3]=[v("span",{class:"mdi mdi-delete text-24px"},null,-1)]),8,Zt)):Y("",!0)])]),_:2},1024)]),_:2},1032,["class"])]))),128))],544),k.addable?(_(),K(L,{key:1,density:"compact",class:"mx-auto w-full flex-shrink-0",variant:"outlined",onClick:l[1]||(l[1]=B=>k.$emit("addItem"))},{default:w(()=>[p(V,null,{default:w(()=>l[4]||(l[4]=[v("div",{class:"flex items-center justify-center min-h-1rem"},[v("span",{class:"mdi mdi-plus text-24px"})],-1)])),_:1})]),_:1})):Y("",!0)])}}}),De=He(Qt,[["__scopeId","data-v-e23bc834"]]),ea={key:0,class:"overflow-y-auto p-16px pb-40px"},re=ae({__name:"FullscreenDialog",props:{modelValue:{},title:{},btnTitle:{},btnEvent:{type:Function}},emits:["update:model-value"],setup(d,{emit:a}){const n=a;function c(){n("update:model-value",null)}function x(s){n("update:model-value",s)}const u=D(!1);async function f(){if(d.modelValue===null)return;await d.btnEvent(d.modelValue)!==!1?c():(u.value=!0,window.setTimeout(()=>{u.value=!1},3e3))}return(s,g)=>{const P=b("v-btn"),t=b("v-toolbar-title"),r=b("v-toolbar-items"),S=b("v-toolbar"),M=b("v-card"),G=b("v-dialog");return _(),K(G,{"model-value":!!s.modelValue,fullscreen:"","onUpdate:modelValue":c},{default:w(()=>[p(M,null,{default:w(()=>[p(S,null,{default:w(()=>[p(P,{icon:"mdi-close",onClick:c}),p(t,null,{default:w(()=>[H($(s.title??""),1)]),_:1}),p(r,null,{default:w(()=>[p(P,{class:me({"text-red":u.value}),text:s.btnTitle,onClick:f},null,8,["class","text"])]),_:1})]),_:1}),s.modelValue?(_(),E("div",ea,[Fe(s.$slots,"default",{data:s.modelValue,updateData:x})])):Y("",!0)]),_:3})]),_:3},8,["model-value"])}}}),ta={class:"relative"},aa={key:0,class:"text-red ml-2px"},ue=ae({__name:"NumberField",props:{modelValue:{default:0},required:{type:Boolean,default:!1},label:{default:null},isFloat:{type:Boolean,default:!1},prefix:{},suffix:{},clearable:{type:Boolean,default:!1},messages:{default:""}},emits:["update:model-value"],setup(d,{emit:a}){const n=a;function c(s){const g=d.isFloat?parseFloat(s):parseInt(s);return isNaN(g)?null:g}const x=ee(()=>{const s=[];return d.required&&s.push(g=>!!c(g)||"此欄位為必填"),s});function u(s){const g=c(s);n("update:model-value",g??0)}function f(s){if(s.target instanceof HTMLInputElement){const g=s.target.defaultValue;s.target.setSelectionRange(g.length,g.length)}}return(s,g)=>{const P=b("v-text-field");return _(),E("div",null,[p(P,{rules:x.value,inputmode:s.isFloat?"decimal":"numeric","model-value":s.modelValue,clearable:s.clearable&&s.modelValue!==0,prefix:s.prefix,suffix:s.suffix,messages:s.messages,"onUpdate:modelValue":u,"onClick:control":f},_e({_:2},[s.label!==null?{name:"label",fn:w(()=>[v("p",ta,[H($(s.label)+" ",1),s.required?(_(),E("span",aa,"*")):Y("",!0)])]),key:"0"}:void 0]),1032,["rules","inputmode","model-value","clearable","prefix","suffix","messages"])])}}}),na={class:"relative"},la={key:0,class:"text-red ml-2px"},oe=ae({__name:"TextFiled",props:{modelValue:{default:null},required:{type:Boolean,default:!1},label:{},isUrl:{type:Boolean,default:!1}},emits:["update:model-value"],setup(d,{emit:a}){const n=a,c=ee(()=>{const u=[];return d.required&&u.push(f=>!!f||"此欄位為必填"),d.isUrl&&u.push(f=>!!(f===null||f===""||f.startsWith("https://"))||"請填寫正確的網址 (需為 https:// 開頭)"),u});function x(u){u=(u==null?void 0:u.trim())??null,n("update:model-value",ge(u)?u:null)}return(u,f)=>{const s=b("v-text-field");return _(),K(s,{clearable:"",rules:c.value,"model-value":u.modelValue,"onUpdate:modelValue":x},{label:w(()=>[v("p",na,[H($(u.label)+" ",1),u.required?(_(),E("span",la,"*")):Y("",!0)])]),_:1},8,["rules","model-value"])}}}),oa={class:"flex-col gap-4px h-full overflow-hidden"},sa={class:"flex"},ra={class:"flex-1 gap-8px flex-col overflow-y-auto py-8px"},ia={class:"flex items-center justify-between"},da=["onClick"],ca={class:"flex-col gap-2"},ua={class:"flex-col gap-4px"},pa={class:"text-0.9em"},ma={class:"flex gap-4px items-center justify-center"},ya={class:"flex-col gap-8px"},ga={class:"gap-8px flex-center"},fa={class:"overflow-y-auto w-full p-24px"},va={key:0,class:"flex-col gap-8px"},Pa={class:"flex items-center justify-between gap-4px min-h-1rem"},ha={class:"flex-col gap-1"},_a={key:0,class:"opacity-50 text-0.75rem"},wa={key:0,class:"mdi text-24px mdi-check-circle"},xa={class:"flex items-center justify-between min-h-1rem gap-4px"},ba={class:"flex-col gap-4px"},Aa={class:"opacity-50 text-0.75rem"},ka={key:0,class:"mdi mdi-check-circle text-24px"},Ca={class:"flex-col gap-2"},Sa={class:"flex-col"},Ra={class:"text-1rem"},Ba={class:"text-0.75rem"},Ea=ae({__name:"CreditCardManagement",setup(d){const a=[{title:"消費N%回饋點數(四捨五入)",value:"RoundedPercentageReward"},{title:"消費N%回饋點數(無條件捨去)",value:"TruncatedPercentageReward"},{title:"每消費N元累積1點 (小數不累計)",value:"FixedRatePointsReward"},{title:"每消費N元累積1點 (小數會累計)",value:"AccumulatedPointsReward"}],n=ve(),{cardConfigs:c,cards:x}=fe(n),u=D(null),f=D(null),s=D(null),g=D(null),P=D(null),t=D(null),r=ee(()=>{const l=t.value===null?null:x.value.get(t.value)??null;return l===null?null:l}),S=D(null),M=D(null);function G(l){for(const o of l)n.updateCardConfig(O(),o)}function e({id:l,config:o}){return qe(o)?(n.updateCardConfig(l,o),!0):(alert("儲存失敗"),!1)}function y(){return{id:O(),config:{name:null,description:null,rewards:[]}}}function N(){return{rewardStrategy:{name:"",type:"RoundedPercentageReward",pointBackRates:[]}}}function X(l){(l.rewardStrategy.type==="RoundedPercentageReward"||l.rewardStrategy.type==="TruncatedPercentageReward")&&(l.rewardStrategy.pointBackRates=l.rewardStrategy.pointBackRates.filter(({rate:o})=>o!==0)),P.value!==null&&f.value!==null&&(f.value.config.rewards[P.value]=l),P.value=null}function J({id:l,config:o}){if(u.value===null||!Lt(o))return alert("儲存失敗"),!1;const V=u.value.config.plans.find(L=>L.id===l);return V?V.config=o:u.value.config.plans.push({id:l,config:o}),!0}function h(){return{id:O(),config:{name:"",airlineCode:"",milesPerUnit:0,pointsPerMile:0}}}function A({id:l,config:o}){if(u.value===null||!It(o)||o.milesPerUnit===0||o.pointsPerMile===0)return alert("儲存失敗"),!1;const V=u.value.config.pointExchanges.find(L=>L.id===l);return V?V.config=o:u.value.config.pointExchanges.push({id:l,config:o}),!0}function I(){u.value!==null&&(n.deleteCardConfig(u.value.id),u.value=null)}const R=D(!0);Ae(()=>S.value,l=>{R.value=!!k(l)});function k(l){if(l===null)return null;let o;try{o=JSON.parse(l)}catch{return null}return qe(o)?o:null}return(l,o)=>{const V=b("v-label"),L=b("v-btn"),B=b("v-card"),T=b("v-textarea"),F=b("v-select"),U=b("v-radio"),Z=b("v-radio-group"),Ce=b("v-switch"),Se=b("v-card-text"),dt=b("v-card-actions"),ct=b("v-dialog"),ut=b("v-checkbox");return _(),E(z,null,[v("div",oa,[v("div",sa,[p(V,{class:"ml-4px flex-grow !text-0.9rem"},{default:w(()=>o[16]||(o[16]=[H(" 點擊 "),v("span",{class:"mdi mdi-pencil mx-4px"},null,-1),H(" 編輯卡片，點擊卡片切換方案 ")])),_:1}),p(L,{text:"匯入",onClick:o[0]||(o[0]=()=>M.value=[])})]),v("div",ra,[(_(!0),E(z,null,Q(C(c).entries(),([i,m],q)=>(_(),K(B,{key:q,density:"compact",class:"mx-auto w-full flex-shrink-0",variant:"outlined",title:m.name,text:m.description??"",onClick:()=>t.value=i},{title:w(()=>[v("div",ia,[H($(m.name)+" ",1),v("span",{class:"mdi mdi-pencil absolute top-0 py-0.625rem px-1rem right-0",onClick:Ge(()=>u.value={id:i,config:C(te)(m)},["stop"])},null,8,da)])]),_:2},1032,["title","text","onClick"]))),128))])]),p(re,{modelValue:u.value,"onUpdate:modelValue":o[7]||(o[7]=i=>u.value=i),title:"編輯卡片","btn-title":"儲存","btn-event":e},{default:w(({data:i})=>[v("div",ca,[p(oe,{modelValue:i.config.name,"onUpdate:modelValue":m=>i.config.name=m,label:"卡片名稱",required:""},null,8,["modelValue","onUpdate:modelValue"]),p(oe,{modelValue:i.config.description,"onUpdate:modelValue":m=>i.config.description=m,label:"卡片描述"},null,8,["modelValue","onUpdate:modelValue"]),p(oe,{modelValue:i.config.cardUrl,"onUpdate:modelValue":m=>i.config.cardUrl=m,"is-url":"",label:"信用卡網頁"},null,8,["modelValue","onUpdate:modelValue"]),p(se,{modelValue:i.config.storeBlackList,"onUpdate:modelValue":m=>i.config.storeBlackList=m,addable:"",label:"卡片不回饋清單",list:C(n).storeList},null,8,["modelValue","onUpdate:modelValue","list"]),p(se,{modelValue:i.config.paymentBlackList,"onUpdate:modelValue":m=>i.config.paymentBlackList=m,label:"卡片不回饋支付方式","show-selected":"",list:C(we)},null,8,["modelValue","onUpdate:modelValue","list"]),p(De,{list:i.config.plans,class:"mb-8",label:"方案設定 (點擊卡片進行編輯)",addable:"",draggable:"",deletable:"","onUpdate:list":m=>i.config.plans=m,onClickItem:o[1]||(o[1]=m=>f.value=C(te)(m)),onAddItem:o[2]||(o[2]=m=>f.value=y()),onDeleteItem:(m,q)=>C(n).openDialog({text:`確定要刪除'${m.config.name??"此"}'方案嗎？`,events:[{text:"取消"},{text:"刪除",event:()=>{i.config.plans.splice(q,1)},class:"text-red"}]})},{default:w(m=>[H($(m.config.name??"(空)"),1)]),_:2},1032,["list","onUpdate:list","onDeleteItem"]),p(De,{list:i.config.pointExchanges,class:"mb-8",addable:"",draggable:"",deletable:"",label:"點數交換方式 (點擊卡片進行編輯)","onUpdate:list":m=>i.config.pointExchanges=m,onClickItem:o[3]||(o[3]=m=>s.value=C(te)(m)),onAddItem:o[4]||(o[4]=m=>s.value=h()),onDeleteItem:(m,q)=>C(n).openDialog({text:`確定要刪除'${m.config.name??"此"}'點數交換方式嗎？`,events:[{text:"取消"},{text:"刪除",event:()=>{i.config.pointExchanges.splice(q,1)},class:"text-red"}]})},{default:w(m=>[H($(m.config.name??"(空)"),1)]),_:2},1032,["list","onUpdate:list","onDeleteItem"]),p(L,{text:"更新設定檔",onClick:o[5]||(o[5]=()=>{u.value!==null&&(S.value=JSON.stringify(u.value.config,null,2))})}),p(L,{class:"text-red",text:"刪除",onClick:o[6]||(o[6]=m=>C(n).openDialog({text:"確定要刪除嗎？",events:[{text:"取消"},{text:"刪除",event:I,class:"text-red"}]}))})])]),_:1},8,["modelValue"]),p(re,{modelValue:f.value,"onUpdate:modelValue":o[9]||(o[9]=i=>f.value=i),title:"編輯方案","btn-title":"儲存","btn-event":J},{default:w(({data:i})=>[p(oe,{modelValue:i.config.name,"onUpdate:modelValue":m=>i.config.name=m,label:"方案名稱"},null,8,["modelValue","onUpdate:modelValue"]),p(T,{label:"方案描述","model-value":i.config.description,"auto-grow":"",clearable:"","onUpdate:modelValue":m=>i.config.description=C(ge)(m)?m:null},null,8,["model-value","onUpdate:modelValue"]),p(De,{list:i.config.rewards,addable:"",draggable:"",deletable:"","onUpdate:list":m=>i.config.rewards=m,onAddItem:()=>{g.value=N(),P.value=i.config.rewards.length},onClickItem:o[8]||(o[8]=(m,q)=>{g.value=C(te)(m),P.value=q}),onDeleteItem:(m,q)=>C(n).openDialog({text:"確定要刪除嗎？",events:[{text:"取消"},{text:"刪除",event:()=>{i.config.rewards.splice(q,1)},class:"text-red"}]})},{label:w(()=>o[17]||(o[17]=[v("p",{class:"flex-col"},[H(" 回饋清單 (點擊卡片進行編輯) "),v("span",{class:"text-0.75em"}," 依回饋排序檢查規則，符合即計算回饋，不再檢查後續項目 ")],-1)])),default:w(m=>[v("p",ua,[H($(m.rewardStrategy.name??"(空)")+" ",1),v("span",pa,$(C(at)(m.rewardStrategy).description),1)])]),_:2},1032,["list","onUpdate:list","onAddItem","onDeleteItem"])]),_:1},8,["modelValue"]),p(re,{modelValue:s.value,"onUpdate:modelValue":o[10]||(o[10]=i=>s.value=i),title:"編輯交換方式","btn-title":"儲存","btn-event":A},{default:w(({data:i})=>[p(oe,{modelValue:i.config.name,"onUpdate:modelValue":m=>i.config.name=m,label:"名稱",required:""},null,8,["modelValue","onUpdate:modelValue"]),p(oe,{modelValue:i.config.airlineCode,"onUpdate:modelValue":m=>i.config.airlineCode=m,label:"目標里程",required:""},null,8,["modelValue","onUpdate:modelValue"]),v("div",ma,[p(ue,{modelValue:i.config.pointsPerMile,"onUpdate:modelValue":m=>i.config.pointsPerMile=m,class:"flex-1",label:"points",required:"",clearable:""},null,8,["modelValue","onUpdate:modelValue"]),o[18]||(o[18]=v("span",{class:"mdi mdi-arrow-right-thick text-24px mb-16px"},null,-1)),p(ue,{modelValue:i.config.milesPerUnit,"onUpdate:modelValue":m=>i.config.milesPerUnit=m,class:"flex-1",label:`${i.config.airlineCode} 哩程`,required:"",clearable:""},null,8,["modelValue","onUpdate:modelValue","label"])])]),_:1},8,["modelValue"]),p(re,{modelValue:g.value,"onUpdate:modelValue":o[11]||(o[11]=i=>g.value=i),title:"編輯回饋","btn-title":"儲存","btn-event":X},{default:w(({data:i})=>[v("div",ya,[p(oe,{modelValue:i.rewardStrategy.name,"onUpdate:modelValue":m=>i.rewardStrategy.name=m,label:"回饋名稱"},null,8,["modelValue","onUpdate:modelValue"]),p(F,{label:"回饋方式",items:a,"model-value":i.rewardStrategy.type,"onUpdate:modelValue":m=>i.rewardStrategy.type=m},null,8,["model-value","onUpdate:modelValue"]),i.rewardStrategy.type==="RoundedPercentageReward"||i.rewardStrategy.type==="TruncatedPercentageReward"?(_(),E(z,{key:0},[(_(!0),E(z,null,Q(i.rewardStrategy.pointBackRates,(m,q)=>(_(),E("div",{key:q,class:"flex gap-4px"},[p(ue,{modelValue:m.rate,"onUpdate:modelValue":de=>m.rate=de,messages:m.rate===0?"0% 回饋儲存時會移除":"",class:"flex-1",prefix:"消費",suffix:"%回饋","is-float":""},null,8,["modelValue","onUpdate:modelValue","messages"]),p(ue,{"model-value":m.limit??0,class:"flex-1",prefix:"上限",suffix:"點",messages:"0 表示沒回饋上限","onUpdate:modelValue":de=>m.limit=de===0?null:de},null,8,["model-value","onUpdate:modelValue"])]))),128)),p(L,{onClick:m=>i.rewardStrategy.pointBackRates.push({rate:0})},{default:w(()=>o[19]||(o[19]=[v("span",{class:"mdi mdi-plus text-24px"},null,-1)])),_:2},1032,["onClick"])],64)):i.rewardStrategy.type==="FixedRatePointsReward"||i.rewardStrategy.type==="AccumulatedPointsReward"?(_(),K(ue,{key:1,modelValue:i.rewardStrategy.spendingPerPoint,"onUpdate:modelValue":m=>i.rewardStrategy.spendingPerPoint=m,prefix:"每消費",suffix:"元累積一點"},null,8,["modelValue","onUpdate:modelValue"])):Y("",!0),p(V,{text:"回饋規則"}),v("div",ga,[p(V,{text:"交易類型"}),p(Z,{"model-value":i.transactionType??null,"hide-details":"",inline:"","onUpdate:modelValue":m=>i.transactionType=m},{default:w(()=>[p(U,{density:"compact",label:"國內交易",value:"Domestic"}),p(U,{density:"compact",label:"國外交易",value:"Foreign"}),p(U,{density:"compact",label:"不限",value:null})]),_:2},1032,["model-value","onUpdate:modelValue"])]),p(se,{modelValue:i.payments,"onUpdate:modelValue":m=>i.payments=m,label:"限制回饋支付方式","show-selected":"",list:C(we)},null,8,["modelValue","onUpdate:modelValue","list"]),p(se,{modelValue:i.paymentBlackList,"onUpdate:modelValue":m=>i.paymentBlackList=m,label:"不回饋支付方式","show-selected":"",list:C(we)},null,8,["modelValue","onUpdate:modelValue","list"]),p(se,{modelValue:i.stores,"onUpdate:modelValue":m=>i.stores=m,addable:"",label:"限制回饋清單/商店",list:C(n).storeList},null,8,["modelValue","onUpdate:modelValue","list"]),p(se,{modelValue:i.storeBlackList,"onUpdate:modelValue":m=>i.storeBlackList=m,addable:"",label:"不回饋清單",list:C(n).storeList},null,8,["modelValue","onUpdate:modelValue","list"]),p(V,{text:"其他設定"}),p(Ce,{"model-value":i.condition??null,label:"生日中",value:"Birthday","hide-details":"",color:"blue","onUpdate:modelValue":m=>i.condition=m??null},null,8,["model-value","onUpdate:modelValue"])])]),_:1},8,["modelValue"]),p(ct,{"model-value":!!t.value,"onUpdate:modelValue":o[13]||(o[13]=i=>t.value=null)},{default:w(()=>[p(B,{"min-width":"100%"},{default:w(()=>[p(Se,{class:"overflow-hidden flex max-h-80dvh !p-0"},{default:w(()=>[v("div",fa,[r.value!==null?(_(),E("div",va,[o[20]||(o[20]=H(" 切換方案 ")),(_(!0),E(z,null,Q(r.value.selectablePlan??[],(i,m)=>(_(),K(B,{key:m,density:"compact",class:"mx-auto w-full flex-shrink-0",variant:"outlined",onClick:()=>t.value&&r.value&&i.id!==r.value.selectedPlanId&&C(n).updatePlan(t.value,i.id)},{default:w(()=>[p(Se,null,{default:w(()=>[v("div",Pa,[v("p",ha,[H($(i.name??"(空)")+" ",1),i.description?(_(),E("span",_a,$(i.description),1)):Y("",!0)]),i.id===r.value.selectedPlanId?(_(),E("span",wa)):Y("",!0)])]),_:2},1024)]),_:2},1032,["onClick"]))),128)),o[21]||(o[21]=H(" 切換點數交換方式 ")),(_(!0),E(z,null,Q(r.value.selectablePointExchange??[],(i,m)=>(_(),K(B,{key:m,density:"compact",class:"mx-auto w-full flex-shrink-0",variant:"outlined",onClick:()=>t.value&&r.value&&i.id!==r.value.selectedPointExchangeId&&C(n).updatePointExchange(t.value,i.id)},{default:w(()=>[p(Se,null,{default:w(()=>[v("div",xa,[v("p",ba,[H($(i.name)+" ",1),v("span",Aa,$(i.description),1)]),i.id===r.value.selectedPointExchangeId?(_(),E("span",ka)):Y("",!0)])]),_:2},1024)]),_:2},1032,["onClick"]))),128))])):Y("",!0)])]),_:1}),p(dt,null,{default:w(()=>[p(L,{class:"ms-auto",text:"Close",onClick:o[12]||(o[12]=i=>t.value=null)})]),_:1})]),_:1})]),_:1},8,["model-value"]),p(re,{modelValue:M.value,"onUpdate:modelValue":o[14]||(o[14]=i=>M.value=i),title:"請選擇卡片","btn-title":"匯入","btn-event":G},{default:w(({data:i,updateData:m})=>[v("div",Ca,[(_(!0),E(z,null,Q(C(Gt),(q,de)=>(_(),K(ut,{key:de,"model-value":i,value:q,"hide-details":"",color:"blue",density:"comfortable",class:"import-card-checkbox","onUpdate:modelValue":Ye=>Ye&&m(Ye)},{label:w(()=>[v("div",Sa,[v("p",Ra,$(q.name),1),v("p",Ba,$(q.description),1)])]),_:2},1032,["model-value","value","onUpdate:modelValue"]))),128))])]),_:1},8,["modelValue"]),p(re,{modelValue:S.value,"onUpdate:modelValue":o[15]||(o[15]=i=>S.value=i),title:"匯入設定檔","btn-title":"匯入","btn-event":i=>{const m=k(i);return u.value!==null&&m!==null?(u.value.config=m,R.value=!1,!0):!1}},{default:w(({data:i,updateData:m})=>[p(T,{"model-value":i,"error-messages":R.value?"":"json 無效",label:"設定檔",rows:20,"onUpdate:modelValue":m},null,8,["model-value","error-messages","onUpdate:modelValue"])]),_:1},8,["modelValue","btn-event"])],64)}}}),Ta=He(Ea,[["__scopeId","data-v-e1f14ddd"]]),Ua={class:"gap-8px h-full flex-col"},Va={class:"flex items-center flex-wrap gap-x-8px"},La={class:"gap-8px flex-center"},Ia={ref:"rewardCardList",class:"flex-col gap-4px overflow-y-auto flex-grow-1"},$a={class:"flex items-center gap-4px overflow-hidden w-full"},Ma={class:"opacity-50 flex-grow-1 text-12px truncate"},Oa={key:0,class:"fa-solid fa-circle-check"},Na={class:"flex-col gap-8px"},Da={class:"text-0.75rem"},Fa={class:"text-wrap"},Ga={class:"flex-col"},Ja={class:"flex justify-between"},ja=["href"],Ka={key:0},Ha={key:1},za="其他店家",Ya=ae({__name:"SearchReward",setup(d){const a=ye(0),n=ye(2),c=et(0),{onlyShowCurrentPlan:x,onlyShowCurrentPointExchange:u,commonPaymentMethods:f,showCards:s,conditionTypes:g,storeAliases:P,storeList:t}=fe(ve()),r=D(0),S=D(null),M=D("Domestic"),G=D([]),e=le("rewardCardList"),y=le("storeAutoComplete"),N=ee(()=>{const I=t.value.map(R=>({store:R,aliases:[...P.value.get(R)??[]]}));return[{store:za},...I]});function X(I,R,k){return R=R.toLowerCase(),[I,...(k==null?void 0:k.raw.aliases)??[]].map(o=>o.toLowerCase()).some(o=>o.includes(R))}const J=ee(()=>{var k;const I={amount:r.value,acceptedPayments:G.value,transactionAttributesType:M.value,currentConditions:[...g.value]};ge(S.value)&&(I.transactionStore=S.value);const R=[];for(const l of s.value){const o=l.getRewardInfos(I,{onlyCurrentPlan:x.value,onlyCurrentExchangeStrategy:u.value}),V=!x.value||!u.value,L=!u.value&&l.selectablePointExchange.length>1;for(const B of o){const T={cardName:l.name,planName:B.planName,rewardName:B.rewardName,miles:B.miles,payments:B.payments,airLinesCode:B.airlineCode,isSelectedPlan:V&&B.planId===l.selectedPlanId,calculateDetail:A(B.rewardStrategy,B.pointExchangeStrategy),description:B.rewardStrategy===null?null:`${B.rewardStrategy.description}，${B.pointExchangeStrategy.description}`,cardUrl:l.cardUrl,cardDescription:l.description,pointExchangeName:L?B.pointExchangeName:""};R.push(T)}}return(k=e.value)==null||k.scrollTo({top:0,behavior:"smooth"}),We(We(R,"isSelectedPlan","desc"),"miles","desc")}),h=D(null);function A(I,R){const{pointsPerMile:k,milesPerUnit:l,airlineCode:o}=R,V="回饋計算:";switch(I==null?void 0:I.type){case"RoundedPercentageReward":case"TruncatedPercentageReward":{const L=I.type==="RoundedPercentageReward"?a:c;let B=0;return[V,...I.pointBackRates.map(({rate:T,limit:F})=>{const U=Math.min(L(r.value*T/100),F??1/0);B+=U;const Z=F!==void 0?` (limit ${F})`:"";return`${r.value} * ${T}% = ${U}${Z}`}),`總計 ${B} points`,`${B} / ${k} * ${l} = ${R.calculateMiles(B)} ${o}`]}case"AccumulatedPointsReward":{const L=n(r.value/I.spendingPerPoint);return[V,`${r.value} / ${I.spendingPerPoint} = ${L} points`,`${L} / ${k} * ${l} = ${R.calculateMiles(L)} ${o}`]}case"FixedRatePointsReward":{const L=c(r.value/I.spendingPerPoint);return[V,`${r.value} / ${I.spendingPerPoint} = ${L} points (小數省略)`,`${L} / ${k} * ${l} = ${R.calculateMiles(L)} ${o}`]}default:return[]}}return(I,R)=>{const k=b("v-autocomplete"),l=b("v-label"),o=b("v-checkbox"),V=b("v-radio"),L=b("v-radio-group"),B=b("v-card"),T=b("v-btn"),F=b("v-dialog");return _(),E(z,null,[v("div",Ua,[p(ue,{modelValue:r.value,"onUpdate:modelValue":R[0]||(R[0]=U=>r.value=U),label:"交易金額",class:"flex-grow-0",density:"comfortable","hide-details":"",clearable:""},null,8,["modelValue"]),p(k,{ref:"storeAutoComplete",modelValue:S.value,"onUpdate:modelValue":R[1]||(R[1]=U=>S.value=U),"custom-filter":X,class:"flex-grow-0",density:"comfortable","hide-details":"","item-value":"store","item-title":"store",items:N.value,clearable:C(ge)(S.value),placeholder:"全部店家","onUpdate:menu":R[2]||(R[2]=U=>{var Z;return!U&&((Z=C(y))==null?void 0:Z.blur())})},null,8,["modelValue","items","clearable"]),v("div",null,[p(l,{text:"店家可使用的付款方式"}),v("div",Va,[(_(!0),E(z,null,Q(C(f),(U,Z)=>(_(),K(o,{key:Z,modelValue:G.value,"onUpdate:modelValue":R[3]||(R[3]=Ce=>G.value=Ce),density:"compact",value:U,"hide-details":"",label:U},null,8,["modelValue","value","label"]))),128))])]),v("div",La,[p(l,{text:"交易類型"}),p(L,{modelValue:M.value,"onUpdate:modelValue":R[4]||(R[4]=U=>M.value=U),"hide-details":"",inline:""},{default:w(()=>[p(V,{density:"compact",label:"國內交易",value:"Domestic"}),p(V,{density:"compact",label:"國外交易",value:"Foreign"})]),_:1},8,["modelValue"])]),v("div",Ia,[(_(!0),E(z,null,Q(J.value,(U,Z)=>(_(),K(B,{key:Z,density:"compact",class:"mx-auto w-full flex-shrink-0",variant:"outlined",onClick:()=>h.value=U},{title:w(()=>[v("div",$a,[H($(U.miles)+" ",1),v("p",Ma,$(U.airLinesCode)+" "+$(U.payments.length===0?"":` (限定支付: ${U.payments.join(", ")})`),1),U.isSelectedPlan?(_(),E("i",Oa)):Y("",!0)])]),text:w(()=>[v("div",Na,[v("p",Da,$(`${U.cardName} ${U.planName??""} ${U.rewardName??""} ${U.pointExchangeName}`),1)])]),_:2},1032,["onClick"]))),128))],512)]),p(F,{"model-value":!!h.value,"onUpdate:modelValue":R[6]||(R[6]=U=>h.value=null)},{default:w(()=>[h.value?(_(),K(B,{key:0,class:"mx-auto reward-detail-dialog","min-width":"100%",title:`${h.value.cardName} ${h.value.planName??""} ${h.value.rewardName??""}`},{subtitle:w(()=>[v("p",Fa,$(h.value.description??""),1)]),text:w(()=>[v("div",Ga,[v("p",Ja,[R[7]||(R[7]=H(" 卡片說明： ")),h.value.cardUrl!==null?(_(),E("a",{key:0,target:"_blank",class:"underline",href:h.value.cardUrl}," 網站 ",8,ja)):Y("",!0)]),h.value.cardDescription!==""||h.value.cardDescription!==null?(_(),E("p",Ka,$(h.value.cardDescription),1)):Y("",!0),h.value.pointExchangeName!==""?(_(),E("p",Ha,$(h.value.pointExchangeName),1)):Y("",!0),R[8]||(R[8]=v("br",null,null,-1)),v("p",null,"消費金額: "+$(r.value),1),v("p",null,"哩程預估: "+$(h.value.miles)+" "+$(h.value.airLinesCode),1),R[9]||(R[9]=v("br",null,null,-1)),(_(!0),E(z,null,Q(h.value.calculateDetail,(U,Z)=>(_(),E("p",{key:Z},$(U),1))),128))])]),actions:w(()=>[p(T,{class:"ms-auto",text:"Close",onClick:R[5]||(R[5]=U=>h.value=null)})]),_:1},8,["title"])):Y("",!0)]),_:1},8,["model-value"])],64)}}}),Wa=He(Ya,[["__scopeId","data-v-7504163f"]]),Xa={class:"flex-col h-full overflow-hidden gap-8px"},qa={class:"flex-shrink-0 flex-col gap-8px"},Za={class:"flex-center gap-4px"},Qa={key:0,class:"mdi mdi-check-circle"},en={key:0,class:"flex justify-between items-center"},tn={class:"flex gap-8px"},an={key:0,class:"gap-4px flex-col flex-grow-1 overflow-y-auto"},nn={class:"text-1rem"},ln={class:"text-0.8rem"},on={key:1,class:"flex-grow-1"},sn={class:"flex-col gap-24px m-8px"},rn={class:"flex-col gap-4px"},dn=ae({__name:"StoreAliasManagement",setup(d){const a=ve(),{aliasType:n,customAliases:c,storeAliases:x}=fe(a),u=le("storeList"),f={default:"系統預設",additional:"預設+自定義",custom:"自定義"},s=D(!0),g=D(!1),P=D(!0),t=D("[]"),r=D(null),S=ee(()=>{let h;return n.value==="default"?h=rt:n.value==="additional"?h=[...x.value].map(([A,I])=>[A,[...I]]):h=[...c.value],h.map(([A,I])=>({title:A,aliases:[...I]}))});Ae(()=>{var h;return(h=r.value)==null?void 0:h.title},h=>{if(h==null||r.value===null)return;const A=[...c.value.get(h)??[]];A[A.length-1]!==""&&A.push(""),r.value.aliases=A}),Ae(s,X),gt(()=>{X(),g.value=!1,P.value=!0,s.value=!0});function M(h,A){if(r.value===null)return;let I=r.value.aliases;I[A]=h,I[I.length-1]!==""&&I.push("")}function G(h){if(n.value!=="default")if(h===null)r.value={title:null,aliases:[]};else{const A=[...c.value.get(h)??[]];A[A.length-1]!==""&&A.push(""),r.value={title:h,aliases:A}}}function e({title:h,aliases:A}){h!==null&&a.updateCustomAliases(h,[...new Set(A)].filter(ge))}function y(h){if(h=h.trim(),t.value=h,g.value=!0,h===""){P.value=!0;return}try{const A=JSON.parse(h);P.value=je(A)}catch(A){console.error(A),P.value=!1}}function N(){let h;if(s.value)h=!0;else{t.value===""&&(t.value="[]");try{const A=JSON.parse(t.value);je(A)?(a.updateAllCustomAliases(A),h=!0):h=!1}catch(A){console.error(A),h=!1}}h?(alert("儲存成功"),g.value=!1):alert(`儲存失敗${s.value?"":"，JSON 不符合規則"}`)}function X(){t.value=JSON.stringify([...c.value],null,2)}function J(h){g.value||(h==="default"&&(s.value=!0),a.updateAliasType(h))}return(h,A)=>{const I=b("v-label"),R=b("v-btn"),k=b("v-btn-toggle"),l=b("v-switch"),o=b("v-card"),V=b("v-textarea"),L=b("v-autocomplete"),B=b("v-text-field");return _(),E(z,null,[v("div",Xa,[v("div",qa,[p(I,{text:"別名設定"}),p(k,{"model-value":C(n),rounded:"0",group:"",class:"w-full flex justify-center",disabled:g.value,"onUpdate:modelValue":J},{default:w(()=>[(_(!0),E(z,null,Q(C(it),(T,F)=>(_(),K(R,{key:F,class:"flex-1",value:T},{default:w(()=>[v("div",Za,[C(n)===T?(_(),E("span",Qa)):Y("",!0),H(" "+$(f[T]),1)])]),_:2},1032,["value"]))),128))]),_:1},8,["model-value","disabled"]),C(n)!=="default"?(_(),E("div",en,[v("div",tn,[s.value?(_(),K(R,{key:0,onClick:A[0]||(A[0]=T=>G(null))},{default:w(()=>A[4]||(A[4]=[H(" Add ")])),_:1})):(_(),K(R,{key:1,onClick:N},{default:w(()=>A[5]||(A[5]=[H(" 儲存 ")])),_:1}))]),p(l,{modelValue:s.value,"onUpdate:modelValue":A[1]||(A[1]=T=>s.value=T),disabled:g.value,"hide-details":"",label:"圖示"},null,8,["modelValue","disabled"])])):Y("",!0)]),s.value?(_(),E("div",an,[(_(!0),E(z,null,Q(S.value,(T,F)=>(_(),K(o,{key:F,density:"compact",class:"mx-auto w-full flex-shrink-0",variant:"outlined",onClick:U=>G(T.title)},{text:w(()=>[v("p",nn,$(T.title),1),v("p",ln,$(T.aliases.join(", ")),1)]),_:2},1032,["onClick"]))),128))])):(_(),E("div",on,[p(V,{"model-value":t.value,clearable:"","auto-grow":"",disabled:C(n)==="default","max-rows":15,messages:g.value?"上方儲存完成後才能執行其他動作，離開這頁不會存檔":"","error-messages":P.value?"":"json 無效",label:"自定義別名設定檔","onUpdate:modelValue":y},null,8,["model-value","disabled","messages","error-messages"])]))]),p(re,{modelValue:r.value,"onUpdate:modelValue":A[3]||(A[3]=T=>r.value=T),title:"編輯商店別名","btn-title":"儲存","btn-event":e},{default:w(({data:T})=>[v("div",sn,[p(L,{ref:"storeList",modelValue:T.title,"onUpdate:modelValue":F=>T.title=F,class:"flex-grow-0","hide-details":"",label:"目標店家",items:C(a).storeList,placeholder:"選擇店家","onUpdate:menu":A[2]||(A[2]=F=>{var U;return!F&&((U=C(u))==null?void 0:U.blur())})},null,8,["modelValue","onUpdate:modelValue","items"]),v("div",rn,[p(I,{text:"自定義別名列表"}),(_(!0),E(z,null,Q(T.aliases,(F,U)=>(_(),K(B,{key:U,"hide-details":"",clearable:"","model-value":F,"onUpdate:modelValue":Z=>M(Z,U),"onClick:clear":()=>T.aliases.splice(U,1)},null,8,["model-value","onUpdate:modelValue","onClick:clear"]))),128))])])]),_:1},8,["modelValue"])],64)}}}),cn={style:{height:"calc(100dvh - 56px)"},class:"overflow-hidden mt-56px p-8px"},un={class:"w-full text-center"},pn={class:"w-full flex items-center justify-between px-8px"},mn=ae({__name:"App",setup(d){const a=ve(),{dialog:n}=fe(a),c={查詢回饋:Wa,信用卡管理:Ta,商家別名:dn,喜好設定:Ht},x=Object.keys(c),u=D(!1),f=D(x[0]);return(s,g)=>{const P=b("v-app-bar-nav-icon"),t=b("v-app-bar-title"),r=b("v-app-bar"),S=b("v-list-item"),M=b("v-divider"),G=b("v-navigation-drawer"),e=b("v-app"),y=b("v-btn"),N=b("v-card"),X=b("v-dialog");return _(),E(z,null,[p(e,null,{default:w(()=>[p(r,{density:"comfortable",elevation:2},{prepend:w(()=>[p(P,{onClick:g[0]||(g[0]=J=>u.value=!u.value)},{default:w(()=>g[2]||(g[2]=[v("i",{class:"fa-solid fa-bars"},null,-1)])),_:1}),p(t,null,{default:w(()=>[H($(f.value),1)]),_:1})]),_:1}),p(G,{modelValue:u.value,"onUpdate:modelValue":g[1]||(g[1]=J=>u.value=J)},{default:w(()=>[(_(!0),E(z,null,Q(C(x),(J,h)=>(_(),E(z,{key:h},[p(S,{title:J,class:me(["h-48px",{"text-emphasis":f.value===J}]),onClick:()=>{f.value=J,u.value=!1}},null,8,["title","class","onClick"]),p(M)],64))),128))]),_:1},8,["modelValue"]),v("main",cn,[(_(),K(vt,null,[(_(),K(ft(c[f.value])))],1024))])]),_:1}),p(X,{"model-value":!!C(n),"onUpdate:modelValue":C(a).closeDialog},{default:w(()=>[C(n)!==null?(_(),K(N,{key:0,class:"mx-auto","min-width":"100%"},{text:w(()=>[v("div",un,$(C(n).text),1)]),actions:w(()=>[v("div",pn,[(_(!0),E(z,null,Q(C(n).events,(J,h)=>(_(),K(y,{key:h,text:J.text,class:me(J.class),variant:"elevated",onClick:async()=>{"event"in J&&await J.event(),C(a).closeDialog()}},null,8,["text","class","onClick"]))),128))])]),_:1})):Y("",!0)]),_:1},8,["model-value","onUpdate:modelValue"])],64)}}}),ze=Pt(mn);ze.use(bt);ze.use(_t());ze.mount("#app");
//# sourceMappingURL=bestMileageCards-Biu_BDRD.js.map
