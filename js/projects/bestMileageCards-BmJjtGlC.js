var Qe=Object.defineProperty;var et=(o,t,n)=>t in o?Qe(o,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):o[t]=n;var O=(o,t,n)=>et(o,typeof t!="symbol"?t+"":t,n);import{d as Z,e as ne,c as q,B as A,g as h,v as F,C as w,x as f,D,t as T,u as C,b as N,o as tt,f as Q,j as S,k as v,E as Re,y as j,F as X,l as Y,m as Ee,G as at,z as Ne,H as nt,w as Ie,I as lt,J as ot,K as st,A as rt}from"../index-CYr7KIcs.js";import{d as it,s as ie,c as dt}from"../pinia-Hbsly0gS.js";import{f as te,C as ct,v as ut}from"../StorageManager-CagWYWrE.js";import{a as Fe,b as Me}from"../sorts-DmEn6gXZ.js";import{f as De,r as se,b as Ve,g as $,a as re}from"../index-f1g9dClV.js";import{_ as Ge}from"../_plugin-vue_export-helper-DlAUqK2U.js";const Be=Z({__name:"ClipList",props:{modelValue:{default:()=>[]},list:{},label:{},message:{},searchable:{type:Boolean,default:!1},addable:{type:Boolean,default:!1},showSelected:{type:Boolean,default:!1},hideDetails:{type:Boolean,default:!1}},emits:["update:model-value"],setup(o,{emit:t}){const n=ne("comboboxComponent"),s=ne("autocompleteComponent"),p=ne("selectComponent"),r=t,d=q(()=>Fe(o.list));function i(a){const u=o.modelValue.filter(B=>B!==a);m(u)}function m([...a]){r("update:model-value",a)}function b(a){return function(u){!u&&a!==null&&a.blur()}}return(a,u)=>{const B=A("v-chip"),G=A("v-combobox"),J=A("v-autocomplete"),e=A("v-select");return a.addable?(h(),F(G,{key:0,ref_key:"comboboxComponent",ref:n,"model-value":a.modelValue,items:d.value,messages:a.message??"",label:a.label,multiple:"",hint:"可新增內容","persistent-hint":"","hide-details":a.hideDetails,"hide-selected":!a.showSelected,"onUpdate:modelValue":m,"onUpdate:menu":u[0]||(u[0]=l=>b(C(n)))},{selection:w(({item:l})=>[f(B,{closable:"","onClick:close":V=>i(l.value)},{default:w(()=>[D(T(l.value),1)]),_:2},1032,["onClick:close"])]),_:1},8,["model-value","items","messages","label","hide-details","hide-selected"])):a.searchable?(h(),F(J,{key:1,ref_key:"autocompleteComponent",ref:s,"model-value":a.modelValue,items:d.value,messages:a.message??"","hide-details":a.hideDetails,label:a.label,multiple:"","hide-selected":!a.showSelected,"clear-on-select":"","onUpdate:modelValue":m,"onUpdate:menu":u[1]||(u[1]=l=>b(C(s)))},{selection:w(({item:l})=>[f(B,{closable:"","onClick:close":V=>i(l.value)},{default:w(()=>[D(T(l.value),1)]),_:2},1032,["onClick:close"])]),_:1},8,["model-value","items","messages","hide-details","label","hide-selected"])):(h(),F(e,{key:2,ref_key:"selectComponent",ref:p,"model-value":a.modelValue,items:d.value,messages:a.message??"","hide-details":a.hideDetails,label:a.label,multiple:"","hide-selected":!a.showSelected,"onUpdate:modelValue":m,"onUpdate:menu":u[2]||(u[2]=l=>b(C(p)))},{selection:w(({item:l})=>[f(B,{closable:"","onClick:close":V=>i(l.value)},{default:w(()=>[D(T(l.value),1)]),_:2},1032,["onClick:close"])]),_:1},8,["model-value","items","messages","hide-details","label","hide-selected"]))}}}),Je=De(0),pt=se(0),Le=se(2);class ge{constructor({type:t,name:n}){O(this,"_name");O(this,"_type");this._type=t,this._name=n}get name(){return this._name}get type(){return this._type}calculateRangePointsCost(t,n){const s=[];for(let i=t;i<=n;i++){const m=Le(i/this.calculatePoints(i));isNaN(m)||m===1/0||m===-1/0||s.push(m)}s.sort((i,m)=>i-m);const p=s[s.length-1],r=s[0];if(p===void 0||r===void 0)throw new Error("cannot be calculated");const d=s.reduce((i,m)=>i+m,0)/s.length;return{max:p,min:r,average:Le(d)}}}class mt extends ge{constructor({pointBackRates:n,...s}){super(s);O(this,"_pointBackRates");this._pointBackRates=n}get _maxRete(){return this._pointBackRates.reduce((n,{rate:s})=>n+s,0)}get pointBackRates(){return this._pointBackRates}get description(){return`消費${this._pointBackRates.length>1?"最高":""}${this._maxRete.toString()}%回饋點數(四捨五入)`}calculatePoints(n){let s=0;for(const{rate:p,limit:r=1/0}of this._pointBackRates)s+=Math.min(pt(n*(p/100)),r);return s}toJSON(){return{name:this._name,type:this._type,pointBackRates:this._pointBackRates}}}class yt extends ge{constructor({pointBackRates:n,...s}){super(s);O(this,"_pointBackRates");this._pointBackRates=n}get _maxRete(){return this._pointBackRates.reduce((n,{rate:s})=>n+s,0)}get pointBackRates(){return this._pointBackRates}get description(){return`消費${this._pointBackRates.length>1?"最高":""}${this._maxRete.toString()}%回饋點數(無條件捨去)`}calculatePoints(n){let s=0;for(const{rate:p,limit:r=1/0}of this._pointBackRates)s+=Math.min(Je(n*(p/100)),r);return s}toJSON(){return{name:this._name,type:this._type,pointBackRates:this._pointBackRates}}}class gt extends ge{constructor({spendingPerPoint:n,...s}){super({...s});O(this,"_spendingPerPoint");this._spendingPerPoint=n}get spendingPerPoint(){return this._spendingPerPoint}get description(){return`每消費${this._spendingPerPoint.toString()}元累積1點 (小數會累計)`}calculatePoints(n){return Le(n/this._spendingPerPoint)}toJSON(){return{name:this._name,type:this._type,spendingPerPoint:this._spendingPerPoint}}}class ft extends ge{constructor({spendingPerPoint:n,...s}){super({...s});O(this,"_spendingPerPoint");this._spendingPerPoint=n}get spendingPerPoint(){return this._spendingPerPoint}get description(){return`每消費${this._spendingPerPoint.toString()}元累積1點 (小數不累計)`}calculatePoints(n){return Je(n/this._spendingPerPoint)}toJSON(){return{name:this._name,type:this._type,spendingPerPoint:this._spendingPerPoint}}}const Pt={RoundedPercentageReward:mt,TruncatedPercentageReward:yt,AccumulatedPointsReward:gt,FixedRatePointsReward:ft};function je(o){return new Pt[o.type](o)}class vt{constructor(t,n,s,p){O(this,"_name");O(this,"_description");O(this,"_rewards");O(this,"_condition");if(this._name=t,this._description=n,this._condition=s,p.length===0)throw new Error(`Plan "${t??"unknown"}" must have at least one reward rule.`);this._rewards=p}get name(){return this._name}get description(){return this._description}get storeList(){return Ve(this._rewards.flatMap(t=>[...t.stores,...t.storeBlackList]))}checkPlanIsVisible(t){return this._condition===null||!!(t!=null&&t.includes(this._condition))}getApplicableReward({transactionStore:t=null,acceptedPayments:n=[],transactionAttributesType:s,currentConditions:p=null}){return this._condition!==null&&!(p!=null&&p.includes(this._condition))?null:this._rewards.find(({stores:r,payments:d,transactionType:i,paymentBlackList:m,storeBlackList:b,condition:a})=>{const u=t===null||r.size===0||r.has(t),B=t===null||b.size===0||!b.has(t),G=n.length===0||d.size===0||n.some(V=>d.has(V)),J=n.length===0||m.size===0||n.some(V=>!m.has(V)),e=i===null||s===i,l=a===null||!!(p!=null&&p.includes(a));return u&&B&&G&&J&&e&&l})??null}getRewardMiles({transactionStore:t,acceptedPayments:n,amount:s,transactionAttributesType:p,currentConditions:r}){const d=this.getApplicableReward({acceptedPayments:n,transactionStore:t,transactionAttributesType:p,currentConditions:r});if(d===null)return null;const i=n===void 0?[...d.payments.values()]:n.filter(m=>d.payments.has(m));return{rewardName:d.rewardStrategy.name,rewardPoints:d.rewardStrategy.calculatePoints(s),payments:i.filter(m=>!d.paymentBlackList.has(m)),rewardStrategy:d.rewardStrategy}}toJSON(){return{name:this._name,description:this._description,condition:this._condition,rewards:this._rewards.map(({rewardStrategy:t,stores:n,payments:s,transactionType:p,paymentBlackList:r,storeBlackList:d,condition:i})=>({rewardStrategy:t.toJSON(),stores:[...n],storeBlackList:[...d],payments:[...s],paymentBlackList:[...r],transactionType:p,condition:i}))}}}const Ke=["信用卡","Apple Pay","Samsung Pay","Google Pay","Line Pay","Fitbit Pay","Garmin Pay","Hami Pay","街口支付","全盈+PAY","全支付","Pi錢包","橘子支付","歐付寶","icash pay","OPEN錢包","My FamiPay","悠遊付","ezPay","GOMAJI Pay","friday wallet","PayPal","PX Pay","中油Pay","台灣Pay","支付寶"];class ht{constructor({name:t,description:n,plans:s,storeBlackList:p,paymentBlackList:r,cardUrl:d,updateAt:i,pointExchanges:m,selectedPlanId:b,selectedPointExchangeId:a}){O(this,"_selectedPlanId");O(this,"_selectedPointExchangeId");O(this,"_name");O(this,"_description");O(this,"_plans");O(this,"_cardUrl");O(this,"_storeBlackList");O(this,"_paymentBlackList");O(this,"_updateAt");O(this,"_pointExchanges");this._name=t,this._description=n,this._plans=s,this._cardUrl=d,this._storeBlackList=p,this._paymentBlackList=r,this._updateAt=i,this._pointExchanges=m;const u=b??this._plans.keys().next().value??null;if(u===null)throw new Error(`this plan id ${u} not found`);this._selectedPlanId=u;const B=a??this._pointExchanges.keys().next().value??null;if(B===null)throw new Error(`this point exchange id ${B} not found`);this._selectedPointExchangeId=B}get name(){return this._name}get description(){return this._description}get selectedPlanId(){return this._selectedPlanId}get selectedPlan(){return this._getPlan(this._selectedPlanId)}get selectedPointExchangeId(){return this._selectedPointExchangeId}get selectedPointExchange(){return this._getPointExchangeStrategy(this._selectedPointExchangeId)}get selectablePlan(){return[...this._plans.entries()].map(([t,{name:n,description:s}])=>({id:t,name:n,description:s}))}get selectablePointExchange(){return[...this._pointExchanges.entries()].map(([t,{name:n,description:s}])=>({id:t,name:n,description:s}))}get storeList(){return Ve([...[...this._plans.values()].flatMap(t=>t.storeList),...this._storeBlackList])}get cardUrl(){return this._cardUrl}_getPlan(t){const n=this._plans.get(t);if(n===void 0)throw new Error(`plan id ${t} not found. Available plans: ${[...this._plans.keys()].join(", ")}`);return n}_getPointExchangeStrategy(t){const n=this._pointExchanges.get(t);if(n===void 0)throw new Error(`pointExchangeStrategy id ${t} not found. Available pointExchanges: ${[...this._plans.keys()].join(", ")}`);return n}_rewardMilesWithPlan(t,n,s){var a;const p=this._getPlan(t),r=this._getPointExchangeStrategy(n),d={planId:t,planName:p.name,rewardName:null,rewardPoints:0,payments:[],rewardStrategy:null,pointExchangeStrategy:r,pointExchangeName:r.name,airlineCode:r.airlineCode,miles:0},i=s.transactionStore!==void 0&&this._storeBlackList.has(s.transactionStore),m=(a=s.acceptedPayments)==null?void 0:a.some(u=>this._paymentBlackList.has(u));if(i||m)return d;const b=p.getRewardMiles(s);return b===null?d:{planId:t,planName:p.name,pointExchangeStrategy:r,pointExchangeName:r.name,miles:r.calculateMiles(b.rewardPoints),airlineCode:r.airlineCode,...b}}getRewardInfos(t,{onlyCurrentPlan:n=!1,onlyCurrentExchangeStrategy:s=!1}={}){const p=n?[[this._selectedPlanId,this.selectedPlan]]:[...this._plans.entries()],r=s?[this._selectedPointExchangeId]:[...this._pointExchanges.keys()],d=[];for(const[i,m]of p)if(m.checkPlanIsVisible(t.currentConditions??null))for(const a of r){const u=this._rewardMilesWithPlan(i,a,t);d.push(u)}return d}toJSON(){return{name:this._name,description:this._description,cardUrl:this._cardUrl,storeBlackList:[...this._storeBlackList],paymentBlackList:[...this._paymentBlackList],selectedPlanId:this._selectedPlanId,plans:[...this._plans].map(([t,n])=>({id:t,config:n.toJSON()})),updateAt:this._updateAt.toISOString(),selectedPointExchangeId:this._selectedPointExchangeId,pointExchanges:[...this._pointExchanges].map(([t,n])=>({id:t,config:n.toJSON()}))}}}const _t=se(2);class wt{constructor({name:t,airlineCode:n,pointsPerMile:s,milesPerUnit:p}){O(this,"_name");O(this,"_airlineCode");O(this,"_pointsPerMile");O(this,"_milesPerUnit");this._name=t,this._airlineCode=n,this._pointsPerMile=s,this._milesPerUnit=p}get name(){return this._name}get description(){return`${this._pointsPerMile}點可以交換${this._milesPerUnit}哩程`}get airlineCode(){return this._airlineCode}get pointsPerMile(){return this._pointsPerMile}get milesPerUnit(){return this._milesPerUnit}calculateMiles(t){return _t(t*this._milesPerUnit/this._pointsPerMile)}toJSON(){return{name:this._name,airlineCode:this._airlineCode,pointsPerMile:this._pointsPerMile,milesPerUnit:this._milesPerUnit}}}function Oe({name:o,description:t,storeBlackList:n,paymentBlackList:s,cardUrl:p,plans:r,updateAt:d,pointExchanges:i,selectedPlanId:m,selectedPointExchangeId:b}){const a=new Map(r.map(({id:u,config:{name:B,description:G,condition:J,rewards:e}})=>[u,new vt(B,G??null,J??null,e.map(({stores:l,payments:V,transactionType:_,rewardStrategy:I,paymentBlackList:y,storeBlackList:x,condition:L})=>({rewardStrategy:je(I),stores:new Set(l),storeBlackList:new Set(x),payments:new Set(V),paymentBlackList:new Set(y),transactionType:_??null,condition:L??null})))]));return new ht({name:o,description:t??null,plans:a,storeBlackList:new Set(n),paymentBlackList:new Set(s),cardUrl:p,updateAt:new Date(d),selectedPlanId:m??null,selectedPointExchangeId:b??null,pointExchanges:new Map(i.map(({id:u,config:B})=>[u,new wt(B)]))})}const xt=(()=>{const o=new Set(["信用卡","Apple Pay","Samsung Pay","Google Pay","Line Pay","Fitbit Pay","Garmin Pay","Hami Pay","街口支付","全盈+PAY","全支付","Pi錢包","橘子支付","歐付寶","icash pay","OPEN錢包","My FamiPay","悠遊付","ezPay","GOMAJI Pay","friday wallet","PayPal","PX Pay","中油Pay","台灣Pay","支付寶"]),t=new Set(["信用卡","Apple Pay","Samsung Pay","Google Pay","Line Pay","Fitbit Pay","Garmin Pay","Hami Pay","街口支付","全盈+PAY","全支付","Pi錢包","橘子支付","歐付寶","icash pay","OPEN錢包","My FamiPay","悠遊付","ezPay","GOMAJI Pay","friday wallet","PayPal","PX Pay","中油Pay","台灣Pay","支付寶"]),n=new Set(["信用卡","Apple Pay","Samsung Pay","Google Pay","Line Pay","Fitbit Pay","Garmin Pay","Hami Pay","街口支付","全盈+PAY","全支付","Pi錢包","橘子支付","歐付寶","icash pay","OPEN錢包","My FamiPay","悠遊付","ezPay","GOMAJI Pay","friday wallet","PayPal","PX Pay","中油Pay","台灣Pay","支付寶"]),s=e=>typeof e.name=="string"&&(e.description===null||e.description===void 0||typeof e.description=="string")&&(e.cardUrl===null||typeof e.cardUrl=="string")&&(e.storeBlackList===void 0||Array.isArray(e.storeBlackList)&&e.storeBlackList.every(l=>typeof l=="string"))&&(e.paymentBlackList===void 0||Array.isArray(e.paymentBlackList)&&e.paymentBlackList.every(l=>o.has(l)===!0))&&(e.selectedPlanId===void 0||typeof e.selectedPlanId=="string"&&RegExp(/(.*)\x2d(.*)\x2d(.*)\x2d(.*)\x2d(.*)/).test(e.selectedPlanId))&&Array.isArray(e.plans)&&e.plans.every(l=>typeof l=="object"&&l!==null&&p(l))&&typeof e.updateAt=="string"&&RegExp(/^[+-]?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?\x2d[+-]?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?\x2d[+-]?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?T[+-]?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?:[+-]?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?:[+-]?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?\.[+-]?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?Z$/).test(e.updateAt)&&(e.selectedPointExchangeId===void 0||typeof e.selectedPointExchangeId=="string"&&RegExp(/(.*)\x2d(.*)\x2d(.*)\x2d(.*)\x2d(.*)/).test(e.selectedPointExchangeId))&&Array.isArray(e.pointExchanges)&&e.pointExchanges.every(l=>typeof l=="object"&&l!==null&&B(l)),p=e=>typeof e.id=="string"&&RegExp(/(.*)\x2d(.*)\x2d(.*)\x2d(.*)\x2d(.*)/).test(e.id)&&typeof e.config=="object"&&e.config!==null&&r(e.config),r=e=>(e.name===null||typeof e.name=="string")&&(e.description===null||e.description===void 0||typeof e.description=="string")&&Array.isArray(e.rewards)&&e.rewards.every(l=>typeof l=="object"&&l!==null&&d(l))&&(e.condition===null||e.condition===void 0||e.condition==="Birthday"),d=e=>typeof e.rewardStrategy=="object"&&e.rewardStrategy!==null&&J(e.rewardStrategy)&&(e.transactionType===null||e.transactionType===void 0||e.transactionType==="Domestic"||e.transactionType==="Foreign")&&(e.stores===void 0||Array.isArray(e.stores)&&e.stores.every(l=>typeof l=="string"))&&(e.storeBlackList===void 0||Array.isArray(e.storeBlackList)&&e.storeBlackList.every(l=>typeof l=="string"))&&(e.payments===void 0||Array.isArray(e.payments)&&e.payments.every(l=>t.has(l)===!0))&&(e.paymentBlackList===void 0||Array.isArray(e.paymentBlackList)&&e.paymentBlackList.every(l=>n.has(l)===!0))&&(e.condition===null||e.condition===void 0||e.condition==="Birthday"),i=e=>Array.isArray(e.pointBackRates)&&e.pointBackRates.every(l=>typeof l=="object"&&l!==null&&m(l))&&(e.name===null||typeof e.name=="string")&&e.type==="RoundedPercentageReward",m=e=>typeof e.rate=="number"&&(e.limit===void 0||typeof e.limit=="number"),b=e=>Array.isArray(e.pointBackRates)&&e.pointBackRates.every(l=>typeof l=="object"&&l!==null&&m(l))&&(e.name===null||typeof e.name=="string")&&e.type==="TruncatedPercentageReward",a=e=>typeof e.spendingPerPoint=="number"&&(e.name===null||typeof e.name=="string")&&e.type==="AccumulatedPointsReward",u=e=>typeof e.spendingPerPoint=="number"&&(e.name===null||typeof e.name=="string")&&e.type==="FixedRatePointsReward",B=e=>typeof e.id=="string"&&RegExp(/(.*)\x2d(.*)\x2d(.*)\x2d(.*)\x2d(.*)/).test(e.id)&&typeof e.config=="object"&&e.config!==null&&G(e.config),G=e=>typeof e.name=="string"&&typeof e.airlineCode=="string"&&typeof e.pointsPerMile=="number"&&typeof e.milesPerUnit=="number",J=e=>e.type==="TruncatedPercentageReward"?b(e):e.type==="RoundedPercentageReward"?i(e):e.type==="FixedRatePointsReward"?u(e):e.type==="AccumulatedPointsReward"?a(e):!1;return e=>typeof e=="object"&&e!==null&&s(e)})(),bt=(()=>{const o=new Set(["信用卡","Apple Pay","Samsung Pay","Google Pay","Line Pay","Fitbit Pay","Garmin Pay","Hami Pay","街口支付","全盈+PAY","全支付","Pi錢包","橘子支付","歐付寶","icash pay","OPEN錢包","My FamiPay","悠遊付","ezPay","GOMAJI Pay","friday wallet","PayPal","PX Pay","中油Pay","台灣Pay","支付寶"]),t=new Set(["信用卡","Apple Pay","Samsung Pay","Google Pay","Line Pay","Fitbit Pay","Garmin Pay","Hami Pay","街口支付","全盈+PAY","全支付","Pi錢包","橘子支付","歐付寶","icash pay","OPEN錢包","My FamiPay","悠遊付","ezPay","GOMAJI Pay","friday wallet","PayPal","PX Pay","中油Pay","台灣Pay","支付寶"]),n=a=>(a.name===null||typeof a.name=="string")&&(a.description===null||a.description===void 0||typeof a.description=="string")&&Array.isArray(a.rewards)&&a.rewards.every(u=>typeof u=="object"&&u!==null&&s(u))&&(a.condition===null||a.condition===void 0||a.condition==="Birthday"),s=a=>typeof a.rewardStrategy=="object"&&a.rewardStrategy!==null&&b(a.rewardStrategy)&&(a.transactionType===null||a.transactionType===void 0||a.transactionType==="Domestic"||a.transactionType==="Foreign")&&(a.stores===void 0||Array.isArray(a.stores)&&a.stores.every(u=>typeof u=="string"))&&(a.storeBlackList===void 0||Array.isArray(a.storeBlackList)&&a.storeBlackList.every(u=>typeof u=="string"))&&(a.payments===void 0||Array.isArray(a.payments)&&a.payments.every(u=>o.has(u)===!0))&&(a.paymentBlackList===void 0||Array.isArray(a.paymentBlackList)&&a.paymentBlackList.every(u=>t.has(u)===!0))&&(a.condition===null||a.condition===void 0||a.condition==="Birthday"),p=a=>Array.isArray(a.pointBackRates)&&a.pointBackRates.every(u=>typeof u=="object"&&u!==null&&r(u))&&(a.name===null||typeof a.name=="string")&&a.type==="RoundedPercentageReward",r=a=>typeof a.rate=="number"&&(a.limit===void 0||typeof a.limit=="number"),d=a=>Array.isArray(a.pointBackRates)&&a.pointBackRates.every(u=>typeof u=="object"&&u!==null&&r(u))&&(a.name===null||typeof a.name=="string")&&a.type==="TruncatedPercentageReward",i=a=>typeof a.spendingPerPoint=="number"&&(a.name===null||typeof a.name=="string")&&a.type==="AccumulatedPointsReward",m=a=>typeof a.spendingPerPoint=="number"&&(a.name===null||typeof a.name=="string")&&a.type==="FixedRatePointsReward",b=a=>a.type==="TruncatedPercentageReward"?d(a):a.type==="RoundedPercentageReward"?p(a):a.type==="FixedRatePointsReward"?m(a):a.type==="AccumulatedPointsReward"?i(a):!1;return a=>typeof a=="object"&&a!==null&&n(a)})(),At=(()=>{const o=t=>typeof t.name=="string"&&typeof t.airlineCode=="string"&&typeof t.pointsPerMile=="number"&&typeof t.milesPerUnit=="number";return t=>typeof t=="object"&&t!==null&&o(t)})(),pe=fe("2024/12/31"),le=fe("2025/6/30","2025/1/1");function fe(o,t){return t===void 0?`權益 ~${te(o,"yyyy/M/d")}`:te(t,"yyyy")===te(o,"yyyy")?`權益 ${te(t,"yyyy/M/d")}~${te(o,"M/d")}`:`權益 ${te(t,"yyyy/M/d")}~${te(o,"yyyy/M/d")}`}const Pe=["分期付款"],ve=[],he=["信用卡","Apple Pay","Samsung Pay","Google Pay","Fitbit Pay","Garmin Pay","Hami Pay"];function _e(o){const t={rewardStrategy:{type:"RoundedPercentageReward",name:null,pointBackRates:[{rate:.3}]}};return[{id:$(),config:{name:"集精選",description:"量販超市, 指定加油, 指定超商, 生活家居",rewards:[{rewardStrategy:{type:"RoundedPercentageReward",name:null,pointBackRates:[{rate:2}]},stores:["家樂福","LOPIA台灣","全聯福利中心","台灣中油-直營","7-ELEVEN","全家便利商店","IKEA"],payments:[...he,"PX Pay","My FamiPay","OPEN錢包"]},t]}},{id:$(),config:{name:"玩數位",description:"數位/串流平台, 網購平台, 國際電商, 辦公神器",rewards:[{rewardStrategy:{type:"RoundedPercentageReward",name:null,pointBackRates:[{rate:o}]},stores:["App Store","Apple Music","iCloud","Apple TV+","Apple Arcade","Apple One","iTunes","Google Play","Disney+","Netflix","Spotify","KKBOX","YouTube Premium","Max","蝦皮購物","momo購物網","PChome 24h購物(不含儲值及電子票券)","小樹購","Coupang 酷澎(台灣)","淘寶/天貓","ChatGPT","Dropbox","Surfshark","NordVPN","McAfee","Microsoft","LinkedIn","Whoscall","Zoom"],paymentBlackList:["Line Pay","街口支付"]},{...t,storeBlackList:["全聯福利中心"]}]}},{id:$(),config:{name:"樂饗購",description:"國內指定百貨, 國內外送平台, 國內餐飲, 國內藥妝",rewards:[{rewardStrategy:{type:"RoundedPercentageReward",name:null,pointBackRates:[{rate:o}]},stores:["遠東SOGO百貨","遠東Garden City","太平洋百貨","新光三越","SKM Park","BELLAVITA","微風廣場","遠東百貨","Big City遠東巨城購物中心","誠品生活","環球購物中心","CITYLINK","統一時代","台北101","ATT 4 FUN","明曜百貨","京站","美麗華","大葉高島屋","比漾廣場","大江國際購物中心","中友百貨","廣三SOGO","Tiger City","勤美誠品綠園道","大魯閣新時代","耐斯廣場","南紡購物中心","夢時代","漢神百貨","漢神巨蛋","MITSUI OUTLET PARK 林口","MITSUI OUTLET PARK 台中港","MITSUI OUTLET PARK 台南","Mitsui Shopping Park LaLaport 台中","義大世界購物廣場","華泰名品城","義享天地","麗寶OUTLET Mall","秀泰生活","台茂購物中心","新月廣場","三創生活","宏匯廣場","NOKE忠泰樂生活","Uber Eats","foodpanda","foodomo","國內餐飲(不含餐券)","麥當勞","康是美","屈臣氏"],payments:he},{...t,storeBlackList:["全聯福利中心"]}]}},{id:$(),config:{name:"趣旅行",description:"指定海外消費, 日本指定遊樂園, 國內外交通, 指定航空公司, 指定飯店住宿, 旅遊/訂房平台, 指定旅行社",rewards:[{rewardStrategy:{type:"RoundedPercentageReward",name:null,pointBackRates:[{rate:o}]},stores:["海外實體消費","東京迪士尼樂園","東京華納兄弟哈利波特影城","大阪環球影城(USJ)","Apple Wallet SUICA","Apple Wallet PASMO","Apple Wallet ICOCA","Uber","Grab","台灣高鐵","yoxi","台灣大車隊","iRent","和運租車","格上租車","中華航空","長榮航空","星宇航空","台灣虎航","國泰航空","樂桃航空","阿聯酋航空","酷航","捷星航空","日本航空","亞洲航空","聯合航空","ANA全日空","新加坡航空","越捷航空","大韓航空","達美航空","土耳其航空","卡達航空","法國航空","國內飯店住宿","星野集團","全球迪士尼飯店","東橫INN","KKday","Agoda","Klook","Airbnb","Hotels.com","Expedia","Booking.com","Trip.com","AsiaYo","ezTravel易遊網","雄獅旅遊","可樂旅遊","東南旅遊","五福旅遊","燦星旅遊","山富旅遊","長汎假期","鳳凰旅行社","Ezfly易飛網","理想旅遊","永利旅行社","三賀旅行社"],payments:he},{...t,storeBlackList:["全聯福利中心"]}]}},{id:$(),config:{name:"來支付",description:"LINE Pay消費",rewards:[{rewardStrategy:{type:"RoundedPercentageReward",name:null,pointBackRates:[{rate:2}]},payments:["Line Pay"]},{...t,storeBlackList:["全聯福利中心"]}]}},{id:$(),config:{name:"慶生月",description:"指定百貨/休閒娛樂/國內外送平台 3.5%, 國外精選遊樂園實體消費/國內人氣樂園/指定蛋糕甜點店/指定咖啡廳/指定國內餐廳/KTV/派對/電玩 10%",condition:"Birthday",rewards:[{rewardStrategy:{type:"RoundedPercentageReward",name:null,pointBackRates:[{rate:10}]},stores:["東京迪士尼樂園","大阪環球影城(USJ)","名古屋樂高樂園","紅葉蛋糕官方網站","法朋烘焙甜點坊","興波咖啡 華山旗艦店","海底撈火鍋","輕井澤鍋物","老四川巴蜀麻辣燙","二本松涮涮屋","橋山.壽喜燒","Umai屋馬燒肉","老井極上燒肉","燒肉中山(台中大墩)","藏壽司台灣","貳樓","膳馨民間創作料理","馨苑小料理","雅室牛排 仁愛圓環店","ABV餐飲集團","WAT","臺虎精釀(信義 | 西門 | 臺中 | 啜飲室大安)","BAR Bodega","BAR MED","JiN Her 今鶴","錢櫃KTV","好樂迪KTV","星聚點KTV","享溫馨KTV","Nintendo","巴哈姆特動畫瘋","閃動格子CyberCube"]},{rewardStrategy:{type:"RoundedPercentageReward",name:null,pointBackRates:[{rate:3.5}]},stores:["新光三越","Uber Eats (不含 Uber One)","Agoda","Trip.com","Klook","國內飯店住宿","星野集團","全球迪士尼飯店","東橫INN"]},{...t,storeBlackList:["全聯福利中心"]}]}}]}const we=[{id:$(),config:{name:"長榮航空哩程",airlineCode:"EVA",pointsPerMile:360,milesPerUnit:1e3}},{id:$(),config:{name:"長榮航空哩程 + 長榮世界卡",airlineCode:"EVA",pointsPerMile:300,milesPerUnit:1e3}}],ze=[{name:"Cube 卡",description:`Cube 卡 (Level 1) 回饋方案 (${le})`,cardUrl:"https://www.cathaybk.com.tw/cathaybk/personal/product/credit-card/cards/cube/",storeBlackList:Pe,paymentBlackList:ve,updateAt:"2024-12-01T00:00:00.000Z",plans:_e(2),pointExchanges:we},{name:"Cube 卡",description:`Cube 卡 (Level 2) 回饋方案 (${le})`,cardUrl:"https://www.cathaybk.com.tw/cathaybk/personal/product/credit-card/cards/cube/",storeBlackList:Pe,paymentBlackList:ve,updateAt:"2024-12-01T00:00:00.000Z",plans:_e(3),pointExchanges:we},{name:"Cube 卡",description:`Cube 卡 (Level 3) 回饋方案 (${le})`,cardUrl:"https://www.cathaybk.com.tw/cathaybk/personal/product/credit-card/cards/cube/",storeBlackList:Pe,paymentBlackList:ve,updateAt:"2024-12-01T00:00:00.000Z",plans:_e(3.3),pointExchanges:we}],kt=ze[1];function xe(o){return[{id:$(),config:{name:null,description:"部分回饋需要另外登錄",rewards:[{rewardStrategy:{type:"FixedRatePointsReward",name:`Expedia專屬網頁線上訂房 ${fe("2025/12/31")}`,spendingPerPoint:8},stores:["Expedia"],payments:["Apple Pay","Samsung Pay","Google Pay","Fitbit Pay","Garmin Pay","Hami Pay"]},{rewardStrategy:{type:"FixedRatePointsReward",name:"長榮官網購票/機上免稅品",spendingPerPoint:10},stores:["長榮機上免稅品","長榮官網購票"]},{rewardStrategy:{type:"FixedRatePointsReward",name:"海外消費",spendingPerPoint:10},transactionType:"Foreign"},{rewardStrategy:{type:"FixedRatePointsReward",name:"國內旅行社 (需登錄) 銀行並未公告符合商家",spendingPerPoint:10},transactionType:"Domestic",stores:["雄獅旅遊","可樂旅遊","東南旅遊","五福旅遊","燦星旅遊","山富旅遊","長汎假期","鳳凰旅行社","Ezfly易飛網","理想旅遊","永利旅行社","三賀旅行社"]},{rewardStrategy:{type:"FixedRatePointsReward",name:"國外自由行、團體旅遊 (需登錄) 銀行並未公告符合商家",spendingPerPoint:10},transactionType:"Foreign"},{rewardStrategy:{type:"FixedRatePointsReward",name:"一般消費",spendingPerPoint:o}}]}}]}const ce=[{id:$(),config:{name:"長榮航空哩程 (每1000哩為單位自動轉換至哩程帳戶)",airlineCode:"EVA",pointsPerMile:1e3,milesPerUnit:1e3}}],ue=fe("2025/3/31","2025/1/1"),He=[{name:"長榮極致無限卡",cardUrl:"https://www.cathaybk.com.tw/cathaybk/personal/product/credit-card/cards/eva/",description:ue,updateAt:"2024-12-29T00:00:00.000Z",plans:xe(20),pointExchanges:ce},{name:"長榮無限卡",cardUrl:"https://www.cathaybk.com.tw/cathaybk/personal/product/credit-card/cards/eva/",description:ue,updateAt:"2024-12-29T00:00:00.000Z",plans:xe(22),pointExchanges:ce},{name:"長榮極致御璽卡",cardUrl:"https://www.cathaybk.com.tw/cathaybk/personal/product/credit-card/cards/eva/",description:ue,updateAt:"2024-12-29T00:00:00.000Z",plans:xe(30),pointExchanges:ce},{name:"長榮御璽卡",cardUrl:"https://www.cathaybk.com.tw/cathaybk/personal/product/credit-card/cards/eva/",description:ue,updateAt:"2024-12-29T00:00:00.000Z",plans:[{id:$(),config:{name:null,description:null,rewards:[{rewardStrategy:{type:"FixedRatePointsReward",name:"一般消費",spendingPerPoint:30}}]}}],pointExchanges:ce}],Ct=He[1],me=["政府稅款","公共事業代扣繳","交通違規罰鍰","分期付款","全聯福利中心","7-ELEVEN","全家便利商店"],ye=[],St=[{name:"星宇世界卡",description:pe,cardUrl:"https://www.esunbank.com/zh-tw/personal/credit-card/intro/co-branded-card/starlux-card",storeBlackList:me,paymentBlackList:ye,pointExchanges:[{id:$(),config:{name:"星宇航空哩程",airlineCode:"SJX",pointsPerMile:1,milesPerUnit:1}}],plans:[{id:$(),config:{name:null,rewards:[{rewardStrategy:{type:"FixedRatePointsReward",name:"國外消費 (生日兩倍)",spendingPerPoint:5},transactionType:"Foreign",condition:"Birthday"},{rewardStrategy:{type:"FixedRatePointsReward",name:"國外消費",spendingPerPoint:10},transactionType:"Foreign"},{rewardStrategy:{type:"FixedRatePointsReward",name:"國內消費",spendingPerPoint:20},transactionType:"Domestic"}]}}],updateAt:new Date("2024/12/01 00:00:00").toISOString()},{name:"星宇商務鈦金卡",description:pe,cardUrl:"https://www.esunbank.com/zh-tw/personal/credit-card/intro/co-branded-card/starlux-card",storeBlackList:me,paymentBlackList:ye,pointExchanges:[{id:$(),config:{name:"星宇航空哩程",airlineCode:"SJX",pointsPerMile:1,milesPerUnit:1}}],plans:[{id:$(),config:{name:null,rewards:[{rewardStrategy:{type:"FixedRatePointsReward",name:"國外消費",spendingPerPoint:7.5},transactionType:"Foreign",condition:"Birthday"},{rewardStrategy:{type:"FixedRatePointsReward",name:"國外消費",spendingPerPoint:15},transactionType:"Foreign"},{rewardStrategy:{type:"FixedRatePointsReward",name:"國內消費",spendingPerPoint:25},transactionType:"Domestic"}]}}],updateAt:new Date("2024/12/01 00:00:00").toISOString()},{name:"星宇鈦金卡",description:pe,cardUrl:"https://www.esunbank.com/zh-tw/personal/credit-card/intro/co-branded-card/starlux-card",storeBlackList:me,paymentBlackList:ye,pointExchanges:[{id:$(),config:{name:"星宇航空哩程",airlineCode:"SJX",pointsPerMile:1,milesPerUnit:1}}],plans:[{id:$(),config:{name:null,rewards:[{rewardStrategy:{type:"FixedRatePointsReward",name:"國外消費",spendingPerPoint:20},transactionType:"Foreign"},{rewardStrategy:{type:"FixedRatePointsReward",name:"國內消費",spendingPerPoint:28},transactionType:"Domestic"}]}}],updateAt:new Date("2024/12/01 00:00:00").toISOString()}],be=["台灣中油-直營","台灣大車隊","台鐵","台灣高鐵","UBER","Yoxi","LINEGO","新光三越","遠東百貨","遠東SOGO百貨","誠品生活","漢神百貨","微風廣場","微風信義","微風南京","微風南山","微風台北車站","環球購物中心","台北101","華泰名品城","MITSUI OUTLET PARK 林口","MITSUI OUTLET PARK 台中港","MITSUI OUTLET PARK 台南","Big City遠東巨城購物中心","昇恆昌","夢時代購物中心","京站","美麗華","南紡購物中心","秀泰生活","台茂購物中心","Mitsui Shopping Park LaLaport 台中","統領廣場","采盟","Uber Eats","foodpanda","星巴克","EZTABLE","王品瘋美食","摩斯漢堡","foodomo","漢來美食","饗Joy","饗食天堂","果然匯","小福利","饗饗","旭集","開飯","饗泰多","真珠","瓦城","非常泰","大心","1010","時時香","BOBO","乾杯集團","路易莎","中華航空","長榮航空","日本航空","台灣虎航","樂桃航空","酷航","立榮航空","華信航空","Agoda","booking.com","Hotels.com","AsiaYo","Expedia","KKday","Klook","雄獅旅遊","可樂旅遊","東南旅行社","Apple直營店","小米台灣","全國電子","燦坤","迪卡儂","屈臣氏","康是美","IKEA","特力屋","特力和樂","UNIQLO","NET","大樹藥局","丁丁藥妝","momo購物網","蝦皮購物","淘寶網","Coupang酷澎","東森購物","雅虎奇摩購物中心","博客來","玉山Wallet愛心捐款-單筆捐款","玉山Wallet愛心捐款-定期定額","特斯拉","Gogoro電池資費","YouBike 2.0","日本實體店","韓國實體店","泰國實體店","越南實體店","新加坡實體店","中國實體店","香港實體店","澳門實體店","美國實體店","英國實體店","法國實體店","德國實體店","義大利實體店"],Ae={rewardStrategy:{type:"TruncatedPercentageReward",name:null,pointBackRates:[{rate:.3},{rate:.7}]}},Xe=[{name:"UniCard 卡",description:pe,cardUrl:"https://www.esunbank.com/zh-tw/personal/credit-card/intro/bank-card/unicard",storeBlackList:me,paymentBlackList:ye,pointExchanges:[{id:$(),config:{name:"長榮航空哩程",airlineCode:"EVA",pointsPerMile:200,milesPerUnit:300}}],plans:[{id:$(),config:{name:"任意選 (需要切換店家)",description:"玉山Wallet設定8家特店",rewards:[{rewardStrategy:{type:"TruncatedPercentageReward",name:null,pointBackRates:[{rate:.3},{rate:.7},{rate:2.5,limit:500}]},stores:be,payments:["信用卡","Apple Pay","Samsung Pay","Google Pay"]},{rewardStrategy:{type:"TruncatedPercentageReward",name:null,pointBackRates:[{rate:.3},{rate:.7},{rate:2.5,limit:500}]},payments:["Line Pay","街口支付","悠遊付","橘子支付","icash pay"]},Ae]}},{id:$(),config:{name:"簡單選",rewards:[{rewardStrategy:{type:"TruncatedPercentageReward",name:null,pointBackRates:[{rate:.3},{rate:.7},{rate:2,limit:500}]},stores:be,payments:["信用卡","Apple Pay","Samsung Pay","Google Pay"]},{rewardStrategy:{type:"TruncatedPercentageReward",name:null,pointBackRates:[{rate:.3},{rate:.7},{rate:2,limit:500}]},payments:["Line Pay","街口支付","悠遊付","橘子支付","icash pay"]},Ae]}},{id:$(),config:{name:"UP選",description:"完成指定任務或99點玉山e point訂閱",rewards:[{rewardStrategy:{type:"TruncatedPercentageReward",name:null,pointBackRates:[{rate:.3},{rate:.7},{rate:3.5,limit:2e3}]},stores:be,payments:["信用卡","Apple Pay","Samsung Pay","Google Pay"]},{rewardStrategy:{type:"TruncatedPercentageReward",name:null,pointBackRates:[{rate:.3},{rate:.7},{rate:3.5,limit:2e3}]},payments:["Line Pay","街口支付","悠遊付","橘子支付","icash pay"]},Ae]}}],updateAt:new Date("2024/12/01 00:00:00").toISOString()}],Rt=Xe[0],ke=["政府稅款","公共事業代扣繳","交通違規罰鍰","分期付款"],Ce=["全盈+PAY","icash pay","OPEN錢包","My FamiPay"],Ye=[{name:"旅人無限卡",description:le,cardUrl:"https://www.hsbc.com.tw/credit-cards/products/travel/visa-infinite/",storeBlackList:ke,paymentBlackList:Ce,pointExchanges:[{id:$(),config:{name:"長榮航空哩程",airlineCode:"EVA",pointsPerMile:1,milesPerUnit:1}}],plans:[{id:$(),config:{name:null,rewards:[{rewardStrategy:{type:"AccumulatedPointsReward",name:"國外消費",spendingPerPoint:10},transactionType:"Foreign"},{rewardStrategy:{type:"AccumulatedPointsReward",name:"國內消費",spendingPerPoint:18},transactionType:"Domestic"}]}}],updateAt:new Date("2024/12/01 00:00:00").toISOString()},{name:"旅人御璽卡",description:le,cardUrl:"https://www.hsbc.com.tw/credit-cards/products/travel/visa-signature/",storeBlackList:ke,paymentBlackList:Ce,pointExchanges:[{id:$(),config:{name:"長榮航空哩程",airlineCode:"EVA",pointsPerMile:1,milesPerUnit:1}}],plans:[{id:$(),config:{name:null,rewards:[{rewardStrategy:{type:"AccumulatedPointsReward",name:"國外消費",spendingPerPoint:15},transactionType:"Foreign"},{rewardStrategy:{type:"AccumulatedPointsReward",name:"國內消費",spendingPerPoint:18},transactionType:"Domestic"}]}}],updateAt:new Date("2024/12/01 00:00:00").toISOString()},{name:"旅人輕旅卡",description:le,cardUrl:"https://www.hsbc.com.tw/credit-cards/products/travel/visa-light/",storeBlackList:ke,paymentBlackList:Ce,pointExchanges:[{id:$(),config:{name:"長榮航空哩程",airlineCode:"EVA",pointsPerMile:1,milesPerUnit:1}}],plans:[{id:$(),config:{name:null,rewards:[{rewardStrategy:{type:"AccumulatedPointsReward",name:"國外消費",spendingPerPoint:20},transactionType:"Foreign"},{rewardStrategy:{type:"AccumulatedPointsReward",name:"國內消費",spendingPerPoint:20},transactionType:"Domestic"}]}}],updateAt:new Date("2024/12/01 00:00:00").toISOString()}],Et=Ye[2],Bt=[Ct,kt,Et,Rt],Lt=[...He,...ze,...Ye,...St,...Xe],Te=o=>Array.isArray(o)&&o.every(t=>Array.isArray(t)&&t.length===2&&typeof t[0]=="string"&&Array.isArray(t[1])&&t[1].every(n=>typeof n=="string")),We=[["7-ELEVEN",["7-11","Seven Eleven","統一超商","小7"]],["ANA全日空",["ANA","全日空","All Nippon Airways","NH"]],["ATT 4 FUN",["ATT4FUN","ATT信義"]],["App Store",["蘋果應用商店"]],["Apple Arcade",["蘋果遊戲訂閱服務"]],["Apple Music",["蘋果音樂","Apple音樂"]],["Apple One",["蘋果One訂閱"]],["Apple TV+",["Apple TV Plus"]],["Apple Wallet ICOCA",["ICOCA電子票","Apple錢包ICOCA"]],["Apple Wallet PASMO",["PASMO電子票","Apple錢包PASMO"]],["Apple Wallet SUICA",["SUICA電子票","Apple錢包SUICA"]],["CITYLINK",["City Link"]],["Disney+",["Disney Plus","迪士尼+"]],["Google Play",["Google應用商店"]],["Grab",["Grab Taxi","Grab叫車"]],["MITSUI OUTLET PARK 台中港",["三井台中港","三井OUTLET台中"]],["MITSUI OUTLET PARK 台南",["三井台南","三井OUTLET台南"]],["MITSUI OUTLET PARK 林口",["三井林口","三井OUTLET林口"]],["Mitsui Shopping Park LaLaport 台中",["LaLaport台中","三井LaLaport台中"]],["Netflix",["網飛"]],["Nintendo",["任天堂","Switch","老任"]],["PChome 24h購物(不含儲值及電子票券)",["PChome","PChome購物"]],["Tiger City",["老虎城","Tiger City購物中心"]],["Trip.com",["攜程"]],["Uber Eats (不含 Uber One)",["優步外送"]],["foodpanda",["熊貓外送","Food Panda"]],["iCloud",["蘋果雲端","iCloud雲端"]],["iRent",["i Rent"]],["iTunes",["蘋果iTunes"]],["中友百貨",["中友"]],["中華航空",["China Airlines","CAL","CI","華航"]],["亞洲航空",["AirAsia","亞航","AXM","AK"]],["京站",["Q Square","京站商場"]],["全家便利商店",["FamilyMart","全家"]],["全球迪士尼飯店",["Disney Hotels"]],["全聯福利中心",["PX Mart"]],["南紡購物中心",["Tainan Spinnery Mall","南紡"]],["博客來",["Books.com.tw"]],["卡達航空",["Qatar Airways","卡航","QTR","QR"]],["可樂旅遊",["Cola Travel","可樂旅行社"]],["台北101",["Taipei 101","101大樓"]],["台灣中油-直營",["中油直營","直營中油"]],["台灣大車隊",["Taiwan Taxi","大車隊"]],["台灣虎航",["Tigerair Taiwan","台虎","TWA","IT"]],["台灣高鐵",["Taiwan High Speed Rail"]],["台茂購物中心",["TaiMall"]],["吉卜力公園",["Ghibli Park"]],["國泰航空",["Cathay Pacific","國泰","CPA","CX","Cathay Pacific Airways"]],["土耳其航空",["Turkish Airlines","土航","THY","TK"]],["夢時代",["Dream Mall"]],["大阪環球影城(USJ)",["Universal Studios Japan"]],["大韓航空",["Korean Air","韓航","KAL","KE"]],["大魯閣新時代",["Taroko Mall","大魯閣"]],["太平洋百貨",["Pacific Department Store","太平洋"]],["好樂迪KTV",["Holiday"]],["家樂福",["Carrefour"]],["屈臣氏",["Watsons"]],["康是美",["Cosmed"]],["捷星航空",["JST","JQ","Jetstar Airways"]],["新加坡航空",["SIA","SQ","Singapore Airlines"]],["日本航空",["JAL","JL","Japan Airlines"]],["星宇航空",["starlux","SJX","JX","STARLUX Airlines"]],["樂桃航空",["APJ","MM","Peach Aviation"]],["法國航空",["AFR","AF","Air France"]],["聯合航空",["UAL","UA","United Airlines"]],["蝦皮購物",["shopee"]],["越捷航空",["VJC","VJ","VietJet Air"]],["達美航空",["DAL","DL","Delta Air Lines"]],["遠東百貨",["遠百"]],["酷航",["SCO","TR","Scoot"]],["長榮航空",["EVA","BR","EVA Airlines","EVA Air"]],["阿聯酋航空",["UAE","EK","Emirates"]],["麥當勞",["McDonald's"]],["IKEA",["宜家家居"]],["星巴克",["starbucks"]]],H=new ct(localStorage,{onlyShowCurrentPlan:o=>typeof o=="boolean",onlyShowCurrentPointExchange:o=>typeof o=="boolean",commonPaymentMethods:(()=>{const o=new Set(["信用卡","Apple Pay","Samsung Pay","Google Pay","Line Pay","Fitbit Pay","Garmin Pay","Hami Pay","街口支付","全盈+PAY","全支付","Pi錢包","橘子支付","歐付寶","icash pay","OPEN錢包","My FamiPay","悠遊付","ezPay","GOMAJI Pay","friday wallet","PayPal","PX Pay","中油Pay","台灣Pay","支付寶"]);return t=>Array.isArray(t)&&t.every(n=>o.has(n)===!0)})(),cardConfigs:(()=>{const o=new Set(["信用卡","Apple Pay","Samsung Pay","Google Pay","Line Pay","Fitbit Pay","Garmin Pay","Hami Pay","街口支付","全盈+PAY","全支付","Pi錢包","橘子支付","歐付寶","icash pay","OPEN錢包","My FamiPay","悠遊付","ezPay","GOMAJI Pay","friday wallet","PayPal","PX Pay","中油Pay","台灣Pay","支付寶"]),t=new Set(["信用卡","Apple Pay","Samsung Pay","Google Pay","Line Pay","Fitbit Pay","Garmin Pay","Hami Pay","街口支付","全盈+PAY","全支付","Pi錢包","橘子支付","歐付寶","icash pay","OPEN錢包","My FamiPay","悠遊付","ezPay","GOMAJI Pay","friday wallet","PayPal","PX Pay","中油Pay","台灣Pay","支付寶"]),n=new Set(["信用卡","Apple Pay","Samsung Pay","Google Pay","Line Pay","Fitbit Pay","Garmin Pay","Hami Pay","街口支付","全盈+PAY","全支付","Pi錢包","橘子支付","歐付寶","icash pay","OPEN錢包","My FamiPay","悠遊付","ezPay","GOMAJI Pay","friday wallet","PayPal","PX Pay","中油Pay","台灣Pay","支付寶"]),s=e=>typeof e.name=="string"&&(e.description===null||e.description===void 0||typeof e.description=="string")&&(e.cardUrl===null||typeof e.cardUrl=="string")&&(e.storeBlackList===void 0||Array.isArray(e.storeBlackList)&&e.storeBlackList.every(l=>typeof l=="string"))&&(e.paymentBlackList===void 0||Array.isArray(e.paymentBlackList)&&e.paymentBlackList.every(l=>o.has(l)===!0))&&(e.selectedPlanId===void 0||typeof e.selectedPlanId=="string"&&RegExp(/(.*)\x2d(.*)\x2d(.*)\x2d(.*)\x2d(.*)/).test(e.selectedPlanId))&&Array.isArray(e.plans)&&e.plans.every(l=>typeof l=="object"&&l!==null&&p(l))&&typeof e.updateAt=="string"&&RegExp(/^[+-]?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?\x2d[+-]?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?\x2d[+-]?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?T[+-]?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?:[+-]?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?:[+-]?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?\.[+-]?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?Z$/).test(e.updateAt)&&(e.selectedPointExchangeId===void 0||typeof e.selectedPointExchangeId=="string"&&RegExp(/(.*)\x2d(.*)\x2d(.*)\x2d(.*)\x2d(.*)/).test(e.selectedPointExchangeId))&&Array.isArray(e.pointExchanges)&&e.pointExchanges.every(l=>typeof l=="object"&&l!==null&&B(l)),p=e=>typeof e.id=="string"&&RegExp(/(.*)\x2d(.*)\x2d(.*)\x2d(.*)\x2d(.*)/).test(e.id)&&typeof e.config=="object"&&e.config!==null&&r(e.config),r=e=>(e.name===null||typeof e.name=="string")&&(e.description===null||e.description===void 0||typeof e.description=="string")&&Array.isArray(e.rewards)&&e.rewards.every(l=>typeof l=="object"&&l!==null&&d(l))&&(e.condition===null||e.condition===void 0||e.condition==="Birthday"),d=e=>typeof e.rewardStrategy=="object"&&e.rewardStrategy!==null&&J(e.rewardStrategy)&&(e.transactionType===null||e.transactionType===void 0||e.transactionType==="Domestic"||e.transactionType==="Foreign")&&(e.stores===void 0||Array.isArray(e.stores)&&e.stores.every(l=>typeof l=="string"))&&(e.storeBlackList===void 0||Array.isArray(e.storeBlackList)&&e.storeBlackList.every(l=>typeof l=="string"))&&(e.payments===void 0||Array.isArray(e.payments)&&e.payments.every(l=>t.has(l)===!0))&&(e.paymentBlackList===void 0||Array.isArray(e.paymentBlackList)&&e.paymentBlackList.every(l=>n.has(l)===!0))&&(e.condition===null||e.condition===void 0||e.condition==="Birthday"),i=e=>Array.isArray(e.pointBackRates)&&e.pointBackRates.every(l=>typeof l=="object"&&l!==null&&m(l))&&(e.name===null||typeof e.name=="string")&&e.type==="RoundedPercentageReward",m=e=>typeof e.rate=="number"&&(e.limit===void 0||typeof e.limit=="number"),b=e=>Array.isArray(e.pointBackRates)&&e.pointBackRates.every(l=>typeof l=="object"&&l!==null&&m(l))&&(e.name===null||typeof e.name=="string")&&e.type==="TruncatedPercentageReward",a=e=>typeof e.spendingPerPoint=="number"&&(e.name===null||typeof e.name=="string")&&e.type==="AccumulatedPointsReward",u=e=>typeof e.spendingPerPoint=="number"&&(e.name===null||typeof e.name=="string")&&e.type==="FixedRatePointsReward",B=e=>typeof e.id=="string"&&RegExp(/(.*)\x2d(.*)\x2d(.*)\x2d(.*)\x2d(.*)/).test(e.id)&&typeof e.config=="object"&&e.config!==null&&G(e.config),G=e=>typeof e.name=="string"&&typeof e.airlineCode=="string"&&typeof e.pointsPerMile=="number"&&typeof e.milesPerUnit=="number",J=e=>e.type==="TruncatedPercentageReward"?b(e):e.type==="RoundedPercentageReward"?i(e):e.type==="FixedRatePointsReward"?u(e):e.type==="AccumulatedPointsReward"?a(e):!1;return e=>Array.isArray(e)&&e.every(l=>typeof l=="object"&&l!==null&&s(l))})(),conditionTypes:o=>Array.isArray(o)&&o.every(t=>t==="Birthday"),aliasType:o=>o==="default"||o==="additional"||o==="custom",customAliases:Te},"bestMileageCards"),qe=["default","additional","custom"],de=it("BestMileageCards",()=>{const o=N(null);function t(P){o.value=P}function n(){o.value=null}tt(()=>{const P=H.get("cardConfigs")??[];b.value=new Map(P.map(U=>[$(),U]))});const s=N(H.get("onlyShowCurrentPlan")??!1);function p(P){H.set("onlyShowCurrentPlan",P),s.value=P}const r=N(H.get("onlyShowCurrentPointExchange")??!1);function d(P){H.set("onlyShowCurrentPointExchange",P),r.value=P}const i=N(H.get("commonPaymentMethods")??["信用卡","Apple Pay","Line Pay","街口支付"]);function m(P){P=[...new Set(P)],H.set("commonPaymentMethods",P),i.value=P}const b=N(new Map),a=q(()=>new Map([...b.value.entries()].map(([P,U])=>[P,Oe(U)]))),u=q(()=>a.value.size===0?Bt.map(P=>Oe(P)):[...a.value.values()]);function B(P,U){b.value.set(P,U),H.set("cardConfigs",[...b.value.values()])}function G(P){b.value.delete(P),H.set("cardConfigs",[...b.value.values()])}function J(P,U){const c=b.value.get(P);if(c===void 0)return!1;try{b.value.set(P,{...c,selectedPlanId:U})}catch{return!1}return H.set("cardConfigs",[...b.value.values()]),!0}function e(P,U){const c=b.value.get(P);if(c===void 0)return!1;try{b.value.set(P,{...c,selectedPointExchangeId:U})}catch{return!1}return H.set("cardConfigs",[...b.value.values()]),!0}const l=q(()=>Fe(Ve(u.value.flatMap(P=>P.storeList)))),V=N(H.get("conditionTypes")??[]);function _([...P]){V.value=P,H.set("conditionTypes",P)}const I=N(H.get("aliasType")??"default");function y(P){qe.includes(P)&&(I.value=P,H.set("aliasType",P))}const x=N(new Map(H.get("customAliases")??[]));function L(P,U){U.length===0?x.value.delete(P):x.value.set(P,U),H.set("customAliases",[...x.value])}function k(P){x.value=new Map(P),H.set("customAliases",P)}const K=q(()=>{const P=[];["default","additional"].includes(I.value)&&P.push(...We),["additional","custom"].includes(I.value)&&P.push(...x.value);const U=new Map;for(const[c,g]of P){const R=U.get(c)??new Set;for(const M of g)R.add(M);U.set(c,R)}return U});return{dialog:Q(o),openDialog:t,closeDialog:n,onlyShowCurrentPlan:Q(s),updateOnlyShowCurrentPlan:p,onlyShowCurrentPointExchange:Q(r),updateOnlyShowCurrentPointExchange:d,commonPaymentMethods:Q(i),updateCommonPaymentMethods:m,cardConfigs:Q(b),cards:a,showCards:u,updateCardConfig:B,deleteCardConfig:G,updatePlan:J,updatePointExchange:e,storeList:Q(l),conditionTypes:Q(V),updateConditionTypes:_,aliasType:Q(I),storeAliases:K,updateAliasType:y,customAliases:Q(x),updateCustomAliases:L,updateAllCustomAliases:k}}),Tt={class:"flex-col gap-24px my-16px"},Ut={class:"gap-8px flex justify-around"},Vt={class:"flex mx-16px"},$t=Z({__name:"CommonSettings",setup(o){const t=de(),{onlyShowCurrentPlan:n,onlyShowCurrentPointExchange:s,commonPaymentMethods:p,conditionTypes:r}=ie(t);return(d,i)=>{const m=A("v-switch"),b=A("v-label");return h(),S("div",Tt,[v("div",Ut,[f(m,{"model-value":C(n),"hide-details":"",color:"blue","onUpdate:modelValue":i[0]||(i[0]=a=>a!==null&&C(t).updateOnlyShowCurrentPlan(a))},{label:w(()=>i[3]||(i[3]=[v("p",{class:"text-0.75rem"},"只顯示當前方案",-1)])),_:1},8,["model-value"]),f(m,{"model-value":C(s),"hide-details":"",color:"blue","onUpdate:modelValue":i[1]||(i[1]=a=>a!==null&&C(t).updateOnlyShowCurrentPointExchange(a))},{label:w(()=>i[4]||(i[4]=[v("p",{class:"text-0.75rem"},"只顯示當前交換方式",-1)])),_:1},8,["model-value"])]),f(Be,{label:"使用中的付款方式","model-value":C(p),list:C(Ke),"hide-details":"","show-selected":"","onUpdate:modelValue":C(t).updateCommonPaymentMethods},null,8,["model-value","list","onUpdate:modelValue"]),v("div",null,[f(b,{text:"其他設定"}),v("div",Vt,[f(m,{"model-value":C(r),label:"生日中",value:"Birthday","hide-details":"",color:"blue","onUpdate:modelValue":i[2]||(i[2]=a=>a!==null&&C(t).updateConditionTypes(a))},null,8,["model-value"])])])])}}}),It={class:"flex-col gap-8px"},Mt={key:1},Ot={class:"flex min-h-1rem items-stretch"},Nt={key:0,class:"flex-center pl-0.5rem pr-0.25rem cursor-ns-resize"},Ft=["onClick"],Se=Z({__name:"CardList",props:{list:{},label:{default:null},addable:{type:Boolean,default:!1},draggable:{type:Boolean,default:!1},deletable:{type:Boolean,default:!1}},emits:["clickItem","deleteItem","addItem"],setup(o){return(t,n)=>{const s=A("v-label"),p=A("v-card-text"),r=A("v-card");return h(),S("div",It,[t.$slots.label||t.label?(h(),F(s,{key:0,class:"flex-shrink-0 w-full"},{default:w(()=>[t.$slots.label?Re(t.$slots,"label",{key:0}):t.label?(h(),S("p",Mt,T(t.label),1)):j("",!0)]),_:3})):j("",!0),(h(!0),S(X,null,Y(t.list,(d,i)=>(h(),F(r,{key:i,density:"compact",class:"mx-auto w-full flex-shrink-0",variant:"outlined",onClick:m=>t.$emit("clickItem",d,i)},{default:w(()=>[f(p,{class:"!p-0"},{default:w(()=>[v("div",Ot,[t.draggable?(h(),S("div",Nt,n[1]||(n[1]=[v("span",{class:"mdi text-24px mdi-drag"},null,-1)]))):j("",!0),v("div",{class:Ee(["flex-grow my-1rem min-h-20px flex items-center",{"ml-1rem":!t.draggable,"mr-1rem":!t.deletable}])},[Re(t.$slots,"default",at({ref_for:!0},d))],2),t.deletable?(h(),S("p",{key:1,class:"flex-center pl-0.25rem pr-0.5rem",onClick:Ne(m=>t.$emit("deleteItem",d,i),["stop"])},n[2]||(n[2]=[v("span",{class:"mdi mdi-delete text-24px"},null,-1)]),8,Ft)):j("",!0)])]),_:2},1024)]),_:2},1032,["onClick"]))),128)),t.addable?(h(),F(r,{key:1,density:"compact",class:"mx-auto w-full flex-shrink-0",variant:"outlined",onClick:n[0]||(n[0]=d=>t.$emit("addItem"))},{default:w(()=>[f(p,null,{default:w(()=>n[3]||(n[3]=[v("div",{class:"flex items-center justify-center min-h-1rem"},[v("span",{class:"mdi mdi-plus text-24px"})],-1)])),_:1})]),_:1})):j("",!0)])}}}),Dt={key:0,class:"overflow-y-auto p-16px pb-40px"},oe=Z({__name:"FullscreenDialog",props:{modelValue:{},title:{},btnTitle:{},btnEvent:{type:Function}},emits:["update:model-value"],setup(o,{emit:t}){const n=t;function s(){n("update:model-value",null)}function p(r){n("update:model-value",r)}return(r,d)=>{const i=A("v-btn"),m=A("v-toolbar-title"),b=A("v-toolbar-items"),a=A("v-toolbar"),u=A("v-card"),B=A("v-dialog");return h(),F(B,{"model-value":!!r.modelValue,fullscreen:"","onUpdate:modelValue":s},{default:w(()=>[f(u,null,{default:w(()=>[f(a,null,{default:w(()=>[f(i,{icon:"mdi-close",onClick:s}),f(m,null,{default:w(()=>[D(T(r.title??""),1)]),_:1}),f(b,null,{default:w(()=>[f(i,{text:r.btnTitle,onClick:d[0]||(d[0]=async()=>{r.modelValue!==null&&(await r.btnEvent(r.modelValue)??!0)&&s()})},null,8,["text"])]),_:1})]),_:1}),r.modelValue?(h(),S("div",Dt,[Re(r.$slots,"default",{data:r.modelValue,updateData:p})])):j("",!0)]),_:3})]),_:3},8,["model-value"])}}}),Gt={class:"relative"},Jt={key:0,class:"text-red ml-2px"},Ue=Z({__name:"NumberField",props:{modelValue:{default:0},required:{type:Boolean,default:!1},label:{default:null},isFloat:{type:Boolean,default:!1}},emits:["update:model-value"],setup(o,{emit:t}){const n=t;function s(d){const i=o.isFloat?parseFloat(d):parseInt(d);return isNaN(i)?null:i}const p=q(()=>{const d=[];return o.required&&d.push(i=>!!s(i)||"此欄位為必填"),d});function r(d){const i=s(d);n("update:model-value",i??0)}return(d,i)=>{const m=A("v-text-field");return h(),F(m,{rules:p.value,inputmode:"decimal","model-value":d.modelValue,clearable:d.modelValue!==0,"onUpdate:modelValue":r},nt({_:2},[d.label!==null?{name:"label",fn:w(()=>[v("p",Gt,[D(T(d.label)+" ",1),d.required?(h(),S("span",Jt,"*")):j("",!0)])]),key:"0"}:void 0]),1032,["rules","model-value","clearable"])}}}),jt={class:"relative"},Kt={key:0,class:"text-red ml-2px"},ae=Z({__name:"TextFiled",props:{modelValue:{default:null},required:{type:Boolean,default:!1},label:{},isUrl:{type:Boolean,default:!1}},emits:["update:model-value"],setup(o,{emit:t}){const n=t,s=q(()=>{const r=[];return o.required&&r.push(d=>!!d||"此欄位為必填"),o.isUrl&&r.push(d=>!!(d===null||d===""||d.startsWith("https://"))||"請填寫正確的網址 (需為 https:// 開頭)"),r});function p(r){r=(r==null?void 0:r.trim())??null,n("update:model-value",re(r)?r:null)}return(r,d)=>{const i=A("v-text-field");return h(),F(i,{clearable:"",rules:s.value,"model-value":r.modelValue,"onUpdate:modelValue":p},{label:w(()=>[v("p",jt,[D(T(r.label)+" ",1),r.required?(h(),S("span",Kt,"*")):j("",!0)])]),_:1},8,["rules","model-value"])}}});function ee(o){if(o===null||typeof o!="object")return o;if(Array.isArray(o))return o.map(n=>ee(n));if(o instanceof Map)return new Map(Array.from(o.entries()).map(([n,s])=>[ee(n),ee(s)]));if(o instanceof Set)return new Set(Array.from(o.values()).map(n=>ee(n)));if(o instanceof Date)return new Date(o.getTime());if(o instanceof RegExp)return new RegExp(o.source,o.flags);const t={};return Object.keys(o).forEach(n=>{t[n]=ee(o[n])}),t}const zt={class:"flex-col gap-4px h-full overflow-hidden"},Ht={class:"flex"},Xt={class:"flex-1 gap-8px flex-col overflow-y-auto py-8px"},Yt={class:"flex items-center justify-between"},Wt=["onClick"],qt={class:"flex-col gap-2"},Zt={class:"flex-col gap-4px"},Qt={class:"text-0.9em"},ea={class:"flex gap-4px items-center justify-center"},ta={class:"flex-1"},aa={class:"flex-1"},na={class:"overflow-y-auto w-full p-24px"},la={key:0,class:"flex-col gap-8px"},oa={class:"flex items-center justify-between gap-4px min-h-1rem"},sa={class:"flex-col gap-1"},ra={key:0,class:"opacity-50 text-0.75rem"},ia={key:0,class:"mdi text-24px mdi-check-circle"},da={class:"flex items-center justify-between min-h-1rem gap-4px"},ca={class:"flex-col gap-4px"},ua={class:"opacity-50 text-0.75rem"},pa={key:0,class:"mdi mdi-check-circle text-24px"},ma={class:"flex-col gap-2"},ya={class:"flex-col"},ga={class:"text-1rem"},fa={class:"text-0.75rem"},Pa=Z({__name:"CreditCardManagement",setup(o){const t=de(),{cardConfigs:n,cards:s}=ie(t),p=N(null),r=N(null),d=N(null),i=N(null),m=q(()=>{const V=i.value===null?null:s.value.get(i.value)??null;return V===null?null:V}),b=N(null);function a(V){for(const _ of V)t.updateCardConfig($(),_)}function u({id:V,config:_}){return xt(_)?(t.updateCardConfig(V,_),!0):(alert("儲存失敗"),!1)}function B(){return{id:$(),config:{name:null,description:null,rewards:[]}}}function G({id:V,config:_}){if(p.value===null||!bt(_))return alert("儲存失敗"),!1;const I=p.value.config.plans.find(y=>y.id===V);return I?I.config=_:p.value.config.plans.push({id:V,config:_}),!0}function J(){return{id:$(),config:{name:"",airlineCode:"",milesPerUnit:0,pointsPerMile:0}}}function e({id:V,config:_}){if(p.value===null||!At(_)||_.milesPerUnit===0||_.pointsPerMile===0)return alert("儲存失敗"),!1;const I=p.value.config.pointExchanges.find(y=>y.id===V);return I?I.config=_:p.value.config.pointExchanges.push({id:V,config:_}),!0}function l(){p.value!==null&&(t.deleteCardConfig(p.value.id),p.value=null)}return(V,_)=>{const I=A("v-label"),y=A("v-btn"),x=A("v-card"),L=A("v-textarea"),k=A("v-card-text"),K=A("v-card-actions"),P=A("v-dialog"),U=A("v-checkbox");return h(),S(X,null,[v("div",zt,[v("div",Ht,[f(I,{class:"ml-4px flex-grow !text-0.9rem"},{default:w(()=>_[12]||(_[12]=[D(" 點擊 "),v("span",{class:"mdi mdi-pencil mx-4px"},null,-1),D(" 編輯卡片，點擊卡片切換方案 ")])),_:1}),f(y,{text:"匯入",onClick:_[0]||(_[0]=()=>b.value=[])})]),v("div",Xt,[(h(!0),S(X,null,Y(C(n).entries(),([c,g],R)=>(h(),F(x,{key:R,density:"compact",class:"mx-auto w-full flex-shrink-0",variant:"outlined",title:g.name,text:g.description??"",onClick:()=>i.value=c},{title:w(()=>[v("div",Yt,[D(T(g.name)+" ",1),v("span",{class:"mdi mdi-pencil absolute top-0 py-0.625rem px-1rem right-0",onClick:Ne(()=>p.value={id:c,config:C(ee)(g)},["stop"])},null,8,Wt)])]),_:2},1032,["title","text","onClick"]))),128))])]),f(oe,{modelValue:p.value,"onUpdate:modelValue":_[6]||(_[6]=c=>p.value=c),title:"編輯卡片","btn-title":"儲存","btn-event":u},{default:w(({data:c})=>[v("div",qt,[f(ae,{modelValue:c.config.name,"onUpdate:modelValue":g=>c.config.name=g,label:"卡片名稱",required:""},null,8,["modelValue","onUpdate:modelValue"]),f(ae,{modelValue:c.config.description,"onUpdate:modelValue":g=>c.config.description=g,label:"卡片描述"},null,8,["modelValue","onUpdate:modelValue"]),f(ae,{modelValue:c.config.cardUrl,"onUpdate:modelValue":g=>c.config.cardUrl=g,"is-url":"",label:"信用卡網頁"},null,8,["modelValue","onUpdate:modelValue"]),f(Be,{modelValue:c.config.storeBlackList,"onUpdate:modelValue":g=>c.config.storeBlackList=g,addable:"",label:"卡片不回饋清單",list:C(t).storeList},null,8,["modelValue","onUpdate:modelValue","list"]),f(Be,{modelValue:c.config.paymentBlackList,"onUpdate:modelValue":g=>c.config.paymentBlackList=g,label:"卡片不回饋支付方式","show-selected":"",list:C(Ke)},null,8,["modelValue","onUpdate:modelValue","list"]),f(Se,{list:c.config.plans,class:"mb-8",label:"方案設定 (點擊卡片進行編輯)",addable:"",deletable:"",onClickItem:_[1]||(_[1]=g=>r.value=C(ee)(g)),onAddItem:_[2]||(_[2]=g=>r.value=B()),onDeleteItem:(g,R)=>C(t).openDialog({text:`確定要刪除'${g.config.name??"此"}'方案嗎？`,events:[{text:"取消"},{text:"刪除",event:()=>{c.config.plans.splice(R,1)},class:"text-red"}]})},{default:w(g=>[D(T(g.config.name??"(空)"),1)]),_:2},1032,["list","onDeleteItem"]),f(Se,{list:c.config.pointExchanges,class:"mb-8",addable:"",deletable:"",label:"點數交換方式 (點擊卡片進行編輯)",onClickItem:_[3]||(_[3]=g=>d.value=C(ee)(g)),onAddItem:_[4]||(_[4]=g=>d.value=J()),onDeleteItem:(g,R)=>C(t).openDialog({text:`確定要刪除'${g.config.name??"此"}'點數交換方式嗎？`,events:[{text:"取消"},{text:"刪除",event:()=>{c.config.pointExchanges.splice(R,1)},class:"text-red"}]})},{default:w(g=>[D(T(g.config.name??"(空)"),1)]),_:2},1032,["list","onDeleteItem"]),f(y,{class:"text-red",text:"刪除",onClick:_[5]||(_[5]=g=>C(t).openDialog({text:"確定要刪除嗎？",events:[{text:"取消"},{text:"刪除",event:l,class:"text-red"}]}))})])]),_:1},8,["modelValue"]),f(oe,{modelValue:r.value,"onUpdate:modelValue":_[7]||(_[7]=c=>r.value=c),title:"編輯方案","btn-title":"儲存","btn-event":G},{default:w(({data:c})=>[f(ae,{modelValue:c.config.name,"onUpdate:modelValue":g=>c.config.name=g,label:"方案名稱"},null,8,["modelValue","onUpdate:modelValue"]),f(L,{label:"方案描述","model-value":c.config.description,"auto-grow":"",clearable:"","onUpdate:modelValue":g=>c.config.description=C(re)(g)?g:null},null,8,["model-value","onUpdate:modelValue"]),f(Se,{list:c.config.rewards,addable:"",deletable:"",onDeleteItem:(g,R)=>C(t).openDialog({text:"確定要刪除嗎？",events:[{text:"取消"},{text:"刪除",event:()=>{c.config.rewards.splice(R,1)},class:"text-red"}]})},{label:w(()=>_[13]||(_[13]=[v("p",{class:"flex-col"},[D(" 回饋清單 (點擊卡片進行編輯) "),v("span",{class:"text-0.75em"}," 依回饋排序檢查規則，符合即計算回饋，不再檢查後續項目 ")],-1)])),default:w(g=>[v("p",Zt,[D(T(g.rewardStrategy.name??"(空)")+" ",1),v("span",Qt,T(C(je)(g.rewardStrategy).description),1)])]),_:2},1032,["list","onDeleteItem"])]),_:1},8,["modelValue"]),f(oe,{modelValue:d.value,"onUpdate:modelValue":_[8]||(_[8]=c=>d.value=c),title:"編輯交換方式","btn-title":"儲存","btn-event":e},{default:w(({data:c})=>[f(ae,{modelValue:c.config.name,"onUpdate:modelValue":g=>c.config.name=g,label:"名稱",required:""},null,8,["modelValue","onUpdate:modelValue"]),f(ae,{modelValue:c.config.airlineCode,"onUpdate:modelValue":g=>c.config.airlineCode=g,label:"目標里程",required:""},null,8,["modelValue","onUpdate:modelValue"]),v("div",ea,[v("div",ta,[f(Ue,{modelValue:c.config.pointsPerMile,"onUpdate:modelValue":g=>c.config.pointsPerMile=g,label:"points",required:""},null,8,["modelValue","onUpdate:modelValue"])]),_[14]||(_[14]=v("span",{class:"mdi mdi-arrow-right-thick text-24px mb-16px"},null,-1)),v("div",aa,[f(Ue,{modelValue:c.config.milesPerUnit,"onUpdate:modelValue":g=>c.config.milesPerUnit=g,label:`${c.config.airlineCode} 哩程`,required:""},null,8,["modelValue","onUpdate:modelValue","label"])])])]),_:1},8,["modelValue"]),f(P,{"model-value":!!i.value,"onUpdate:modelValue":_[10]||(_[10]=c=>i.value=null)},{default:w(()=>[f(x,{"min-width":"100%"},{default:w(()=>[f(k,{class:"overflow-hidden flex max-h-80dvh !p-0"},{default:w(()=>[v("div",na,[m.value!==null?(h(),S("div",la,[_[15]||(_[15]=D(" 切換方案 ")),(h(!0),S(X,null,Y(m.value.selectablePlan??[],(c,g)=>(h(),F(x,{key:g,density:"compact",class:"mx-auto w-full flex-shrink-0",variant:"outlined",onClick:()=>i.value&&m.value&&c.id!==m.value.selectedPlanId&&C(t).updatePlan(i.value,c.id)},{default:w(()=>[f(k,null,{default:w(()=>[v("div",oa,[v("p",sa,[D(T(c.name??"(空)")+" ",1),c.description?(h(),S("span",ra,T(c.description),1)):j("",!0)]),c.id===m.value.selectedPlanId?(h(),S("span",ia)):j("",!0)])]),_:2},1024)]),_:2},1032,["onClick"]))),128)),_[16]||(_[16]=D(" 切換點數交換方式 ")),(h(!0),S(X,null,Y(m.value.selectablePointExchange??[],(c,g)=>(h(),F(x,{key:g,density:"compact",class:"mx-auto w-full flex-shrink-0",variant:"outlined",onClick:()=>i.value&&m.value&&c.id!==m.value.selectedPointExchangeId&&C(t).updatePointExchange(i.value,c.id)},{default:w(()=>[f(k,null,{default:w(()=>[v("div",da,[v("p",ca,[D(T(c.name)+" ",1),v("span",ua,T(c.description),1)]),c.id===m.value.selectedPointExchangeId?(h(),S("span",pa)):j("",!0)])]),_:2},1024)]),_:2},1032,["onClick"]))),128))])):j("",!0)])]),_:1}),f(K,null,{default:w(()=>[f(y,{class:"ms-auto",text:"Close",onClick:_[9]||(_[9]=c=>i.value=null)})]),_:1})]),_:1})]),_:1},8,["model-value"]),f(oe,{modelValue:b.value,"onUpdate:modelValue":_[11]||(_[11]=c=>b.value=c),title:"請選擇卡片","btn-title":"匯入","btn-event":a},{default:w(({data:c,updateData:g})=>[v("div",ma,[(h(!0),S(X,null,Y(C(Lt),(R,M)=>(h(),F(U,{key:M,"model-value":c,value:R,"hide-details":"",color:"blue",density:"comfortable",class:"import-card-checkbox","onUpdate:modelValue":z=>z&&g(z)},{label:w(()=>[v("div",ya,[v("p",ga,T(R.name),1),v("p",fa,T(R.description),1)])]),_:2},1032,["model-value","value","onUpdate:modelValue"]))),128))])]),_:1},8,["modelValue"])],64)}}}),va=Ge(Pa,[["__scopeId","data-v-846e7496"]]),ha={class:"gap-8px h-full flex-col"},_a={class:"flex items-center flex-wrap gap-x-8px"},wa={class:"gap-8px flex-center"},xa={ref:"rewardCardList",class:"flex-col gap-4px overflow-y-auto flex-grow-1"},ba={class:"flex items-center gap-4px overflow-hidden w-full"},Aa={class:"opacity-50 flex-grow-1 text-12px truncate"},ka={key:0,class:"fa-solid fa-circle-check"},Ca={class:"flex-col gap-8px"},Sa={class:"text-0.75rem"},Ra={class:"text-wrap"},Ea={class:"flex-col"},Ba={class:"flex justify-between"},La=["href"],Ta={key:0},Ua={key:1},Va="其他店家",$a=Z({__name:"SearchReward",setup(o){const t=se(0),n=se(2),s=De(0),{onlyShowCurrentPlan:p,onlyShowCurrentPointExchange:r,commonPaymentMethods:d,showCards:i,conditionTypes:m,storeAliases:b,storeList:a}=ie(de()),u=N(0),B=N(null),G=N("Domestic"),J=N([]),e=ne("rewardCardList"),l=ne("storeAutoComplete"),V=q(()=>{const L=a.value.map(k=>({store:k,aliases:[...b.value.get(k)??[]]}));return[{store:Va},...L]});function _(L,k,K){return k=k.toLowerCase(),[L,...(K==null?void 0:K.raw.aliases)??[]].map(U=>U.toLowerCase()).some(U=>U.includes(k))}const I=q(()=>{var K;const L={amount:u.value,acceptedPayments:J.value,transactionAttributesType:G.value,currentConditions:[...m.value]};re(B.value)&&(L.transactionStore=B.value);const k=[];for(const P of i.value){const U=P.getRewardInfos(L,{onlyCurrentPlan:p.value,onlyCurrentExchangeStrategy:r.value}),c=!p.value||!r.value,g=!r.value&&P.selectablePointExchange.length>1;for(const R of U){const M={cardName:P.name,planName:R.planName,rewardName:R.rewardName,miles:R.miles,payments:R.payments,airLinesCode:R.airlineCode,isSelectedPlan:c&&R.planId===P.selectedPlanId,calculateDetail:x(R.rewardStrategy,R.pointExchangeStrategy),description:R.rewardStrategy===null?null:`${R.rewardStrategy.description}，${R.pointExchangeStrategy.description}`,cardUrl:P.cardUrl,cardDescription:P.description,pointExchangeName:g?R.pointExchangeName:""};k.push(M)}}return(K=e.value)==null||K.scrollTo({top:0,behavior:"smooth"}),Me(Me(k,"isSelectedPlan","desc"),"miles","desc")}),y=N(null);function x(L,k){const{pointsPerMile:K,milesPerUnit:P,airlineCode:U}=k,c="回饋計算:";switch(L==null?void 0:L.type){case"RoundedPercentageReward":case"TruncatedPercentageReward":{const g=L.type==="RoundedPercentageReward"?t:s;let R=0;return[c,...L.pointBackRates.map(({rate:M,limit:z})=>{const E=Math.min(g(u.value*M/100),z??1/0);R+=E;const W=z!==void 0?` (limit ${z})`:"";return`${u.value} * ${M}% = ${E}${W}`}),`總計 ${R} points`,`${R} / ${K} * ${P} = ${k.calculateMiles(R)} ${U}`]}case"AccumulatedPointsReward":{const g=n(u.value/L.spendingPerPoint);return[c,`${u.value} / ${L.spendingPerPoint} = ${g} points`,`${g} / ${K} * ${P} = ${k.calculateMiles(g)} ${U}`]}case"FixedRatePointsReward":{const g=s(u.value/L.spendingPerPoint);return[c,`${u.value} / ${L.spendingPerPoint} = ${g} points (小數省略)`,`${g} / ${K} * ${P} = ${k.calculateMiles(g)} ${U}`]}default:return[]}}return(L,k)=>{const K=A("v-autocomplete"),P=A("v-label"),U=A("v-checkbox"),c=A("v-radio"),g=A("v-radio-group"),R=A("v-card"),M=A("v-btn"),z=A("v-dialog");return h(),S(X,null,[v("div",ha,[f(Ue,{modelValue:u.value,"onUpdate:modelValue":k[0]||(k[0]=E=>u.value=E),label:"交易金額",class:"flex-grow-0",density:"comfortable","hide-details":""},null,8,["modelValue"]),f(K,{ref:"storeAutoComplete",modelValue:B.value,"onUpdate:modelValue":k[1]||(k[1]=E=>B.value=E),"custom-filter":_,class:"flex-grow-0",density:"comfortable","hide-details":"","item-value":"store","item-title":"store",items:V.value,clearable:C(re)(B.value),placeholder:"全部店家","onUpdate:menu":k[2]||(k[2]=E=>{var W;return!E&&((W=C(l))==null?void 0:W.blur())})},null,8,["modelValue","items","clearable"]),v("div",null,[f(P,{text:"店家可使用的付款方式"}),v("div",_a,[(h(!0),S(X,null,Y(C(d),(E,W)=>(h(),F(U,{key:W,modelValue:J.value,"onUpdate:modelValue":k[3]||(k[3]=Ze=>J.value=Ze),density:"compact",value:E,"hide-details":"",label:E},null,8,["modelValue","value","label"]))),128))])]),v("div",wa,[f(P,{text:"交易類型"}),f(g,{modelValue:G.value,"onUpdate:modelValue":k[4]||(k[4]=E=>G.value=E),"hide-details":"",inline:""},{default:w(()=>[f(c,{density:"compact",label:"國內交易",value:"Domestic"}),f(c,{density:"compact",label:"國外交易",value:"Foreign"})]),_:1},8,["modelValue"])]),v("div",xa,[(h(!0),S(X,null,Y(I.value,(E,W)=>(h(),F(R,{key:W,density:"compact",class:"mx-auto w-full flex-shrink-0",variant:"outlined",onClick:()=>y.value=E},{title:w(()=>[v("div",ba,[D(T(E.miles)+" ",1),v("p",Aa,T(E.airLinesCode)+" "+T(E.payments.length===0?"":` (限定支付: ${E.payments.join(", ")})`),1),E.isSelectedPlan?(h(),S("i",ka)):j("",!0)])]),text:w(()=>[v("div",Ca,[v("p",Sa,T(`${E.cardName} ${E.planName??""} ${E.rewardName??""} ${E.pointExchangeName}`),1)])]),_:2},1032,["onClick"]))),128))],512)]),f(z,{"model-value":!!y.value,"onUpdate:modelValue":k[6]||(k[6]=E=>y.value=null)},{default:w(()=>[y.value?(h(),F(R,{key:0,class:"mx-auto reward-detail-dialog","min-width":"100%",title:`${y.value.cardName} ${y.value.planName??""} ${y.value.rewardName??""}`},{subtitle:w(()=>[v("p",Ra,T(y.value.description??""),1)]),text:w(()=>[v("div",Ea,[v("p",Ba,[k[7]||(k[7]=D(" 卡片說明： ")),y.value.cardUrl!==null?(h(),S("a",{key:0,target:"_blank",class:"underline",href:y.value.cardUrl}," 網站 ",8,La)):j("",!0)]),y.value.cardDescription!==""||y.value.cardDescription!==null?(h(),S("p",Ta,T(y.value.cardDescription),1)):j("",!0),y.value.pointExchangeName!==""?(h(),S("p",Ua,T(y.value.pointExchangeName),1)):j("",!0),k[8]||(k[8]=v("br",null,null,-1)),v("p",null,"消費金額: "+T(u.value),1),v("p",null,"哩程預估: "+T(y.value.miles)+" "+T(y.value.airLinesCode),1),k[9]||(k[9]=v("br",null,null,-1)),(h(!0),S(X,null,Y(y.value.calculateDetail,(E,W)=>(h(),S("p",{key:W},T(E),1))),128))])]),actions:w(()=>[f(M,{class:"ms-auto",text:"Close",onClick:k[5]||(k[5]=E=>y.value=null)})]),_:1},8,["title"])):j("",!0)]),_:1},8,["model-value"])],64)}}}),Ia=Ge($a,[["__scopeId","data-v-18e5ec74"]]),Ma={class:"flex-col h-full overflow-hidden gap-8px"},Oa={class:"flex-shrink-0 flex-col gap-8px"},Na={key:0,class:"flex justify-between items-center"},Fa={class:"flex gap-8px"},Da={key:0,class:"gap-4px flex-col flex-grow-1 overflow-y-auto"},Ga={class:"text-1rem"},Ja={class:"text-0.8rem"},ja={key:1,class:"flex-grow-1"},Ka={class:"flex-col gap-24px m-8px"},za={class:"flex-col gap-4px"},Ha=Z({__name:"StoreAliasManagement",setup(o){const t=de(),{aliasType:n,customAliases:s,storeAliases:p}=ie(t),r=ne("storeList"),d={default:"系統預設",additional:"預設+自定義",custom:"自定義"},i=N(!0),m=N(!1),b=N(!0),a=N("[]"),u=N(null),B=q(()=>{let y;return n.value==="default"?y=We:n.value==="additional"?y=[...p.value].map(([x,L])=>[x,[...L]]):y=[...s.value],y.map(([x,L])=>({title:x,aliases:[...L]}))});Ie(()=>{var y;return(y=u.value)==null?void 0:y.title},y=>{if(y==null||u.value===null)return;const x=[...s.value.get(y)??[]];x[x.length-1]!==""&&x.push(""),u.value.aliases=x}),Ie(i,_),lt(()=>{_(),m.value=!1,b.value=!0,i.value=!0});function G(y,x){if(u.value===null)return;let L=u.value.aliases;L[x]=y,L[L.length-1]!==""&&L.push("")}function J(y){if(n.value!=="default")if(y===null)u.value={title:null,aliases:[]};else{const x=[...s.value.get(y)??[]];x[x.length-1]!==""&&x.push(""),u.value={title:y,aliases:x}}}function e({title:y,aliases:x}){y!==null&&t.updateCustomAliases(y,[...new Set(x)].filter(re))}function l(y){if(y=y.trim(),a.value=y,m.value=!0,y===""){b.value=!0;return}try{const x=JSON.parse(y);b.value=Te(x)}catch(x){console.error(x),b.value=!1}}function V(){let y;if(i.value)y=!0;else{a.value===""&&(a.value="[]");try{const x=JSON.parse(a.value);Te(x)?(t.updateAllCustomAliases(x),y=!0):y=!1}catch(x){console.error(x),y=!1}}y?(alert("儲存成功"),m.value=!1):alert(`儲存失敗${i.value?"":"，JSON 不符合規則"}`)}function _(){a.value=JSON.stringify([...s.value],null,2)}function I(y){m.value||(y==="default"&&(i.value=!0),t.updateAliasType(y))}return(y,x)=>{const L=A("v-label"),k=A("v-btn"),K=A("v-btn-toggle"),P=A("v-switch"),U=A("v-card"),c=A("v-textarea"),g=A("v-autocomplete"),R=A("v-text-field");return h(),S(X,null,[v("div",Ma,[v("div",Oa,[f(L,{text:"別名設定"}),f(K,{"model-value":C(n),rounded:"0",group:"",class:"w-full flex justify-center",disabled:m.value,"onUpdate:modelValue":I},{default:w(()=>[(h(!0),S(X,null,Y(C(qe),(M,z)=>(h(),F(k,{key:z,class:"flex-1",value:M},{default:w(()=>[D(T(d[M]),1)]),_:2},1032,["value"]))),128))]),_:1},8,["model-value","disabled"]),C(n)!=="default"?(h(),S("div",Na,[v("div",Fa,[i.value?(h(),F(k,{key:0,onClick:x[0]||(x[0]=M=>J(null))},{default:w(()=>x[4]||(x[4]=[D(" Add ")])),_:1})):(h(),F(k,{key:1,onClick:V},{default:w(()=>x[5]||(x[5]=[D(" 儲存 ")])),_:1}))]),f(P,{modelValue:i.value,"onUpdate:modelValue":x[1]||(x[1]=M=>i.value=M),disabled:m.value,"hide-details":"",label:"圖示"},null,8,["modelValue","disabled"])])):j("",!0)]),i.value?(h(),S("div",Da,[(h(!0),S(X,null,Y(B.value,(M,z)=>(h(),F(U,{key:z,density:"compact",class:"mx-auto w-full flex-shrink-0",variant:"outlined",onClick:E=>J(M.title)},{text:w(()=>[v("p",Ga,T(M.title),1),v("p",Ja,T(M.aliases.join(", ")),1)]),_:2},1032,["onClick"]))),128))])):(h(),S("div",ja,[f(c,{"model-value":a.value,clearable:"","auto-grow":"",disabled:C(n)==="default","max-rows":15,messages:m.value?"上方儲存完成後才能執行其他動作，離開這頁不會存檔":"","error-messages":b.value?"":"json 無效",label:"自定義別名設定檔","onUpdate:modelValue":l},null,8,["model-value","disabled","messages","error-messages"])]))]),f(oe,{modelValue:u.value,"onUpdate:modelValue":x[3]||(x[3]=M=>u.value=M),title:"編輯商店別名","btn-title":"儲存","btn-event":e},{default:w(({data:M})=>[v("div",Ka,[f(g,{ref:"storeList",modelValue:M.title,"onUpdate:modelValue":z=>M.title=z,class:"flex-grow-0","hide-details":"",label:"目標店家",items:C(t).storeList,placeholder:"選擇店家","onUpdate:menu":x[2]||(x[2]=z=>{var E;return!z&&((E=C(r))==null?void 0:E.blur())})},null,8,["modelValue","onUpdate:modelValue","items"]),v("div",za,[f(L,{text:"自定義別名列表"}),(h(!0),S(X,null,Y(M.aliases,(z,E)=>(h(),F(R,{key:E,"hide-details":"",clearable:"","model-value":z,"onUpdate:modelValue":W=>G(W,E),"onClick:clear":()=>M.aliases.splice(E,1)},null,8,["model-value","onUpdate:modelValue","onClick:clear"]))),128))])])]),_:1},8,["modelValue"])],64)}}}),Xa={style:{height:"calc(100dvh - 56px)"},class:"overflow-hidden mt-56px p-8px"},Ya={class:"w-full text-center"},Wa={class:"w-full flex items-center justify-between px-8px"},qa=Z({__name:"App",setup(o){const t=de(),{dialog:n}=ie(t),s={查詢回饋:Ia,信用卡管理:va,商家別名:Ha,喜好設定:$t},p=Object.keys(s),r=N(!1),d=N(p[0]);return(i,m)=>{const b=A("v-app-bar-nav-icon"),a=A("v-app-bar-title"),u=A("v-app-bar"),B=A("v-list-item"),G=A("v-divider"),J=A("v-navigation-drawer"),e=A("v-app"),l=A("v-btn"),V=A("v-card"),_=A("v-dialog");return h(),S(X,null,[f(e,null,{default:w(()=>[f(u,{density:"comfortable",elevation:2},{prepend:w(()=>[f(b,{onClick:m[0]||(m[0]=I=>r.value=!r.value)},{default:w(()=>m[2]||(m[2]=[v("i",{class:"fa-solid fa-bars"},null,-1)])),_:1}),f(a,null,{default:w(()=>[D(T(d.value),1)]),_:1})]),_:1}),f(J,{modelValue:r.value,"onUpdate:modelValue":m[1]||(m[1]=I=>r.value=I)},{default:w(()=>[(h(!0),S(X,null,Y(C(p),(I,y)=>(h(),S(X,{key:y},[f(B,{title:I,class:Ee(["h-48px",{"text-emphasis":d.value===I}]),onClick:()=>{d.value=I,r.value=!1}},null,8,["title","class","onClick"]),f(G)],64))),128))]),_:1},8,["modelValue"]),v("main",Xa,[(h(),F(st,null,[(h(),F(ot(s[d.value])))],1024))])]),_:1}),f(_,{"model-value":!!C(n),"onUpdate:modelValue":C(t).closeDialog},{default:w(()=>[C(n)!==null?(h(),F(V,{key:0,class:"mx-auto","min-width":"100%"},{text:w(()=>[v("div",Ya,T(C(n).text),1)]),actions:w(()=>[v("div",Wa,[(h(!0),S(X,null,Y(C(n).events,(I,y)=>(h(),F(l,{key:y,text:I.text,class:Ee(I.class),variant:"elevated",onClick:async()=>{"event"in I&&await I.event(),C(t).closeDialog()}},null,8,["text","class","onClick"]))),128))])]),_:1})):j("",!0)]),_:1},8,["model-value","onUpdate:modelValue"])],64)}}}),$e=rt(qa);$e.use(ut);$e.use(dt());$e.mount("#app");
//# sourceMappingURL=bestMileageCards-BmJjtGlC.js.map
