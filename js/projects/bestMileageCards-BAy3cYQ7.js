var mt=Object.defineProperty;var yt=(c,t,a)=>t in c?mt(c,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):c[t]=a;var J=(c,t,a)=>yt(c,typeof t!="symbol"?t+"":t,a);import{d as le,e as se,c as te,C as A,v as j,j as _,G as be,D as w,m as h,x as p,E as K,t as M,u as E,b as O,o as et,f as ae,g as V,s as pe,w as ge,y as Y,H as Ge,F as z,q as ee,l as fe,z as Je,I as gt,J as ft,K as vt,L as Pt,B as ht}from"../index-WjYLUYho.js";import{d as _t,s as he,c as wt}from"../pinia-CSpRV4pv.js";import{a as xt,C as bt,v as At}from"../StorageManager-DmacarBz.js";import{a as tt,b as Xe}from"../sorts-DmEn6gXZ.js";import{f as at,r as ve,b as He,g as N,i as Pe}from"../index-w2jt-Wul.js";import{_ as We}from"../_plugin-vue_export-helper-DlAUqK2U.js";const ie=le({__name:"ClipList",props:{modelValue:{default:()=>[]},list:{},label:{},message:{},searchable:{type:Boolean,default:!1},addable:{type:Boolean,default:!1},showSelected:{type:Boolean,default:!1},hideDetails:{type:Boolean,default:!1}},emits:["update:model-value"],setup(c,{emit:t}){const a=se("comboboxComponent"),i=se("autocompleteComponent"),x=se("selectComponent"),u=t,f=te(()=>tt(c.list));function l(r){const U=c.modelValue.filter(T=>T!==r);v(U)}function v([...r]){u("update:model-value",r)}function P(r){return function(U){!U&&r!==null&&r.blur()}}function n(){v([])}return(r,U)=>{const T=A("v-chip"),$=A("v-combobox"),e=A("v-autocomplete"),m=A("v-select");return r.addable?(_(),j($,{key:0,ref_key:"comboboxComponent",ref:a,"model-value":r.modelValue,items:f.value,label:r.label,hint:"可新增內容",multiple:"","persistent-hint":"","hide-details":r.hideDetails,"hide-selected":!r.showSelected,"onUpdate:modelValue":v,"onUpdate:menu":U[0]||(U[0]=D=>P(E(a)))},be({selection:w(({item:D})=>[p(T,{closable:"","onClick:close":q=>l(D.value)},{default:w(()=>[K(M(D.value),1)]),_:2},1032,["onClick:close"])]),_:2},[r.modelValue.length!==0?{name:"details",fn:w(()=>[h("p",{class:"cursor-pointer text-red",onClick:n},"全部刪除")]),key:"0"}:void 0]),1032,["model-value","items","label","hide-details","hide-selected"])):r.searchable?(_(),j(e,{key:1,ref_key:"autocompleteComponent",ref:i,"model-value":r.modelValue,items:f.value,"hide-details":r.hideDetails,label:r.label,multiple:"","hide-selected":!r.showSelected,"clear-on-select":"","onUpdate:modelValue":v,"onUpdate:menu":U[1]||(U[1]=D=>P(E(i)))},be({selection:w(({item:D})=>[p(T,{closable:"","onClick:close":q=>l(D.value)},{default:w(()=>[K(M(D.value),1)]),_:2},1032,["onClick:close"])]),_:2},[r.modelValue.length!==0?{name:"details",fn:w(()=>[h("p",{class:"cursor-pointer text-red",onClick:n},"全部刪除")]),key:"0"}:void 0]),1032,["model-value","items","hide-details","label","hide-selected"])):(_(),j(m,{key:2,ref_key:"selectComponent",ref:x,"model-value":r.modelValue,items:f.value,"hide-details":r.hideDetails,label:r.label,multiple:"","hide-selected":!r.showSelected,"onUpdate:modelValue":v,"onUpdate:menu":U[2]||(U[2]=D=>P(E(x)))},be({selection:w(({item:D})=>[p(T,{closable:"","onClick:close":q=>l(D.value)},{default:w(()=>[K(M(D.value),1)]),_:2},1032,["onClick:close"])]),_:2},[r.modelValue.length!==0?{name:"details",fn:w(()=>[h("p",{class:"cursor-pointer text-red",onClick:n},"全部刪除")]),key:"0"}:void 0]),1032,["model-value","items","hide-details","label","hide-selected"]))}}}),nt=at(0),kt=ve(0),je=ve(2);class Ce{constructor({type:t,name:a}){J(this,"_name");J(this,"_type");this._type=t,this._name=a}get name(){return this._name}get type(){return this._type}calculateRangePointsCost(t,a){const i=[];for(let l=t;l<=a;l++){const v=je(l/this.calculatePoints(l));isNaN(v)||v===1/0||v===-1/0||i.push(v)}i.sort((l,v)=>l-v);const x=i[i.length-1],u=i[0];if(x===void 0||u===void 0)throw new Error("cannot be calculated");const f=i.reduce((l,v)=>l+v,0)/i.length;return{max:x,min:u,average:je(f)}}}class St extends Ce{constructor({pointBackRates:a,...i}){super(i);J(this,"_pointBackRates");this._pointBackRates=a}get _maxRete(){return this._pointBackRates.reduce((a,{rate:i})=>a+i,0)}get pointBackRates(){return this._pointBackRates}get description(){return`消費${this._pointBackRates.length>1?"最高":""}${this._maxRete.toString()}%回饋點數(四捨五入)`}calculatePoints(a){let i=0;for(const{rate:x,limit:u}of this._pointBackRates)i+=Math.min(kt(a*(x/100)),u??1/0);return i}toJSON(){return{name:this._name,type:this._type,pointBackRates:this._pointBackRates}}}class Ct extends Ce{constructor({pointBackRates:a,...i}){super(i);J(this,"_pointBackRates");this._pointBackRates=a}get _maxRete(){return this._pointBackRates.reduce((a,{rate:i})=>a+i,0)}get pointBackRates(){return this._pointBackRates}get description(){return`消費${this._pointBackRates.length>1?"最高":""}${this._maxRete.toString()}%回饋點數(無條件捨去)`}calculatePoints(a){let i=0;for(const{rate:x,limit:u}of this._pointBackRates)i+=Math.min(nt(a*(x/100)),u??1/0);return i}toJSON(){return{name:this._name,type:this._type,pointBackRates:this._pointBackRates}}}class Rt extends Ce{constructor({spendingPerPoint:a,...i}){super({...i});J(this,"_spendingPerPoint");this._spendingPerPoint=a}get spendingPerPoint(){return this._spendingPerPoint}get description(){return`每消費${this._spendingPerPoint.toString()}元累積1點 (小數會累計)`}calculatePoints(a){return je(a/this._spendingPerPoint)}toJSON(){return{name:this._name,type:this._type,spendingPerPoint:this._spendingPerPoint}}}class Et extends Ce{constructor({spendingPerPoint:a,...i}){super({...i});J(this,"_spendingPerPoint");this._spendingPerPoint=a}get spendingPerPoint(){return this._spendingPerPoint}get description(){return`每消費${this._spendingPerPoint.toString()}元累積1點 (小數不累計)`}calculatePoints(a){return nt(a/this._spendingPerPoint)}toJSON(){return{name:this._name,type:this._type,spendingPerPoint:this._spendingPerPoint}}}const Bt={RoundedPercentageReward:St,TruncatedPercentageReward:Ct,AccumulatedPointsReward:Rt,FixedRatePointsReward:Et};function lt(c){return new Bt[c.type](c)}class Ut{constructor(t,a,i,x){J(this,"_name");J(this,"_description");J(this,"_rewards");J(this,"_condition");if(this._name=t,this._description=a,this._condition=i,x.length===0)throw new Error(`Plan "${t??"unknown"}" must have at least one reward rule.`);this._rewards=x}get name(){return this._name}get description(){return this._description}get storeList(){return He(this._rewards.flatMap(t=>[...t.stores,...t.storeBlackList]))}checkPlanIsVisible(t){return this._condition===null||!!(t!=null&&t.includes(this._condition))}getApplicableReward({transactionStore:t=null,acceptedPayments:a=[],transactionAttributesType:i,currentConditions:x=null}){return this._condition!==null&&!(x!=null&&x.includes(this._condition))?null:this._rewards.find(({stores:u,payments:f,transactionType:l,paymentBlackList:v,storeBlackList:P,condition:n})=>{const r=t===null||u.size===0||u.has(t),U=t===null||P.size===0||!P.has(t),T=a.length===0||f.size===0||a.some(D=>f.has(D)),$=a.length===0||v.size===0||a.some(D=>!v.has(D)),e=l===null||i===l,m=n===null||!!(x!=null&&x.includes(n));return r&&U&&T&&$&&e&&m})??null}getRewardMiles({transactionStore:t,acceptedPayments:a,amount:i,transactionAttributesType:x,currentConditions:u}){const f=this.getApplicableReward({acceptedPayments:a,transactionStore:t,transactionAttributesType:x,currentConditions:u});if(f===null)return null;const l=a===void 0?[...f.payments.values()]:a.filter(P=>f.payments.has(P));return f.rewardStrategy.calculatePoints(i)===0?null:{rewardName:f.rewardStrategy.name,rewardPoints:f.rewardStrategy.calculatePoints(i),payments:l.filter(P=>!f.paymentBlackList.has(P)),rewardStrategy:f.rewardStrategy}}toJSON(){return{name:this._name,description:this._description,condition:this._condition,rewards:this._rewards.map(({rewardStrategy:t,stores:a,payments:i,transactionType:x,paymentBlackList:u,storeBlackList:f,condition:l})=>({rewardStrategy:t.toJSON(),stores:[...a],storeBlackList:[...f],payments:[...i],paymentBlackList:[...u],transactionType:x,condition:l}))}}}const Ae=["信用卡","Apple Pay","Samsung Pay","Google Pay","Line Pay","Fitbit Pay","Garmin Pay","Hami Pay","街口支付","全盈+PAY","全支付","Pi錢包","橘子支付","歐付寶","icash pay","OPEN錢包","My FamiPay","悠遊付","ezPay","GOMAJI Pay","friday wallet","PayPal","PX Pay","中油Pay","台灣Pay","支付寶"];class Vt{constructor({name:t,description:a,plans:i,storeBlackList:x,paymentBlackList:u,cardUrl:f,updateAt:l,pointExchanges:v,selectedPlanId:P,selectedPointExchangeId:n}){J(this,"_selectedPlanId");J(this,"_selectedPointExchangeId");J(this,"_name");J(this,"_description");J(this,"_plans");J(this,"_cardUrl");J(this,"_storeBlackList");J(this,"_paymentBlackList");J(this,"_updateAt");J(this,"_pointExchanges");this._name=t,this._description=a,this._plans=i,this._cardUrl=f,this._storeBlackList=x,this._paymentBlackList=u,this._updateAt=l,this._pointExchanges=v;const r=P??this._plans.keys().next().value??null;if(r===null)throw new Error(`this plan id ${r} not found`);this._selectedPlanId=r;const U=n??this._pointExchanges.keys().next().value??null;if(U===null)throw new Error(`this point exchange id ${U} not found`);this._selectedPointExchangeId=U}get name(){return this._name}get description(){return this._description}get selectedPlanId(){return this._selectedPlanId}get selectedPlan(){return this._getPlan(this._selectedPlanId)}get selectedPointExchangeId(){return this._selectedPointExchangeId}get selectedPointExchange(){return this._getPointExchangeStrategy(this._selectedPointExchangeId)}get selectablePlan(){return[...this._plans.entries()].map(([t,{name:a,description:i}])=>({id:t,name:a,description:i}))}get selectablePointExchange(){return[...this._pointExchanges.entries()].map(([t,{name:a,description:i}])=>({id:t,name:a,description:i}))}get storeList(){return He([...[...this._plans.values()].flatMap(t=>t.storeList),...this._storeBlackList])}get cardUrl(){return this._cardUrl}_getPlan(t){const a=this._plans.get(t);if(a===void 0)throw new Error(`plan id ${t} not found. Available plans: ${[...this._plans.keys()].join(", ")}`);return a}_getPointExchangeStrategy(t){const a=this._pointExchanges.get(t);if(a===void 0)throw new Error(`pointExchangeStrategy id ${t} not found. Available pointExchanges: ${[...this._plans.keys()].join(", ")}`);return a}_rewardMilesWithPlan(t,a,i){var n;const x=this._getPlan(t),u=this._getPointExchangeStrategy(a),f={planId:t,planName:x.name,rewardName:null,rewardPoints:0,payments:[],rewardStrategy:null,pointExchangeStrategy:u,pointExchangeName:u.name,airlineCode:u.airlineCode,miles:0},l=i.transactionStore!==void 0&&this._storeBlackList.has(i.transactionStore),v=(n=i.acceptedPayments)==null?void 0:n.some(r=>this._paymentBlackList.has(r));if(l||v)return f;const P=x.getRewardMiles(i);return P===null?f:{planId:t,planName:x.name,pointExchangeStrategy:u,pointExchangeName:u.name,miles:u.calculateMiles(P.rewardPoints),airlineCode:u.airlineCode,...P}}getRewardInfos(t,{onlyCurrentPlan:a=!1,onlyCurrentExchangeStrategy:i=!1}={}){const x=a?[[this._selectedPlanId,this.selectedPlan]]:[...this._plans.entries()],u=i?[this._selectedPointExchangeId]:[...this._pointExchanges.keys()],f=[];for(const[l,v]of x)if(v.checkPlanIsVisible(t.currentConditions??null))for(const n of u){const r=this._rewardMilesWithPlan(l,n,t);f.push(r)}return f}toJSON(){return{name:this._name,description:this._description,cardUrl:this._cardUrl,storeBlackList:[...this._storeBlackList],paymentBlackList:[...this._paymentBlackList],selectedPlanId:this._selectedPlanId,plans:[...this._plans].map(([t,a])=>({id:t,config:a.toJSON()})),updateAt:this._updateAt.toISOString(),selectedPointExchangeId:this._selectedPointExchangeId,pointExchanges:[...this._pointExchanges].map(([t,a])=>({id:t,config:a.toJSON()}))}}}const Lt=ve(2);class Tt{constructor({name:t,airlineCode:a,pointsPerMile:i,milesPerUnit:x}){J(this,"_name");J(this,"_airlineCode");J(this,"_pointsPerMile");J(this,"_milesPerUnit");this._name=t,this._airlineCode=a,this._pointsPerMile=i,this._milesPerUnit=x}get name(){return this._name}get description(){return`${this._pointsPerMile}點可以交換${this._milesPerUnit}哩程`}get airlineCode(){return this._airlineCode}get pointsPerMile(){return this._pointsPerMile}get milesPerUnit(){return this._milesPerUnit}calculateMiles(t){return Lt(t*this._milesPerUnit/this._pointsPerMile)}toJSON(){return{name:this._name,airlineCode:this._airlineCode,pointsPerMile:this._pointsPerMile,milesPerUnit:this._milesPerUnit}}}function qe({name:c,description:t,storeBlackList:a,paymentBlackList:i,cardUrl:x,plans:u,updateAt:f,pointExchanges:l,selectedPlanId:v,selectedPointExchangeId:P}){const n=new Map(u.map(({id:r,config:{name:U,description:T,condition:$,rewards:e}})=>[r,new Ut(U,T??null,$??null,e.map(({stores:m,payments:D,transactionType:q,rewardStrategy:G,paymentBlackList:C,storeBlackList:S,condition:I})=>({rewardStrategy:lt(G),stores:new Set(m),storeBlackList:new Set(S),payments:new Set(D),paymentBlackList:new Set(C),transactionType:q??null,condition:I??null})))]));return new Vt({name:c,description:t??null,plans:n,storeBlackList:new Set(a),paymentBlackList:new Set(i),cardUrl:x,updateAt:new Date(f),selectedPlanId:v??null,selectedPointExchangeId:P??null,pointExchanges:new Map(l.map(({id:r,config:U})=>[r,new Tt(U)]))})}const Ze=(()=>{const c=new Set(["信用卡","Apple Pay","Samsung Pay","Google Pay","Line Pay","Fitbit Pay","Garmin Pay","Hami Pay","街口支付","全盈+PAY","全支付","Pi錢包","橘子支付","歐付寶","icash pay","OPEN錢包","My FamiPay","悠遊付","ezPay","GOMAJI Pay","friday wallet","PayPal","PX Pay","中油Pay","台灣Pay","支付寶"]),t=new Set(["信用卡","Apple Pay","Samsung Pay","Google Pay","Line Pay","Fitbit Pay","Garmin Pay","Hami Pay","街口支付","全盈+PAY","全支付","Pi錢包","橘子支付","歐付寶","icash pay","OPEN錢包","My FamiPay","悠遊付","ezPay","GOMAJI Pay","friday wallet","PayPal","PX Pay","中油Pay","台灣Pay","支付寶"]),a=new Set(["信用卡","Apple Pay","Samsung Pay","Google Pay","Line Pay","Fitbit Pay","Garmin Pay","Hami Pay","街口支付","全盈+PAY","全支付","Pi錢包","橘子支付","歐付寶","icash pay","OPEN錢包","My FamiPay","悠遊付","ezPay","GOMAJI Pay","friday wallet","PayPal","PX Pay","中油Pay","台灣Pay","支付寶"]),i=e=>typeof e.name=="string"&&(e.description===null||e.description===void 0||typeof e.description=="string")&&(e.cardUrl===null||typeof e.cardUrl=="string")&&(e.storeBlackList===void 0||Array.isArray(e.storeBlackList)&&e.storeBlackList.every(m=>typeof m=="string"))&&(e.paymentBlackList===void 0||Array.isArray(e.paymentBlackList)&&e.paymentBlackList.every(m=>c.has(m)===!0))&&(e.selectedPlanId===void 0||typeof e.selectedPlanId=="string"&&RegExp(/(.*)\x2d(.*)\x2d(.*)\x2d(.*)\x2d(.*)/).test(e.selectedPlanId))&&Array.isArray(e.plans)&&e.plans.every(m=>typeof m=="object"&&m!==null&&x(m))&&typeof e.updateAt=="string"&&RegExp(/^[+-]?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?\x2d[+-]?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?\x2d[+-]?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?T[+-]?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?:[+-]?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?:[+-]?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?\.[+-]?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?Z$/).test(e.updateAt)&&(e.selectedPointExchangeId===void 0||typeof e.selectedPointExchangeId=="string"&&RegExp(/(.*)\x2d(.*)\x2d(.*)\x2d(.*)\x2d(.*)/).test(e.selectedPointExchangeId))&&Array.isArray(e.pointExchanges)&&e.pointExchanges.every(m=>typeof m=="object"&&m!==null&&U(m)),x=e=>typeof e.id=="string"&&RegExp(/(.*)\x2d(.*)\x2d(.*)\x2d(.*)\x2d(.*)/).test(e.id)&&typeof e.config=="object"&&e.config!==null&&u(e.config),u=e=>(e.name===null||typeof e.name=="string")&&(e.description===null||e.description===void 0||typeof e.description=="string")&&Array.isArray(e.rewards)&&e.rewards.every(m=>typeof m=="object"&&m!==null&&f(m))&&(e.condition===null||e.condition===void 0||e.condition==="Birthday"),f=e=>typeof e.rewardStrategy=="object"&&e.rewardStrategy!==null&&$(e.rewardStrategy)&&(e.transactionType===null||e.transactionType===void 0||e.transactionType==="Domestic"||e.transactionType==="Foreign")&&(e.stores===void 0||Array.isArray(e.stores)&&e.stores.every(m=>typeof m=="string"))&&(e.storeBlackList===void 0||Array.isArray(e.storeBlackList)&&e.storeBlackList.every(m=>typeof m=="string"))&&(e.payments===void 0||Array.isArray(e.payments)&&e.payments.every(m=>t.has(m)===!0))&&(e.paymentBlackList===void 0||Array.isArray(e.paymentBlackList)&&e.paymentBlackList.every(m=>a.has(m)===!0))&&(e.condition===null||e.condition===void 0||e.condition==="Birthday"),l=e=>Array.isArray(e.pointBackRates)&&e.pointBackRates.every(m=>typeof m=="object"&&m!==null&&v(m))&&(e.name===null||typeof e.name=="string")&&e.type==="RoundedPercentageReward",v=e=>typeof e.rate=="number"&&(e.limit===null||e.limit===void 0||typeof e.limit=="number"),P=e=>Array.isArray(e.pointBackRates)&&e.pointBackRates.every(m=>typeof m=="object"&&m!==null&&v(m))&&(e.name===null||typeof e.name=="string")&&e.type==="TruncatedPercentageReward",n=e=>typeof e.spendingPerPoint=="number"&&(e.name===null||typeof e.name=="string")&&e.type==="AccumulatedPointsReward",r=e=>typeof e.spendingPerPoint=="number"&&(e.name===null||typeof e.name=="string")&&e.type==="FixedRatePointsReward",U=e=>typeof e.id=="string"&&RegExp(/(.*)\x2d(.*)\x2d(.*)\x2d(.*)\x2d(.*)/).test(e.id)&&typeof e.config=="object"&&e.config!==null&&T(e.config),T=e=>typeof e.name=="string"&&typeof e.airlineCode=="string"&&typeof e.pointsPerMile=="number"&&typeof e.milesPerUnit=="number",$=e=>e.type==="TruncatedPercentageReward"?P(e):e.type==="RoundedPercentageReward"?l(e):e.type==="FixedRatePointsReward"?r(e):e.type==="AccumulatedPointsReward"?n(e):!1;return e=>typeof e=="object"&&e!==null&&i(e)})(),It=(()=>{const c=new Set(["信用卡","Apple Pay","Samsung Pay","Google Pay","Line Pay","Fitbit Pay","Garmin Pay","Hami Pay","街口支付","全盈+PAY","全支付","Pi錢包","橘子支付","歐付寶","icash pay","OPEN錢包","My FamiPay","悠遊付","ezPay","GOMAJI Pay","friday wallet","PayPal","PX Pay","中油Pay","台灣Pay","支付寶"]),t=new Set(["信用卡","Apple Pay","Samsung Pay","Google Pay","Line Pay","Fitbit Pay","Garmin Pay","Hami Pay","街口支付","全盈+PAY","全支付","Pi錢包","橘子支付","歐付寶","icash pay","OPEN錢包","My FamiPay","悠遊付","ezPay","GOMAJI Pay","friday wallet","PayPal","PX Pay","中油Pay","台灣Pay","支付寶"]),a=n=>(n.name===null||typeof n.name=="string")&&(n.description===null||n.description===void 0||typeof n.description=="string")&&Array.isArray(n.rewards)&&n.rewards.every(r=>typeof r=="object"&&r!==null&&i(r))&&(n.condition===null||n.condition===void 0||n.condition==="Birthday"),i=n=>typeof n.rewardStrategy=="object"&&n.rewardStrategy!==null&&P(n.rewardStrategy)&&(n.transactionType===null||n.transactionType===void 0||n.transactionType==="Domestic"||n.transactionType==="Foreign")&&(n.stores===void 0||Array.isArray(n.stores)&&n.stores.every(r=>typeof r=="string"))&&(n.storeBlackList===void 0||Array.isArray(n.storeBlackList)&&n.storeBlackList.every(r=>typeof r=="string"))&&(n.payments===void 0||Array.isArray(n.payments)&&n.payments.every(r=>c.has(r)===!0))&&(n.paymentBlackList===void 0||Array.isArray(n.paymentBlackList)&&n.paymentBlackList.every(r=>t.has(r)===!0))&&(n.condition===null||n.condition===void 0||n.condition==="Birthday"),x=n=>Array.isArray(n.pointBackRates)&&n.pointBackRates.every(r=>typeof r=="object"&&r!==null&&u(r))&&(n.name===null||typeof n.name=="string")&&n.type==="RoundedPercentageReward",u=n=>typeof n.rate=="number"&&(n.limit===null||n.limit===void 0||typeof n.limit=="number"),f=n=>Array.isArray(n.pointBackRates)&&n.pointBackRates.every(r=>typeof r=="object"&&r!==null&&u(r))&&(n.name===null||typeof n.name=="string")&&n.type==="TruncatedPercentageReward",l=n=>typeof n.spendingPerPoint=="number"&&(n.name===null||typeof n.name=="string")&&n.type==="AccumulatedPointsReward",v=n=>typeof n.spendingPerPoint=="number"&&(n.name===null||typeof n.name=="string")&&n.type==="FixedRatePointsReward",P=n=>n.type==="TruncatedPercentageReward"?f(n):n.type==="RoundedPercentageReward"?x(n):n.type==="FixedRatePointsReward"?v(n):n.type==="AccumulatedPointsReward"?l(n):!1;return n=>typeof n=="object"&&n!==null&&a(n)})(),$t=(()=>{const c=t=>typeof t.name=="string"&&typeof t.airlineCode=="string"&&typeof t.pointsPerMile=="number"&&typeof t.milesPerUnit=="number";return t=>typeof t=="object"&&t!==null&&c(t)})(),ce=ye("2025/6/30");function ye(c,t){return`權益 ~${xt(c,"yyyy/M/d")}`}const Ee=["分期付款"],Be=[],Ue=["信用卡","Apple Pay","Samsung Pay","Google Pay","Fitbit Pay","Garmin Pay","Hami Pay"];function Ve(c){const t={rewardStrategy:{type:"RoundedPercentageReward",name:null,pointBackRates:[{rate:.3}]}};return[{id:N(),config:{name:"集精選",description:"量販超市, 指定加油, 指定超商, 生活家居",rewards:[{rewardStrategy:{type:"RoundedPercentageReward",name:null,pointBackRates:[{rate:2}]},stores:["家樂福","LOPIA台灣","全聯福利中心","台灣中油-直營","7-ELEVEN","全家便利商店","IKEA"],payments:[...Ue,"PX Pay","My FamiPay","OPEN錢包"]},t]}},{id:N(),config:{name:"玩數位",description:"數位/串流平台, 網購平台, 國際電商, 辦公神器",rewards:[{rewardStrategy:{type:"RoundedPercentageReward",name:null,pointBackRates:[{rate:c}]},stores:["App Store","Apple Music","iCloud","Apple TV+","Apple Arcade","Apple One","iTunes","Google Play","Disney+","Netflix","Spotify","KKBOX","YouTube Premium","Max","蝦皮購物","momo購物網","PChome 24h購物(不含儲值及電子票券)","小樹購","Coupang 酷澎(台灣)","淘寶/天貓","ChatGPT","Dropbox","Surfshark","NordVPN","McAfee","Microsoft","LinkedIn","Whoscall","Zoom"],paymentBlackList:["Line Pay","街口支付"]},{...t,storeBlackList:["全聯福利中心"]}]}},{id:N(),config:{name:"樂饗購",description:"國內指定百貨, 國內外送平台, 國內餐飲, 國內藥妝",rewards:[{rewardStrategy:{type:"RoundedPercentageReward",name:null,pointBackRates:[{rate:c}]},stores:["遠東SOGO百貨","遠東Garden City","太平洋百貨","新光三越","SKM Park","BELLAVITA","微風廣場","遠東百貨","Big City遠東巨城購物中心","誠品生活","環球購物中心","CITYLINK","統一時代","台北101","ATT 4 FUN","明曜百貨","京站","美麗華","大葉高島屋","比漾廣場","大江國際購物中心","中友百貨","廣三SOGO","Tiger City","勤美誠品綠園道","大魯閣新時代","耐斯廣場","南紡購物中心","夢時代","漢神百貨","漢神巨蛋","MITSUI OUTLET PARK 林口","MITSUI OUTLET PARK 台中港","MITSUI OUTLET PARK 台南","Mitsui Shopping Park LaLaport 台中","義大世界購物廣場","華泰名品城","義享天地","麗寶OUTLET Mall","秀泰生活","台茂購物中心","新月廣場","三創生活","宏匯廣場","NOKE忠泰樂生活","Uber Eats","foodpanda","foodomo","國內餐飲(不含餐券)","麥當勞","康是美","屈臣氏"],payments:Ue},{...t,storeBlackList:["全聯福利中心"]}]}},{id:N(),config:{name:"趣旅行",description:"指定海外消費, 日本指定遊樂園, 國內外交通, 指定航空公司, 指定飯店住宿, 旅遊/訂房平台, 指定旅行社",rewards:[{rewardStrategy:{type:"RoundedPercentageReward",name:null,pointBackRates:[{rate:c}]},stores:["海外實體消費","東京迪士尼樂園","東京華納兄弟哈利波特影城","大阪環球影城(USJ)","Apple Wallet SUICA","Apple Wallet PASMO","Apple Wallet ICOCA","Uber","Grab","台灣高鐵","yoxi","台灣大車隊","iRent","和運租車","格上租車","中華航空","長榮航空","星宇航空","台灣虎航","國泰航空","樂桃航空","阿聯酋航空","酷航","捷星航空","日本航空","亞洲航空","聯合航空","ANA全日空","新加坡航空","越捷航空","大韓航空","達美航空","土耳其航空","卡達航空","法國航空","國內飯店住宿","星野集團","全球迪士尼飯店","東橫INN","KKday","Agoda","Klook","Airbnb","Hotels.com","Expedia","Booking.com","Trip.com","AsiaYo","ezTravel易遊網","雄獅旅遊","可樂旅遊","東南旅遊","五福旅遊","燦星旅遊","山富旅遊","長汎假期","鳳凰旅行社","Ezfly易飛網","理想旅遊","永利旅行社","三賀旅行社"],payments:Ue},{...t,storeBlackList:["全聯福利中心"]}]}},{id:N(),config:{name:"來支付",description:"LINE Pay消費",rewards:[{rewardStrategy:{type:"RoundedPercentageReward",name:null,pointBackRates:[{rate:2}]},payments:["Line Pay"]},{...t,storeBlackList:["全聯福利中心"]}]}},{id:N(),config:{name:"慶生月",description:"指定百貨/休閒娛樂/國內外送平台 3.5%, 國外精選遊樂園實體消費/國內人氣樂園/指定蛋糕甜點店/指定咖啡廳/指定國內餐廳/KTV/派對/電玩 10%",condition:"Birthday",rewards:[{rewardStrategy:{type:"RoundedPercentageReward",name:null,pointBackRates:[{rate:10}]},stores:["東京迪士尼樂園","大阪環球影城(USJ)","名古屋樂高樂園","紅葉蛋糕官方網站","法朋烘焙甜點坊","興波咖啡 華山旗艦店","海底撈火鍋","輕井澤鍋物","老四川巴蜀麻辣燙","二本松涮涮屋","橋山.壽喜燒","Umai屋馬燒肉","老井極上燒肉","燒肉中山(台中大墩)","藏壽司台灣","貳樓","膳馨民間創作料理","馨苑小料理","雅室牛排 仁愛圓環店","ABV餐飲集團","WAT","臺虎精釀(信義 | 西門 | 臺中 | 啜飲室大安)","BAR Bodega","BAR MED","JiN Her 今鶴","錢櫃KTV","好樂迪KTV","星聚點KTV","享溫馨KTV","Nintendo","巴哈姆特動畫瘋","閃動格子CyberCube"]},{rewardStrategy:{type:"RoundedPercentageReward",name:null,pointBackRates:[{rate:3.5}]},stores:["新光三越","Uber Eats (不含 Uber One)","Agoda","Trip.com","Klook","國內飯店住宿","星野集團","全球迪士尼飯店","東橫INN"]},{...t,storeBlackList:["全聯福利中心"]}]}}]}const Le=[{id:N(),config:{name:"長榮航空哩程",airlineCode:"EVA",pointsPerMile:360,milesPerUnit:1e3}},{id:N(),config:{name:"長榮航空哩程 + 長榮世界卡",airlineCode:"EVA",pointsPerMile:300,milesPerUnit:1e3}}],ot=[{name:"Cube 卡",description:`Cube 卡 (Level 1) 回饋方案 (${ce})`,cardUrl:"https://www.cathaybk.com.tw/cathaybk/personal/product/credit-card/cards/cube/",storeBlackList:Ee,paymentBlackList:Be,updateAt:"2024-12-01T00:00:00.000Z",plans:Ve(2),pointExchanges:Le},{name:"Cube 卡",description:`Cube 卡 (Level 2) 回饋方案 (${ce})`,cardUrl:"https://www.cathaybk.com.tw/cathaybk/personal/product/credit-card/cards/cube/",storeBlackList:Ee,paymentBlackList:Be,updateAt:"2024-12-01T00:00:00.000Z",plans:Ve(3),pointExchanges:Le},{name:"Cube 卡",description:`Cube 卡 (Level 3) 回饋方案 (${ce})`,cardUrl:"https://www.cathaybk.com.tw/cathaybk/personal/product/credit-card/cards/cube/",storeBlackList:Ee,paymentBlackList:Be,updateAt:"2024-12-01T00:00:00.000Z",plans:Ve(3.3),pointExchanges:Le}],Mt=ot[1];function Te(c){return[{id:N(),config:{name:null,description:"部分回饋需要另外登錄",rewards:[{rewardStrategy:{type:"FixedRatePointsReward",name:`Expedia專屬網頁線上訂房 ${ye("2025/12/31")}`,spendingPerPoint:8},stores:["Expedia"],payments:["Apple Pay","Samsung Pay","Google Pay","Fitbit Pay","Garmin Pay","Hami Pay"]},{rewardStrategy:{type:"FixedRatePointsReward",name:"長榮官網購票/機上免稅品",spendingPerPoint:10},stores:["長榮機上免稅品","長榮官網購票"]},{rewardStrategy:{type:"FixedRatePointsReward",name:"海外消費",spendingPerPoint:10},transactionType:"Foreign"},{rewardStrategy:{type:"FixedRatePointsReward",name:"國內旅行社 (需登錄) 銀行並未公告符合商家",spendingPerPoint:10},transactionType:"Domestic",stores:["雄獅旅遊","可樂旅遊","東南旅遊","五福旅遊","燦星旅遊","山富旅遊","長汎假期","鳳凰旅行社","Ezfly易飛網","理想旅遊","永利旅行社","三賀旅行社"]},{rewardStrategy:{type:"FixedRatePointsReward",name:"國外自由行、團體旅遊 (需登錄) 銀行並未公告符合商家",spendingPerPoint:10},transactionType:"Foreign"},{rewardStrategy:{type:"FixedRatePointsReward",name:"一般消費",spendingPerPoint:c}}]}}]}const we=[{id:N(),config:{name:"長榮航空哩程 (每1000哩為單位自動轉換至哩程帳戶)",airlineCode:"EVA",pointsPerMile:1e3,milesPerUnit:1e3}}],xe=ye("2025/3/31"),st=[{name:"長榮極致無限卡",cardUrl:"https://www.cathaybk.com.tw/cathaybk/personal/product/credit-card/cards/eva/",description:xe,updateAt:"2024-12-29T00:00:00.000Z",plans:Te(20),pointExchanges:we},{name:"長榮無限卡",cardUrl:"https://www.cathaybk.com.tw/cathaybk/personal/product/credit-card/cards/eva/",description:xe,updateAt:"2024-12-29T00:00:00.000Z",plans:Te(22),pointExchanges:we},{name:"長榮極致御璽卡",cardUrl:"https://www.cathaybk.com.tw/cathaybk/personal/product/credit-card/cards/eva/",description:xe,updateAt:"2024-12-29T00:00:00.000Z",plans:Te(30),pointExchanges:we},{name:"長榮御璽卡",cardUrl:"https://www.cathaybk.com.tw/cathaybk/personal/product/credit-card/cards/eva/",description:xe,updateAt:"2024-12-29T00:00:00.000Z",plans:[{id:N(),config:{name:null,description:null,rewards:[{rewardStrategy:{type:"FixedRatePointsReward",name:"一般消費",spendingPerPoint:30}}]}}],pointExchanges:we}],Ot=st[1],ke=["政府稅款","公共事業代扣繳","交通違規罰鍰","分期付款","全聯福利中心","7-ELEVEN","全家便利商店"],Se=[];function Ie(c){return{rewardStrategy:{type:"FixedRatePointsReward",name:"指定通路里程加速",spendingPerPoint:c},transactionType:"Domestic",stores:["星宇航空官方網站/App購票","星宇航空形象門市","béshopping","星宇航空國際航線機上免稅品"]}}const Nt=[{name:"星宇世界卡",description:ye("2025/2/28"),cardUrl:"https://www.esunbank.com/zh-tw/personal/credit-card/intro/co-branded-card/starlux-card",storeBlackList:ke,paymentBlackList:Se,pointExchanges:[{id:N(),config:{name:"星宇航空哩程",airlineCode:"SJX",pointsPerMile:1,milesPerUnit:1}}],plans:[{id:N(),config:{name:null,rewards:[{rewardStrategy:{type:"FixedRatePointsReward",name:"國外消費 (生日兩倍)",spendingPerPoint:5},transactionType:"Foreign",condition:"Birthday"},Ie(5),{rewardStrategy:{type:"FixedRatePointsReward",name:"國外消費",spendingPerPoint:10},transactionType:"Foreign"},{rewardStrategy:{type:"FixedRatePointsReward",name:"國內消費",spendingPerPoint:20},transactionType:"Domestic"}]}}],updateAt:new Date("2025/01/12 22:00:00").toISOString()},{name:"星宇商務鈦金卡",description:ye("2025/2/28"),cardUrl:"https://www.esunbank.com/zh-tw/personal/credit-card/intro/co-branded-card/starlux-card",storeBlackList:ke,paymentBlackList:Se,pointExchanges:[{id:N(),config:{name:"星宇航空哩程",airlineCode:"SJX",pointsPerMile:1,milesPerUnit:1}}],plans:[{id:N(),config:{name:null,rewards:[{rewardStrategy:{type:"FixedRatePointsReward",name:"國外消費",spendingPerPoint:7.5},transactionType:"Foreign",condition:"Birthday"},Ie(7.5),{rewardStrategy:{type:"FixedRatePointsReward",name:"國外消費",spendingPerPoint:15},transactionType:"Foreign"},{rewardStrategy:{type:"FixedRatePointsReward",name:"國內消費",spendingPerPoint:25},transactionType:"Domestic"}]}}],updateAt:new Date("2025/01/12 22:00:00").toISOString()},{name:"星宇鈦金卡",description:ye("2025/2/28"),cardUrl:"https://www.esunbank.com/zh-tw/personal/credit-card/intro/co-branded-card/starlux-card",storeBlackList:ke,paymentBlackList:Se,pointExchanges:[{id:N(),config:{name:"星宇航空哩程",airlineCode:"SJX",pointsPerMile:1,milesPerUnit:1}}],plans:[{id:N(),config:{name:null,rewards:[Ie(10),{rewardStrategy:{type:"FixedRatePointsReward",name:"國外消費",spendingPerPoint:20},transactionType:"Foreign"},{rewardStrategy:{type:"FixedRatePointsReward",name:"國內消費",spendingPerPoint:28},transactionType:"Domestic"}]}}],updateAt:new Date("2025/01/12 22:00:00").toISOString()}],$e=["台灣中油","台灣大車隊","台鐵","台灣高鐵","UBER","Yoxi","桃園機場捷運","新光三越","遠東百貨","遠東SOGO百貨","Big City遠東巨城購物中心","漢神百貨","微風廣場","微風信義","微風南京","微風南山","微風台北車站","台北101","華泰名品城","MITSUI OUTLET PARK 林口","MITSUI OUTLET PARK 台中港","MITSUI OUTLET PARK 台南","京站","美麗華","誠品生活","秀泰生活","Mitsui Shopping Park LaLaport 台中","統領廣場","太平洋百貨","統一時代百貨(台北店)","昇恆昌","采盟","Uber Eats","foodpanda","EZTABLE","王品瘋美食","摩斯漢堡","漢來美食","饗Joy","饗食天堂","果然匯","小福利","饗饗","旭集","開飯","饗泰多","真珠","瓦城","非常泰","大心","1010","時時香","BOBO","乾杯集團","路易莎","中華航空","長榮航空","日本航空","台灣虎航","樂桃航空","酷航","立榮航空","華信航空","Trip.com","booking.com","Hotels.com","AsiaYo","Expedia","KKday","Klook","雄獅旅遊","可樂旅遊","東南旅行社","Apple直營店","小米台灣","全國電子","燦坤","迪卡儂","寵物公園","家家樂","屈臣氏","特力屋","特力和樂","UNIQLO","NET","大樹藥局","丁丁藥妝","momo購物網","蝦皮購物","淘寶網","Coupang酷澎","東森購物","博客來","日本實體店","韓國實體店","泰國實體店","越南實體店","新加坡實體店","馬來西亞實體店","菲律賓實體店","中國實體店","香港實體店","澳門實體店","美國實體店","加拿大實體店","英國實體店","法國實體店","德國實體店","義大利實體店","澳洲實體店","玉山Wallet愛心捐款-單筆捐款","玉山Wallet愛心捐款-定期定額","特斯拉","Gogoro電池資費","YouBike 2.0"],Me=["Line Pay","街口支付","悠遊付","全盈+PAY","全支付","橘子支付"],Oe={rewardStrategy:{type:"RoundedPercentageReward",name:null,pointBackRates:[{rate:.3},{rate:.7}]}},rt=[{name:"UniCard 卡",description:ce,cardUrl:"https://www.esunbank.com/zh-tw/personal/credit-card/intro/bank-card/unicard",storeBlackList:ke,paymentBlackList:Se,pointExchanges:[{id:N(),config:{name:"長榮航空哩程",airlineCode:"EVA",pointsPerMile:200,milesPerUnit:300}}],plans:[{id:N(),config:{name:"任意選 (需要切換店家)",description:"玉山Wallet設定8家特店",rewards:[{rewardStrategy:{type:"RoundedPercentageReward",name:null,pointBackRates:[{rate:.3},{rate:.7},{rate:2.5,limit:500}]},stores:$e,payments:["信用卡","Apple Pay","Samsung Pay","Google Pay"]},{rewardStrategy:{type:"RoundedPercentageReward",name:null,pointBackRates:[{rate:.3},{rate:.7},{rate:2.5,limit:500}]},payments:Me},Oe]}},{id:N(),config:{name:"簡單選",rewards:[{rewardStrategy:{type:"RoundedPercentageReward",name:null,pointBackRates:[{rate:.3},{rate:.7},{rate:2,limit:500}]},stores:$e,payments:["信用卡","Apple Pay","Samsung Pay","Google Pay"]},{rewardStrategy:{type:"RoundedPercentageReward",name:null,pointBackRates:[{rate:.3},{rate:.7},{rate:2,limit:500}]},payments:Me},Oe]}},{id:N(),config:{name:"UP選",description:"完成指定任務或99點玉山e point訂閱",rewards:[{rewardStrategy:{type:"RoundedPercentageReward",name:null,pointBackRates:[{rate:.3},{rate:.7},{rate:3.5,limit:2e3}]},stores:$e,payments:["信用卡","Apple Pay","Samsung Pay","Google Pay"]},{rewardStrategy:{type:"RoundedPercentageReward",name:null,pointBackRates:[{rate:.3},{rate:.7},{rate:3.5,limit:2e3}]},payments:Me},Oe]}}],updateAt:new Date("2025/01/12 22:00:00").toISOString()}],Dt=rt[0],Ne=["政府稅款","公共事業代扣繳","交通違規罰鍰","分期付款"],De=["全盈+PAY","icash pay","OPEN錢包","My FamiPay"],it=[{name:"旅人無限卡",description:ce,cardUrl:"https://www.hsbc.com.tw/credit-cards/products/travel/visa-infinite/",storeBlackList:Ne,paymentBlackList:De,pointExchanges:[{id:N(),config:{name:"長榮航空哩程",airlineCode:"EVA",pointsPerMile:1,milesPerUnit:1}}],plans:[{id:N(),config:{name:null,rewards:[{rewardStrategy:{type:"AccumulatedPointsReward",name:"國外消費",spendingPerPoint:10},transactionType:"Foreign"},{rewardStrategy:{type:"AccumulatedPointsReward",name:"國內消費",spendingPerPoint:18},transactionType:"Domestic"}]}}],updateAt:new Date("2024/12/01 00:00:00").toISOString()},{name:"旅人御璽卡",description:ce,cardUrl:"https://www.hsbc.com.tw/credit-cards/products/travel/visa-signature/",storeBlackList:Ne,paymentBlackList:De,pointExchanges:[{id:N(),config:{name:"長榮航空哩程",airlineCode:"EVA",pointsPerMile:1,milesPerUnit:1}}],plans:[{id:N(),config:{name:null,rewards:[{rewardStrategy:{type:"AccumulatedPointsReward",name:"國外消費",spendingPerPoint:15},transactionType:"Foreign"},{rewardStrategy:{type:"AccumulatedPointsReward",name:"國內消費",spendingPerPoint:18},transactionType:"Domestic"}]}}],updateAt:new Date("2024/12/01 00:00:00").toISOString()},{name:"旅人輕旅卡",description:ce,cardUrl:"https://www.hsbc.com.tw/credit-cards/products/travel/visa-light/",storeBlackList:Ne,paymentBlackList:De,pointExchanges:[{id:N(),config:{name:"長榮航空哩程",airlineCode:"EVA",pointsPerMile:1,milesPerUnit:1}}],plans:[{id:N(),config:{name:null,rewards:[{rewardStrategy:{type:"AccumulatedPointsReward",name:"國外消費",spendingPerPoint:20},transactionType:"Foreign"},{rewardStrategy:{type:"AccumulatedPointsReward",name:"國內消費",spendingPerPoint:20},transactionType:"Domestic"}]}}],updateAt:new Date("2024/12/01 00:00:00").toISOString()}],Ft=it[2],Gt=[Ot,Mt,Ft,Dt],Jt=[...st,...ot,...it,...Nt,...rt],Ke=c=>Array.isArray(c)&&c.every(t=>Array.isArray(t)&&t.length===2&&typeof t[0]=="string"&&Array.isArray(t[1])&&t[1].every(a=>typeof a=="string")),dt=[["7-ELEVEN",["7-11","Seven Eleven","統一超商","小7"]],["ANA全日空",["ANA","全日空","All Nippon Airways","NH"]],["ATT 4 FUN",["ATT4FUN","ATT信義"]],["App Store",["蘋果應用商店"]],["Apple Arcade",["蘋果遊戲訂閱服務"]],["Apple Music",["蘋果音樂","Apple音樂"]],["Apple One",["蘋果One訂閱"]],["Apple TV+",["Apple TV Plus"]],["Apple Wallet ICOCA",["ICOCA電子票","Apple錢包ICOCA"]],["Apple Wallet PASMO",["PASMO電子票","Apple錢包PASMO"]],["Apple Wallet SUICA",["SUICA電子票","Apple錢包SUICA"]],["CITYLINK",["City Link"]],["Disney+",["Disney Plus","迪士尼+"]],["Google Play",["Google應用商店"]],["Grab",["Grab Taxi","Grab叫車"]],["MITSUI OUTLET PARK 台中港",["三井台中港","三井OUTLET台中"]],["MITSUI OUTLET PARK 台南",["三井台南","三井OUTLET台南"]],["MITSUI OUTLET PARK 林口",["三井林口","三井OUTLET林口"]],["Mitsui Shopping Park LaLaport 台中",["LaLaport台中","三井LaLaport台中"]],["Netflix",["網飛"]],["Nintendo",["任天堂","Switch","老任"]],["PChome 24h購物(不含儲值及電子票券)",["PChome","PChome購物"]],["Tiger City",["老虎城","Tiger City購物中心"]],["Trip.com",["攜程"]],["Uber Eats (不含 Uber One)",["優步外送"]],["foodpanda",["熊貓外送","Food Panda"]],["iCloud",["蘋果雲端","iCloud雲端"]],["iRent",["i Rent"]],["iTunes",["蘋果iTunes"]],["中友百貨",["中友"]],["中華航空",["China Airlines","CAL","CI","華航"]],["亞洲航空",["AirAsia","亞航","AXM","AK"]],["京站",["Q Square","京站商場"]],["全家便利商店",["FamilyMart","全家"]],["全球迪士尼飯店",["Disney Hotels"]],["全聯福利中心",["PX Mart"]],["南紡購物中心",["Tainan Spinnery Mall","南紡"]],["博客來",["Books.com.tw"]],["卡達航空",["Qatar Airways","卡航","QTR","QR"]],["可樂旅遊",["Cola Travel","可樂旅行社"]],["台北101",["Taipei 101","101大樓"]],["台灣中油-直營",["中油直營","直營中油"]],["台灣大車隊",["Taiwan Taxi","大車隊"]],["台灣虎航",["Tigerair Taiwan","台虎","TWA","IT"]],["台灣高鐵",["Taiwan High Speed Rail"]],["台茂購物中心",["TaiMall"]],["吉卜力公園",["Ghibli Park"]],["國泰航空",["Cathay Pacific","國泰","CPA","CX","Cathay Pacific Airways"]],["土耳其航空",["Turkish Airlines","土航","THY","TK"]],["夢時代",["Dream Mall"]],["大阪環球影城(USJ)",["Universal Studios Japan"]],["大韓航空",["Korean Air","韓航","KAL","KE"]],["大魯閣新時代",["Taroko Mall","大魯閣"]],["太平洋百貨",["Pacific Department Store","太平洋"]],["好樂迪KTV",["Holiday"]],["家樂福",["Carrefour"]],["屈臣氏",["Watsons"]],["康是美",["Cosmed"]],["捷星航空",["JST","JQ","Jetstar Airways"]],["新加坡航空",["SIA","SQ","Singapore Airlines"]],["日本航空",["JAL","JL","Japan Airlines"]],["星宇航空",["starlux","SJX","JX","STARLUX Airlines"]],["樂桃航空",["APJ","MM","Peach Aviation"]],["法國航空",["AFR","AF","Air France"]],["聯合航空",["UAL","UA","United Airlines"]],["蝦皮購物",["shopee"]],["越捷航空",["VJC","VJ","VietJet Air"]],["達美航空",["DAL","DL","Delta Air Lines"]],["遠東百貨",["遠百"]],["酷航",["SCO","TR","Scoot"]],["長榮航空",["EVA","BR","EVA Airlines","EVA Air"]],["阿聯酋航空",["UAE","EK","Emirates"]],["麥當勞",["McDonald's"]],["IKEA",["宜家家居"]],["星巴克",["starbucks"]]],W=new bt(localStorage,{onlyShowCurrentPlan:c=>typeof c=="boolean",onlyShowCurrentPointExchange:c=>typeof c=="boolean",commonPaymentMethods:(()=>{const c=new Set(["信用卡","Apple Pay","Samsung Pay","Google Pay","Line Pay","Fitbit Pay","Garmin Pay","Hami Pay","街口支付","全盈+PAY","全支付","Pi錢包","橘子支付","歐付寶","icash pay","OPEN錢包","My FamiPay","悠遊付","ezPay","GOMAJI Pay","friday wallet","PayPal","PX Pay","中油Pay","台灣Pay","支付寶"]);return t=>Array.isArray(t)&&t.every(a=>c.has(a)===!0)})(),cardConfigs:(()=>{const c=new Set(["信用卡","Apple Pay","Samsung Pay","Google Pay","Line Pay","Fitbit Pay","Garmin Pay","Hami Pay","街口支付","全盈+PAY","全支付","Pi錢包","橘子支付","歐付寶","icash pay","OPEN錢包","My FamiPay","悠遊付","ezPay","GOMAJI Pay","friday wallet","PayPal","PX Pay","中油Pay","台灣Pay","支付寶"]),t=new Set(["信用卡","Apple Pay","Samsung Pay","Google Pay","Line Pay","Fitbit Pay","Garmin Pay","Hami Pay","街口支付","全盈+PAY","全支付","Pi錢包","橘子支付","歐付寶","icash pay","OPEN錢包","My FamiPay","悠遊付","ezPay","GOMAJI Pay","friday wallet","PayPal","PX Pay","中油Pay","台灣Pay","支付寶"]),a=new Set(["信用卡","Apple Pay","Samsung Pay","Google Pay","Line Pay","Fitbit Pay","Garmin Pay","Hami Pay","街口支付","全盈+PAY","全支付","Pi錢包","橘子支付","歐付寶","icash pay","OPEN錢包","My FamiPay","悠遊付","ezPay","GOMAJI Pay","friday wallet","PayPal","PX Pay","中油Pay","台灣Pay","支付寶"]),i=e=>typeof e.name=="string"&&(e.description===null||e.description===void 0||typeof e.description=="string")&&(e.cardUrl===null||typeof e.cardUrl=="string")&&(e.storeBlackList===void 0||Array.isArray(e.storeBlackList)&&e.storeBlackList.every(m=>typeof m=="string"))&&(e.paymentBlackList===void 0||Array.isArray(e.paymentBlackList)&&e.paymentBlackList.every(m=>c.has(m)===!0))&&(e.selectedPlanId===void 0||typeof e.selectedPlanId=="string"&&RegExp(/(.*)\x2d(.*)\x2d(.*)\x2d(.*)\x2d(.*)/).test(e.selectedPlanId))&&Array.isArray(e.plans)&&e.plans.every(m=>typeof m=="object"&&m!==null&&x(m))&&typeof e.updateAt=="string"&&RegExp(/^[+-]?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?\x2d[+-]?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?\x2d[+-]?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?T[+-]?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?:[+-]?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?:[+-]?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?\.[+-]?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?Z$/).test(e.updateAt)&&(e.selectedPointExchangeId===void 0||typeof e.selectedPointExchangeId=="string"&&RegExp(/(.*)\x2d(.*)\x2d(.*)\x2d(.*)\x2d(.*)/).test(e.selectedPointExchangeId))&&Array.isArray(e.pointExchanges)&&e.pointExchanges.every(m=>typeof m=="object"&&m!==null&&U(m)),x=e=>typeof e.id=="string"&&RegExp(/(.*)\x2d(.*)\x2d(.*)\x2d(.*)\x2d(.*)/).test(e.id)&&typeof e.config=="object"&&e.config!==null&&u(e.config),u=e=>(e.name===null||typeof e.name=="string")&&(e.description===null||e.description===void 0||typeof e.description=="string")&&Array.isArray(e.rewards)&&e.rewards.every(m=>typeof m=="object"&&m!==null&&f(m))&&(e.condition===null||e.condition===void 0||e.condition==="Birthday"),f=e=>typeof e.rewardStrategy=="object"&&e.rewardStrategy!==null&&$(e.rewardStrategy)&&(e.transactionType===null||e.transactionType===void 0||e.transactionType==="Domestic"||e.transactionType==="Foreign")&&(e.stores===void 0||Array.isArray(e.stores)&&e.stores.every(m=>typeof m=="string"))&&(e.storeBlackList===void 0||Array.isArray(e.storeBlackList)&&e.storeBlackList.every(m=>typeof m=="string"))&&(e.payments===void 0||Array.isArray(e.payments)&&e.payments.every(m=>t.has(m)===!0))&&(e.paymentBlackList===void 0||Array.isArray(e.paymentBlackList)&&e.paymentBlackList.every(m=>a.has(m)===!0))&&(e.condition===null||e.condition===void 0||e.condition==="Birthday"),l=e=>Array.isArray(e.pointBackRates)&&e.pointBackRates.every(m=>typeof m=="object"&&m!==null&&v(m))&&(e.name===null||typeof e.name=="string")&&e.type==="RoundedPercentageReward",v=e=>typeof e.rate=="number"&&(e.limit===null||e.limit===void 0||typeof e.limit=="number"),P=e=>Array.isArray(e.pointBackRates)&&e.pointBackRates.every(m=>typeof m=="object"&&m!==null&&v(m))&&(e.name===null||typeof e.name=="string")&&e.type==="TruncatedPercentageReward",n=e=>typeof e.spendingPerPoint=="number"&&(e.name===null||typeof e.name=="string")&&e.type==="AccumulatedPointsReward",r=e=>typeof e.spendingPerPoint=="number"&&(e.name===null||typeof e.name=="string")&&e.type==="FixedRatePointsReward",U=e=>typeof e.id=="string"&&RegExp(/(.*)\x2d(.*)\x2d(.*)\x2d(.*)\x2d(.*)/).test(e.id)&&typeof e.config=="object"&&e.config!==null&&T(e.config),T=e=>typeof e.name=="string"&&typeof e.airlineCode=="string"&&typeof e.pointsPerMile=="number"&&typeof e.milesPerUnit=="number",$=e=>e.type==="TruncatedPercentageReward"?P(e):e.type==="RoundedPercentageReward"?l(e):e.type==="FixedRatePointsReward"?r(e):e.type==="AccumulatedPointsReward"?n(e):!1;return e=>Array.isArray(e)&&e.every(m=>typeof m=="object"&&m!==null&&i(m))})(),conditionTypes:c=>Array.isArray(c)&&c.every(t=>t==="Birthday"),aliasType:c=>c==="default"||c==="additional"||c==="custom",customAliases:Ke,acceptedPaymentsWithStore:(()=>{const c=new Set(["信用卡","Apple Pay","Samsung Pay","Google Pay","Line Pay","Fitbit Pay","Garmin Pay","Hami Pay","街口支付","全盈+PAY","全支付","Pi錢包","橘子支付","歐付寶","icash pay","OPEN錢包","My FamiPay","悠遊付","ezPay","GOMAJI Pay","friday wallet","PayPal","PX Pay","中油Pay","台灣Pay","支付寶"]);return t=>Array.isArray(t)&&t.every(a=>Array.isArray(a)&&a.length===2&&typeof a[0]=="string"&&Array.isArray(a[1])&&a[1].every(i=>c.has(i)===!0))})()},"bestMileageCards"),ct=["default","additional","custom"],_e=_t("BestMileageCards",()=>{const c=O(null);function t(g){c.value=g}function a(){c.value=null}et(()=>{const g=W.get("cardConfigs")??[];P.value=new Map(g.map(k=>[N(),k])),G.value=new Map(W.get("acceptedPaymentsWithStore"))});const i=O(W.get("onlyShowCurrentPlan")??!1);function x(g){W.set("onlyShowCurrentPlan",g),i.value=g}const u=O(W.get("onlyShowCurrentPointExchange")??!1);function f(g){W.set("onlyShowCurrentPointExchange",g),u.value=g}const l=O(W.get("commonPaymentMethods")??["信用卡","Apple Pay","Line Pay","街口支付"]);function v(g){g=[...new Set(g)],W.set("commonPaymentMethods",g),l.value=g}const P=O(new Map),n=te(()=>new Map([...P.value.entries()].map(([g,k])=>[g,qe(k)]))),r=te(()=>n.value.size===0?Gt.map(g=>qe(g)):[...n.value.values()]);function U(g,k){P.value.set(g,k),W.set("cardConfigs",[...P.value.values()])}function T(g){P.value.delete(g),W.set("cardConfigs",[...P.value.values()])}function $(g,k){const L=P.value.get(g);if(L===void 0)return!1;try{P.value.set(g,{...L,selectedPlanId:k})}catch{return!1}return W.set("cardConfigs",[...P.value.values()]),!0}function e(g,k){const L=P.value.get(g);if(L===void 0)return!1;try{P.value.set(g,{...L,selectedPointExchangeId:k})}catch{return!1}return W.set("cardConfigs",[...P.value.values()]),!0}const m=te(()=>tt(He(r.value.flatMap(g=>g.storeList)))),D=O(W.get("conditionTypes")??[]);function q([...g]){D.value=g,W.set("conditionTypes",g)}const G=O(new Map);function C(g,k){k.length===0?G.value.delete(g):G.value.set(g,k),W.set("acceptedPaymentsWithStore",[...G.value.entries()])}const S=O(W.get("aliasType")??"default");function I(g){ct.includes(g)&&(S.value=g,W.set("aliasType",g))}const X=O(new Map(W.get("customAliases")??[]));function b(g,k){k.length===0?X.value.delete(g):X.value.set(g,k),W.set("customAliases",[...X.value])}function s(g){X.value=new Map(g),W.set("customAliases",g)}const o=te(()=>{const g=[];["default","additional"].includes(S.value)&&g.push(...dt),["additional","custom"].includes(S.value)&&g.push(...X.value);const k=new Map;for(const[L,R]of g){const B=k.get(L)??new Set;for(const H of R)B.add(H);k.set(L,B)}return k});return{dialog:ae(c),openDialog:t,closeDialog:a,onlyShowCurrentPlan:ae(i),updateOnlyShowCurrentPlan:x,onlyShowCurrentPointExchange:ae(u),updateOnlyShowCurrentPointExchange:f,commonPaymentMethods:ae(l),updateCommonPaymentMethods:v,cardConfigs:ae(P),cards:n,showCards:r,updateCardConfig:U,deleteCardConfig:T,updatePlan:$,updatePointExchange:e,storeList:ae(m),conditionTypes:ae(D),updateConditionTypes:q,aliasType:ae(S),storeAliases:o,updateAliasType:I,customAliases:ae(X),updateCustomAliases:b,updateAllCustomAliases:s,acceptedPaymentsWithStore:ae(G),updateAcceptedPaymentsWithStore:C}}),jt={class:"flex-col gap-24px my-16px"},Kt={class:"gap-8px flex justify-around"},Ht={class:"flex mx-16px"},Wt=le({__name:"CommonSettings",setup(c){const t=_e(),{onlyShowCurrentPlan:a,onlyShowCurrentPointExchange:i,commonPaymentMethods:x,conditionTypes:u}=he(t);return(f,l)=>{const v=A("v-switch"),P=A("v-label");return _(),V("div",jt,[h("div",Kt,[p(v,{"model-value":E(a),"hide-details":"",color:"blue","onUpdate:modelValue":l[0]||(l[0]=n=>n!==null&&E(t).updateOnlyShowCurrentPlan(n))},{label:w(()=>l[3]||(l[3]=[h("p",{class:"text-0.75rem"},"只顯示當前方案",-1)])),_:1},8,["model-value"]),p(v,{"model-value":E(i),"hide-details":"",color:"blue","onUpdate:modelValue":l[1]||(l[1]=n=>n!==null&&E(t).updateOnlyShowCurrentPointExchange(n))},{label:w(()=>l[4]||(l[4]=[h("p",{class:"text-0.75rem"},"只顯示當前交換方式",-1)])),_:1},8,["model-value"])]),p(ie,{label:"使用中的付款方式","model-value":E(x),list:E(Ae),"hide-details":"","show-selected":"","onUpdate:modelValue":E(t).updateCommonPaymentMethods},null,8,["model-value","list","onUpdate:modelValue"]),h("div",null,[p(P,{text:"其他設定"}),h("div",Ht,[p(v,{"model-value":E(u),label:"生日中",value:"Birthday","hide-details":"",color:"blue","onUpdate:modelValue":l[2]||(l[2]=n=>n!==null&&E(t).updateConditionTypes(n))},null,8,["model-value"])])])])}}});function ne(c){if(c===null||typeof c!="object")return c;if(Array.isArray(c))return c.map(a=>ne(a));if(c instanceof Map)return new Map(Array.from(c.entries()).map(([a,i])=>[ne(a),ne(i)]));if(c instanceof Set)return new Set(Array.from(c.values()).map(a=>ne(a)));if(c instanceof Date)return new Date(c.getTime());if(c instanceof RegExp)return new RegExp(c.source,c.flags);const t={};return Object.keys(c).forEach(a=>{t[a]=ne(c[a])}),t}const zt={class:"flex-col gap-8px"},Yt={key:1},Xt={class:"flex min-h-1rem items-stretch"},qt=["onDragover","onDragstart","onTouchstart"],Zt=["onClick"],Qt=["onClick"],ea=le({__name:"CardList",props:{list:{},label:{},addable:{type:Boolean},draggable:{type:Boolean},deletable:{type:Boolean}},emits:["clickItem","deleteItem","addItem","update:list"],setup(c,{emit:t}){const a=c,i=t,x=se("cardListContainer"),u=se("cardItem"),f=pe([]),l=pe(null),v=pe(null),P=pe(null),n=pe(null),r=pe(!1);let U=null;et(()=>{T()}),ge(()=>a.list,T,{deep:!0});function T(){f.value=ne(a.list)}function $(b,s){if(!b.dataTransfer)return;l.value=s,b.dataTransfer.setData("text/plain",s.toString()),b.dataTransfer.effectAllowed="move";const o=new Image;o.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==",b.dataTransfer.setDragImage(o,0,0)}function e(b,s){const o=b.touches[0]??null;o&&(P.value=s,n.value=o.clientY,r.value=!1,U=window.setTimeout(()=>{r.value=!0},400))}function m(b){if(!r.value||P.value===null||n.value===null)return;const s=b.touches[0]??null;if(!s)return;const o=s.clientY-n.value;if(X(P.value,o)){const k=P.value+(o>0?1:-1);if(k<0||k>=f.value.length)return;const L=f.value[P.value];if(!L)return;f.value.splice(P.value,1),f.value.splice(k,0,L),P.value=k,n.value=s.clientY}}function D(){U!==null&&(clearTimeout(U),U=null),P.value=null,n.value=null,r.value=!1,i("update:list",f.value)}function q(b,s){if(b.preventDefault(),l.value===s||l.value===null)return;const o=f.value[l.value];o&&(f.value.splice(l.value,1),f.value.splice(s,0,o),v.value=s,l.value=s)}function G(b){var o;const s=b.relatedTarget;s!==null&&((o=x.value)!=null&&o.contains(s))||(v.value=null)}function C(){l.value=null,v.value=null,i("update:list",f.value)}function S(b,s){i("clickItem",b,s)}function I(b,s){i("deleteItem",b,s)}function X(b,s){var k;const o=((k=u.value)==null?void 0:k.map(L=>L.getBoundingClientRect().height))??[],g=o[b];if(s>0){const L=o[b+1];if(g===void 0||L===void 0)return!1;const R=g/2+L/2;return s>=R}else{const L=o[b-1];if(g===void 0||L===void 0)return!1;const R=g/2+L/2;return Math.abs(s)>=R}}return(b,s)=>{const o=A("v-label"),g=A("v-card-text"),k=A("v-card");return _(),V("div",zt,[b.$slots.label||b.label?(_(),j(o,{key:0,class:"flex-shrink-0 w-full"},{default:w(()=>[b.$slots.label?Ge(b.$slots,"label",{key:0},void 0,!0):(_(),V("p",Yt,M(b.label),1))]),_:3})):Y("",!0),h("div",{ref_key:"cardListContainer",ref:x,class:"flex-col gap-8px",onDragleave:G},[(_(!0),V(z,null,ee(f.value,(L,R)=>(_(),V("div",{ref_for:!0,ref:"cardItem",key:R},[p(k,{density:"compact",class:fe(["mx-auto w-full flex-shrink-0 card-item",{"drag-over":v.value===R||P.value===R&&r.value}]),variant:"outlined"},{default:w(()=>[p(g,{class:"!p-0"},{default:w(()=>[h("div",Xt,[b.draggable?(_(),V("div",{key:0,draggable:"true",class:"flex-center pl-0.5rem pr-0.25rem cursor-ns-resize",onDragover:Je(B=>q(B,R),["prevent"]),onDragstart:B=>$(B,R),onDragend:C,onTouchstart:B=>e(B,R),onTouchmove:s[0]||(s[0]=Je(B=>m(B),["prevent"])),onTouchend:D},s[2]||(s[2]=[h("span",{class:"mdi text-24px mdi-drag"},null,-1)]),40,qt)):Y("",!0),h("div",{class:fe(["flex-grow min-h-20px flex items-center py-1rem cursor-pointer",{"pl-1rem":!b.draggable,"pr-1rem":!b.deletable}]),onClick:B=>S(L,R)},[Ge(b.$slots,"default",gt({ref_for:!0},L),void 0,!0)],10,Zt),b.deletable?(_(),V("p",{key:1,class:"flex-center pl-0.25rem pr-0.5rem cursor-pointer",onClick:B=>I(L,R)},s[3]||(s[3]=[h("span",{class:"mdi mdi-delete text-24px"},null,-1)]),8,Qt)):Y("",!0)])]),_:2},1024)]),_:2},1032,["class"])]))),128))],544),b.addable?(_(),j(k,{key:1,density:"compact",class:"mx-auto w-full flex-shrink-0",variant:"outlined",onClick:s[1]||(s[1]=L=>b.$emit("addItem"))},{default:w(()=>[p(g,null,{default:w(()=>s[4]||(s[4]=[h("div",{class:"flex items-center justify-center min-h-1rem"},[h("span",{class:"mdi mdi-plus text-24px"})],-1)])),_:1})]),_:1})):Y("",!0)])}}}),Fe=We(ea,[["__scopeId","data-v-e23bc834"]]),ta={key:0,class:"overflow-y-auto p-16px pb-40px"},de=le({__name:"FullscreenDialog",props:{modelValue:{},title:{},btnTitle:{},btnEvent:{type:Function}},emits:["update:model-value"],setup(c,{emit:t}){const a=t;function i(){a("update:model-value",null)}function x(l){a("update:model-value",l)}const u=O(!1);async function f(){if(c.modelValue===null)return;await c.btnEvent(c.modelValue)!==!1?i():(u.value=!0,window.setTimeout(()=>{u.value=!1},3e3))}return(l,v)=>{const P=A("v-btn"),n=A("v-toolbar-title"),r=A("v-toolbar-items"),U=A("v-toolbar"),T=A("v-card"),$=A("v-dialog");return _(),j($,{"model-value":!!l.modelValue,fullscreen:"","onUpdate:modelValue":i},{default:w(()=>[p(T,null,{default:w(()=>[p(U,null,{default:w(()=>[p(P,{icon:"mdi-close",onClick:i}),p(n,null,{default:w(()=>[K(M(l.title??""),1)]),_:1}),p(r,null,{default:w(()=>[p(P,{class:fe({"text-red":u.value}),text:l.btnTitle,onClick:f},null,8,["class","text"])]),_:1})]),_:1}),l.modelValue?(_(),V("div",ta,[Ge(l.$slots,"default",{data:l.modelValue,updateData:x})])):Y("",!0)]),_:3})]),_:3},8,["model-value"])}}}),aa={class:"relative"},na={key:0,class:"text-red ml-2px"},me=le({__name:"NumberField",props:{modelValue:{default:0},required:{type:Boolean,default:!1},label:{default:null},isFloat:{type:Boolean,default:!1},prefix:{},suffix:{},clearable:{type:Boolean,default:!1},messages:{default:""}},emits:["update:model-value"],setup(c,{emit:t}){const a=t;function i(l){const v=c.isFloat?parseFloat(l):parseInt(l);return isNaN(v)?null:v}const x=te(()=>{const l=[];return c.required&&l.push(v=>!!i(v)||"此欄位為必填"),l});function u(l){const v=i(l);a("update:model-value",v??0)}function f(l){if(l.target instanceof HTMLInputElement){const v=l.target.defaultValue;l.target.setSelectionRange(v.length,v.length)}}return(l,v)=>{const P=A("v-text-field");return _(),V("div",null,[p(P,{rules:x.value,inputmode:l.isFloat?"decimal":"numeric","model-value":l.modelValue,clearable:l.clearable&&l.modelValue!==0,prefix:l.prefix,suffix:l.suffix,messages:l.messages,"onUpdate:modelValue":u,"onClick:control":f},be({_:2},[l.label!==null?{name:"label",fn:w(()=>[h("p",aa,[K(M(l.label)+" ",1),l.required?(_(),V("span",na,"*")):Y("",!0)])]),key:"0"}:void 0]),1032,["rules","inputmode","model-value","clearable","prefix","suffix","messages"])])}}}),la={class:"relative"},oa={key:0,class:"text-red ml-2px"},re=le({__name:"TextFiled",props:{modelValue:{default:null},required:{type:Boolean,default:!1},label:{},isUrl:{type:Boolean,default:!1}},emits:["update:model-value"],setup(c,{emit:t}){const a=t,i=te(()=>{const u=[];return c.required&&u.push(f=>!!f||"此欄位為必填"),c.isUrl&&u.push(f=>!!(f===null||f===""||f.startsWith("https://"))||"請填寫正確的網址 (需為 https:// 開頭)"),u});function x(u){u=(u==null?void 0:u.trim())??null,a("update:model-value",Pe(u)?u:null)}return(u,f)=>{const l=A("v-text-field");return _(),j(l,{clearable:"",rules:i.value,"model-value":u.modelValue,"onUpdate:modelValue":x},{label:w(()=>[h("p",la,[K(M(u.label)+" ",1),u.required?(_(),V("span",oa,"*")):Y("",!0)])]),_:1},8,["rules","model-value"])}}}),sa={class:"flex-col gap-4px h-full overflow-hidden"},ra={class:"flex"},ia={class:"flex-1 gap-8px flex-col overflow-y-auto py-8px"},da={class:"flex items-center justify-between"},ca=["onClick"],ua={class:"flex-col gap-2"},pa={class:"flex-col gap-4px"},ma={class:"text-0.9em"},ya={class:"flex gap-4px items-center justify-center"},ga={class:"flex-col gap-8px"},fa={class:"gap-8px flex-center"},va={class:"overflow-y-auto w-full p-24px"},Pa={key:0,class:"flex-col gap-8px"},ha={class:"flex items-center justify-between gap-4px min-h-1rem"},_a={class:"flex-col gap-1"},wa={key:0,class:"opacity-50 text-0.75rem"},xa={key:0,class:"mdi text-24px mdi-check-circle"},ba={class:"flex items-center justify-between min-h-1rem gap-4px"},Aa={class:"flex-col gap-4px"},ka={class:"opacity-50 text-0.75rem"},Sa={key:0,class:"mdi mdi-check-circle text-24px"},Ca={class:"flex-col gap-2"},Ra={class:"flex-col"},Ea={class:"text-1rem"},Ba={class:"text-0.75rem"},Ua=le({__name:"CreditCardManagement",setup(c){const t=[{title:"消費N%回饋點數(四捨五入)",value:"RoundedPercentageReward"},{title:"消費N%回饋點數(無條件捨去)",value:"TruncatedPercentageReward"},{title:"每消費N元累積1點 (小數不累計)",value:"FixedRatePointsReward"},{title:"每消費N元累積1點 (小數會累計)",value:"AccumulatedPointsReward"}],a=_e(),{cardConfigs:i,cards:x}=he(a),u=O(null),f=O(null),l=O(null),v=O(null),P=O(null),n=O(null),r=te(()=>{const s=n.value===null?null:x.value.get(n.value)??null;return s===null?null:s}),U=O(null),T=O(null);function $(s){for(const o of s)a.updateCardConfig(N(),o)}function e({id:s,config:o}){return Ze(o)?(a.updateCardConfig(s,o),!0):(alert("儲存失敗"),!1)}function m(){return{id:N(),config:{name:null,description:null,rewards:[]}}}function D(){return{rewardStrategy:{name:"",type:"RoundedPercentageReward",pointBackRates:[]}}}function q(s){(s.rewardStrategy.type==="RoundedPercentageReward"||s.rewardStrategy.type==="TruncatedPercentageReward")&&(s.rewardStrategy.pointBackRates=s.rewardStrategy.pointBackRates.filter(({rate:o})=>o!==0)),P.value!==null&&f.value!==null&&(f.value.config.rewards[P.value]=s),P.value=null}function G({id:s,config:o}){if(u.value===null||!It(o))return alert("儲存失敗"),!1;const g=u.value.config.plans.find(k=>k.id===s);return g?g.config=o:u.value.config.plans.push({id:s,config:o}),!0}function C(){return{id:N(),config:{name:"",airlineCode:"",milesPerUnit:0,pointsPerMile:0}}}function S({id:s,config:o}){if(u.value===null||!$t(o)||o.milesPerUnit===0||o.pointsPerMile===0)return alert("儲存失敗"),!1;const g=u.value.config.pointExchanges.find(k=>k.id===s);return g?g.config=o:u.value.config.pointExchanges.push({id:s,config:o}),!0}function I(){u.value!==null&&(a.deleteCardConfig(u.value.id),u.value=null)}const X=O(!0);ge(()=>U.value,s=>{X.value=!!b(s)});function b(s){if(s===null)return null;let o;try{o=JSON.parse(s)}catch{return null}return Ze(o)?o:null}return(s,o)=>{const g=A("v-label"),k=A("v-btn"),L=A("v-card"),R=A("v-textarea"),B=A("v-select"),H=A("v-radio"),oe=A("v-radio-group"),F=A("v-switch"),Q=A("v-card-text"),Re=A("v-card-actions"),ut=A("v-dialog"),pt=A("v-checkbox");return _(),V(z,null,[h("div",sa,[h("div",ra,[p(g,{class:"ml-4px flex-grow !text-0.9rem"},{default:w(()=>o[16]||(o[16]=[K(" 點擊 "),h("span",{class:"mdi mdi-pencil mx-4px"},null,-1),K(" 編輯卡片，點擊卡片切換方案 ")])),_:1}),p(k,{text:"匯入",onClick:o[0]||(o[0]=()=>T.value=[])})]),h("div",ia,[(_(!0),V(z,null,ee(E(i).entries(),([d,y],Z)=>(_(),j(L,{key:Z,density:"compact",class:"mx-auto w-full flex-shrink-0",variant:"outlined",title:y.name,text:y.description??"",onClick:()=>n.value=d},{title:w(()=>[h("div",da,[K(M(y.name)+" ",1),h("span",{class:"mdi mdi-pencil absolute top-0 py-0.625rem px-1rem right-0",onClick:Je(()=>u.value={id:d,config:E(ne)(y)},["stop"])},null,8,ca)])]),_:2},1032,["title","text","onClick"]))),128))])]),p(de,{modelValue:u.value,"onUpdate:modelValue":o[7]||(o[7]=d=>u.value=d),title:"編輯卡片","btn-title":"儲存","btn-event":e},{default:w(({data:d})=>[h("div",ua,[p(re,{modelValue:d.config.name,"onUpdate:modelValue":y=>d.config.name=y,label:"卡片名稱",required:""},null,8,["modelValue","onUpdate:modelValue"]),p(re,{modelValue:d.config.description,"onUpdate:modelValue":y=>d.config.description=y,label:"卡片描述"},null,8,["modelValue","onUpdate:modelValue"]),p(re,{modelValue:d.config.cardUrl,"onUpdate:modelValue":y=>d.config.cardUrl=y,"is-url":"",label:"信用卡網頁"},null,8,["modelValue","onUpdate:modelValue"]),p(ie,{modelValue:d.config.storeBlackList,"onUpdate:modelValue":y=>d.config.storeBlackList=y,addable:"",label:"卡片不回饋清單",list:E(a).storeList},null,8,["modelValue","onUpdate:modelValue","list"]),p(ie,{modelValue:d.config.paymentBlackList,"onUpdate:modelValue":y=>d.config.paymentBlackList=y,label:"卡片不回饋支付方式","show-selected":"",list:E(Ae)},null,8,["modelValue","onUpdate:modelValue","list"]),p(Fe,{list:d.config.plans,class:"mb-8",label:"方案設定 (點擊卡片進行編輯)",addable:"",draggable:"",deletable:"","onUpdate:list":y=>d.config.plans=y,onClickItem:o[1]||(o[1]=y=>f.value=E(ne)(y)),onAddItem:o[2]||(o[2]=y=>f.value=m()),onDeleteItem:(y,Z)=>E(a).openDialog({text:`確定要刪除'${y.config.name??"此"}'方案嗎？`,events:[{text:"取消"},{text:"刪除",event:()=>{d.config.plans.splice(Z,1)},class:"text-red"}]})},{default:w(y=>[K(M(y.config.name??"(空)"),1)]),_:2},1032,["list","onUpdate:list","onDeleteItem"]),p(Fe,{list:d.config.pointExchanges,class:"mb-8",addable:"",draggable:"",deletable:"",label:"點數交換方式 (點擊卡片進行編輯)","onUpdate:list":y=>d.config.pointExchanges=y,onClickItem:o[3]||(o[3]=y=>l.value=E(ne)(y)),onAddItem:o[4]||(o[4]=y=>l.value=C()),onDeleteItem:(y,Z)=>E(a).openDialog({text:`確定要刪除'${y.config.name??"此"}'點數交換方式嗎？`,events:[{text:"取消"},{text:"刪除",event:()=>{d.config.pointExchanges.splice(Z,1)},class:"text-red"}]})},{default:w(y=>[K(M(y.config.name??"(空)"),1)]),_:2},1032,["list","onUpdate:list","onDeleteItem"]),p(k,{text:"更新設定檔",onClick:o[5]||(o[5]=()=>{u.value!==null&&(U.value=JSON.stringify(u.value.config,null,2))})}),p(k,{class:"text-red",text:"刪除",onClick:o[6]||(o[6]=y=>E(a).openDialog({text:"確定要刪除嗎？",events:[{text:"取消"},{text:"刪除",event:I,class:"text-red"}]}))})])]),_:1},8,["modelValue"]),p(de,{modelValue:f.value,"onUpdate:modelValue":o[9]||(o[9]=d=>f.value=d),title:"編輯方案","btn-title":"儲存","btn-event":G},{default:w(({data:d})=>[p(re,{modelValue:d.config.name,"onUpdate:modelValue":y=>d.config.name=y,label:"方案名稱"},null,8,["modelValue","onUpdate:modelValue"]),p(R,{label:"方案描述","model-value":d.config.description,"auto-grow":"",clearable:"","onUpdate:modelValue":y=>d.config.description=E(Pe)(y)?y:null},null,8,["model-value","onUpdate:modelValue"]),p(Fe,{list:d.config.rewards,addable:"",draggable:"",deletable:"","onUpdate:list":y=>d.config.rewards=y,onAddItem:()=>{v.value=D(),P.value=d.config.rewards.length},onClickItem:o[8]||(o[8]=(y,Z)=>{v.value=E(ne)(y),P.value=Z}),onDeleteItem:(y,Z)=>E(a).openDialog({text:"確定要刪除嗎？",events:[{text:"取消"},{text:"刪除",event:()=>{d.config.rewards.splice(Z,1)},class:"text-red"}]})},{label:w(()=>o[17]||(o[17]=[h("p",{class:"flex-col"},[K(" 回饋清單 (點擊卡片進行編輯) "),h("span",{class:"text-0.75em"}," 依回饋排序檢查規則，符合即計算回饋，不再檢查後續項目 ")],-1)])),default:w(y=>[h("p",pa,[K(M(y.rewardStrategy.name??"(空)")+" ",1),h("span",ma,M(E(lt)(y.rewardStrategy).description),1)])]),_:2},1032,["list","onUpdate:list","onAddItem","onDeleteItem"])]),_:1},8,["modelValue"]),p(de,{modelValue:l.value,"onUpdate:modelValue":o[10]||(o[10]=d=>l.value=d),title:"編輯交換方式","btn-title":"儲存","btn-event":S},{default:w(({data:d})=>[p(re,{modelValue:d.config.name,"onUpdate:modelValue":y=>d.config.name=y,label:"名稱",required:""},null,8,["modelValue","onUpdate:modelValue"]),p(re,{modelValue:d.config.airlineCode,"onUpdate:modelValue":y=>d.config.airlineCode=y,label:"目標里程",required:""},null,8,["modelValue","onUpdate:modelValue"]),h("div",ya,[p(me,{modelValue:d.config.pointsPerMile,"onUpdate:modelValue":y=>d.config.pointsPerMile=y,class:"flex-1",label:"points",required:"",clearable:""},null,8,["modelValue","onUpdate:modelValue"]),o[18]||(o[18]=h("span",{class:"mdi mdi-arrow-right-thick text-24px mb-16px"},null,-1)),p(me,{modelValue:d.config.milesPerUnit,"onUpdate:modelValue":y=>d.config.milesPerUnit=y,class:"flex-1",label:`${d.config.airlineCode} 哩程`,required:"",clearable:""},null,8,["modelValue","onUpdate:modelValue","label"])])]),_:1},8,["modelValue"]),p(de,{modelValue:v.value,"onUpdate:modelValue":o[11]||(o[11]=d=>v.value=d),title:"編輯回饋","btn-title":"儲存","btn-event":q},{default:w(({data:d})=>[h("div",ga,[p(re,{modelValue:d.rewardStrategy.name,"onUpdate:modelValue":y=>d.rewardStrategy.name=y,label:"回饋名稱"},null,8,["modelValue","onUpdate:modelValue"]),p(B,{label:"回饋方式",items:t,"model-value":d.rewardStrategy.type,"onUpdate:modelValue":y=>d.rewardStrategy.type=y},null,8,["model-value","onUpdate:modelValue"]),d.rewardStrategy.type==="RoundedPercentageReward"||d.rewardStrategy.type==="TruncatedPercentageReward"?(_(),V(z,{key:0},[(_(!0),V(z,null,ee(d.rewardStrategy.pointBackRates,(y,Z)=>(_(),V("div",{key:Z,class:"flex gap-4px"},[p(me,{modelValue:y.rate,"onUpdate:modelValue":ue=>y.rate=ue,messages:y.rate===0?"0% 回饋儲存時會移除":"",class:"flex-1",prefix:"消費",suffix:"%回饋","is-float":""},null,8,["modelValue","onUpdate:modelValue","messages"]),p(me,{"model-value":y.limit??0,class:"flex-1",prefix:"上限",suffix:"點",messages:"0 表示沒回饋上限","onUpdate:modelValue":ue=>y.limit=ue===0?null:ue},null,8,["model-value","onUpdate:modelValue"])]))),128)),p(k,{onClick:y=>d.rewardStrategy.pointBackRates.push({rate:0})},{default:w(()=>o[19]||(o[19]=[h("span",{class:"mdi mdi-plus text-24px"},null,-1)])),_:2},1032,["onClick"])],64)):d.rewardStrategy.type==="FixedRatePointsReward"||d.rewardStrategy.type==="AccumulatedPointsReward"?(_(),j(me,{key:1,modelValue:d.rewardStrategy.spendingPerPoint,"onUpdate:modelValue":y=>d.rewardStrategy.spendingPerPoint=y,prefix:"每消費",suffix:"元累積一點"},null,8,["modelValue","onUpdate:modelValue"])):Y("",!0),p(g,{text:"回饋規則"}),h("div",fa,[p(g,{text:"交易類型"}),p(oe,{"model-value":d.transactionType??null,"hide-details":"",inline:"","onUpdate:modelValue":y=>d.transactionType=y},{default:w(()=>[p(H,{density:"compact",label:"國內交易",value:"Domestic"}),p(H,{density:"compact",label:"國外交易",value:"Foreign"}),p(H,{density:"compact",label:"不限",value:null})]),_:2},1032,["model-value","onUpdate:modelValue"])]),p(ie,{modelValue:d.payments,"onUpdate:modelValue":y=>d.payments=y,label:"限制回饋支付方式","show-selected":"",list:E(Ae)},null,8,["modelValue","onUpdate:modelValue","list"]),p(ie,{modelValue:d.paymentBlackList,"onUpdate:modelValue":y=>d.paymentBlackList=y,label:"不回饋支付方式","show-selected":"",list:E(Ae)},null,8,["modelValue","onUpdate:modelValue","list"]),p(ie,{modelValue:d.stores,"onUpdate:modelValue":y=>d.stores=y,addable:"",label:"限制回饋清單/商店",list:E(a).storeList},null,8,["modelValue","onUpdate:modelValue","list"]),p(ie,{modelValue:d.storeBlackList,"onUpdate:modelValue":y=>d.storeBlackList=y,addable:"",label:"不回饋清單",list:E(a).storeList},null,8,["modelValue","onUpdate:modelValue","list"]),p(g,{text:"其他設定"}),p(F,{"model-value":d.condition??null,label:"生日中",value:"Birthday","hide-details":"",color:"blue","onUpdate:modelValue":y=>d.condition=y??null},null,8,["model-value","onUpdate:modelValue"])])]),_:1},8,["modelValue"]),p(ut,{"model-value":!!n.value,"onUpdate:modelValue":o[13]||(o[13]=d=>n.value=null)},{default:w(()=>[p(L,{"min-width":"100%"},{default:w(()=>[p(Q,{class:"overflow-hidden flex max-h-80dvh !p-0"},{default:w(()=>[h("div",va,[r.value!==null?(_(),V("div",Pa,[o[20]||(o[20]=K(" 切換方案 ")),(_(!0),V(z,null,ee(r.value.selectablePlan??[],(d,y)=>(_(),j(L,{key:y,density:"compact",class:"mx-auto w-full flex-shrink-0",variant:"outlined",onClick:()=>n.value&&r.value&&d.id!==r.value.selectedPlanId&&E(a).updatePlan(n.value,d.id)},{default:w(()=>[p(Q,null,{default:w(()=>[h("div",ha,[h("p",_a,[K(M(d.name??"(空)")+" ",1),d.description?(_(),V("span",wa,M(d.description),1)):Y("",!0)]),d.id===r.value.selectedPlanId?(_(),V("span",xa)):Y("",!0)])]),_:2},1024)]),_:2},1032,["onClick"]))),128)),o[21]||(o[21]=K(" 切換點數交換方式 ")),(_(!0),V(z,null,ee(r.value.selectablePointExchange??[],(d,y)=>(_(),j(L,{key:y,density:"compact",class:"mx-auto w-full flex-shrink-0",variant:"outlined",onClick:()=>n.value&&r.value&&d.id!==r.value.selectedPointExchangeId&&E(a).updatePointExchange(n.value,d.id)},{default:w(()=>[p(Q,null,{default:w(()=>[h("div",ba,[h("p",Aa,[K(M(d.name)+" ",1),h("span",ka,M(d.description),1)]),d.id===r.value.selectedPointExchangeId?(_(),V("span",Sa)):Y("",!0)])]),_:2},1024)]),_:2},1032,["onClick"]))),128))])):Y("",!0)])]),_:1}),p(Re,null,{default:w(()=>[p(k,{class:"ms-auto",text:"Close",onClick:o[12]||(o[12]=d=>n.value=null)})]),_:1})]),_:1})]),_:1},8,["model-value"]),p(de,{modelValue:T.value,"onUpdate:modelValue":o[14]||(o[14]=d=>T.value=d),title:"請選擇卡片","btn-title":"匯入","btn-event":$},{default:w(({data:d,updateData:y})=>[h("div",Ca,[(_(!0),V(z,null,ee(E(Jt),(Z,ue)=>(_(),j(pt,{key:ue,"model-value":d,value:Z,"hide-details":"",color:"blue",density:"comfortable",class:"import-card-checkbox","onUpdate:modelValue":Ye=>Ye&&y(Ye)},{label:w(()=>[h("div",Ra,[h("p",Ea,M(Z.name),1),h("p",Ba,M(Z.description),1)])]),_:2},1032,["model-value","value","onUpdate:modelValue"]))),128))])]),_:1},8,["modelValue"]),p(de,{modelValue:U.value,"onUpdate:modelValue":o[15]||(o[15]=d=>U.value=d),title:"匯入設定檔","btn-title":"匯入","btn-event":d=>{const y=b(d);return u.value!==null&&y!==null?(u.value.config=y,X.value=!1,!0):!1}},{default:w(({data:d,updateData:y})=>[p(R,{"model-value":d,"error-messages":X.value?"":"json 無效",label:"設定檔",rows:20,"onUpdate:modelValue":y},null,8,["model-value","error-messages","onUpdate:modelValue"])]),_:1},8,["modelValue","btn-event"])],64)}}}),Va=We(Ua,[["__scopeId","data-v-e1f14ddd"]]),La={class:"gap-8px h-full flex-col"},Ta={class:"flex items-center flex-wrap gap-x-8px"},Ia={class:"gap-8px flex-center"},$a={ref:"rewardCardList",class:"flex-col gap-4px overflow-y-auto flex-grow-1"},Ma={class:"flex items-center gap-4px overflow-hidden w-full"},Oa={class:"opacity-50 flex-grow-1 text-12px truncate"},Na={key:0,class:"fa-solid fa-circle-check"},Da={class:"flex-col gap-8px"},Fa={class:"text-0.75rem"},Ga={class:"text-wrap"},Ja={class:"flex-col"},ja={class:"flex justify-between"},Ka=["href"],Ha={key:0},Wa={key:1},Qe="其他店家",za=le({__name:"SearchReward",setup(c){const t=ve(0),a=ve(2),i=at(0),x=_e(),{onlyShowCurrentPlan:u,onlyShowCurrentPointExchange:f,commonPaymentMethods:l,showCards:v,conditionTypes:P,storeAliases:n,storeList:r,acceptedPaymentsWithStore:U}=he(x),T=O(0),$=O(null),e=O("Domestic"),m=O([]),D=se("rewardCardList"),q=se("storeAutoComplete"),G=te(()=>{const b=r.value.map(s=>({store:s,aliases:[...n.value.get(s)??[]]}));return[{store:Qe},...b]});function C(b,s,o){return s=s.toLowerCase(),[b,...(o==null?void 0:o.raw.aliases)??[]].map(k=>k.toLowerCase()).some(k=>k.includes(s))}ge($,()=>{$.value!==null&&(m.value=[...U.value.get($.value)??[]])}),ge(m,()=>{$.value!==null&&$.value!==Qe&&x.updateAcceptedPaymentsWithStore($.value,m.value)});const S=te(()=>{var o;const b={amount:T.value,acceptedPayments:m.value,transactionAttributesType:e.value,currentConditions:[...P.value]};Pe($.value)&&(b.transactionStore=$.value);const s=[];for(const g of v.value){const k=g.getRewardInfos(b,{onlyCurrentPlan:u.value,onlyCurrentExchangeStrategy:f.value}),L=!u.value||!f.value,R=!f.value&&g.selectablePointExchange.length>1;for(const B of k){const H={cardName:g.name,planName:B.planName,rewardName:B.rewardName,miles:B.miles,payments:B.payments,airLinesCode:B.airlineCode,isSelectedPlan:L&&B.planId===g.selectedPlanId,calculateDetail:X(B.rewardStrategy,B.pointExchangeStrategy),description:B.rewardStrategy===null?null:`${B.rewardStrategy.description}，${B.pointExchangeStrategy.description}`,cardUrl:g.cardUrl,cardDescription:g.description,pointExchangeName:R?B.pointExchangeName:""};s.push(H)}}return(o=D.value)==null||o.scrollTo({top:0,behavior:"smooth"}),Xe(Xe(s,"isSelectedPlan","desc"),"miles","desc")}),I=O(null);function X(b,s){const{pointsPerMile:o,milesPerUnit:g,airlineCode:k}=s,L="回饋計算:";switch(b==null?void 0:b.type){case"RoundedPercentageReward":case"TruncatedPercentageReward":{const R=b.type==="RoundedPercentageReward"?t:i;let B=0;return[L,...b.pointBackRates.map(({rate:H,limit:oe})=>{const F=Math.min(R(T.value*H/100),oe??1/0);B+=F;const Q=oe!==void 0?` (limit ${oe})`:"";return`${T.value} * ${H}% = ${F}${Q}`}),`總計 ${B} points`,`${B} / ${o} * ${g} = ${s.calculateMiles(B)} ${k}`]}case"AccumulatedPointsReward":{const R=a(T.value/b.spendingPerPoint);return[L,`${T.value} / ${b.spendingPerPoint} = ${R} points`,`${R} / ${o} * ${g} = ${s.calculateMiles(R)} ${k}`]}case"FixedRatePointsReward":{const R=i(T.value/b.spendingPerPoint);return[L,`${T.value} / ${b.spendingPerPoint} = ${R} points (小數省略)`,`${R} / ${o} * ${g} = ${s.calculateMiles(R)} ${k}`]}default:return[]}}return(b,s)=>{const o=A("v-autocomplete"),g=A("v-label"),k=A("v-checkbox"),L=A("v-radio"),R=A("v-radio-group"),B=A("v-card"),H=A("v-btn"),oe=A("v-dialog");return _(),V(z,null,[h("div",La,[p(me,{modelValue:T.value,"onUpdate:modelValue":s[0]||(s[0]=F=>T.value=F),label:"交易金額",class:"flex-grow-0",density:"comfortable","hide-details":"",clearable:""},null,8,["modelValue"]),p(o,{ref:"storeAutoComplete",modelValue:$.value,"onUpdate:modelValue":s[1]||(s[1]=F=>$.value=F),"custom-filter":C,class:"flex-grow-0",density:"comfortable","hide-details":"","item-value":"store","item-title":"store",items:G.value,clearable:E(Pe)($.value),placeholder:"全部店家","onUpdate:menu":s[2]||(s[2]=F=>{var Q;return!F&&((Q=E(q))==null?void 0:Q.blur())})},null,8,["modelValue","items","clearable"]),h("div",null,[p(g,{text:"店家可使用的付款方式"}),h("div",Ta,[(_(!0),V(z,null,ee(E(l),(F,Q)=>(_(),j(k,{key:Q,modelValue:m.value,"onUpdate:modelValue":s[3]||(s[3]=Re=>m.value=Re),density:"compact",value:F,"hide-details":"",label:F},null,8,["modelValue","value","label"]))),128))])]),h("div",Ia,[p(g,{text:"交易類型"}),p(R,{modelValue:e.value,"onUpdate:modelValue":s[4]||(s[4]=F=>e.value=F),"hide-details":"",inline:""},{default:w(()=>[p(L,{density:"compact",label:"國內交易",value:"Domestic"}),p(L,{density:"compact",label:"國外交易",value:"Foreign"})]),_:1},8,["modelValue"])]),h("div",$a,[(_(!0),V(z,null,ee(S.value,(F,Q)=>(_(),j(B,{key:Q,density:"compact",class:"mx-auto w-full flex-shrink-0",variant:"outlined",onClick:()=>I.value=F},{title:w(()=>[h("div",Ma,[K(M(F.miles)+" ",1),h("p",Oa,M(F.airLinesCode)+" "+M(F.payments.length===0?"":` (限定支付: ${F.payments.join(", ")})`),1),F.isSelectedPlan?(_(),V("i",Na)):Y("",!0)])]),text:w(()=>[h("div",Da,[h("p",Fa,M(`${F.cardName} ${F.planName??""} ${F.rewardName??""} ${F.pointExchangeName}`),1)])]),_:2},1032,["onClick"]))),128))],512)]),p(oe,{"model-value":!!I.value,"onUpdate:modelValue":s[6]||(s[6]=F=>I.value=null)},{default:w(()=>[I.value?(_(),j(B,{key:0,class:"mx-auto reward-detail-dialog","min-width":"100%",title:`${I.value.cardName} ${I.value.planName??""} ${I.value.rewardName??""}`},{subtitle:w(()=>[h("p",Ga,M(I.value.description??""),1)]),text:w(()=>[h("div",Ja,[h("p",ja,[s[7]||(s[7]=K(" 卡片說明： ")),I.value.cardUrl!==null?(_(),V("a",{key:0,target:"_blank",class:"underline",href:I.value.cardUrl}," 網站 ",8,Ka)):Y("",!0)]),I.value.cardDescription!==""||I.value.cardDescription!==null?(_(),V("p",Ha,M(I.value.cardDescription),1)):Y("",!0),I.value.pointExchangeName!==""?(_(),V("p",Wa,M(I.value.pointExchangeName),1)):Y("",!0),s[8]||(s[8]=h("br",null,null,-1)),h("p",null,"消費金額: "+M(T.value),1),h("p",null,"哩程預估: "+M(I.value.miles)+" "+M(I.value.airLinesCode),1),s[9]||(s[9]=h("br",null,null,-1)),(_(!0),V(z,null,ee(I.value.calculateDetail,(F,Q)=>(_(),V("p",{key:Q},M(F),1))),128))])]),actions:w(()=>[p(H,{class:"ms-auto",text:"Close",onClick:s[5]||(s[5]=F=>I.value=null)})]),_:1},8,["title"])):Y("",!0)]),_:1},8,["model-value"])],64)}}}),Ya=We(za,[["__scopeId","data-v-498044a0"]]),Xa={class:"flex-col h-full overflow-hidden gap-8px"},qa={class:"flex-shrink-0 flex-col gap-8px"},Za={class:"flex-center gap-4px"},Qa={key:0,class:"mdi mdi-check-circle"},en={key:0,class:"flex justify-between items-center"},tn={class:"flex gap-8px"},an={key:0,class:"gap-4px flex-col flex-grow-1 overflow-y-auto"},nn={class:"text-1rem"},ln={class:"text-0.8rem"},on={key:1,class:"flex-grow-1"},sn={class:"flex-col gap-24px m-8px"},rn={class:"flex-col gap-4px"},dn=le({__name:"StoreAliasManagement",setup(c){const t=_e(),{aliasType:a,customAliases:i,storeAliases:x}=he(t),u=se("storeList"),f={default:"系統預設",additional:"預設+自定義",custom:"自定義"},l=O(!0),v=O(!1),P=O(!0),n=O("[]"),r=O(null),U=te(()=>{let C;return a.value==="default"?C=dt:a.value==="additional"?C=[...x.value].map(([S,I])=>[S,[...I]]):C=[...i.value],C.map(([S,I])=>({title:S,aliases:[...I]}))});ge(()=>{var C;return(C=r.value)==null?void 0:C.title},C=>{if(C==null||r.value===null)return;const S=[...i.value.get(C)??[]];S[S.length-1]!==""&&S.push(""),r.value.aliases=S}),ge(l,q),ft(()=>{q(),v.value=!1,P.value=!0,l.value=!0});function T(C,S){if(r.value===null)return;let I=r.value.aliases;I[S]=C,I[I.length-1]!==""&&I.push("")}function $(C){if(a.value!=="default")if(C===null)r.value={title:null,aliases:[]};else{const S=[...i.value.get(C)??[]];S[S.length-1]!==""&&S.push(""),r.value={title:C,aliases:S}}}function e({title:C,aliases:S}){C!==null&&t.updateCustomAliases(C,[...new Set(S)].filter(Pe))}function m(C){if(C=C.trim(),n.value=C,v.value=!0,C===""){P.value=!0;return}try{const S=JSON.parse(C);P.value=Ke(S)}catch(S){console.error(S),P.value=!1}}function D(){let C;if(l.value)C=!0;else{n.value===""&&(n.value="[]");try{const S=JSON.parse(n.value);Ke(S)?(t.updateAllCustomAliases(S),C=!0):C=!1}catch(S){console.error(S),C=!1}}C?(alert("儲存成功"),v.value=!1):alert(`儲存失敗${l.value?"":"，JSON 不符合規則"}`)}function q(){n.value=JSON.stringify([...i.value],null,2)}function G(C){v.value||(C==="default"&&(l.value=!0),t.updateAliasType(C))}return(C,S)=>{const I=A("v-label"),X=A("v-btn"),b=A("v-btn-toggle"),s=A("v-switch"),o=A("v-card"),g=A("v-textarea"),k=A("v-autocomplete"),L=A("v-text-field");return _(),V(z,null,[h("div",Xa,[h("div",qa,[p(I,{text:"別名設定"}),p(b,{"model-value":E(a),rounded:"0",group:"",class:"w-full flex justify-center",disabled:v.value,"onUpdate:modelValue":G},{default:w(()=>[(_(!0),V(z,null,ee(E(ct),(R,B)=>(_(),j(X,{key:B,class:"flex-1",value:R},{default:w(()=>[h("div",Za,[E(a)===R?(_(),V("span",Qa)):Y("",!0),K(" "+M(f[R]),1)])]),_:2},1032,["value"]))),128))]),_:1},8,["model-value","disabled"]),E(a)!=="default"?(_(),V("div",en,[h("div",tn,[l.value?(_(),j(X,{key:0,onClick:S[0]||(S[0]=R=>$(null))},{default:w(()=>S[4]||(S[4]=[K(" Add ")])),_:1})):(_(),j(X,{key:1,onClick:D},{default:w(()=>S[5]||(S[5]=[K(" 儲存 ")])),_:1}))]),p(s,{modelValue:l.value,"onUpdate:modelValue":S[1]||(S[1]=R=>l.value=R),disabled:v.value,"hide-details":"",label:"圖示"},null,8,["modelValue","disabled"])])):Y("",!0)]),l.value?(_(),V("div",an,[(_(!0),V(z,null,ee(U.value,(R,B)=>(_(),j(o,{key:B,density:"compact",class:"mx-auto w-full flex-shrink-0",variant:"outlined",onClick:H=>$(R.title)},{text:w(()=>[h("p",nn,M(R.title),1),h("p",ln,M(R.aliases.join(", ")),1)]),_:2},1032,["onClick"]))),128))])):(_(),V("div",on,[p(g,{"model-value":n.value,clearable:"","auto-grow":"",disabled:E(a)==="default","max-rows":15,messages:v.value?"上方儲存完成後才能執行其他動作，離開這頁不會存檔":"","error-messages":P.value?"":"json 無效",label:"自定義別名設定檔","onUpdate:modelValue":m},null,8,["model-value","disabled","messages","error-messages"])]))]),p(de,{modelValue:r.value,"onUpdate:modelValue":S[3]||(S[3]=R=>r.value=R),title:"編輯商店別名","btn-title":"儲存","btn-event":e},{default:w(({data:R})=>[h("div",sn,[p(k,{ref:"storeList",modelValue:R.title,"onUpdate:modelValue":B=>R.title=B,class:"flex-grow-0","hide-details":"",label:"目標店家",items:E(t).storeList,placeholder:"選擇店家","onUpdate:menu":S[2]||(S[2]=B=>{var H;return!B&&((H=E(u))==null?void 0:H.blur())})},null,8,["modelValue","onUpdate:modelValue","items"]),h("div",rn,[p(I,{text:"自定義別名列表"}),(_(!0),V(z,null,ee(R.aliases,(B,H)=>(_(),j(L,{key:H,"hide-details":"",clearable:"","model-value":B,"onUpdate:modelValue":oe=>T(oe,H),"onClick:clear":()=>R.aliases.splice(H,1)},null,8,["model-value","onUpdate:modelValue","onClick:clear"]))),128))])])]),_:1},8,["modelValue"])],64)}}}),cn={style:{height:"calc(100dvh - 56px)"},class:"overflow-hidden mt-56px p-8px"},un={class:"w-full text-center"},pn={class:"w-full flex items-center justify-between px-8px"},mn=le({__name:"App",setup(c){const t=_e(),{dialog:a}=he(t),i={查詢回饋:Ya,信用卡管理:Va,商家別名:dn,喜好設定:Wt},x=Object.keys(i),u=O(!1),f=O(x[0]);return(l,v)=>{const P=A("v-app-bar-nav-icon"),n=A("v-app-bar-title"),r=A("v-app-bar"),U=A("v-list-item"),T=A("v-divider"),$=A("v-navigation-drawer"),e=A("v-app"),m=A("v-btn"),D=A("v-card"),q=A("v-dialog");return _(),V(z,null,[p(e,null,{default:w(()=>[p(r,{density:"comfortable",elevation:2},{prepend:w(()=>[p(P,{onClick:v[0]||(v[0]=G=>u.value=!u.value)},{default:w(()=>v[2]||(v[2]=[h("i",{class:"fa-solid fa-bars"},null,-1)])),_:1}),p(n,null,{default:w(()=>[K(M(f.value),1)]),_:1})]),_:1}),p($,{modelValue:u.value,"onUpdate:modelValue":v[1]||(v[1]=G=>u.value=G)},{default:w(()=>[(_(!0),V(z,null,ee(E(x),(G,C)=>(_(),V(z,{key:C},[p(U,{title:G,class:fe(["h-48px",{"text-emphasis":f.value===G}]),onClick:()=>{f.value=G,u.value=!1}},null,8,["title","class","onClick"]),p(T)],64))),128))]),_:1},8,["modelValue"]),h("main",cn,[(_(),j(vt,null,[(_(),j(Pt(i[f.value])))],1024))])]),_:1}),p(q,{"model-value":!!E(a),"onUpdate:modelValue":E(t).closeDialog},{default:w(()=>[E(a)!==null?(_(),j(D,{key:0,class:"mx-auto","min-width":"100%"},{text:w(()=>[h("div",un,M(E(a).text),1)]),actions:w(()=>[h("div",pn,[(_(!0),V(z,null,ee(E(a).events,(G,C)=>(_(),j(m,{key:C,text:G.text,class:fe(G.class),variant:"elevated",onClick:async()=>{"event"in G&&await G.event(),E(t).closeDialog()}},null,8,["text","class","onClick"]))),128))])]),_:1})):Y("",!0)]),_:1},8,["model-value","onUpdate:modelValue"])],64)}}}),ze=ht(mn);ze.use(At);ze.use(wt());ze.mount("#app");
//# sourceMappingURL=bestMileageCards-BAy3cYQ7.js.map
