var $e=Object.defineProperty;var Ne=(p,e,a)=>e in p?$e(p,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):p[e]=a;var R=(p,e,a)=>Ne(p,typeof e!="symbol"?e+"":e,a);import{o as Ce,b as L,c as W,f as Z,d as ne,B as _,g as h,j as C,k as w,x as y,C as A,u as E,F as O,l as z,v as $,D as j,t as B,e as fe,y as Q,w as be,E as Ve,m as Oe,K as Fe,G as De,A as Je}from"../index-DoOaPqx1.js";import{d as Ke,s as ce,c as Ge}from"../pinia-DwUF_5rD.js";import{C as je,v as ze}from"../StorageManager-DcRJVMpv.js";import{a as Te,b as Re}from"../sorts-BPW8KRTv.js";import{f as Le,r as ae,b as xe,g as de,a as we}from"../index-f1g9dClV.js";import{_ as Xe}from"../_plugin-vue_export-helper-DlAUqK2U.js";const Be=Le(0),We=ae(0),Ae=ae(2);class ue{constructor({type:e,name:a}){R(this,"_name");R(this,"_type");this._type=e,this._name=a}get name(){return this._name}get type(){return this._type}calculateRangePointsCost(e,a){const s=[];for(let u=e;u<=a;u++){const g=Ae(u/this.calculatePoints(u));isNaN(g)||g===1/0||g===-1/0||s.push(g)}s.sort((u,g)=>u-g);const i=s[s.length-1],m=s[0];if(i===void 0||m===void 0)throw new Error("cannot be calculated");const d=s.reduce((u,g)=>u+g,0)/s.length;return{max:i,min:m,average:Ae(d)}}}class He extends ue{constructor({pointBackRates:a,...s}){super(s);R(this,"_pointBackRates");this._pointBackRates=a}get _maxRete(){return this._pointBackRates.reduce((a,{rate:s})=>a+s,0)}get pointBackRates(){return this._pointBackRates}get description(){return`消費${this._pointBackRates.length>1?"最高":""}${this._maxRete.toString()}%回饋點數(四捨五入)`}calculatePoints(a){let s=0;for(const{rate:i,limit:m=1/0}of this._pointBackRates)s+=Math.min(We(a*(i/100)),m);return s}toJSON(){return{name:this._name,type:this._type,pointBackRates:this._pointBackRates}}}class Ye extends ue{constructor({pointBackRates:a,...s}){super(s);R(this,"_pointBackRates");this._pointBackRates=a}get _maxRete(){return this._pointBackRates.reduce((a,{rate:s})=>a+s,0)}get pointBackRates(){return this._pointBackRates}get description(){return`消費${this._pointBackRates.length>1?"最高":""}${this._maxRete.toString()}%回饋點數(無條件捨去)`}calculatePoints(a){let s=0;for(const{rate:i,limit:m=1/0}of this._pointBackRates)s+=Math.min(Be(a*(i/100)),m);return s}toJSON(){return{name:this._name,type:this._type,pointBackRates:this._pointBackRates}}}class Ze extends ue{constructor({spendingPerPoint:a,...s}){super({...s});R(this,"_spendingPerPoint");this._spendingPerPoint=a}get spendingPerPoint(){return this._spendingPerPoint}get description(){return`每消費${this._spendingPerPoint.toString()}元累積1點 (小數會累計)`}calculatePoints(a){return Ae(a/this._spendingPerPoint)}toJSON(){return{name:this._name,type:this._type,spendingPerPoint:this._spendingPerPoint}}}class Qe extends ue{constructor({spendingPerPoint:a,...s}){super({...s});R(this,"_spendingPerPoint");this._spendingPerPoint=a}get spendingPerPoint(){return this._spendingPerPoint}get description(){return`每消費${this._spendingPerPoint.toString()}元累積1點 (小數不累計)`}calculatePoints(a){return Be(a/this._spendingPerPoint)}toJSON(){return{name:this._name,type:this._type,spendingPerPoint:this._spendingPerPoint}}}const qe={RoundedPercentageReward:He,TruncatedPercentageReward:Ye,AccumulatedPointsReward:Ze,FixedRatePointsReward:Qe};function et(p){return new qe[p.type](p)}class tt{constructor(e,a,s){R(this,"_name");R(this,"_rewards");R(this,"_condition");if(this._name=e,this._condition=a,s.length===0)throw new Error(`Plan "${e??"unknown"}" must have at least one reward rule.`);this._rewards=s}get name(){return this._name}get storeList(){return xe(this._rewards.flatMap(e=>[...e.stores,...e.storeBlackList]))}checkPlanIsVisible(e){return this._condition===null||!!(e!=null&&e.includes(this._condition))}getApplicableReward({transactionStore:e=null,acceptedPayments:a=[],transactionAttributesType:s,currentConditions:i=null}){return this._condition!==null&&!(i!=null&&i.includes(this._condition))?null:this._rewards.find(({stores:m,payments:d,transactionType:u,paymentBlackList:g,storeBlackList:f,condition:o})=>{const v=e===null||m.size===0||m.has(e),S=e===null||f.size===0||!f.has(e),t=a.length===0||d.size===0||a.some(k=>d.has(k)),r=a.length===0||g.size===0||a.some(k=>!g.has(k)),F=u===null||s===u,P=o===null||!!(i!=null&&i.includes(o));return v&&S&&t&&r&&F&&P})??null}getRewardMiles({transactionStore:e,acceptedPayments:a,amount:s,transactionAttributesType:i,currentConditions:m}){const d=this.getApplicableReward({acceptedPayments:a,transactionStore:e,transactionAttributesType:i,currentConditions:m});if(d===null)return null;const u=a===void 0?[...d.payments.values()]:a.filter(g=>d.payments.has(g));return{rewardName:d.rewardStrategy.name,rewardPoints:d.rewardStrategy.calculatePoints(s),payments:u.filter(g=>!d.paymentBlackList.has(g)),rewardStrategy:d.rewardStrategy}}toJSON(){return{name:this._name,condition:this._condition,rewards:this._rewards.map(({rewardStrategy:e,stores:a,payments:s,transactionType:i,paymentBlackList:m,storeBlackList:d,condition:u})=>({rewardStrategy:e.toJSON(),stores:[...a],storeBlackList:[...d],payments:[...s],paymentBlackList:[...m],transactionType:i,condition:u}))}}}const at=["信用卡","Apple Pay","Samsung Pay","Google Pay","Line Pay","Fitbit Pay","Garmin Pay","Hami Pay","街口支付","全盈+PAY","全支付","Pi錢包","橘子支付","歐付寶","icash pay","OPEN錢包","My FamiPay","悠遊付","ezPay","GOMAJI Pay","friday wallet","PayPal","PX Pay","中油Pay","台灣Pay","支付寶"];class nt{constructor({name:e,description:a,plans:s,storeBlackList:i,paymentBlackList:m,cardUrl:d,updateAt:u,pointExchangeStrategies:g}){R(this,"_selectedPlanId");R(this,"_selectedPointExchangeStrategyId");R(this,"_name");R(this,"_description");R(this,"_plans");R(this,"_cardUrl");R(this,"_storeBlackList");R(this,"_paymentBlackList");R(this,"_updateAt");R(this,"_pointExchangeStrategies");this._name=e,this._description=a,this._plans=s,this._cardUrl=d,this._storeBlackList=i,this._paymentBlackList=m,this._updateAt=u,this._pointExchangeStrategies=g;const f=this._plans.keys().next().value;if(this._plans.size===0||f===void 0)throw new Error("this credit card no any plan");this._selectedPlanId=f;const o=this._pointExchangeStrategies.keys().next().value;if(this._plans.size===0||o===void 0)throw new Error("this credit card no any exchange strategy");this._selectedPointExchangeStrategyId=o}get name(){return this._name}get description(){return this._description}get selectedPlanId(){return this._selectedPlanId}get selectedPlan(){return this._getPlan(this._selectedPlanId)}get selectedPointExchangeStrategyId(){return this._selectedPointExchangeStrategyId}get selectedPointExchangeStrategy(){return this._getPointExchangeStrategy(this._selectedPointExchangeStrategyId)}get selectablePlan(){return[...this._plans.entries()].map(([e,{name:a}])=>({id:e,name:a}))}get storeList(){return xe([...[...this._plans.values()].flatMap(e=>e.storeList),...this._storeBlackList])}get cardUrl(){return this._cardUrl}_getPlan(e){const a=this._plans.get(e);if(a===void 0)throw new Error(`plan id ${e} not found. Available plans: ${[...this._plans.keys()].join(", ")}`);return a}_getPointExchangeStrategy(e){const a=this._pointExchangeStrategies.get(e);if(a===void 0)throw new Error(`pointExchangeStrategy id ${e} not found. Available pointExchangeStrategies: ${[...this._plans.keys()].join(", ")}`);return a}_rewardMilesWithPlan(e,a,s){var o;const i=this._getPlan(e),m=this._getPointExchangeStrategy(a),d={planId:e,planName:i.name,rewardName:null,rewardPoints:0,payments:[],rewardStrategy:null,pointExchangeStrategy:m,pointExchangeName:m.name,airlineCode:m.airlineCode,miles:0},u=s.transactionStore!==void 0&&this._storeBlackList.has(s.transactionStore),g=(o=s.acceptedPayments)==null?void 0:o.some(v=>this._paymentBlackList.has(v));if(u||g)return d;const f=i.getRewardMiles(s);return f===null?d:{planId:e,planName:i.name,pointExchangeStrategy:m,pointExchangeName:m.name,miles:m.calculateMiles(f.rewardPoints),airlineCode:m.airlineCode,...f}}updatePlan(e){return this._plans.get(e)?(this._selectedPlanId=e,!0):!1}updatePointExchangeStrategy(e){return this._pointExchangeStrategies.get(e)?(this._selectedPointExchangeStrategyId=e,!0):!1}getRewardInfos(e,{onlyCurrentPlan:a=!1,onlyCurrentExchangeStrategy:s=!1}={}){const i=a?[[this._selectedPlanId,this.selectedPlan]]:[...this._plans.entries()],m=s?[this._selectedPointExchangeStrategyId]:[...this._pointExchangeStrategies.keys()],d=[];for(const[u,g]of i)if(g.checkPlanIsVisible(e.currentConditions??null))for(const o of m){const v=this._rewardMilesWithPlan(u,o,e);d.push(v)}return d}toJSON(){return{name:this._name,description:this._description,cardUrl:this._cardUrl,storeBlackList:[...this._storeBlackList],paymentBlackList:[...this._paymentBlackList],plans:[...this._plans].sort(([e])=>e===this._selectedPlanId?-1:1).map(([e,a])=>a.toJSON()),updateAt:this._updateAt.toISOString(),pointExchangeStrategies:[...this._pointExchangeStrategies].sort(([e])=>e===this._selectedPointExchangeStrategyId?-1:1).map(([e,a])=>a.toJSON())}}}const st=ae(2);class ot{constructor({name:e,airlineCode:a,pointsPerMile:s,milesPerUnit:i}){R(this,"_name");R(this,"_airlineCode");R(this,"_pointsPerMile");R(this,"_milesPerUnit");this._name=e,this._airlineCode=a,this._pointsPerMile=s,this._milesPerUnit=i}get name(){return this._name}get description(){return`${this._pointsPerMile}點可以交換${this._milesPerUnit}哩程`}get airlineCode(){return this._airlineCode}get pointsPerMile(){return this._pointsPerMile}get milesPerUnit(){return this._milesPerUnit}calculateMiles(e){return st(e*this._milesPerUnit/this._pointsPerMile)}toJSON(){return{name:this._name,airlineCode:this._airlineCode,pointsPerMile:this._pointsPerMile,milesPerUnit:this._milesPerUnit}}}function lt({name:p,description:e,storeBlackList:a,paymentBlackList:s,cardUrl:i,plans:m,updateAt:d,pointExchangeStrategies:u}){const g=new Map(m.map(({name:f,condition:o,rewards:v})=>[de(),new tt(f,o??null,v.map(({stores:S,payments:t,transactionType:r,rewardStrategy:F,paymentBlackList:P,storeBlackList:k,condition:J})=>({rewardStrategy:et(F),stores:new Set(S),storeBlackList:new Set(k),payments:new Set(t),paymentBlackList:new Set(P),transactionType:r??null,condition:J??null})))]));return new nt({name:p,description:e,plans:g,storeBlackList:new Set(a),paymentBlackList:new Set(s),cardUrl:i,updateAt:new Date(d),pointExchangeStrategies:new Map(u.map(f=>[de(),new ot(f)]))})}const se=["分期付款"],oe=[],ye=["信用卡","Apple Pay","Samsung Pay","Google Pay","Fitbit Pay","Garmin Pay","Hami Pay"];function le(p){const e={rewardStrategy:{type:"RoundedPercentageReward",name:null,pointBackRates:[{rate:.3}]}};return[{name:"集精選",rewards:[{rewardStrategy:{type:"RoundedPercentageReward",name:null,pointBackRates:[{rate:2}]},stores:["家樂福","LOPIA台灣","全聯福利中心","台灣中油-直營","7-ELEVEN","全家便利商店","IKEA"],payments:[...ye,"PX Pay","My FamiPay","OPEN錢包"]},e]},{name:"玩數位",rewards:[{rewardStrategy:{type:"RoundedPercentageReward",name:null,pointBackRates:[{rate:p}]},stores:["App Store","Apple Music","iCloud","Apple TV+","Apple Arcade","Apple One","iTunes","Google Play","Disney+","Netflix","Spotify","KKBOX","YouTube Premium","蝦皮購物","momo購物網","PChome 24h購物(不含儲值及電子票券)","博客來","小樹購","Coupang 酷澎(台灣)","淘寶/天貓"],paymentBlackList:["Line Pay","街口支付"]},{...e,storeBlackList:["全聯福利中心"]}]},{name:"樂饗購",rewards:[{rewardStrategy:{type:"RoundedPercentageReward",name:null,pointBackRates:[{rate:p}]},stores:["遠東SOGO百貨","遠東Garden City","太平洋百貨","新光三越","SKM Park","BELLAVITA","微風廣場","遠東百貨","Big City遠東巨城購物中心","誠品生活","環球購物中心","CITYLINK","統一時代","台北101","ATT 4 FUN","明曜百貨","京站","美麗華","大葉高島屋","比漾廣場","大江國際購物中心","中友百貨","廣三SOGO","Tiger City","勤美誠品綠園道","大魯閣新時代","耐斯廣場","南紡購物中心","夢時代","漢神百貨","漢神巨蛋","MITSUI OUTLET PARK 林口","MITSUI OUTLET PARK 台中港","MITSUI OUTLET PARK 台南","Mitsui Shopping Park LaLaport 台中","義大世界購物廣場","華泰名品城","義享天地","麗寶OUTLET Mall","秀泰生活","台茂購物中心","新月廣場","三創生活","宏匯廣場","高雄棧貳庫/大港倉","NOKE忠泰樂生活","Uber Eats","foodpanda","foodomo","國內餐飲(不含餐券)","麥當勞","康是美","屈臣氏"],payments:ye},{...e,storeBlackList:["全聯福利中心"]}]},{name:"趣旅行",rewards:[{rewardStrategy:{type:"RoundedPercentageReward",name:null,pointBackRates:[{rate:p}]},stores:["海外實體消費","東京迪士尼樂園","東京華納兄弟哈利波特影城","大阪環球影城(USJ)","吉卜力公園","Apple Wallet SUICA","Apple Wallet PASMO","Apple Wallet ICOCA","Uber","Grab","台灣高鐵","yoxi","台灣大車隊","iRent","和運租車","格上租車","中華航空","長榮航空","星宇航空","台灣虎航","國泰航空","樂桃航空","阿聯酋航空","酷航","捷星航空","日本航空","亞洲航空","聯合航空","ANA全日空","新加坡航空","越捷航空","大韓航空","達美航空","土耳其航空","卡達航空","法國航空","國內飯店住宿","星野集團","全球迪士尼飯店","東橫INN","KKday","Agoda","Klook","Airbnb","Hotels.com","Expedia","Booking.com","Trip.com","AsiaYo","ezTravel易遊網","雄獅旅遊","可樂旅遊","東南旅遊","五福旅遊","燦星旅遊","山富旅遊","長汎假期","鳳凰旅行社","Ezfly易飛網","理想旅遊","永利旅行社","三賀旅行社","173WIFI","JetFi mobile","威訊 WaySim","AIRSIM","SIM88"],payments:ye},{...e,storeBlackList:["全聯福利中心"]}]},{name:"來支付",rewards:[{rewardStrategy:{type:"RoundedPercentageReward",name:null,pointBackRates:[{rate:2}]},payments:["Line Pay"]},{...e,storeBlackList:["全聯福利中心"]}]},{name:"慶生月",condition:"Birthday",rewards:[{rewardStrategy:{type:"RoundedPercentageReward",name:null,pointBackRates:[{rate:10}]},stores:["東京迪士尼樂園","大阪環球影城(USJ)","名古屋樂高樂園","紅葉蛋糕官方網站","法朋烘焙甜點坊","興波咖啡 華山旗艦店","海底撈火鍋","輕井澤鍋物","老四川巴蜀麻辣燙","二本松涮涮屋","橋山.壽喜燒","Umai屋馬燒肉","老井極上燒肉","燒肉中山(台中大墩)","藏壽司台灣","貳樓","膳馨民間創作料理","馨苑小料理","雅室牛排 仁愛圓環店","ABV餐飲集團","WAT","臺虎精釀(信義 | 西門 | 臺中 | 啜飲室大安)","BAR Bodega","BAR MED","JiN Her 今鶴","錢櫃KTV","好樂迪KTV","星聚點KTV","享溫馨KTV","Nintendo","巴哈姆特動畫瘋","閃動格子CyberCube"]},{rewardStrategy:{type:"RoundedPercentageReward",name:null,pointBackRates:[{rate:3.5}]},stores:["新光三越","Uber Eats (不含 Uber One)","Agoda","Trip.com","Klook","國內飯店住宿","星野集團","全球迪士尼飯店","東橫INN"]},{...e,storeBlackList:["全聯福利中心"]}]}]}const ge=[{name:"長榮航空哩程",airlineCode:"EVA",pointsPerMile:360,milesPerUnit:1e3},{name:"長榮航空哩程 + 長榮世界卡",airlineCode:"EVA",pointsPerMile:300,milesPerUnit:1e3}],rt=[{name:"Cube 卡",description:"Cube 卡 (Level 1) 回饋方案",cardUrl:"https://www.cathaybk.com.tw/cathaybk/personal/product/credit-card/cards/cube/",storeBlackList:se,paymentBlackList:oe,updateAt:"2024-12-01T00:00:00.000Z",plans:le(2),pointExchangeStrategies:ge},{name:"Cube 卡",description:"Cube 卡 (Level 2) 回饋方案",cardUrl:"https://www.cathaybk.com.tw/cathaybk/personal/product/credit-card/cards/cube/",storeBlackList:se,paymentBlackList:oe,updateAt:"2024-12-01T00:00:00.000Z",plans:le(3),pointExchangeStrategies:ge},{name:"Cube 卡",description:"Cube 卡 (Level 3) 回饋方案",cardUrl:"https://www.cathaybk.com.tw/cathaybk/personal/product/credit-card/cards/cube/",storeBlackList:se,paymentBlackList:oe,updateAt:"2024-12-01T00:00:00.000Z",plans:le(3.3),pointExchangeStrategies:ge}],it={name:"Cube 卡",description:"Cube 卡 (Level 2) 回饋方案",cardUrl:"https://www.cathaybk.com.tw/cathaybk/personal/product/credit-card/cards/cube/",storeBlackList:se,paymentBlackList:oe,updateAt:"2024-12-01T00:00:00.000Z",plans:le(3),pointExchangeStrategies:[{name:"長榮航空哩程",airlineCode:"EVA",pointsPerMile:360,milesPerUnit:1e3}]},re=["政府稅款","公共事業代扣繳","交通違規罰鍰","分期付款","全聯福利中心","7-ELEVEN","全家便利商店"],ie=[],dt=[{name:"星宇世界卡",description:"",cardUrl:"https://www.esunbank.com/zh-tw/personal/credit-card/intro/co-branded-card/starlux-card",storeBlackList:re,paymentBlackList:ie,pointExchangeStrategies:[{name:"星宇航空哩程",airlineCode:"SJX",pointsPerMile:1,milesPerUnit:1}],plans:[{name:null,rewards:[{rewardStrategy:{type:"FixedRatePointsReward",name:"國外消費",spendingPerPoint:5},transactionType:"Foreign",condition:"Birthday"},{rewardStrategy:{type:"FixedRatePointsReward",name:"國外消費",spendingPerPoint:10},transactionType:"Foreign"},{rewardStrategy:{type:"FixedRatePointsReward",name:"國內消費",spendingPerPoint:20},transactionType:"Domestic"}]}],updateAt:new Date("2024/12/01 00:00:00").toISOString()},{name:"星宇商務鈦金卡",description:"",cardUrl:"https://www.esunbank.com/zh-tw/personal/credit-card/intro/co-branded-card/starlux-card",storeBlackList:re,paymentBlackList:ie,pointExchangeStrategies:[{name:"星宇航空哩程",airlineCode:"SJX",pointsPerMile:1,milesPerUnit:1}],plans:[{name:null,rewards:[{rewardStrategy:{type:"FixedRatePointsReward",name:"國外消費",spendingPerPoint:7.5},transactionType:"Foreign",condition:"Birthday"},{rewardStrategy:{type:"FixedRatePointsReward",name:"國外消費",spendingPerPoint:15},transactionType:"Foreign"},{rewardStrategy:{type:"FixedRatePointsReward",name:"國內消費",spendingPerPoint:25},transactionType:"Domestic"}]}],updateAt:new Date("2024/12/01 00:00:00").toISOString()},{name:"星宇鈦金卡",description:"",cardUrl:"https://www.esunbank.com/zh-tw/personal/credit-card/intro/co-branded-card/starlux-card",storeBlackList:re,paymentBlackList:ie,pointExchangeStrategies:[{name:"星宇航空哩程",airlineCode:"SJX",pointsPerMile:1,milesPerUnit:1}],plans:[{name:null,rewards:[{rewardStrategy:{type:"FixedRatePointsReward",name:"國外消費",spendingPerPoint:20},transactionType:"Foreign"},{rewardStrategy:{type:"FixedRatePointsReward",name:"國內消費",spendingPerPoint:28},transactionType:"Domestic"}]}],updateAt:new Date("2024/12/01 00:00:00").toISOString()}],ve=["台灣中油-直營","台灣大車隊","台鐵","台灣高鐵","UBER","Yoxi","LINEGO","新光三越","遠東百貨","遠東SOGO百貨","誠品生活","漢神百貨","微風廣場","微風信義","微風南京","微風南山","微風台北車站","環球購物中心","台北101","華泰名品城","MITSUI OUTLET PARK 林口","MITSUI OUTLET PARK 台中港","MITSUI OUTLET PARK 台南","Big City遠東巨城購物中心","昇恆昌","夢時代購物中心","京站","美麗華","南紡購物中心","秀泰生活","台茂購物中心","Mitsui Shopping Park LaLaport 台中","統領廣場","采盟","Uber Eats","foodpanda","星巴克","EZTABLE","王品瘋美食","摩斯漢堡","foodomo","漢來美食","饗Joy","饗食天堂","果然匯","小福利","饗饗","旭集","開飯","饗泰多","真珠","瓦城","非常泰","大心","1010","時時香","BOBO","乾杯集團","路易莎","中華航空","長榮航空","日本航空","台灣虎航","樂桃航空","酷航","立榮航空","華信航空","Agoda","booking.com","Hotels.com","AsiaYo","Expedia","KKday","Klook","雄獅旅遊","可樂旅遊","東南旅行社","Apple直營店","小米台灣","全國電子","燦坤","迪卡儂","屈臣氏","康是美","IKEA","特力屋","特力和樂","UNIQLO","NET","大樹藥局","丁丁藥妝","momo購物網","蝦皮購物","淘寶網","Coupang酷澎","東森購物","雅虎奇摩購物中心","博客來","玉山Wallet愛心捐款-單筆捐款","玉山Wallet愛心捐款-定期定額","特斯拉","Gogoro電池資費","YouBike 2.0","日本實體店","韓國實體店","泰國實體店","越南實體店","新加坡實體店","中國實體店","香港實體店","澳門實體店","美國實體店","英國實體店","法國實體店","德國實體店","義大利實體店"],_e={rewardStrategy:{type:"TruncatedPercentageReward",name:null,pointBackRates:[{rate:.3},{rate:.7}]}},Ee=[{name:"UniCard 卡",description:"",cardUrl:"https://www.esunbank.com/zh-tw/personal/credit-card/intro/bank-card/unicard",storeBlackList:re,paymentBlackList:ie,pointExchangeStrategies:[{name:"長榮航空哩程",airlineCode:"EVA",pointsPerMile:200,milesPerUnit:300}],plans:[{name:"任意選 (需要切換店家)",rewards:[{rewardStrategy:{type:"TruncatedPercentageReward",name:null,pointBackRates:[{rate:.3},{rate:.7},{rate:2.5,limit:500}]},stores:ve,payments:["信用卡","Apple Pay","Samsung Pay","Google Pay"]},{rewardStrategy:{type:"TruncatedPercentageReward",name:null,pointBackRates:[{rate:.3},{rate:.7},{rate:2.5,limit:500}]},payments:["Line Pay","街口支付","悠遊付","橘子支付","icash pay"]},_e]},{name:"簡單選",rewards:[{rewardStrategy:{type:"TruncatedPercentageReward",name:null,pointBackRates:[{rate:.3},{rate:.7},{rate:2,limit:500}]},stores:ve,payments:["信用卡","Apple Pay","Samsung Pay","Google Pay"]},{rewardStrategy:{type:"TruncatedPercentageReward",name:null,pointBackRates:[{rate:.3},{rate:.7},{rate:2,limit:500}]},payments:["Line Pay","街口支付","悠遊付","橘子支付","icash pay"]},_e]},{name:"UP選",rewards:[{rewardStrategy:{type:"TruncatedPercentageReward",name:null,pointBackRates:[{rate:.3},{rate:.7},{rate:3.5,limit:2e3}]},stores:ve,payments:["信用卡","Apple Pay","Samsung Pay","Google Pay"]},{rewardStrategy:{type:"TruncatedPercentageReward",name:null,pointBackRates:[{rate:.3},{rate:.7},{rate:3.5,limit:2e3}]},payments:["Line Pay","街口支付","悠遊付","橘子支付","icash pay"]},_e]}],updateAt:new Date("2024/12/01 00:00:00").toISOString()}],ct=Ee[0],Pe=["政府稅款","公共事業代扣繳","交通違規罰鍰","分期付款"],he=["全盈+PAY","icash pay","OPEN錢包","My FamiPay"],Me=[{name:"旅人無限卡",description:"",cardUrl:"https://www.hsbc.com.tw/credit-cards/products/travel/visa-infinite/",storeBlackList:Pe,paymentBlackList:he,pointExchangeStrategies:[{name:"長榮航空哩程",airlineCode:"EVA",pointsPerMile:1,milesPerUnit:1}],plans:[{name:null,rewards:[{rewardStrategy:{type:"AccumulatedPointsReward",name:"國外消費",spendingPerPoint:10},transactionType:"Foreign"},{rewardStrategy:{type:"AccumulatedPointsReward",name:"國內消費",spendingPerPoint:18},transactionType:"Domestic"}]}],updateAt:new Date("2024/12/01 00:00:00").toISOString()},{name:"旅人御璽卡",description:"",cardUrl:"https://www.hsbc.com.tw/credit-cards/products/travel/visa-signature/",storeBlackList:Pe,paymentBlackList:he,pointExchangeStrategies:[{name:"長榮航空哩程",airlineCode:"EVA",pointsPerMile:1,milesPerUnit:1}],plans:[{name:null,rewards:[{rewardStrategy:{type:"AccumulatedPointsReward",name:"國外消費",spendingPerPoint:15},transactionType:"Foreign"},{rewardStrategy:{type:"AccumulatedPointsReward",name:"國內消費",spendingPerPoint:18},transactionType:"Domestic"}]}],updateAt:new Date("2024/12/01 00:00:00").toISOString()},{name:"旅人輕旅卡",description:"",cardUrl:"https://www.hsbc.com.tw/credit-cards/products/travel/visa-light/",storeBlackList:Pe,paymentBlackList:he,pointExchangeStrategies:[{name:"長榮航空哩程",airlineCode:"EVA",pointsPerMile:1,milesPerUnit:1}],plans:[{name:null,rewards:[{rewardStrategy:{type:"AccumulatedPointsReward",name:"國外消費",spendingPerPoint:20},transactionType:"Foreign"},{rewardStrategy:{type:"AccumulatedPointsReward",name:"國內消費",spendingPerPoint:20},transactionType:"Domestic"}]}],updateAt:new Date("2024/12/01 00:00:00").toISOString()}],ut=Me[2],pt=[it,ut,ct],mt=[...rt,...Me,...dt,...Ee],Se=p=>Array.isArray(p)&&p.every(e=>Array.isArray(e)&&e.length===2&&typeof e[0]=="string"&&Array.isArray(e[1])&&e[1].every(a=>typeof a=="string")),Ue=[["7-ELEVEN",["7-11","Seven Eleven","統一超商","小7"]],["ANA全日空",["ANA","全日空","All Nippon Airways","NH"]],["ATT 4 FUN",["ATT4FUN","ATT信義"]],["App Store",["蘋果應用商店"]],["Apple Arcade",["蘋果遊戲訂閱服務"]],["Apple Music",["蘋果音樂","Apple音樂"]],["Apple One",["蘋果One訂閱"]],["Apple TV+",["Apple TV Plus"]],["Apple Wallet ICOCA",["ICOCA電子票","Apple錢包ICOCA"]],["Apple Wallet PASMO",["PASMO電子票","Apple錢包PASMO"]],["Apple Wallet SUICA",["SUICA電子票","Apple錢包SUICA"]],["CITYLINK",["City Link"]],["Disney+",["Disney Plus","迪士尼+"]],["Google Play",["Google應用商店"]],["Grab",["Grab Taxi","Grab叫車"]],["MITSUI OUTLET PARK 台中港",["三井台中港","三井OUTLET台中"]],["MITSUI OUTLET PARK 台南",["三井台南","三井OUTLET台南"]],["MITSUI OUTLET PARK 林口",["三井林口","三井OUTLET林口"]],["Mitsui Shopping Park LaLaport 台中",["LaLaport台中","三井LaLaport台中"]],["Netflix",["網飛"]],["Nintendo",["任天堂","Switch","老任"]],["PChome 24h購物(不含儲值及電子票券)",["PChome","PChome購物"]],["Tiger City",["老虎城","Tiger City購物中心"]],["Trip.com",["攜程"]],["Uber Eats (不含 Uber One)",["優步外送"]],["foodpanda",["熊貓外送","Food Panda"]],["iCloud",["蘋果雲端","iCloud雲端"]],["iRent",["i Rent"]],["iTunes",["蘋果iTunes"]],["中友百貨",["中友"]],["中華航空",["China Airlines","CAL","CI","華航"]],["亞洲航空",["AirAsia","亞航","AXM","AK"]],["京站",["Q Square","京站商場"]],["全家便利商店",["FamilyMart","全家"]],["全球迪士尼飯店",["Disney Hotels"]],["全聯福利中心",["PX Mart"]],["南紡購物中心",["Tainan Spinnery Mall","南紡"]],["博客來",["Books.com.tw"]],["卡達航空",["Qatar Airways","卡航","QTR","QR"]],["可樂旅遊",["Cola Travel","可樂旅行社"]],["台北101",["Taipei 101","101大樓"]],["台灣中油-直營",["中油直營","直營中油"]],["台灣大車隊",["Taiwan Taxi","大車隊"]],["台灣虎航",["Tigerair Taiwan","台虎","TWA","IT"]],["台灣高鐵",["Taiwan High Speed Rail"]],["台茂購物中心",["TaiMall"]],["吉卜力公園",["Ghibli Park"]],["國泰航空",["Cathay Pacific","國泰","CPA","CX","Cathay Pacific Airways"]],["土耳其航空",["Turkish Airlines","土航","THY","TK"]],["夢時代",["Dream Mall"]],["大阪環球影城(USJ)",["Universal Studios Japan"]],["大韓航空",["Korean Air","韓航","KAL","KE"]],["大魯閣新時代",["Taroko Mall","大魯閣"]],["太平洋百貨",["Pacific Department Store","太平洋"]],["好樂迪KTV",["Holiday"]],["家樂福",["Carrefour"]],["屈臣氏",["Watsons"]],["康是美",["Cosmed"]],["捷星航空",["JST","JQ","Jetstar Airways"]],["新加坡航空",["SIA","SQ","Singapore Airlines"]],["日本航空",["JAL","JL","Japan Airlines"]],["星宇航空",["starlux","SJX","JX","STARLUX Airlines"]],["樂桃航空",["APJ","MM","Peach Aviation"]],["法國航空",["AFR","AF","Air France"]],["聯合航空",["UAL","UA","United Airlines"]],["蝦皮購物",["shopee"]],["越捷航空",["VJC","VJ","VietJet Air"]],["達美航空",["DAL","DL","Delta Air Lines"]],["遠東百貨",["遠百"]],["酷航",["SCO","TR","Scoot"]],["長榮航空",["EVA","BR","EVA Airlines","EVA Air"]],["阿聯酋航空",["UAE","EK","Emirates"]],["麥當勞",["McDonald's"]],["IKEA",["宜家家居"]],["星巴克",["starbucks"]]],yt=p=>p==="AllPlanRewardMiles"||p==="CurrentPlanRewardMiles",D=new je(localStorage,{showRewardMilesType:yt,commonPaymentMethods:(()=>{const p=new Set(["信用卡","Apple Pay","Samsung Pay","Google Pay","Line Pay","Fitbit Pay","Garmin Pay","Hami Pay","街口支付","全盈+PAY","全支付","Pi錢包","橘子支付","歐付寶","icash pay","OPEN錢包","My FamiPay","悠遊付","ezPay","GOMAJI Pay","friday wallet","PayPal","PX Pay","中油Pay","台灣Pay","支付寶"]);return e=>Array.isArray(e)&&e.every(a=>p.has(a)===!0)})(),cardConfigs:(()=>{const p=new Set(["信用卡","Apple Pay","Samsung Pay","Google Pay","Line Pay","Fitbit Pay","Garmin Pay","Hami Pay","街口支付","全盈+PAY","全支付","Pi錢包","橘子支付","歐付寶","icash pay","OPEN錢包","My FamiPay","悠遊付","ezPay","GOMAJI Pay","friday wallet","PayPal","PX Pay","中油Pay","台灣Pay","支付寶"]),e=new Set(["信用卡","Apple Pay","Samsung Pay","Google Pay","Line Pay","Fitbit Pay","Garmin Pay","Hami Pay","街口支付","全盈+PAY","全支付","Pi錢包","橘子支付","歐付寶","icash pay","OPEN錢包","My FamiPay","悠遊付","ezPay","GOMAJI Pay","friday wallet","PayPal","PX Pay","中油Pay","台灣Pay","支付寶"]),a=new Set(["信用卡","Apple Pay","Samsung Pay","Google Pay","Line Pay","Fitbit Pay","Garmin Pay","Hami Pay","街口支付","全盈+PAY","全支付","Pi錢包","橘子支付","歐付寶","icash pay","OPEN錢包","My FamiPay","悠遊付","ezPay","GOMAJI Pay","friday wallet","PayPal","PX Pay","中油Pay","台灣Pay","支付寶"]),s=t=>typeof t.name=="string"&&typeof t.description=="string"&&(t.cardUrl===null||typeof t.cardUrl=="string")&&(t.storeBlackList===void 0||Array.isArray(t.storeBlackList)&&t.storeBlackList.every(r=>typeof r=="string"))&&(t.paymentBlackList===void 0||Array.isArray(t.paymentBlackList)&&t.paymentBlackList.every(r=>p.has(r)===!0))&&Array.isArray(t.plans)&&t.plans.every(r=>typeof r=="object"&&r!==null&&i(r))&&typeof t.updateAt=="string"&&RegExp(/^[+-]?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?\x2d[+-]?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?\x2d[+-]?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?T[+-]?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?:[+-]?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?:[+-]?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?\.[+-]?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?Z$/).test(t.updateAt)&&Array.isArray(t.pointExchangeStrategies)&&t.pointExchangeStrategies.every(r=>typeof r=="object"&&r!==null&&v(r)),i=t=>(t.name===null||typeof t.name=="string")&&Array.isArray(t.rewards)&&t.rewards.every(r=>typeof r=="object"&&r!==null&&m(r))&&(t.condition===null||t.condition===void 0||t.condition==="Birthday"),m=t=>typeof t.rewardStrategy=="object"&&t.rewardStrategy!==null&&S(t.rewardStrategy)&&(t.transactionType===null||t.transactionType===void 0||t.transactionType==="Domestic"||t.transactionType==="Foreign")&&(t.stores===void 0||Array.isArray(t.stores)&&t.stores.every(r=>typeof r=="string"))&&(t.storeBlackList===void 0||Array.isArray(t.storeBlackList)&&t.storeBlackList.every(r=>typeof r=="string"))&&(t.payments===void 0||Array.isArray(t.payments)&&t.payments.every(r=>e.has(r)===!0))&&(t.paymentBlackList===void 0||Array.isArray(t.paymentBlackList)&&t.paymentBlackList.every(r=>a.has(r)===!0))&&(t.condition===null||t.condition===void 0||t.condition==="Birthday"),d=t=>Array.isArray(t.pointBackRates)&&t.pointBackRates.every(r=>typeof r=="object"&&r!==null&&u(r))&&(t.name===null||typeof t.name=="string")&&t.type==="RoundedPercentageReward",u=t=>typeof t.rate=="number"&&(t.limit===void 0||typeof t.limit=="number"),g=t=>Array.isArray(t.pointBackRates)&&t.pointBackRates.every(r=>typeof r=="object"&&r!==null&&u(r))&&(t.name===null||typeof t.name=="string")&&t.type==="TruncatedPercentageReward",f=t=>typeof t.spendingPerPoint=="number"&&(t.name===null||typeof t.name=="string")&&t.type==="AccumulatedPointsReward",o=t=>typeof t.spendingPerPoint=="number"&&(t.name===null||typeof t.name=="string")&&t.type==="FixedRatePointsReward",v=t=>(t.name===null||typeof t.name=="string")&&typeof t.airlineCode=="string"&&typeof t.pointsPerMile=="number"&&typeof t.milesPerUnit=="number",S=t=>t.type==="TruncatedPercentageReward"?g(t):t.type==="RoundedPercentageReward"?d(t):t.type==="FixedRatePointsReward"?o(t):t.type==="AccumulatedPointsReward"?f(t):!1;return t=>Array.isArray(t)&&t.every(r=>typeof r=="object"&&r!==null&&s(r))})(),conditionTypes:p=>Array.isArray(p)&&p.every(e=>e==="Birthday"),aliasType:p=>p==="default"||p==="additional"||p==="custom",customAliases:Se},"bestMileageCards"),Ie=["default","additional","custom"],pe=Ke("BestMileageCards",()=>{Ce(()=>{const P=D.get("cardConfigs")??[];i.value=new Map(P.map(k=>[de(),k]))});const p=L(D.get("showRewardMilesType")??"AllPlanRewardMiles");function e(P){D.set("showRewardMilesType",P),p.value=P}const a=L(D.get("commonPaymentMethods")??["信用卡","Apple Pay","Line Pay","街口支付"]);function s([...P]){P=[...new Set(P)],D.set("commonPaymentMethods",P),a.value=P}const i=L(new Map),m=W(()=>(i.value.size===0?pt:[...i.value.values()]).map(k=>lt(k)));function d(P,k){i.value.set(P,k),D.set("cardConfigs",[...i.value.values()])}const u=W(()=>Te(xe(m.value.flatMap(P=>P.storeList)),"asc")),g=L(D.get("conditionTypes")??[]);function f([...P]){g.value=P,D.set("conditionTypes",P)}const o=L(D.get("aliasType")??"default");function v(P){Ie.includes(P)&&(o.value=P,D.set("aliasType",P))}const S=L(new Map(D.get("customAliases")??[]));function t(P,k){k.length===0?S.value.delete(P):S.value.set(P,k),D.set("customAliases",[...S.value])}function r(P){S.value=new Map(P),D.set("customAliases",P)}const F=W(()=>{const P=[];["default","additional"].includes(o.value)&&P.push(...Ue),["additional","custom"].includes(o.value)&&P.push(...S.value);const k=new Map;for(const[J,b]of P){const l=k.get(J)??new Set;for(const n of b)l.add(n);k.set(J,l)}return k});return{showRewardMilesType:Z(p),updateShowRewardMilesType:e,commonPaymentMethods:Z(a),updateCommonPaymentMethods:s,cardConfigs:Z(i),cards:m,updateCardConfig:d,storeList:Z(u),conditionTypes:Z(g),updateConditionTypes:f,aliasType:Z(o),storeAliases:F,updateAliasType:v,customAliases:Z(S),updateCustomAliases:t,updateAllCustomAliases:r}}),gt={class:"flex-col gap-24px my-16px"},vt={class:"flex-center gap-8px"},_t={class:"flex mx-16px"},Pt=ne({__name:"CommonSettings",setup(p){const e=pe(),{showRewardMilesType:a,commonPaymentMethods:s,conditionTypes:i}=ce(e);return(m,d)=>{const u=_("v-label"),g=_("v-radio"),f=_("v-radio-group"),o=_("v-select"),v=_("v-switch");return h(),C("div",gt,[w("div",vt,[y(u,{text:"回饋顯示"}),y(f,{"model-value":E(a),"hide-details":"",inline:"","onUpdate:modelValue":d[0]||(d[0]=S=>S!==null&&E(e).updateShowRewardMilesType(S))},{default:A(()=>[y(g,{density:"compact",label:"全部方案",value:"AllPlanRewardMiles"}),y(g,{density:"compact",label:"當前方案",value:"CurrentPlanRewardMiles"})]),_:1},8,["model-value"])]),w("div",null,[y(o,{"model-value":E(s),items:E(Te)(E(at),"asc"),label:"使用中的付款方式",multiple:"","hide-details":"","onUpdate:modelValue":d[1]||(d[1]=S=>S!==null&&E(e).updateCommonPaymentMethods(S))},null,8,["model-value","items"])]),w("div",null,[y(u,{text:"其他設定"}),w("div",_t,[y(v,{"model-value":E(i),label:"生日中",value:"Birthday","hide-details":"",color:"blue","onUpdate:modelValue":d[2]||(d[2]=S=>S!==null&&E(e).updateConditionTypes(S))},null,8,["model-value"])])])])}}}),ht={class:"flex-col gap-8px"},ft={class:"flex justify-end"},wt={class:"flex-col"},At={class:"text-1rem"},St={class:"text-0.75rem"},te="ADD",xt=ne({__name:"CreditCardManagement",setup(p){const e=pe(),{cardConfigs:a}=ce(e),s=W(()=>[...a.value.keys()]),i=W(()=>m.value===te?null:a.value.get(m.value)??null),m=L(te);Ce(()=>{const f=s.value[0];f&&(m.value=f)});const d=L(!1),u=L([]);function g(){for(const f of u.value)e.updateCardConfig(de(),f),d.value=!1}return(f,o)=>{const v=_("v-btn"),S=_("v-tab"),t=_("v-tabs"),r=_("v-tabs-window-item"),F=_("v-tabs-window"),P=_("v-card-text"),k=_("v-card"),J=_("v-checkbox"),b=_("v-dialog");return h(),C(O,null,[w("div",ht,[w("div",ft,[y(v,{text:"匯入",onClick:o[0]||(o[0]=()=>{u.value=[],d.value=!0})})]),y(k,null,{default:A(()=>[y(t,{modelValue:m.value,"onUpdate:modelValue":o[1]||(o[1]=l=>m.value=l)},{default:A(()=>[(h(!0),C(O,null,z(s.value,(l,n)=>(h(),$(S,{key:n,value:l},{default:A(()=>{var c;return[j(B(((c=E(a).get(l))==null?void 0:c.name)??"unknown"),1)]}),_:2},1032,["value"]))),128)),y(S,{value:te},{default:A(()=>o[6]||(o[6]=[w("i",{class:"fas fa-plus text-16px"},null,-1)])),_:1})]),_:1},8,["modelValue"]),y(P,null,{default:A(()=>[y(F,{modelValue:m.value,"onUpdate:modelValue":o[2]||(o[2]=l=>m.value=l)},{default:A(()=>[(h(!0),C(O,null,z(s.value,(l,n)=>(h(),$(r,{key:n,value:l},{default:A(()=>[j(B(i.value),1)]),_:2},1032,["value"]))),128)),y(r,{value:te},{default:A(()=>[j(B(te))]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),y(b,{modelValue:d.value,"onUpdate:modelValue":o[5]||(o[5]=l=>d.value=l)},{default:A(()=>[y(k,{class:"mx-auto","min-width":"100%",title:"請選擇卡片匯入"},{actions:A(()=>[y(v,{text:"取消",onClick:o[4]||(o[4]=l=>d.value=!1)}),y(v,{text:"匯入",onClick:g})]),default:A(()=>[(h(!0),C(O,null,z(E(mt),(l,n)=>(h(),$(J,{key:n,modelValue:u.value,"onUpdate:modelValue":o[3]||(o[3]=c=>u.value=c),value:l,"hide-details":"",density:"comfortable"},{label:A(()=>[w("div",wt,[w("p",At,B(l.name),1),w("p",St,B(l.description),1)])]),_:2},1032,["modelValue","value"]))),128))]),_:1})]),_:1},8,["modelValue"])],64)}}}),kt={class:"gap-8px h-full flex-col"},bt={class:"flex items-center flex-wrap gap-x-8px"},Rt={class:"gap-8px flex-center"},Ct={ref:"rewardCardList",class:"flex-col gap-4px flex-grow-1 overflow-y-auto"},Tt={class:"flex items-center justify-between"},Lt={class:"flex gap-4px items-end"},Bt={class:"text-12px opacity-50 p-4px"},Et={key:0,class:"fa-solid fa-circle-check"},Mt={class:"flex-col gap-8px"},Ut={class:"text-0.75rem"},It={class:"text-wrap"},$t={class:"flex-col"},Nt={class:"flex justify-between"},Vt=["href"],Ot={key:0},Ft={key:1},Dt="其他店家",Jt=ne({__name:"SearchReward",setup(p){const e=ae(0),a=ae(2),s=Le(0),{showRewardMilesType:i,commonPaymentMethods:m,cards:d,conditionTypes:u,storeAliases:g,storeList:f}=ce(pe()),o=L(0),v=L(null),S=L("Domestic"),t=L([]),r=fe("rewardCardList"),F=fe("storeAutoComplete"),P=W(()=>{const n=f.value.map(c=>({store:c,aliases:[...g.value.get(c)??[]]}));return[{store:Dt},...n]});function k(n,c,M){return c=c.toLowerCase(),[n,...(M==null?void 0:M.raw.aliases)??[]].map(V=>V.toLowerCase()).some(V=>V.includes(c))}const J=W(()=>{var M;const n={amount:o.value,acceptedPayments:t.value,transactionAttributesType:S.value,currentConditions:[...u.value]};we(v.value)&&(n.transactionStore=v.value);const c=[];for(const N of d.value){const V=N.getRewardInfos(n,i.value==="CurrentPlanRewardMiles"?{onlyCurrentExchangeStrategy:!0,onlyCurrentPlan:!0}:{});for(const T of V){const I={cardName:N.name,planName:T.planName,rewardName:T.rewardName,miles:T.miles,payments:T.payments,airLinesCode:T.airlineCode,isSelectedPlan:i.value==="AllPlanRewardMiles"&&T.planId===N.selectedPlanId,calculateDetail:l(T.rewardStrategy,T.pointExchangeStrategy),description:T.rewardStrategy===null?null:`${T.rewardStrategy.description}，${T.pointExchangeStrategy.description}`,cardUrl:N.cardUrl,cardDescription:N.description,pointExchangeName:T.pointExchangeName};c.push(I)}}return(M=r.value)==null||M.scrollTo({top:0,behavior:"smooth"}),Re(Re(c,"isSelectedPlan","desc"),"miles","desc")}),b=L(null);function l(n,c){const{pointsPerMile:M,milesPerUnit:N,airlineCode:V}=c,T="回饋計算:";switch(n==null?void 0:n.type){case"RoundedPercentageReward":case"TruncatedPercentageReward":{const I=n.type==="RoundedPercentageReward"?e:s;let X=0;return[T,...n.pointBackRates.map(({rate:H,limit:Y})=>{const q=Math.min(I(o.value*H/100),Y??1/0);X+=q;const x=Y!==void 0?` (limit ${Y})`:"";return`${o.value} * ${H}% = ${q}${x}`}),`總計 ${X} points`,`${X} / ${M} * ${N} = ${c.calculateMiles(X)} ${V}`]}case"AccumulatedPointsReward":{const I=a(o.value/n.spendingPerPoint);return[T,`${o.value} / ${n.spendingPerPoint} = ${I} points`,`${I} / ${M} * ${N} = ${c.calculateMiles(I)} ${V}`]}case"FixedRatePointsReward":{const I=s(o.value/n.spendingPerPoint);return[T,`${o.value} / ${n.spendingPerPoint} = ${I} points (小數省略)`,`${I} / ${M} * ${N} = ${c.calculateMiles(I)} ${V}`]}default:return[]}}return(n,c)=>{const M=_("v-text-field"),N=_("v-autocomplete"),V=_("v-label"),T=_("v-checkbox"),I=_("v-radio"),X=_("v-radio-group"),H=_("v-card"),Y=_("v-btn"),q=_("v-dialog");return h(),C(O,null,[w("div",kt,[y(M,{"model-value":o.value,class:"flex-grow-0",density:"comfortable","hide-details":"",label:"交易金額",inputmode:"decimal",clearable:o.value!==0,"onUpdate:modelValue":c[0]||(c[0]=x=>o.value=isNaN(parseFloat(x))?0:parseFloat(x))},null,8,["model-value","clearable"]),y(N,{ref:"storeAutoComplete",modelValue:v.value,"onUpdate:modelValue":c[1]||(c[1]=x=>v.value=x),"custom-filter":k,class:"flex-grow-0",density:"comfortable","hide-details":"","item-value":"store","item-title":"store",label:"消費店家",items:P.value,clearable:E(we)(v.value),placeholder:"全部店家","onUpdate:menu":c[2]||(c[2]=x=>{var K;return!x&&((K=E(F))==null?void 0:K.blur())})},null,8,["modelValue","items","clearable"]),w("div",null,[y(V,{text:"支援的付款方式"}),w("div",bt,[(h(!0),C(O,null,z(E(m),(x,K)=>(h(),$(T,{key:K,modelValue:t.value,"onUpdate:modelValue":c[3]||(c[3]=me=>t.value=me),density:"compact",value:x,"hide-details":"",label:x},null,8,["modelValue","value","label"]))),128))])]),w("div",Rt,[y(V,{text:"交易類型"}),y(X,{modelValue:S.value,"onUpdate:modelValue":c[4]||(c[4]=x=>S.value=x),"hide-details":"",inline:""},{default:A(()=>[y(I,{density:"compact",label:"國內交易",value:"Domestic"}),y(I,{density:"compact",label:"國外交易",value:"Foreign"})]),_:1},8,["modelValue"])]),w("div",Ct,[(h(!0),C(O,null,z(J.value,(x,K)=>(h(),$(H,{key:K,density:"compact",class:"mx-auto w-full flex-shrink-0",variant:"outlined",onClick:()=>b.value=x},{title:A(()=>[w("div",Tt,[w("div",Lt,[j(B(x.miles)+" ",1),w("p",Bt,B(x.airLinesCode),1)]),x.isSelectedPlan?(h(),C("i",Et)):Q("",!0)])]),text:A(()=>[w("div",Mt,[w("p",Ut,B(`${x.cardName} ${x.planName??""} ${x.rewardName??""}`)+" "+B(x.payments.length===0?"":` (支付方式: ${x.payments.join(", ")})`),1)])]),_:2},1032,["onClick"]))),128))],512)]),y(q,{"model-value":!!b.value,"onUpdate:modelValue":c[6]||(c[6]=x=>b.value=null)},{default:A(()=>[b.value?(h(),$(H,{key:0,class:"mx-auto reward-detail-dialog","min-width":"100%",title:`${b.value.cardName} ${b.value.planName??""} ${b.value.rewardName??""}`},{subtitle:A(()=>[w("p",It,B(b.value.description??""),1)]),text:A(()=>[w("div",$t,[w("p",Nt,[c[7]||(c[7]=j(" 卡片說明： ")),b.value.cardUrl!==null?(h(),C("a",{key:0,target:"_blank",class:"underline",href:b.value.cardUrl}," 網站 ",8,Vt)):Q("",!0)]),b.value.cardDescription!==""?(h(),C("p",Ot,B(b.value.cardDescription),1)):Q("",!0),b.value.pointExchangeName!==""?(h(),C("p",Ft,B(b.value.pointExchangeName),1)):Q("",!0),c[8]||(c[8]=w("br",null,null,-1)),w("p",null,"消費金額: "+B(o.value),1),w("p",null,"哩程預估: "+B(b.value.miles)+" "+B(b.value.airLinesCode),1),c[9]||(c[9]=w("br",null,null,-1)),(h(!0),C(O,null,z(b.value.calculateDetail,(x,K)=>(h(),C("p",{key:K},B(x),1))),128))])]),actions:A(()=>[y(Y,{class:"ms-auto",text:"Close",onClick:c[5]||(c[5]=x=>b.value=null)})]),_:1},8,["title"])):Q("",!0)]),_:1},8,["model-value"])],64)}}}),Kt=Xe(Jt,[["__scopeId","data-v-8877d240"]]),Gt={class:"flex-col h-full overflow-hidden gap-8px"},jt={class:"flex-shrink-0 flex-col gap-8px"},zt={key:0,class:"flex justify-between items-center"},Xt={class:"flex gap-8px"},Wt={key:0,class:"gap-4px flex-col flex-grow-1 overflow-y-auto"},Ht={class:"text-1rem"},Yt={class:"text-0.8rem"},Zt={key:1,class:"flex-grow-1"},Qt={class:"flex-col gap-24px m-8px"},qt={class:"flex-col gap-4px"},ea=ne({__name:"StoreAliasManagement",setup(p){const e=pe(),{aliasType:a,customAliases:s,storeAliases:i}=ce(e),m=fe("storeList"),d={default:"系統預設",additional:"預設+自定義",custom:"自定義"},u=L(!0),g=L(!1),f=L(!0),o=L("[]"),v=L(null),S=W(()=>{let l;return a.value==="default"?l=Ue:a.value==="additional"?l=[...i.value].map(([n,c])=>[n,[...c]]):l=[...s.value],l.map(([n,c])=>({title:n,aliases:[...c]}))});be(()=>{var l;return(l=v.value)==null?void 0:l.title},l=>{if(l==null||v.value===null)return;const n=[...s.value.get(l)??[]];n[n.length-1]!==""&&n.push(""),v.value.aliases=n}),be(u,J),Ve(()=>{J(),g.value=!1,f.value=!0,u.value=!0});function t(l,n){if(v.value===null)return;let c=v.value.aliases;c[n]=l,c[c.length-1]!==""&&c.push("")}function r(l){if(a.value!=="default")if(l===null)v.value={title:null,aliases:[]};else{const n=[...s.value.get(l)??[]];n[n.length-1]!==""&&n.push(""),v.value={title:l,aliases:n}}}function F(){const{title:l,aliases:n}=v.value??{};l==null||n===void 0||(e.updateCustomAliases(l,[...new Set(n)].filter(we)),v.value=null)}function P(l){if(l=l.trim(),o.value=l,g.value=!0,l===""){f.value=!0;return}try{const n=JSON.parse(l);f.value=Se(n)}catch(n){console.error(n),f.value=!1}}function k(){let l;if(u.value)l=!0;else{o.value===""&&(o.value="[]");try{const n=JSON.parse(o.value);Se(n)?(e.updateAllCustomAliases(n),l=!0):l=!1}catch(n){console.error(n),l=!1}}l?(alert("儲存成功"),g.value=!1):alert(`儲存失敗${u.value?"":"，JSON 不符合規則"}`)}function J(){o.value=JSON.stringify([...s.value],null,2)}function b(l){g.value||(l==="default"&&(u.value=!0),e.updateAliasType(l))}return(l,n)=>{const c=_("v-label"),M=_("v-btn"),N=_("v-btn-toggle"),V=_("v-switch"),T=_("v-card"),I=_("v-textarea"),X=_("v-toolbar-title"),H=_("v-spacer"),Y=_("v-toolbar-items"),q=_("v-toolbar"),x=_("v-autocomplete"),K=_("v-text-field"),me=_("v-dialog");return h(),C(O,null,[w("div",Gt,[w("div",jt,[y(c,{text:"別名設定"}),y(N,{"model-value":E(a),rounded:"0",group:"",class:"w-full flex justify-center",disabled:g.value,"onUpdate:modelValue":b},{default:A(()=>[(h(!0),C(O,null,z(E(Ie),(U,G)=>(h(),$(M,{key:G,class:"flex-1",value:U},{default:A(()=>[j(B(d[U]),1)]),_:2},1032,["value"]))),128))]),_:1},8,["model-value","disabled"]),E(a)!=="default"?(h(),C("div",zt,[w("div",Xt,[u.value?(h(),$(M,{key:0,onClick:n[0]||(n[0]=U=>r(null))},{default:A(()=>n[6]||(n[6]=[j(" Add ")])),_:1})):(h(),$(M,{key:1,onClick:k},{default:A(()=>n[7]||(n[7]=[j(" Save ")])),_:1}))]),y(V,{modelValue:u.value,"onUpdate:modelValue":n[1]||(n[1]=U=>u.value=U),disabled:g.value,"hide-details":"",label:"圖示"},null,8,["modelValue","disabled"])])):Q("",!0)]),u.value?(h(),C("div",Wt,[(h(!0),C(O,null,z(S.value,(U,G)=>(h(),$(T,{key:G,density:"compact",class:"mx-auto w-full flex-shrink-0",variant:"outlined",onClick:ee=>r(U.title)},{text:A(()=>[w("p",Ht,B(U.title),1),w("p",Yt,B(U.aliases.join(", ")),1)]),_:2},1032,["onClick"]))),128))])):(h(),C("div",Zt,[y(I,{"model-value":o.value,clearable:o.value!=="","auto-grow":"",disabled:E(a)==="default","max-rows":15,messages:g.value?"上方儲存完成後才能執行其他動作，離開這頁不會存檔":"","error-messages":f.value?"":"json 無效",label:"自定義別名設定檔","onUpdate:modelValue":P},null,8,["model-value","clearable","disabled","messages","error-messages"])]))]),y(me,{"model-value":!!v.value,fullscreen:"","onUpdate:modelValue":n[5]||(n[5]=U=>v.value=null)},{default:A(()=>[v.value?(h(),$(T,{key:0,class:"reward-detail-dialog"},{default:A(()=>[y(q,null,{default:A(()=>[y(M,{icon:"mdi-close",onClick:n[2]||(n[2]=U=>v.value=null)}),y(X,null,{default:A(()=>n[8]||(n[8]=[j("編輯商店別名")])),_:1}),y(H),y(Y,null,{default:A(()=>[y(M,{text:"Save",variant:"text",onClick:F})]),_:1})]),_:1}),w("div",Qt,[y(x,{ref:"storeList",modelValue:v.value.title,"onUpdate:modelValue":n[3]||(n[3]=U=>v.value.title=U),class:"flex-grow-0","hide-details":"",label:"目標店家",items:E(e).storeList,placeholder:"選擇店家","onUpdate:menu":n[4]||(n[4]=U=>{var G;return!U&&((G=E(m))==null?void 0:G.blur())})},null,8,["modelValue","items"]),w("div",qt,[y(c,{text:"自定義別名列表"}),(h(!0),C(O,null,z(v.value.aliases,(U,G)=>(h(),$(K,{key:G,"hide-details":"",clearable:"","model-value":U,"onUpdate:modelValue":ee=>t(ee,G),"onClick:clear":()=>{var ee;return(ee=v.value)==null?void 0:ee.aliases.splice(G,1)}},null,8,["model-value","onUpdate:modelValue","onClick:clear"]))),128))])])]),_:1})):Q("",!0)]),_:1},8,["model-value"])],64)}}}),ta={style:{height:"calc(100dvh - 56px)"},class:"overflow-hidden mt-56px p-8px"},aa=ne({__name:"App",setup(p){const e={查詢回饋:Kt,信用卡管理:xt,商家別名:ea,喜好設定:Pt},a=Object.keys(e),s=L(!1),i=L(a[0]);return(m,d)=>{const u=_("v-app-bar-nav-icon"),g=_("v-app-bar-title"),f=_("v-app-bar"),o=_("v-list-item"),v=_("v-divider"),S=_("v-navigation-drawer"),t=_("v-app");return h(),$(t,null,{default:A(()=>[y(f,{density:"comfortable",elevation:2},{prepend:A(()=>[y(u,{onClick:d[0]||(d[0]=r=>s.value=!s.value)},{default:A(()=>d[2]||(d[2]=[w("i",{class:"fa-solid fa-bars"},null,-1)])),_:1}),y(g,null,{default:A(()=>[j(B(i.value),1)]),_:1})]),_:1}),y(S,{modelValue:s.value,"onUpdate:modelValue":d[1]||(d[1]=r=>s.value=r)},{default:A(()=>[(h(!0),C(O,null,z(E(a),(r,F)=>(h(),C(O,{key:F},[y(o,{title:r,class:Oe(["h-48px",{"text-emphasis":i.value===r}]),onClick:()=>{i.value=r,s.value=!1}},null,8,["title","class","onClick"]),y(v)],64))),128))]),_:1},8,["modelValue"]),w("main",ta,[(h(),$(Fe,null,[(h(),$(De(e[i.value])))],1024))])]),_:1})}}}),ke=Je(aa);ke.use(ze);ke.use(Ge());ke.mount("#app");
//# sourceMappingURL=bestMileageCards-BdINdtmC.js.map
