var Ne=Object.defineProperty;var Oe=(o,t,n)=>t in o?Ne(o,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):o[t]=n;var M=(o,t,n)=>Oe(o,typeof t!="symbol"?t+"":t,n);import{b as B,o as Fe,c as Z,f as Q,d as ae,B as _,g as f,j as C,k as x,x as i,C as P,u as R,E as De,G as Je,v as D,D as z,t as U,y as X,F as G,l as H,e as xe,w as be,H as Ke,m as Re,I as Ge,K as je,A as ze}from"../index-D7HKpjF4.js";import{d as We,s as se,c as Xe}from"../pinia-DrEUiQ2A.js";import{C as He,v as Ye}from"../StorageManager-Mw4zEIDw.js";import{a as Be,b as Te}from"../sorts-BPW8KRTv.js";import{f as Ee,r as le,b as ke,g as T,a as me}from"../index-f1g9dClV.js";import{_ as qe}from"../_plugin-vue_export-helper-DlAUqK2U.js";const Me=Ee(0),Ze=le(0),Ae=le(2);class ye{constructor({type:t,name:n}){M(this,"_name");M(this,"_type");this._type=t,this._name=n}get name(){return this._name}get type(){return this._type}calculateRangePointsCost(t,n){const s=[];for(let m=t;m<=n;m++){const u=Ae(m/this.calculatePoints(m));isNaN(u)||u===1/0||u===-1/0||s.push(u)}s.sort((m,u)=>m-u);const l=s[s.length-1],d=s[0];if(l===void 0||d===void 0)throw new Error("cannot be calculated");const p=s.reduce((m,u)=>m+u,0)/s.length;return{max:l,min:d,average:Ae(p)}}}class Qe extends ye{constructor({pointBackRates:n,...s}){super(s);M(this,"_pointBackRates");this._pointBackRates=n}get _maxRete(){return this._pointBackRates.reduce((n,{rate:s})=>n+s,0)}get pointBackRates(){return this._pointBackRates}get description(){return`消費${this._pointBackRates.length>1?"最高":""}${this._maxRete.toString()}%回饋點數(四捨五入)`}calculatePoints(n){let s=0;for(const{rate:l,limit:d=1/0}of this._pointBackRates)s+=Math.min(Ze(n*(l/100)),d);return s}toJSON(){return{name:this._name,type:this._type,pointBackRates:this._pointBackRates}}}class et extends ye{constructor({pointBackRates:n,...s}){super(s);M(this,"_pointBackRates");this._pointBackRates=n}get _maxRete(){return this._pointBackRates.reduce((n,{rate:s})=>n+s,0)}get pointBackRates(){return this._pointBackRates}get description(){return`消費${this._pointBackRates.length>1?"最高":""}${this._maxRete.toString()}%回饋點數(無條件捨去)`}calculatePoints(n){let s=0;for(const{rate:l,limit:d=1/0}of this._pointBackRates)s+=Math.min(Me(n*(l/100)),d);return s}toJSON(){return{name:this._name,type:this._type,pointBackRates:this._pointBackRates}}}class tt extends ye{constructor({spendingPerPoint:n,...s}){super({...s});M(this,"_spendingPerPoint");this._spendingPerPoint=n}get spendingPerPoint(){return this._spendingPerPoint}get description(){return`每消費${this._spendingPerPoint.toString()}元累積1點 (小數會累計)`}calculatePoints(n){return Ae(n/this._spendingPerPoint)}toJSON(){return{name:this._name,type:this._type,spendingPerPoint:this._spendingPerPoint}}}class at extends ye{constructor({spendingPerPoint:n,...s}){super({...s});M(this,"_spendingPerPoint");this._spendingPerPoint=n}get spendingPerPoint(){return this._spendingPerPoint}get description(){return`每消費${this._spendingPerPoint.toString()}元累積1點 (小數不累計)`}calculatePoints(n){return Me(n/this._spendingPerPoint)}toJSON(){return{name:this._name,type:this._type,spendingPerPoint:this._spendingPerPoint}}}const nt={RoundedPercentageReward:Qe,TruncatedPercentageReward:et,AccumulatedPointsReward:tt,FixedRatePointsReward:at};function lt(o){return new nt[o.type](o)}class st{constructor(t,n,s){M(this,"_name");M(this,"_rewards");M(this,"_condition");if(this._name=t,this._condition=n,s.length===0)throw new Error(`Plan "${t??"unknown"}" must have at least one reward rule.`);this._rewards=s}get name(){return this._name}get storeList(){return ke(this._rewards.flatMap(t=>[...t.stores,...t.storeBlackList]))}checkPlanIsVisible(t){return this._condition===null||!!(t!=null&&t.includes(this._condition))}getApplicableReward({transactionStore:t=null,acceptedPayments:n=[],transactionAttributesType:s,currentConditions:l=null}){return this._condition!==null&&!(l!=null&&l.includes(this._condition))?null:this._rewards.find(({stores:d,payments:p,transactionType:m,paymentBlackList:u,storeBlackList:k,condition:h})=>{const g=t===null||d.size===0||d.has(t),S=t===null||k.size===0||!k.has(t),V=n.length===0||p.size===0||n.some(y=>p.has(y)),j=n.length===0||u.size===0||n.some(y=>!u.has(y)),e=m===null||s===m,c=h===null||!!(l!=null&&l.includes(h));return g&&S&&V&&j&&e&&c})??null}getRewardMiles({transactionStore:t,acceptedPayments:n,amount:s,transactionAttributesType:l,currentConditions:d}){const p=this.getApplicableReward({acceptedPayments:n,transactionStore:t,transactionAttributesType:l,currentConditions:d});if(p===null)return null;const m=n===void 0?[...p.payments.values()]:n.filter(u=>p.payments.has(u));return{rewardName:p.rewardStrategy.name,rewardPoints:p.rewardStrategy.calculatePoints(s),payments:m.filter(u=>!p.paymentBlackList.has(u)),rewardStrategy:p.rewardStrategy}}toJSON(){return{name:this._name,condition:this._condition,rewards:this._rewards.map(({rewardStrategy:t,stores:n,payments:s,transactionType:l,paymentBlackList:d,storeBlackList:p,condition:m})=>({rewardStrategy:t.toJSON(),stores:[...n],storeBlackList:[...p],payments:[...s],paymentBlackList:[...d],transactionType:l,condition:m}))}}}const ot=["信用卡","Apple Pay","Samsung Pay","Google Pay","Line Pay","Fitbit Pay","Garmin Pay","Hami Pay","街口支付","全盈+PAY","全支付","Pi錢包","橘子支付","歐付寶","icash pay","OPEN錢包","My FamiPay","悠遊付","ezPay","GOMAJI Pay","friday wallet","PayPal","PX Pay","中油Pay","台灣Pay","支付寶"];class it{constructor({name:t,description:n,plans:s,storeBlackList:l,paymentBlackList:d,cardUrl:p,updateAt:m,pointExchangeStrategies:u,selectedPlanId:k,selectedPointExchangeStrategyId:h}){M(this,"_selectedPlanId");M(this,"_selectedPointExchangeStrategyId");M(this,"_name");M(this,"_description");M(this,"_plans");M(this,"_cardUrl");M(this,"_storeBlackList");M(this,"_paymentBlackList");M(this,"_updateAt");M(this,"_pointExchangeStrategies");this._name=t,this._description=n,this._plans=s,this._cardUrl=p,this._storeBlackList=l,this._paymentBlackList=d,this._updateAt=m,this._pointExchangeStrategies=u;const g=(k!==null&&this._plans.get(k)?k:null)??this._plans.keys().next().value;if(this._plans.size===0||g===void 0)throw new Error("this credit card no any plan");this._selectedPlanId=g;const S=(h!==null&&this._pointExchangeStrategies.get(h)?h:null)??this._pointExchangeStrategies.keys().next().value;if(this._plans.size===0||S===void 0)throw new Error("this credit card no any exchange strategy");this._selectedPointExchangeStrategyId=S}get name(){return this._name}get description(){return this._description}get selectedPlanId(){return this._selectedPlanId}get selectedPlan(){return this._getPlan(this._selectedPlanId)}get selectedPointExchangeStrategyId(){return this._selectedPointExchangeStrategyId}get selectedPointExchangeStrategy(){return this._getPointExchangeStrategy(this._selectedPointExchangeStrategyId)}get selectablePlan(){return[...this._plans.entries()].map(([t,{name:n}])=>({id:t,name:n}))}get selectablePointExchangeStrategy(){return[...this._pointExchangeStrategies.entries()].map(([t,{name:n}])=>({id:t,name:n}))}get storeList(){return ke([...[...this._plans.values()].flatMap(t=>t.storeList),...this._storeBlackList])}get cardUrl(){return this._cardUrl}_getPlan(t){const n=this._plans.get(t);if(n===void 0)throw new Error(`plan id ${t} not found. Available plans: ${[...this._plans.keys()].join(", ")}`);return n}_getPointExchangeStrategy(t){const n=this._pointExchangeStrategies.get(t);if(n===void 0)throw new Error(`pointExchangeStrategy id ${t} not found. Available pointExchangeStrategies: ${[...this._plans.keys()].join(", ")}`);return n}_rewardMilesWithPlan(t,n,s){var h;const l=this._getPlan(t),d=this._getPointExchangeStrategy(n),p={planId:t,planName:l.name,rewardName:null,rewardPoints:0,payments:[],rewardStrategy:null,pointExchangeStrategy:d,pointExchangeName:d.name,airlineCode:d.airlineCode,miles:0},m=s.transactionStore!==void 0&&this._storeBlackList.has(s.transactionStore),u=(h=s.acceptedPayments)==null?void 0:h.some(g=>this._paymentBlackList.has(g));if(m||u)return p;const k=l.getRewardMiles(s);return k===null?p:{planId:t,planName:l.name,pointExchangeStrategy:d,pointExchangeName:d.name,miles:d.calculateMiles(k.rewardPoints),airlineCode:d.airlineCode,...k}}updatePlan(t){return this._plans.get(t)?(this._selectedPlanId=t,!0):!1}updatePointExchangeStrategy(t){return this._pointExchangeStrategies.get(t)?(this._selectedPointExchangeStrategyId=t,!0):!1}getRewardInfos(t,{onlyCurrentPlan:n=!1,onlyCurrentExchangeStrategy:s=!1}={}){const l=n?[[this._selectedPlanId,this.selectedPlan]]:[...this._plans.entries()],d=s?[this._selectedPointExchangeStrategyId]:[...this._pointExchangeStrategies.keys()],p=[];for(const[m,u]of l)if(u.checkPlanIsVisible(t.currentConditions??null))for(const h of d){const g=this._rewardMilesWithPlan(m,h,t);p.push(g)}return p}toJSON(){return{name:this._name,description:this._description,cardUrl:this._cardUrl,storeBlackList:[...this._storeBlackList],paymentBlackList:[...this._paymentBlackList],selectedPlanId:this._selectedPlanId,plans:[...this._plans].map(([t,n])=>({id:t,config:n.toJSON()})),updateAt:this._updateAt.toISOString(),selectedPointExchangeStrategyId:this._selectedPointExchangeStrategyId,pointExchangeStrategies:[...this._pointExchangeStrategies].map(([t,n])=>({id:t,config:n.toJSON()}))}}}const rt=le(2);class dt{constructor({name:t,airlineCode:n,pointsPerMile:s,milesPerUnit:l}){M(this,"_name");M(this,"_airlineCode");M(this,"_pointsPerMile");M(this,"_milesPerUnit");this._name=t,this._airlineCode=n,this._pointsPerMile=s,this._milesPerUnit=l}get name(){return this._name}get description(){return`${this._pointsPerMile}點可以交換${this._milesPerUnit}哩程`}get airlineCode(){return this._airlineCode}get pointsPerMile(){return this._pointsPerMile}get milesPerUnit(){return this._milesPerUnit}calculateMiles(t){return rt(t*this._milesPerUnit/this._pointsPerMile)}toJSON(){return{name:this._name,airlineCode:this._airlineCode,pointsPerMile:this._pointsPerMile,milesPerUnit:this._milesPerUnit}}}function Le({name:o,description:t,storeBlackList:n,paymentBlackList:s,cardUrl:l,plans:d,updateAt:p,pointExchangeStrategies:m,selectedPlanId:u,selectedPointExchangeStrategyId:k}){const h=new Map(d.map(({id:g,config:{name:S,condition:V,rewards:j}})=>[g,new st(S,V??null,j.map(({stores:e,payments:c,transactionType:y,rewardStrategy:N,paymentBlackList:w,storeBlackList:v,condition:a})=>({rewardStrategy:lt(N),stores:new Set(e),storeBlackList:new Set(v),payments:new Set(c),paymentBlackList:new Set(w),transactionType:y??null,condition:a??null})))]));return new it({name:o,description:t,plans:h,storeBlackList:new Set(n),paymentBlackList:new Set(s),cardUrl:l,updateAt:new Date(p),selectedPlanId:u??null,selectedPointExchangeStrategyId:k??null,pointExchangeStrategies:new Map(m.map(({id:g,config:S})=>[g,new dt(S)]))})}const ie=["分期付款"],re=[],ve=["信用卡","Apple Pay","Samsung Pay","Google Pay","Fitbit Pay","Garmin Pay","Hami Pay"];function de(o){const t={rewardStrategy:{type:"RoundedPercentageReward",name:null,pointBackRates:[{rate:.3}]}};return[{id:T(),config:{name:"集精選",rewards:[{rewardStrategy:{type:"RoundedPercentageReward",name:null,pointBackRates:[{rate:2}]},stores:["家樂福","LOPIA台灣","全聯福利中心","台灣中油-直營","7-ELEVEN","全家便利商店","IKEA"],payments:[...ve,"PX Pay","My FamiPay","OPEN錢包"]},t]}},{id:T(),config:{name:"玩數位",rewards:[{rewardStrategy:{type:"RoundedPercentageReward",name:null,pointBackRates:[{rate:o}]},stores:["App Store","Apple Music","iCloud","Apple TV+","Apple Arcade","Apple One","iTunes","Google Play","Disney+","Netflix","Spotify","KKBOX","YouTube Premium","蝦皮購物","momo購物網","PChome 24h購物(不含儲值及電子票券)","博客來","小樹購","Coupang 酷澎(台灣)","淘寶/天貓"],paymentBlackList:["Line Pay","街口支付"]},{...t,storeBlackList:["全聯福利中心"]}]}},{id:T(),config:{name:"樂饗購",rewards:[{rewardStrategy:{type:"RoundedPercentageReward",name:null,pointBackRates:[{rate:o}]},stores:["遠東SOGO百貨","遠東Garden City","太平洋百貨","新光三越","SKM Park","BELLAVITA","微風廣場","遠東百貨","Big City遠東巨城購物中心","誠品生活","環球購物中心","CITYLINK","統一時代","台北101","ATT 4 FUN","明曜百貨","京站","美麗華","大葉高島屋","比漾廣場","大江國際購物中心","中友百貨","廣三SOGO","Tiger City","勤美誠品綠園道","大魯閣新時代","耐斯廣場","南紡購物中心","夢時代","漢神百貨","漢神巨蛋","MITSUI OUTLET PARK 林口","MITSUI OUTLET PARK 台中港","MITSUI OUTLET PARK 台南","Mitsui Shopping Park LaLaport 台中","義大世界購物廣場","華泰名品城","義享天地","麗寶OUTLET Mall","秀泰生活","台茂購物中心","新月廣場","三創生活","宏匯廣場","高雄棧貳庫/大港倉","NOKE忠泰樂生活","Uber Eats","foodpanda","foodomo","國內餐飲(不含餐券)","麥當勞","康是美","屈臣氏"],payments:ve},{...t,storeBlackList:["全聯福利中心"]}]}},{id:T(),config:{name:"趣旅行",rewards:[{rewardStrategy:{type:"RoundedPercentageReward",name:null,pointBackRates:[{rate:o}]},stores:["海外實體消費","東京迪士尼樂園","東京華納兄弟哈利波特影城","大阪環球影城(USJ)","吉卜力公園","Apple Wallet SUICA","Apple Wallet PASMO","Apple Wallet ICOCA","Uber","Grab","台灣高鐵","yoxi","台灣大車隊","iRent","和運租車","格上租車","中華航空","長榮航空","星宇航空","台灣虎航","國泰航空","樂桃航空","阿聯酋航空","酷航","捷星航空","日本航空","亞洲航空","聯合航空","ANA全日空","新加坡航空","越捷航空","大韓航空","達美航空","土耳其航空","卡達航空","法國航空","國內飯店住宿","星野集團","全球迪士尼飯店","東橫INN","KKday","Agoda","Klook","Airbnb","Hotels.com","Expedia","Booking.com","Trip.com","AsiaYo","ezTravel易遊網","雄獅旅遊","可樂旅遊","東南旅遊","五福旅遊","燦星旅遊","山富旅遊","長汎假期","鳳凰旅行社","Ezfly易飛網","理想旅遊","永利旅行社","三賀旅行社","173WIFI","JetFi mobile","威訊 WaySim","AIRSIM","SIM88"],payments:ve},{...t,storeBlackList:["全聯福利中心"]}]}},{id:T(),config:{name:"來支付",rewards:[{rewardStrategy:{type:"RoundedPercentageReward",name:null,pointBackRates:[{rate:2}]},payments:["Line Pay"]},{...t,storeBlackList:["全聯福利中心"]}]}},{id:T(),config:{name:"慶生月",condition:"Birthday",rewards:[{rewardStrategy:{type:"RoundedPercentageReward",name:null,pointBackRates:[{rate:10}]},stores:["東京迪士尼樂園","大阪環球影城(USJ)","名古屋樂高樂園","紅葉蛋糕官方網站","法朋烘焙甜點坊","興波咖啡 華山旗艦店","海底撈火鍋","輕井澤鍋物","老四川巴蜀麻辣燙","二本松涮涮屋","橋山.壽喜燒","Umai屋馬燒肉","老井極上燒肉","燒肉中山(台中大墩)","藏壽司台灣","貳樓","膳馨民間創作料理","馨苑小料理","雅室牛排 仁愛圓環店","ABV餐飲集團","WAT","臺虎精釀(信義 | 西門 | 臺中 | 啜飲室大安)","BAR Bodega","BAR MED","JiN Her 今鶴","錢櫃KTV","好樂迪KTV","星聚點KTV","享溫馨KTV","Nintendo","巴哈姆特動畫瘋","閃動格子CyberCube"]},{rewardStrategy:{type:"RoundedPercentageReward",name:null,pointBackRates:[{rate:3.5}]},stores:["新光三越","Uber Eats (不含 Uber One)","Agoda","Trip.com","Klook","國內飯店住宿","星野集團","全球迪士尼飯店","東橫INN"]},{...t,storeBlackList:["全聯福利中心"]}]}}]}const ce=[{id:T(),config:{name:"長榮航空哩程",airlineCode:"EVA",pointsPerMile:360,milesPerUnit:1e3}},{id:T(),config:{name:"長榮航空哩程 + 長榮世界卡",airlineCode:"EVA",pointsPerMile:300,milesPerUnit:1e3}}],ct=[{name:"Cube 卡",description:"Cube 卡 (Level 1) 回饋方案",cardUrl:"https://www.cathaybk.com.tw/cathaybk/personal/product/credit-card/cards/cube/",storeBlackList:ie,paymentBlackList:re,updateAt:"2024-12-01T00:00:00.000Z",plans:de(2),pointExchangeStrategies:ce},{name:"Cube 卡",description:"Cube 卡 (Level 2) 回饋方案",cardUrl:"https://www.cathaybk.com.tw/cathaybk/personal/product/credit-card/cards/cube/",storeBlackList:ie,paymentBlackList:re,updateAt:"2024-12-01T00:00:00.000Z",plans:de(3),pointExchangeStrategies:ce},{name:"Cube 卡",description:"Cube 卡 (Level 3) 回饋方案",cardUrl:"https://www.cathaybk.com.tw/cathaybk/personal/product/credit-card/cards/cube/",storeBlackList:ie,paymentBlackList:re,updateAt:"2024-12-01T00:00:00.000Z",plans:de(3.3),pointExchangeStrategies:ce}],ut={name:"Cube 卡",description:"Cube 卡 (Level 2) 回饋方案",cardUrl:"https://www.cathaybk.com.tw/cathaybk/personal/product/credit-card/cards/cube/",storeBlackList:ie,paymentBlackList:re,updateAt:"2024-12-01T00:00:00.000Z",plans:de(3),pointExchangeStrategies:ce},ue=["政府稅款","公共事業代扣繳","交通違規罰鍰","分期付款","全聯福利中心","7-ELEVEN","全家便利商店"],pe=[],pt=[{name:"星宇世界卡",description:null,cardUrl:"https://www.esunbank.com/zh-tw/personal/credit-card/intro/co-branded-card/starlux-card",storeBlackList:ue,paymentBlackList:pe,pointExchangeStrategies:[{id:T(),config:{name:"星宇航空哩程",airlineCode:"SJX",pointsPerMile:1,milesPerUnit:1}}],plans:[{id:T(),config:{name:null,rewards:[{rewardStrategy:{type:"FixedRatePointsReward",name:"國外消費",spendingPerPoint:5},transactionType:"Foreign",condition:"Birthday"},{rewardStrategy:{type:"FixedRatePointsReward",name:"國外消費",spendingPerPoint:10},transactionType:"Foreign"},{rewardStrategy:{type:"FixedRatePointsReward",name:"國內消費",spendingPerPoint:20},transactionType:"Domestic"}]}}],updateAt:new Date("2024/12/01 00:00:00").toISOString()},{name:"星宇商務鈦金卡",description:null,cardUrl:"https://www.esunbank.com/zh-tw/personal/credit-card/intro/co-branded-card/starlux-card",storeBlackList:ue,paymentBlackList:pe,pointExchangeStrategies:[{id:T(),config:{name:"星宇航空哩程",airlineCode:"SJX",pointsPerMile:1,milesPerUnit:1}}],plans:[{id:T(),config:{name:null,rewards:[{rewardStrategy:{type:"FixedRatePointsReward",name:"國外消費",spendingPerPoint:7.5},transactionType:"Foreign",condition:"Birthday"},{rewardStrategy:{type:"FixedRatePointsReward",name:"國外消費",spendingPerPoint:15},transactionType:"Foreign"},{rewardStrategy:{type:"FixedRatePointsReward",name:"國內消費",spendingPerPoint:25},transactionType:"Domestic"}]}}],updateAt:new Date("2024/12/01 00:00:00").toISOString()},{name:"星宇鈦金卡",description:null,cardUrl:"https://www.esunbank.com/zh-tw/personal/credit-card/intro/co-branded-card/starlux-card",storeBlackList:ue,paymentBlackList:pe,pointExchangeStrategies:[{id:T(),config:{name:"星宇航空哩程",airlineCode:"SJX",pointsPerMile:1,milesPerUnit:1}}],plans:[{id:T(),config:{name:null,rewards:[{rewardStrategy:{type:"FixedRatePointsReward",name:"國外消費",spendingPerPoint:20},transactionType:"Foreign"},{rewardStrategy:{type:"FixedRatePointsReward",name:"國內消費",spendingPerPoint:28},transactionType:"Domestic"}]}}],updateAt:new Date("2024/12/01 00:00:00").toISOString()}],fe=["台灣中油-直營","台灣大車隊","台鐵","台灣高鐵","UBER","Yoxi","LINEGO","新光三越","遠東百貨","遠東SOGO百貨","誠品生活","漢神百貨","微風廣場","微風信義","微風南京","微風南山","微風台北車站","環球購物中心","台北101","華泰名品城","MITSUI OUTLET PARK 林口","MITSUI OUTLET PARK 台中港","MITSUI OUTLET PARK 台南","Big City遠東巨城購物中心","昇恆昌","夢時代購物中心","京站","美麗華","南紡購物中心","秀泰生活","台茂購物中心","Mitsui Shopping Park LaLaport 台中","統領廣場","采盟","Uber Eats","foodpanda","星巴克","EZTABLE","王品瘋美食","摩斯漢堡","foodomo","漢來美食","饗Joy","饗食天堂","果然匯","小福利","饗饗","旭集","開飯","饗泰多","真珠","瓦城","非常泰","大心","1010","時時香","BOBO","乾杯集團","路易莎","中華航空","長榮航空","日本航空","台灣虎航","樂桃航空","酷航","立榮航空","華信航空","Agoda","booking.com","Hotels.com","AsiaYo","Expedia","KKday","Klook","雄獅旅遊","可樂旅遊","東南旅行社","Apple直營店","小米台灣","全國電子","燦坤","迪卡儂","屈臣氏","康是美","IKEA","特力屋","特力和樂","UNIQLO","NET","大樹藥局","丁丁藥妝","momo購物網","蝦皮購物","淘寶網","Coupang酷澎","東森購物","雅虎奇摩購物中心","博客來","玉山Wallet愛心捐款-單筆捐款","玉山Wallet愛心捐款-定期定額","特斯拉","Gogoro電池資費","YouBike 2.0","日本實體店","韓國實體店","泰國實體店","越南實體店","新加坡實體店","中國實體店","香港實體店","澳門實體店","美國實體店","英國實體店","法國實體店","德國實體店","義大利實體店"],_e={rewardStrategy:{type:"TruncatedPercentageReward",name:null,pointBackRates:[{rate:.3},{rate:.7}]}},Ue=[{name:"UniCard 卡",description:null,cardUrl:"https://www.esunbank.com/zh-tw/personal/credit-card/intro/bank-card/unicard",storeBlackList:ue,paymentBlackList:pe,pointExchangeStrategies:[{id:T(),config:{name:"長榮航空哩程",airlineCode:"EVA",pointsPerMile:200,milesPerUnit:300}}],plans:[{id:T(),config:{name:"任意選 (需要切換店家)",rewards:[{rewardStrategy:{type:"TruncatedPercentageReward",name:null,pointBackRates:[{rate:.3},{rate:.7},{rate:2.5,limit:500}]},stores:fe,payments:["信用卡","Apple Pay","Samsung Pay","Google Pay"]},{rewardStrategy:{type:"TruncatedPercentageReward",name:null,pointBackRates:[{rate:.3},{rate:.7},{rate:2.5,limit:500}]},payments:["Line Pay","街口支付","悠遊付","橘子支付","icash pay"]},_e]}},{id:T(),config:{name:"簡單選",rewards:[{rewardStrategy:{type:"TruncatedPercentageReward",name:null,pointBackRates:[{rate:.3},{rate:.7},{rate:2,limit:500}]},stores:fe,payments:["信用卡","Apple Pay","Samsung Pay","Google Pay"]},{rewardStrategy:{type:"TruncatedPercentageReward",name:null,pointBackRates:[{rate:.3},{rate:.7},{rate:2,limit:500}]},payments:["Line Pay","街口支付","悠遊付","橘子支付","icash pay"]},_e]}},{id:T(),config:{name:"UP選",rewards:[{rewardStrategy:{type:"TruncatedPercentageReward",name:null,pointBackRates:[{rate:.3},{rate:.7},{rate:3.5,limit:2e3}]},stores:fe,payments:["信用卡","Apple Pay","Samsung Pay","Google Pay"]},{rewardStrategy:{type:"TruncatedPercentageReward",name:null,pointBackRates:[{rate:.3},{rate:.7},{rate:3.5,limit:2e3}]},payments:["Line Pay","街口支付","悠遊付","橘子支付","icash pay"]},_e]}}],updateAt:new Date("2024/12/01 00:00:00").toISOString()}],mt=Ue[0],Pe=["政府稅款","公共事業代扣繳","交通違規罰鍰","分期付款"],he=["全盈+PAY","icash pay","OPEN錢包","My FamiPay"],Ie=[{name:"旅人無限卡",description:null,cardUrl:"https://www.hsbc.com.tw/credit-cards/products/travel/visa-infinite/",storeBlackList:Pe,paymentBlackList:he,pointExchangeStrategies:[{id:T(),config:{name:"長榮航空哩程",airlineCode:"EVA",pointsPerMile:1,milesPerUnit:1}}],plans:[{id:T(),config:{name:null,rewards:[{rewardStrategy:{type:"AccumulatedPointsReward",name:"國外消費",spendingPerPoint:10},transactionType:"Foreign"},{rewardStrategy:{type:"AccumulatedPointsReward",name:"國內消費",spendingPerPoint:18},transactionType:"Domestic"}]}}],updateAt:new Date("2024/12/01 00:00:00").toISOString()},{name:"旅人御璽卡",description:null,cardUrl:"https://www.hsbc.com.tw/credit-cards/products/travel/visa-signature/",storeBlackList:Pe,paymentBlackList:he,pointExchangeStrategies:[{id:T(),config:{name:"長榮航空哩程",airlineCode:"EVA",pointsPerMile:1,milesPerUnit:1}}],plans:[{id:T(),config:{name:null,rewards:[{rewardStrategy:{type:"AccumulatedPointsReward",name:"國外消費",spendingPerPoint:15},transactionType:"Foreign"},{rewardStrategy:{type:"AccumulatedPointsReward",name:"國內消費",spendingPerPoint:18},transactionType:"Domestic"}]}}],updateAt:new Date("2024/12/01 00:00:00").toISOString()},{name:"旅人輕旅卡",description:null,cardUrl:"https://www.hsbc.com.tw/credit-cards/products/travel/visa-light/",storeBlackList:Pe,paymentBlackList:he,pointExchangeStrategies:[{id:T(),config:{name:"長榮航空哩程",airlineCode:"EVA",pointsPerMile:1,milesPerUnit:1}}],plans:[{id:T(),config:{name:null,rewards:[{rewardStrategy:{type:"AccumulatedPointsReward",name:"國外消費",spendingPerPoint:20},transactionType:"Foreign"},{rewardStrategy:{type:"AccumulatedPointsReward",name:"國內消費",spendingPerPoint:20},transactionType:"Domestic"}]}}],updateAt:new Date("2024/12/01 00:00:00").toISOString()}],yt=Ie[2],gt=[ut,yt,mt],vt=[...ct,...Ie,...pt,...Ue],Se=o=>Array.isArray(o)&&o.every(t=>Array.isArray(t)&&t.length===2&&typeof t[0]=="string"&&Array.isArray(t[1])&&t[1].every(n=>typeof n=="string")),$e=[["7-ELEVEN",["7-11","Seven Eleven","統一超商","小7"]],["ANA全日空",["ANA","全日空","All Nippon Airways","NH"]],["ATT 4 FUN",["ATT4FUN","ATT信義"]],["App Store",["蘋果應用商店"]],["Apple Arcade",["蘋果遊戲訂閱服務"]],["Apple Music",["蘋果音樂","Apple音樂"]],["Apple One",["蘋果One訂閱"]],["Apple TV+",["Apple TV Plus"]],["Apple Wallet ICOCA",["ICOCA電子票","Apple錢包ICOCA"]],["Apple Wallet PASMO",["PASMO電子票","Apple錢包PASMO"]],["Apple Wallet SUICA",["SUICA電子票","Apple錢包SUICA"]],["CITYLINK",["City Link"]],["Disney+",["Disney Plus","迪士尼+"]],["Google Play",["Google應用商店"]],["Grab",["Grab Taxi","Grab叫車"]],["MITSUI OUTLET PARK 台中港",["三井台中港","三井OUTLET台中"]],["MITSUI OUTLET PARK 台南",["三井台南","三井OUTLET台南"]],["MITSUI OUTLET PARK 林口",["三井林口","三井OUTLET林口"]],["Mitsui Shopping Park LaLaport 台中",["LaLaport台中","三井LaLaport台中"]],["Netflix",["網飛"]],["Nintendo",["任天堂","Switch","老任"]],["PChome 24h購物(不含儲值及電子票券)",["PChome","PChome購物"]],["Tiger City",["老虎城","Tiger City購物中心"]],["Trip.com",["攜程"]],["Uber Eats (不含 Uber One)",["優步外送"]],["foodpanda",["熊貓外送","Food Panda"]],["iCloud",["蘋果雲端","iCloud雲端"]],["iRent",["i Rent"]],["iTunes",["蘋果iTunes"]],["中友百貨",["中友"]],["中華航空",["China Airlines","CAL","CI","華航"]],["亞洲航空",["AirAsia","亞航","AXM","AK"]],["京站",["Q Square","京站商場"]],["全家便利商店",["FamilyMart","全家"]],["全球迪士尼飯店",["Disney Hotels"]],["全聯福利中心",["PX Mart"]],["南紡購物中心",["Tainan Spinnery Mall","南紡"]],["博客來",["Books.com.tw"]],["卡達航空",["Qatar Airways","卡航","QTR","QR"]],["可樂旅遊",["Cola Travel","可樂旅行社"]],["台北101",["Taipei 101","101大樓"]],["台灣中油-直營",["中油直營","直營中油"]],["台灣大車隊",["Taiwan Taxi","大車隊"]],["台灣虎航",["Tigerair Taiwan","台虎","TWA","IT"]],["台灣高鐵",["Taiwan High Speed Rail"]],["台茂購物中心",["TaiMall"]],["吉卜力公園",["Ghibli Park"]],["國泰航空",["Cathay Pacific","國泰","CPA","CX","Cathay Pacific Airways"]],["土耳其航空",["Turkish Airlines","土航","THY","TK"]],["夢時代",["Dream Mall"]],["大阪環球影城(USJ)",["Universal Studios Japan"]],["大韓航空",["Korean Air","韓航","KAL","KE"]],["大魯閣新時代",["Taroko Mall","大魯閣"]],["太平洋百貨",["Pacific Department Store","太平洋"]],["好樂迪KTV",["Holiday"]],["家樂福",["Carrefour"]],["屈臣氏",["Watsons"]],["康是美",["Cosmed"]],["捷星航空",["JST","JQ","Jetstar Airways"]],["新加坡航空",["SIA","SQ","Singapore Airlines"]],["日本航空",["JAL","JL","Japan Airlines"]],["星宇航空",["starlux","SJX","JX","STARLUX Airlines"]],["樂桃航空",["APJ","MM","Peach Aviation"]],["法國航空",["AFR","AF","Air France"]],["聯合航空",["UAL","UA","United Airlines"]],["蝦皮購物",["shopee"]],["越捷航空",["VJC","VJ","VietJet Air"]],["達美航空",["DAL","DL","Delta Air Lines"]],["遠東百貨",["遠百"]],["酷航",["SCO","TR","Scoot"]],["長榮航空",["EVA","BR","EVA Airlines","EVA Air"]],["阿聯酋航空",["UAE","EK","Emirates"]],["麥當勞",["McDonald's"]],["IKEA",["宜家家居"]],["星巴克",["starbucks"]]],ft=o=>o==="AllPlanRewardMiles"||o==="CurrentPlanRewardMiles",W=new He(localStorage,{showRewardMilesType:ft,commonPaymentMethods:(()=>{const o=new Set(["信用卡","Apple Pay","Samsung Pay","Google Pay","Line Pay","Fitbit Pay","Garmin Pay","Hami Pay","街口支付","全盈+PAY","全支付","Pi錢包","橘子支付","歐付寶","icash pay","OPEN錢包","My FamiPay","悠遊付","ezPay","GOMAJI Pay","friday wallet","PayPal","PX Pay","中油Pay","台灣Pay","支付寶"]);return t=>Array.isArray(t)&&t.every(n=>o.has(n)===!0)})(),cardConfigs:(()=>{const o=new Set(["信用卡","Apple Pay","Samsung Pay","Google Pay","Line Pay","Fitbit Pay","Garmin Pay","Hami Pay","街口支付","全盈+PAY","全支付","Pi錢包","橘子支付","歐付寶","icash pay","OPEN錢包","My FamiPay","悠遊付","ezPay","GOMAJI Pay","friday wallet","PayPal","PX Pay","中油Pay","台灣Pay","支付寶"]),t=new Set(["信用卡","Apple Pay","Samsung Pay","Google Pay","Line Pay","Fitbit Pay","Garmin Pay","Hami Pay","街口支付","全盈+PAY","全支付","Pi錢包","橘子支付","歐付寶","icash pay","OPEN錢包","My FamiPay","悠遊付","ezPay","GOMAJI Pay","friday wallet","PayPal","PX Pay","中油Pay","台灣Pay","支付寶"]),n=new Set(["信用卡","Apple Pay","Samsung Pay","Google Pay","Line Pay","Fitbit Pay","Garmin Pay","Hami Pay","街口支付","全盈+PAY","全支付","Pi錢包","橘子支付","歐付寶","icash pay","OPEN錢包","My FamiPay","悠遊付","ezPay","GOMAJI Pay","friday wallet","PayPal","PX Pay","中油Pay","台灣Pay","支付寶"]),s=e=>typeof e.name=="string"&&(e.description===null||typeof e.description=="string")&&(e.cardUrl===null||typeof e.cardUrl=="string")&&(e.storeBlackList===void 0||Array.isArray(e.storeBlackList)&&e.storeBlackList.every(c=>typeof c=="string"))&&(e.paymentBlackList===void 0||Array.isArray(e.paymentBlackList)&&e.paymentBlackList.every(c=>o.has(c)===!0))&&(e.selectedPlanId===void 0||typeof e.selectedPlanId=="string"&&RegExp(/(.*)\x2d(.*)\x2d(.*)\x2d(.*)\x2d(.*)/).test(e.selectedPlanId))&&Array.isArray(e.plans)&&e.plans.every(c=>typeof c=="object"&&c!==null&&l(c))&&typeof e.updateAt=="string"&&RegExp(/^[+-]?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?\x2d[+-]?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?\x2d[+-]?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?T[+-]?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?:[+-]?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?:[+-]?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?\.[+-]?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?Z$/).test(e.updateAt)&&(e.selectedPointExchangeStrategyId===void 0||typeof e.selectedPointExchangeStrategyId=="string"&&RegExp(/(.*)\x2d(.*)\x2d(.*)\x2d(.*)\x2d(.*)/).test(e.selectedPointExchangeStrategyId))&&Array.isArray(e.pointExchangeStrategies)&&e.pointExchangeStrategies.every(c=>typeof c=="object"&&c!==null&&S(c)),l=e=>typeof e.id=="string"&&RegExp(/(.*)\x2d(.*)\x2d(.*)\x2d(.*)\x2d(.*)/).test(e.id)&&typeof e.config=="object"&&e.config!==null&&d(e.config),d=e=>(e.name===null||typeof e.name=="string")&&Array.isArray(e.rewards)&&e.rewards.every(c=>typeof c=="object"&&c!==null&&p(c))&&(e.condition===null||e.condition===void 0||e.condition==="Birthday"),p=e=>typeof e.rewardStrategy=="object"&&e.rewardStrategy!==null&&j(e.rewardStrategy)&&(e.transactionType===null||e.transactionType===void 0||e.transactionType==="Domestic"||e.transactionType==="Foreign")&&(e.stores===void 0||Array.isArray(e.stores)&&e.stores.every(c=>typeof c=="string"))&&(e.storeBlackList===void 0||Array.isArray(e.storeBlackList)&&e.storeBlackList.every(c=>typeof c=="string"))&&(e.payments===void 0||Array.isArray(e.payments)&&e.payments.every(c=>t.has(c)===!0))&&(e.paymentBlackList===void 0||Array.isArray(e.paymentBlackList)&&e.paymentBlackList.every(c=>n.has(c)===!0))&&(e.condition===null||e.condition===void 0||e.condition==="Birthday"),m=e=>Array.isArray(e.pointBackRates)&&e.pointBackRates.every(c=>typeof c=="object"&&c!==null&&u(c))&&(e.name===null||typeof e.name=="string")&&e.type==="RoundedPercentageReward",u=e=>typeof e.rate=="number"&&(e.limit===void 0||typeof e.limit=="number"),k=e=>Array.isArray(e.pointBackRates)&&e.pointBackRates.every(c=>typeof c=="object"&&c!==null&&u(c))&&(e.name===null||typeof e.name=="string")&&e.type==="TruncatedPercentageReward",h=e=>typeof e.spendingPerPoint=="number"&&(e.name===null||typeof e.name=="string")&&e.type==="AccumulatedPointsReward",g=e=>typeof e.spendingPerPoint=="number"&&(e.name===null||typeof e.name=="string")&&e.type==="FixedRatePointsReward",S=e=>typeof e.id=="string"&&RegExp(/(.*)\x2d(.*)\x2d(.*)\x2d(.*)\x2d(.*)/).test(e.id)&&typeof e.config=="object"&&e.config!==null&&V(e.config),V=e=>(e.name===null||typeof e.name=="string")&&typeof e.airlineCode=="string"&&typeof e.pointsPerMile=="number"&&typeof e.milesPerUnit=="number",j=e=>e.type==="TruncatedPercentageReward"?k(e):e.type==="RoundedPercentageReward"?m(e):e.type==="FixedRatePointsReward"?g(e):e.type==="AccumulatedPointsReward"?h(e):!1;return e=>Array.isArray(e)&&e.every(c=>typeof c=="object"&&c!==null&&s(c))})(),conditionTypes:o=>Array.isArray(o)&&o.every(t=>t==="Birthday"),aliasType:o=>o==="default"||o==="additional"||o==="custom",customAliases:Se},"bestMileageCards"),Ve=["default","additional","custom"],oe=We("BestMileageCards",()=>{const o=B(null);function t(a){o.value=a}function n(){o.value=null}Fe(()=>{const a=W.get("cardConfigs")??[];m.value=new Map(a.map(r=>[T(),r]))});const s=B(W.get("showRewardMilesType")??"AllPlanRewardMiles");function l(a){W.set("showRewardMilesType",a),s.value=a}const d=B(W.get("commonPaymentMethods")??["信用卡","Apple Pay","Line Pay","街口支付"]);function p([...a]){a=[...new Set(a)],W.set("commonPaymentMethods",a),d.value=a}const m=B(new Map),u=Z(()=>new Map([...m.value.entries()].map(([a,r])=>[a,Le(r)]))),k=Z(()=>u.value.size===0?gt.map(a=>Le(a)):[...u.value.values()]);function h(a,r){m.value.set(a,r),W.set("cardConfigs",[...m.value.values()])}function g(a){m.value.delete(a),W.set("cardConfigs",[...m.value.values()])}const S=Z(()=>Be(ke(k.value.flatMap(a=>a.storeList)),"asc")),V=B(W.get("conditionTypes")??[]);function j([...a]){V.value=a,W.set("conditionTypes",a)}const e=B(W.get("aliasType")??"default");function c(a){Ve.includes(a)&&(e.value=a,W.set("aliasType",a))}const y=B(new Map(W.get("customAliases")??[]));function N(a,r){r.length===0?y.value.delete(a):y.value.set(a,r),W.set("customAliases",[...y.value])}function w(a){y.value=new Map(a),W.set("customAliases",a)}const v=Z(()=>{const a=[];["default","additional"].includes(e.value)&&a.push(...$e),["additional","custom"].includes(e.value)&&a.push(...y.value);const r=new Map;for(const[E,$]of a){const I=r.get(E)??new Set;for(const L of $)I.add(L);r.set(E,I)}return r});return{dialog:Q(o),openDialog:t,closeDialog:n,showRewardMilesType:Q(s),updateShowRewardMilesType:l,commonPaymentMethods:Q(d),updateCommonPaymentMethods:p,cardConfigs:Q(m),cards:u,showCards:k,updateCardConfig:h,deleteCardConfig:g,storeList:Q(S),conditionTypes:Q(V),updateConditionTypes:j,aliasType:Q(e),storeAliases:v,updateAliasType:c,customAliases:Q(y),updateCustomAliases:N,updateAllCustomAliases:w}}),_t={class:"flex-col gap-24px my-16px"},Pt={class:"flex-center gap-8px"},ht={class:"flex mx-16px"},wt=ae({__name:"CommonSettings",setup(o){const t=oe(),{showRewardMilesType:n,commonPaymentMethods:s,conditionTypes:l}=se(t);return(d,p)=>{const m=_("v-label"),u=_("v-radio"),k=_("v-radio-group"),h=_("v-select"),g=_("v-switch");return f(),C("div",_t,[x("div",Pt,[i(m,{text:"回饋顯示"}),i(k,{"model-value":R(n),"hide-details":"",inline:"","onUpdate:modelValue":p[0]||(p[0]=S=>S!==null&&R(t).updateShowRewardMilesType(S))},{default:P(()=>[i(u,{density:"compact",label:"全部方案",value:"AllPlanRewardMiles"}),i(u,{density:"compact",label:"當前方案",value:"CurrentPlanRewardMiles"})]),_:1},8,["model-value"])]),x("div",null,[i(h,{"model-value":R(s),items:R(Be)(R(ot),"asc"),label:"使用中的付款方式",multiple:"","hide-details":"","onUpdate:modelValue":p[1]||(p[1]=S=>S!==null&&R(t).updateCommonPaymentMethods(S))},null,8,["model-value","items"])]),x("div",null,[i(m,{text:"其他設定"}),x("div",ht,[i(g,{"model-value":R(l),label:"生日中",value:"Birthday","hide-details":"",color:"blue","onUpdate:modelValue":p[2]||(p[2]=S=>S!==null&&R(t).updateConditionTypes(S))},null,8,["model-value"])])])])}}}),xt={class:"relative"},At={key:0,class:"text-red ml-2px"},we=ae({__name:"TextFiled",props:De({required:{type:Boolean,default:!1},label:{},isUrl:{type:Boolean,default:!1}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(o){const t=Je(o,"modelValue"),n=Z(()=>{const l=[];return o.required&&l.push(d=>!!d||"此欄位為必填"),o.isUrl&&l.push(d=>!!(d===null||d===""||d.startsWith("https://"))||"請填寫正確的網址 (需為 https:// 開頭)"),l});function s(l){l=(l==null?void 0:l.trim())??null,t.value=me(l)?l:null}return(l,d)=>{const p=_("v-text-field");return f(),D(p,{clearable:"",rules:n.value,"model-value":t.value,"onUpdate:modelValue":s},{label:P(()=>[x("p",xt,[z(U(l.label)+" ",1),l.required?(f(),C("span",At,"*")):X("",!0)])]),_:1},8,["rules","model-value"])}}});function te(o){if(o===null||typeof o!="object")return o;if(Array.isArray(o))return o.map(n=>te(n));if(o instanceof Map)return new Map(Array.from(o.entries()).map(([n,s])=>[te(n),te(s)]));if(o instanceof Set)return new Set(Array.from(o.values()).map(n=>te(n)));if(o instanceof Date)return new Date(o.getTime());if(o instanceof RegExp)return new RegExp(o.source,o.flags);const t={};return Object.keys(o).forEach(n=>{t[n]=te(o[n])}),t}const St={class:"flex-col gap-4px h-full overflow-hidden"},kt={class:"flex justify-end"},Ct={class:"flex-1 gap-8px flex-col overflow-y-auto py-8px"},bt={class:"flex items-center justify-between"},Rt=["onClick"],Tt={key:0,class:"flex-col gap-2 m-16px"},Lt={class:"overflow-y-auto w-full p-24px"},Bt={key:0,class:"flex-col gap-8px"},Et={key:0,class:"mdi mdi-check-circle text-24px"},Mt={key:0,class:"mdi mdi-check-circle text-24px"},Ut={class:"flex-col gap-4px m-8px"},It={class:"flex-col"},$t={class:"text-1rem"},Vt={class:"text-0.75rem"},Nt=ae({__name:"CreditCardManagement",setup(o){const t=oe(),{cardConfigs:n,cards:s}=se(t),l=B(null),d=B(null),p=Z(()=>{const c=d.value===null?null:s.value.get(d.value)??null;return c===null?null:(u(),h(),c)}),m=B(null);function u(){const c=d.value===null?null:s.value.get(d.value)??null;c!==null&&(m.value=c.selectedPlanId)}const k=B(null);function h(){const c=d.value===null?null:s.value.get(d.value)??null;c!==null&&(k.value=c.selectedPointExchangeStrategyId)}const g=B(!1),S=B([]);function V(){for(const c of S.value)t.updateCardConfig(T(),c),g.value=!1}function j(){l.value!==null&&(t.updateCardConfig(l.value.id,l.value.config),l.value=null)}function e(){l.value!==null&&(t.deleteCardConfig(l.value.id),l.value=null)}return(c,y)=>{const N=_("v-btn"),w=_("v-card"),v=_("v-toolbar-title"),a=_("v-spacer"),r=_("v-toolbar-items"),E=_("v-toolbar"),$=_("v-dialog"),I=_("v-card-text"),L=_("v-card-actions"),O=_("v-checkbox");return f(),C(G,null,[x("div",St,[x("div",kt,[i(N,{text:"匯入",onClick:y[0]||(y[0]=()=>{S.value=[],g.value=!0})})]),x("div",Ct,[(f(!0),C(G,null,H(R(n).entries(),([A,F],J)=>(f(),D(w,{key:J,density:"compact",class:"mx-auto w-full flex-shrink-0",variant:"outlined",title:F.name,text:F.description??"",onClick:()=>d.value=A},{title:P(()=>[x("div",bt,[z(U(F.name)+" ",1),x("span",{class:"mdi mdi-pencil absolute top-0 py-0.625rem px-1rem right-0",onClick:()=>l.value={id:A,config:R(te)(F)}},null,8,Rt)])]),_:2},1032,["title","text","onClick"]))),128))])]),i($,{"model-value":!!l.value,fullscreen:"","onUpdate:modelValue":y[6]||(y[6]=A=>l.value=null)},{default:P(()=>[i(w,null,{default:P(()=>[i(E,null,{default:P(()=>[i(N,{icon:"mdi-close",onClick:y[1]||(y[1]=A=>l.value=null)}),i(v,null,{default:P(()=>y[12]||(y[12]=[z("編輯卡片")])),_:1}),i(a),i(r,null,{default:P(()=>[i(N,{text:"Save",onClick:j})]),_:1})]),_:1}),l.value?(f(),C("div",Tt,[i(we,{modelValue:l.value.config.name,"onUpdate:modelValue":y[2]||(y[2]=A=>l.value.config.name=A),label:"卡片名稱",required:""},null,8,["modelValue"]),i(we,{modelValue:l.value.config.description,"onUpdate:modelValue":y[3]||(y[3]=A=>l.value.config.description=A),label:"卡片描述"},null,8,["modelValue"]),i(we,{modelValue:l.value.config.cardUrl,"onUpdate:modelValue":y[4]||(y[4]=A=>l.value.config.cardUrl=A),"is-url":"",label:"信用卡網頁"},null,8,["modelValue"]),x("div",null,[i(N,{class:"text-red",text:"刪除",onClick:y[5]||(y[5]=A=>R(t).openDialog({text:"確定要刪除嗎？",events:[{text:"取消"},{text:"刪除",event:e,class:"text-red"}]}))})])])):X("",!0)]),_:1})]),_:1},8,["model-value"]),i($,{"model-value":!!d.value,"onUpdate:modelValue":y[8]||(y[8]=A=>d.value=null)},{default:P(()=>[i(w,{"min-width":"100%"},{default:P(()=>[i(I,{class:"max-h-80dvh overflow-hidden flex !p-0"},{default:P(()=>[x("div",Lt,[p.value!==null?(f(),C("div",Bt,[y[13]||(y[13]=z(" 切換方案 ")),(f(!0),C(G,null,H(p.value.selectablePlan??[],(A,F)=>(f(),D(w,{key:F,density:"compact",class:"mx-auto w-full flex-shrink-0",variant:"outlined",onClick:()=>{var J;(J=p.value)==null||J.updatePlan(A.id),u()}},{default:P(()=>[i(I,{class:"h-3.6rem flex items-center justify-between"},{default:P(()=>[z(U(A.name??"")+" ",1),A.id===m.value?(f(),C("span",Et)):X("",!0)]),_:2},1024)]),_:2},1032,["onClick"]))),128)),y[14]||(y[14]=z(" 切換回饋 ")),(f(!0),C(G,null,H(p.value.selectablePointExchangeStrategy??[],(A,F)=>(f(),D(w,{key:F,density:"compact",class:"mx-auto w-full flex-shrink-0",variant:"outlined",onClick:()=>{var J;(J=p.value)==null||J.updatePointExchangeStrategy(A.id),h()}},{default:P(()=>[i(I,{class:"h-3.6rem flex items-center justify-between"},{default:P(()=>[z(U(A.name??"")+" ",1),A.id===k.value?(f(),C("span",Mt)):X("",!0)]),_:2},1024)]),_:2},1032,["onClick"]))),128))])):X("",!0)])]),_:1}),i(L,null,{default:P(()=>[i(N,{class:"ms-auto",text:"Close",onClick:y[7]||(y[7]=A=>d.value=null)})]),_:1})]),_:1})]),_:1},8,["model-value"]),i($,{modelValue:g.value,"onUpdate:modelValue":y[11]||(y[11]=A=>g.value=A),fullscreen:""},{default:P(()=>[i(w,null,{default:P(()=>[i(E,null,{default:P(()=>[i(N,{icon:"mdi-close",onClick:y[9]||(y[9]=A=>g.value=!1)}),i(v,null,{default:P(()=>y[15]||(y[15]=[z("請選擇卡片")])),_:1}),i(a),i(r,null,{default:P(()=>[i(N,{text:"匯入",onClick:V})]),_:1})]),_:1}),x("div",Ut,[(f(!0),C(G,null,H(R(vt),(A,F)=>(f(),D(O,{key:F,modelValue:S.value,"onUpdate:modelValue":y[10]||(y[10]=J=>S.value=J),value:A,"hide-details":"",density:"comfortable"},{label:P(()=>[x("div",It,[x("p",$t,U(A.name),1),x("p",Vt,U(A.description),1)])]),_:2},1032,["modelValue","value"]))),128))])]),_:1})]),_:1},8,["modelValue"])],64)}}}),Ot={class:"gap-8px h-full flex-col"},Ft={class:"flex items-center flex-wrap gap-x-8px"},Dt={class:"gap-8px flex-center"},Jt={ref:"rewardCardList",class:"flex-col gap-4px flex-grow-1 overflow-y-auto"},Kt={class:"flex items-center justify-between"},Gt={class:"flex gap-4px items-end"},jt={class:"text-12px opacity-50 p-4px"},zt={key:0,class:"fa-solid fa-circle-check"},Wt={class:"flex-col gap-8px"},Xt={class:"text-0.75rem"},Ht={class:"text-wrap"},Yt={class:"flex-col"},qt={class:"flex justify-between"},Zt=["href"],Qt={key:0},ea={key:1},ta="其他店家",aa=ae({__name:"SearchReward",setup(o){const t=le(0),n=le(2),s=Ee(0),{showRewardMilesType:l,commonPaymentMethods:d,showCards:p,conditionTypes:m,storeAliases:u,storeList:k}=se(oe()),h=B(0),g=B(null),S=B("Domestic"),V=B([]),j=xe("rewardCardList"),e=xe("storeAutoComplete"),c=Z(()=>{const a=k.value.map(r=>({store:r,aliases:[...u.value.get(r)??[]]}));return[{store:ta},...a]});function y(a,r,E){return r=r.toLowerCase(),[a,...(E==null?void 0:E.raw.aliases)??[]].map(I=>I.toLowerCase()).some(I=>I.includes(r))}const N=Z(()=>{var E;const a={amount:h.value,acceptedPayments:V.value,transactionAttributesType:S.value,currentConditions:[...m.value]};me(g.value)&&(a.transactionStore=g.value);const r=[];for(const $ of p.value){const I=$.getRewardInfos(a,l.value==="CurrentPlanRewardMiles"?{onlyCurrentExchangeStrategy:!0,onlyCurrentPlan:!0}:{});for(const L of I){const O={cardName:$.name,planName:L.planName,rewardName:L.rewardName,miles:L.miles,payments:L.payments,airLinesCode:L.airlineCode,isSelectedPlan:l.value==="AllPlanRewardMiles"&&L.planId===$.selectedPlanId,calculateDetail:v(L.rewardStrategy,L.pointExchangeStrategy),description:L.rewardStrategy===null?null:`${L.rewardStrategy.description}，${L.pointExchangeStrategy.description}`,cardUrl:$.cardUrl,cardDescription:$.description,pointExchangeName:L.pointExchangeName};r.push(O)}}return(E=j.value)==null||E.scrollTo({top:0,behavior:"smooth"}),Te(Te(r,"isSelectedPlan","desc"),"miles","desc")}),w=B(null);function v(a,r){const{pointsPerMile:E,milesPerUnit:$,airlineCode:I}=r,L="回饋計算:";switch(a==null?void 0:a.type){case"RoundedPercentageReward":case"TruncatedPercentageReward":{const O=a.type==="RoundedPercentageReward"?t:s;let A=0;return[L,...a.pointBackRates.map(({rate:F,limit:J})=>{const ee=Math.min(O(h.value*F/100),J??1/0);A+=ee;const b=J!==void 0?` (limit ${J})`:"";return`${h.value} * ${F}% = ${ee}${b}`}),`總計 ${A} points`,`${A} / ${E} * ${$} = ${r.calculateMiles(A)} ${I}`]}case"AccumulatedPointsReward":{const O=n(h.value/a.spendingPerPoint);return[L,`${h.value} / ${a.spendingPerPoint} = ${O} points`,`${O} / ${E} * ${$} = ${r.calculateMiles(O)} ${I}`]}case"FixedRatePointsReward":{const O=s(h.value/a.spendingPerPoint);return[L,`${h.value} / ${a.spendingPerPoint} = ${O} points (小數省略)`,`${O} / ${E} * ${$} = ${r.calculateMiles(O)} ${I}`]}default:return[]}}return(a,r)=>{const E=_("v-text-field"),$=_("v-autocomplete"),I=_("v-label"),L=_("v-checkbox"),O=_("v-radio"),A=_("v-radio-group"),F=_("v-card"),J=_("v-btn"),ee=_("v-dialog");return f(),C(G,null,[x("div",Ot,[i(E,{"model-value":h.value,class:"flex-grow-0",density:"comfortable","hide-details":"",label:"交易金額",inputmode:"decimal",clearable:h.value!==0,"onUpdate:modelValue":r[0]||(r[0]=b=>h.value=isNaN(parseFloat(b))?0:parseFloat(b))},null,8,["model-value","clearable"]),i($,{ref:"storeAutoComplete",modelValue:g.value,"onUpdate:modelValue":r[1]||(r[1]=b=>g.value=b),"custom-filter":y,class:"flex-grow-0",density:"comfortable","hide-details":"","item-value":"store","item-title":"store",label:"消費店家",items:c.value,clearable:R(me)(g.value),placeholder:"全部店家","onUpdate:menu":r[2]||(r[2]=b=>{var Y;return!b&&((Y=R(e))==null?void 0:Y.blur())})},null,8,["modelValue","items","clearable"]),x("div",null,[i(I,{text:"支援的付款方式"}),x("div",Ft,[(f(!0),C(G,null,H(R(d),(b,Y)=>(f(),D(L,{key:Y,modelValue:V.value,"onUpdate:modelValue":r[3]||(r[3]=ge=>V.value=ge),density:"compact",value:b,"hide-details":"",label:b},null,8,["modelValue","value","label"]))),128))])]),x("div",Dt,[i(I,{text:"交易類型"}),i(A,{modelValue:S.value,"onUpdate:modelValue":r[4]||(r[4]=b=>S.value=b),"hide-details":"",inline:""},{default:P(()=>[i(O,{density:"compact",label:"國內交易",value:"Domestic"}),i(O,{density:"compact",label:"國外交易",value:"Foreign"})]),_:1},8,["modelValue"])]),x("div",Jt,[(f(!0),C(G,null,H(N.value,(b,Y)=>(f(),D(F,{key:Y,density:"compact",class:"mx-auto w-full flex-shrink-0",variant:"outlined",onClick:()=>w.value=b},{title:P(()=>[x("div",Kt,[x("div",Gt,[z(U(b.miles)+" ",1),x("p",jt,U(b.airLinesCode),1)]),b.isSelectedPlan?(f(),C("i",zt)):X("",!0)])]),text:P(()=>[x("div",Wt,[x("p",Xt,U(`${b.cardName} ${b.planName??""} ${b.rewardName??""}`)+" "+U(b.payments.length===0?"":` (支付方式: ${b.payments.join(", ")})`),1)])]),_:2},1032,["onClick"]))),128))],512)]),i(ee,{"model-value":!!w.value,"onUpdate:modelValue":r[6]||(r[6]=b=>w.value=null)},{default:P(()=>[w.value?(f(),D(F,{key:0,class:"mx-auto reward-detail-dialog","min-width":"100%",title:`${w.value.cardName} ${w.value.planName??""} ${w.value.rewardName??""}`},{subtitle:P(()=>[x("p",Ht,U(w.value.description??""),1)]),text:P(()=>[x("div",Yt,[x("p",qt,[r[7]||(r[7]=z(" 卡片說明： ")),w.value.cardUrl!==null?(f(),C("a",{key:0,target:"_blank",class:"underline",href:w.value.cardUrl}," 網站 ",8,Zt)):X("",!0)]),w.value.cardDescription!==""||w.value.cardDescription!==null?(f(),C("p",Qt,U(w.value.cardDescription),1)):X("",!0),w.value.pointExchangeName!==""?(f(),C("p",ea,U(w.value.pointExchangeName),1)):X("",!0),r[8]||(r[8]=x("br",null,null,-1)),x("p",null,"消費金額: "+U(h.value),1),x("p",null,"哩程預估: "+U(w.value.miles)+" "+U(w.value.airLinesCode),1),r[9]||(r[9]=x("br",null,null,-1)),(f(!0),C(G,null,H(w.value.calculateDetail,(b,Y)=>(f(),C("p",{key:Y},U(b),1))),128))])]),actions:P(()=>[i(J,{class:"ms-auto",text:"Close",onClick:r[5]||(r[5]=b=>w.value=null)})]),_:1},8,["title"])):X("",!0)]),_:1},8,["model-value"])],64)}}}),na=qe(aa,[["__scopeId","data-v-47681e1e"]]),la={class:"flex-col h-full overflow-hidden gap-8px"},sa={class:"flex-shrink-0 flex-col gap-8px"},oa={key:0,class:"flex justify-between items-center"},ia={class:"flex gap-8px"},ra={key:0,class:"gap-4px flex-col flex-grow-1 overflow-y-auto"},da={class:"text-1rem"},ca={class:"text-0.8rem"},ua={key:1,class:"flex-grow-1"},pa={class:"flex-col gap-24px m-8px"},ma={class:"flex-col gap-4px"},ya=ae({__name:"StoreAliasManagement",setup(o){const t=oe(),{aliasType:n,customAliases:s,storeAliases:l}=se(t),d=xe("storeList"),p={default:"系統預設",additional:"預設+自定義",custom:"自定義"},m=B(!0),u=B(!1),k=B(!0),h=B("[]"),g=B(null),S=Z(()=>{let v;return n.value==="default"?v=$e:n.value==="additional"?v=[...l.value].map(([a,r])=>[a,[...r]]):v=[...s.value],v.map(([a,r])=>({title:a,aliases:[...r]}))});be(()=>{var v;return(v=g.value)==null?void 0:v.title},v=>{if(v==null||g.value===null)return;const a=[...s.value.get(v)??[]];a[a.length-1]!==""&&a.push(""),g.value.aliases=a}),be(m,N),Ke(()=>{N(),u.value=!1,k.value=!0,m.value=!0});function V(v,a){if(g.value===null)return;let r=g.value.aliases;r[a]=v,r[r.length-1]!==""&&r.push("")}function j(v){if(n.value!=="default")if(v===null)g.value={title:null,aliases:[]};else{const a=[...s.value.get(v)??[]];a[a.length-1]!==""&&a.push(""),g.value={title:v,aliases:a}}}function e(){const{title:v,aliases:a}=g.value??{};v==null||a===void 0||(t.updateCustomAliases(v,[...new Set(a)].filter(me)),g.value=null)}function c(v){if(v=v.trim(),h.value=v,u.value=!0,v===""){k.value=!0;return}try{const a=JSON.parse(v);k.value=Se(a)}catch(a){console.error(a),k.value=!1}}function y(){let v;if(m.value)v=!0;else{h.value===""&&(h.value="[]");try{const a=JSON.parse(h.value);Se(a)?(t.updateAllCustomAliases(a),v=!0):v=!1}catch(a){console.error(a),v=!1}}v?(alert("儲存成功"),u.value=!1):alert(`儲存失敗${m.value?"":"，JSON 不符合規則"}`)}function N(){h.value=JSON.stringify([...s.value],null,2)}function w(v){u.value||(v==="default"&&(m.value=!0),t.updateAliasType(v))}return(v,a)=>{const r=_("v-label"),E=_("v-btn"),$=_("v-btn-toggle"),I=_("v-switch"),L=_("v-card"),O=_("v-textarea"),A=_("v-toolbar-title"),F=_("v-spacer"),J=_("v-toolbar-items"),ee=_("v-toolbar"),b=_("v-autocomplete"),Y=_("v-text-field"),ge=_("v-dialog");return f(),C(G,null,[x("div",la,[x("div",sa,[i(r,{text:"別名設定"}),i($,{"model-value":R(n),rounded:"0",group:"",class:"w-full flex justify-center",disabled:u.value,"onUpdate:modelValue":w},{default:P(()=>[(f(!0),C(G,null,H(R(Ve),(K,q)=>(f(),D(E,{key:q,class:"flex-1",value:K},{default:P(()=>[z(U(p[K]),1)]),_:2},1032,["value"]))),128))]),_:1},8,["model-value","disabled"]),R(n)!=="default"?(f(),C("div",oa,[x("div",ia,[m.value?(f(),D(E,{key:0,onClick:a[0]||(a[0]=K=>j(null))},{default:P(()=>a[6]||(a[6]=[z(" Add ")])),_:1})):(f(),D(E,{key:1,onClick:y},{default:P(()=>a[7]||(a[7]=[z(" Save ")])),_:1}))]),i(I,{modelValue:m.value,"onUpdate:modelValue":a[1]||(a[1]=K=>m.value=K),disabled:u.value,"hide-details":"",label:"圖示"},null,8,["modelValue","disabled"])])):X("",!0)]),m.value?(f(),C("div",ra,[(f(!0),C(G,null,H(S.value,(K,q)=>(f(),D(L,{key:q,density:"compact",class:"mx-auto w-full flex-shrink-0",variant:"outlined",onClick:ne=>j(K.title)},{text:P(()=>[x("p",da,U(K.title),1),x("p",ca,U(K.aliases.join(", ")),1)]),_:2},1032,["onClick"]))),128))])):(f(),C("div",ua,[i(O,{"model-value":h.value,clearable:h.value!=="","auto-grow":"",disabled:R(n)==="default","max-rows":15,messages:u.value?"上方儲存完成後才能執行其他動作，離開這頁不會存檔":"","error-messages":k.value?"":"json 無效",label:"自定義別名設定檔","onUpdate:modelValue":c},null,8,["model-value","clearable","disabled","messages","error-messages"])]))]),i(ge,{"model-value":!!g.value,fullscreen:"","onUpdate:modelValue":a[5]||(a[5]=K=>g.value=null)},{default:P(()=>[g.value?(f(),D(L,{key:0},{default:P(()=>[i(ee,null,{default:P(()=>[i(E,{icon:"mdi-close",onClick:a[2]||(a[2]=K=>g.value=null)}),i(A,null,{default:P(()=>a[8]||(a[8]=[z("編輯商店別名")])),_:1}),i(F),i(J,null,{default:P(()=>[i(E,{text:"Save",variant:"text",onClick:e})]),_:1})]),_:1}),x("div",pa,[i(b,{ref:"storeList",modelValue:g.value.title,"onUpdate:modelValue":a[3]||(a[3]=K=>g.value.title=K),class:"flex-grow-0","hide-details":"",label:"目標店家",items:R(t).storeList,placeholder:"選擇店家","onUpdate:menu":a[4]||(a[4]=K=>{var q;return!K&&((q=R(d))==null?void 0:q.blur())})},null,8,["modelValue","items"]),x("div",ma,[i(r,{text:"自定義別名列表"}),(f(!0),C(G,null,H(g.value.aliases,(K,q)=>(f(),D(Y,{key:q,"hide-details":"",clearable:"","model-value":K,"onUpdate:modelValue":ne=>V(ne,q),"onClick:clear":()=>{var ne;return(ne=g.value)==null?void 0:ne.aliases.splice(q,1)}},null,8,["model-value","onUpdate:modelValue","onClick:clear"]))),128))])])]),_:1})):X("",!0)]),_:1},8,["model-value"])],64)}}}),ga={style:{height:"calc(100dvh - 56px)"},class:"overflow-hidden mt-56px p-8px"},va={class:"w-full text-center"},fa={class:"w-full flex items-center justify-between px-8px"},_a=ae({__name:"App",setup(o){const t=oe(),{dialog:n}=se(t),s={查詢回饋:na,信用卡管理:Nt,商家別名:ya,喜好設定:wt},l=Object.keys(s),d=B(!1),p=B(l[0]);return(m,u)=>{const k=_("v-app-bar-nav-icon"),h=_("v-app-bar-title"),g=_("v-app-bar"),S=_("v-list-item"),V=_("v-divider"),j=_("v-navigation-drawer"),e=_("v-app"),c=_("v-btn"),y=_("v-card"),N=_("v-dialog");return f(),C(G,null,[i(e,null,{default:P(()=>[i(g,{density:"comfortable",elevation:2},{prepend:P(()=>[i(k,{onClick:u[0]||(u[0]=w=>d.value=!d.value)},{default:P(()=>u[2]||(u[2]=[x("i",{class:"fa-solid fa-bars"},null,-1)])),_:1}),i(h,null,{default:P(()=>[z(U(p.value),1)]),_:1})]),_:1}),i(j,{modelValue:d.value,"onUpdate:modelValue":u[1]||(u[1]=w=>d.value=w)},{default:P(()=>[(f(!0),C(G,null,H(R(l),(w,v)=>(f(),C(G,{key:v},[i(S,{title:w,class:Re(["h-48px",{"text-emphasis":p.value===w}]),onClick:()=>{p.value=w,d.value=!1}},null,8,["title","class","onClick"]),i(V)],64))),128))]),_:1},8,["modelValue"]),x("main",ga,[(f(),D(je,null,[(f(),D(Ge(s[p.value])))],1024))])]),_:1}),i(N,{"model-value":!!R(n),"onUpdate:modelValue":R(t).closeDialog},{default:P(()=>[R(n)!==null?(f(),D(y,{key:0,class:"mx-auto","min-width":"100%"},{text:P(()=>[x("div",va,U(R(n).text),1)]),actions:P(()=>[x("div",fa,[(f(!0),C(G,null,H(R(n).events,(w,v)=>(f(),D(c,{key:v,text:w.text,class:Re(w.class),variant:"elevated",onClick:async()=>{"event"in w&&await w.event(),R(t).closeDialog()}},null,8,["text","class","onClick"]))),128))])]),_:1})):X("",!0)]),_:1},8,["model-value","onUpdate:modelValue"])],64)}}}),Ce=ze(_a);Ce.use(Ye);Ce.use(Xe());Ce.mount("#app");
//# sourceMappingURL=bestMileageCards-ICuiwBYX.js.map
