{"version":3,"file":"bestMileageCards-gQyqcKzZ.js","sources":["../../../src/views/projects/BestMileageCards/CreditCard/modules/Reward.ts","../../../src/views/projects/BestMileageCards/CreditCard/modules/Plan.ts","../../../src/views/projects/BestMileageCards/CreditCard/modules/type.ts","../../../src/views/projects/BestMileageCards/CreditCard/modules/Card.ts","../../../src/views/projects/BestMileageCards/CreditCard/modules/PointExchange.ts","../../../src/views/projects/BestMileageCards/CreditCard/createCard.ts","../../../src/views/projects/BestMileageCards/configs/defaultCards/cathay.ts","../../../src/views/projects/BestMileageCards/configs/defaultCards/esunbank.ts","../../../src/views/projects/BestMileageCards/configs/defaultCards/hsbc.ts","../../../src/views/projects/BestMileageCards/configs/defaultCards/index.ts","../../../src/views/projects/BestMileageCards/configs/storeAliases.ts","../../../src/views/projects/BestMileageCards/types.ts","../../../src/views/projects/BestMileageCards/utils.ts","../../../src/views/projects/BestMileageCards/store.ts","../../../src/views/projects/BestMileageCards/containers/CommonSettings.vue","../../../src/components/TextFiled.vue","../../../src/utils/cloneDeep.ts","../../../src/views/projects/BestMileageCards/containers/CreditCardManagement.vue","../../../src/views/projects/BestMileageCards/containers/SearchReward.vue","../../../src/views/projects/BestMileageCards/containers/StoreAliasManagement.vue","../../../src/views/projects/BestMileageCards/App.vue","../../../src/views/projects/BestMileageCards/main.ts"],"sourcesContent":["import { floorByDigits, roundByDigits } from '@/utils'\n\nconst floorBy0 = floorByDigits(0)\nconst roundBy0 = roundByDigits(0)\nconst roundBy2 = roundByDigits(2)\n\ninterface RateItem {\n  rate: number\n  limit?: number\n}\n\ninterface BaseRewardStrategyParams<Type extends RewardType> {\n  /** 回饋名稱 */\n  name: string | null\n  /** 點數累積類型 */\n  type: Type\n}\nabstract class BaseRewardStrategy<Type extends RewardType> {\n  /** 回饋名稱 */\n  protected readonly _name: string | null\n  /** 點數累積類型 */\n  protected readonly _type: Type\n\n  public constructor({ type, name }: BaseRewardStrategyParams<Type>) {\n    this._type = type\n    this._name = name\n  }\n\n  /** 回饋名稱 */\n  public get name(): string | null {\n    return this._name\n  }\n  /** 點數累積類型 */\n  public get type(): Type {\n    return this._type\n  }\n  public abstract get description(): string\n\n  // TODO: 標準成本 baselineCostPerMile\n  // TODO: 最優成本 bestCaseCostPerMile\n  // TODO: 最差成本 maximumCostPerMile\n\n  /**\n   * @param amount 金額\n   * @returns 回饋點數\n   */\n  public abstract calculatePoints(amount: number): number\n  public calculateRangePointsCost(\n    minAmount: number,\n    maxAmount: number,\n  ): { max: number; min: number; average: number } {\n    const list: number[] = []\n    for (let amount = minAmount; amount <= maxAmount; amount++) {\n      const data = roundBy2(amount / this.calculatePoints(amount))\n      if (isNaN(data) || data === Infinity || data === -Infinity) {\n        continue\n      }\n      list.push(data)\n    }\n    list.sort((a, b) => a - b)\n    const max = list[list.length - 1]\n    const min = list[0]\n    if (max === undefined || min === undefined) {\n      throw new Error('cannot be calculated')\n    }\n    const average =\n      list.reduce((previousValue, currentValue) => previousValue + currentValue, 0) / list.length\n    return {\n      max,\n      min,\n      average: roundBy2(average),\n    }\n  }\n  public abstract toJSON(): RewardConfig\n}\n\n/** 點數回饋 (N%回饋點數，四捨五入) */\nexport class RoundedPercentageReward<\n  Type extends 'RoundedPercentageReward',\n> extends BaseRewardStrategy<Type> {\n  /** N% 回饋（四捨五入） */\n  private readonly _pointBackRates: RateItem[]\n\n  public constructor({\n    pointBackRates,\n    ...superParams\n  }: {\n    /** N% 回饋（四捨五入） */\n    pointBackRates: RateItem[]\n  } & BaseRewardStrategyParams<Type>) {\n    super(superParams)\n    this._pointBackRates = pointBackRates\n  }\n  private get _maxRete(): number {\n    return this._pointBackRates.reduce((total, { rate }) => total + rate, 0)\n  }\n  public get pointBackRates(): RateItem[] {\n    return this._pointBackRates\n  }\n  public get description(): string {\n    return `消費${this._pointBackRates.length > 1 ? '最高' : ''}${this._maxRete.toString()}%回饋點數(四捨五入)`\n  }\n\n  public calculatePoints(amount: number): number {\n    let points = 0\n    for (const { rate, limit = Infinity } of this._pointBackRates) {\n      points += Math.min(roundBy0(amount * (rate / 100)), limit)\n    }\n    return points\n  }\n\n  public toJSON(): RewardConfig {\n    return {\n      name: this._name,\n      type: this._type,\n      pointBackRates: this._pointBackRates,\n    }\n  }\n}\n\n/** 點數回饋 (N%回饋點數，無條件捨去) */\nexport class TruncatedPercentageReward<\n  Type extends 'TruncatedPercentageReward',\n> extends BaseRewardStrategy<Type> {\n  /** N% 回饋（無條件捨去） */\n  private readonly _pointBackRates: RateItem[]\n\n  public constructor({\n    pointBackRates,\n    ...superParams\n  }: {\n    /** N% 回饋（無條件捨去） */\n    pointBackRates: RateItem[]\n  } & BaseRewardStrategyParams<Type>) {\n    super(superParams)\n    this._pointBackRates = pointBackRates\n  }\n  private get _maxRete(): number {\n    return this._pointBackRates.reduce((total, { rate }) => total + rate, 0)\n  }\n  public get pointBackRates(): RateItem[] {\n    return this._pointBackRates\n  }\n  public get description(): string {\n    return `消費${this._pointBackRates.length > 1 ? '最高' : ''}${this._maxRete.toString()}%回饋點數(無條件捨去)`\n  }\n\n  public calculatePoints(amount: number): number {\n    let points = 0\n    for (const { rate, limit = Infinity } of this._pointBackRates) {\n      points += Math.min(floorBy0(amount * (rate / 100)), limit)\n    }\n    return points\n  }\n\n  public toJSON(): RewardConfig {\n    return {\n      name: this._name,\n      type: this._type,\n      pointBackRates: this._pointBackRates,\n    }\n  }\n}\n\n/** 哩程回饋 (消費 N 元取得一點，小數會累計) */\nexport class AccumulatedPointsReward<\n  Type extends 'AccumulatedPointsReward',\n> extends BaseRewardStrategy<Type> {\n  /** N 元一哩 */\n  private readonly _spendingPerPoint: number\n\n  public constructor({\n    spendingPerPoint,\n    ...superParams\n  }: {\n    /** N 元一哩 */\n    spendingPerPoint: number\n  } & BaseRewardStrategyParams<Type>) {\n    super({ ...superParams })\n    this._spendingPerPoint = spendingPerPoint\n  }\n\n  /** N 元一哩 */\n  public get spendingPerPoint(): number {\n    return this._spendingPerPoint\n  }\n  public get description(): string {\n    return `每消費${this._spendingPerPoint.toString()}元累積1點 (小數會累計)`\n  }\n\n  public calculatePoints(amount: number): number {\n    return roundBy2(amount / this._spendingPerPoint)\n  }\n\n  public toJSON(): RewardConfig {\n    return {\n      name: this._name,\n      type: this._type,\n      spendingPerPoint: this._spendingPerPoint,\n    }\n  }\n}\n\n/** 哩程回饋 (消費 N 元取得一點) */\nexport class FixedRatePointsReward<\n  Type extends 'FixedRatePointsReward',\n> extends BaseRewardStrategy<Type> {\n  /** N 元一哩 */\n  private readonly _spendingPerPoint: number\n\n  public constructor({\n    spendingPerPoint,\n    ...superParams\n  }: {\n    /** N 元一哩 */\n    spendingPerPoint: number\n  } & BaseRewardStrategyParams<Type>) {\n    super({ ...superParams })\n    this._spendingPerPoint = spendingPerPoint\n  }\n\n  /** N 元一哩 */\n  public get spendingPerPoint(): number {\n    return this._spendingPerPoint\n  }\n  public get description(): string {\n    return `每消費${this._spendingPerPoint.toString()}元累積1點 (小數不累計)`\n  }\n\n  public calculatePoints(amount: number): number {\n    return floorBy0(amount / this._spendingPerPoint)\n  }\n\n  public toJSON(): RewardConfig {\n    return {\n      name: this._name,\n      type: this._type,\n      spendingPerPoint: this._spendingPerPoint,\n    }\n  }\n}\n\nconst rewards = {\n  RoundedPercentageReward,\n  TruncatedPercentageReward,\n  AccumulatedPointsReward,\n  FixedRatePointsReward,\n} as const\nexport type RewardType = keyof typeof rewards\nexport type Reward<Type extends RewardType> = InstanceType<(typeof rewards)[Type]>\nexport type RewardConfig = ConstructorParameters<(typeof rewards)[RewardType]>[0]\n\nexport function rewardStrategyFactory<Type extends RewardType>(\n  params: RewardConfig & { type: Type },\n): Reward<Type> {\n  // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n  // @ts-expect-error\n  // eslint-disable-next-line @typescript-eslint/no-unsafe-return\n  return new rewards[params.type](params)\n}\n","import { removeDuplicates } from '@/utils'\n\nimport { type Reward, type RewardType } from './Reward'\nimport type {\n  Payment,\n  TransactionInfo,\n  RewardInfo,\n  TransactionType,\n  PlanConfig,\n  ConditionType,\n  RewardRuleConfig,\n} from './type'\n\ninterface PlanReward {\n  readonly rewardStrategy: Reward<RewardType>\n  readonly stores: ReadonlySet<string>\n  readonly storeBlackList: ReadonlySet<string>\n  readonly payments: ReadonlySet<Payment>\n  readonly paymentBlackList: ReadonlySet<Payment>\n  readonly transactionType: TransactionType | null\n  readonly condition: ConditionType | null\n}\n\nexport class Plan {\n  private readonly _name: string | null\n  private readonly _rewards: readonly PlanReward[]\n  private readonly _condition: ConditionType | null\n\n  public constructor(name: string | null, condition: ConditionType | null, rewards: PlanReward[]) {\n    this._name = name\n    this._condition = condition\n    if (rewards.length === 0) {\n      throw new Error(`Plan \"${name ?? 'unknown'}\" must have at least one reward rule.`)\n    }\n    this._rewards = rewards\n  }\n\n  public get name(): string | null {\n    return this._name\n  }\n  /** 方便在前端做選單或 autocomplete 用的 */\n  public get storeList(): string[] {\n    return removeDuplicates(\n      this._rewards.flatMap((reward) => [...reward.stores, ...reward.storeBlackList]),\n    )\n  }\n\n  public checkPlanIsVisible(currentConditions: ConditionType[] | null): boolean {\n    return this._condition === null || Boolean(currentConditions?.includes(this._condition))\n  }\n\n  public getApplicableReward({\n    transactionStore = null,\n    acceptedPayments = [],\n    transactionAttributesType,\n    currentConditions = null,\n  }: {\n    transactionStore?: string | null | undefined\n    acceptedPayments?: Payment[] | undefined\n    transactionAttributesType: TransactionType\n    currentConditions?: ConditionType[] | null | undefined\n  }): PlanReward | null {\n    if (this._condition !== null && !currentConditions?.includes(this._condition)) {\n      return null\n    }\n    return (\n      this._rewards.find(\n        ({\n          stores,\n          payments,\n          transactionType,\n          paymentBlackList,\n          storeBlackList,\n          condition,\n        }: PlanReward): boolean => {\n          const isStoreValid =\n            transactionStore === null || stores.size === 0 || stores.has(transactionStore)\n          const isStoreNotBlackListed =\n            transactionStore === null ||\n            storeBlackList.size === 0 ||\n            !storeBlackList.has(transactionStore)\n\n          const isPaymentValid =\n            acceptedPayments.length === 0 ||\n            payments.size === 0 ||\n            acceptedPayments.some((payment) => payments.has(payment))\n          const isPaymentNotBlackListed =\n            acceptedPayments.length === 0 ||\n            paymentBlackList.size === 0 ||\n            acceptedPayments.some((item) => !paymentBlackList.has(item))\n\n          const isTransactionTypeMatch =\n            transactionType === null || transactionAttributesType === transactionType\n          const conditionValid =\n            condition === null || Boolean(currentConditions?.includes(condition))\n\n          return (\n            isStoreValid &&\n            isStoreNotBlackListed &&\n            isPaymentValid &&\n            isPaymentNotBlackListed &&\n            isTransactionTypeMatch &&\n            conditionValid\n          )\n        },\n      ) ?? null\n    )\n  }\n\n  public getRewardMiles({\n    transactionStore,\n    acceptedPayments,\n    amount,\n    transactionAttributesType,\n    currentConditions,\n  }: TransactionInfo): Pick<\n    RewardInfo,\n    'rewardName' | 'rewardPoints' | 'payments' | 'rewardStrategy'\n  > | null {\n    const reward = this.getApplicableReward({\n      acceptedPayments,\n      transactionStore,\n      transactionAttributesType,\n      currentConditions,\n    })\n    if (reward === null) {\n      return null\n    }\n    const payments =\n      acceptedPayments === undefined\n        ? [...reward.payments.values()]\n        : acceptedPayments.filter((item) => reward.payments.has(item))\n    return {\n      rewardName: reward.rewardStrategy.name,\n      rewardPoints: reward.rewardStrategy.calculatePoints(amount),\n      payments: payments.filter((payment) => !reward.paymentBlackList.has(payment)),\n      rewardStrategy: reward.rewardStrategy,\n    }\n  }\n\n  public toJSON(): Required<PlanConfig> & { rewards: Required<RewardRuleConfig>[] } {\n    return {\n      name: this._name,\n      condition: this._condition,\n      rewards: this._rewards.map(\n        ({\n          rewardStrategy,\n          stores,\n          payments,\n          transactionType,\n          paymentBlackList,\n          storeBlackList,\n          condition,\n        }) => ({\n          rewardStrategy: rewardStrategy.toJSON(),\n          stores: [...stores],\n          storeBlackList: [...storeBlackList],\n          payments: [...payments],\n          paymentBlackList: [...paymentBlackList],\n          transactionType,\n          condition,\n        }),\n      ),\n    }\n  }\n}\n","import type { DateISOString, UUID } from '@/types'\n\nimport type { PointExchangeConfig, PointExchangeStrategy } from './PointExchange'\nimport type { Reward, RewardConfig, RewardType } from './Reward'\n\nexport const Payment = [\n  '信用卡',\n  'Apple Pay',\n  'Samsung Pay',\n  'Google Pay',\n  'Line Pay',\n  'Fitbit Pay',\n  'Garmin Pay',\n  'Hami Pay',\n  '街口支付',\n  '全盈+PAY',\n  '全支付',\n  'Pi錢包',\n  '橘子支付',\n  '歐付寶',\n  'icash pay',\n  'OPEN錢包',\n  'My FamiPay',\n  '悠遊付',\n  'ezPay',\n  'GOMAJI Pay',\n  'friday wallet',\n  'PayPal',\n  'PX Pay',\n  '中油Pay',\n  '台灣Pay',\n  '支付寶',\n] as const\nexport type Payment = (typeof Payment)[number]\nexport type TransactionType = 'Domestic' | 'Foreign'\nexport const ConditionType = ['Birthday'] as const\nexport type ConditionType = (typeof ConditionType)[number]\n\n/** input 的交易資料 */\nexport interface TransactionInfo {\n  /** 消費店家 */\n  transactionStore?: string\n  /** 支援的交易方式 */\n  acceptedPayments?: Payment[]\n  /** 交易屬性（國內交易、國外交易） */\n  transactionAttributesType: TransactionType\n  currentConditions?: ConditionType[]\n  amount: number\n}\n\n/** 回饋哩程資訊 */\nexport interface RewardInfo {\n  readonly planId: UUID\n  readonly planName: string | null\n  readonly payments: readonly Payment[]\n  readonly rewardName: string | null\n  readonly rewardStrategy: Reward<RewardType> | null\n  readonly rewardPoints: number\n  readonly pointExchangeName: string | null\n  readonly pointExchangeStrategy: PointExchangeStrategy\n  readonly airlineCode: string\n  readonly miles: number\n}\n\nexport interface RewardRuleConfig {\n  rewardStrategy: RewardConfig\n  transactionType?: TransactionType | null\n  stores?: string[]\n  storeBlackList?: string[]\n  payments?: Payment[]\n  paymentBlackList?: Payment[]\n  condition?: ConditionType | null\n}\nexport interface PlanConfig {\n  name: string | null\n  /** 回饋列表會有順序問題，前面的達成後就不會往下搜索，所以需要注意順序 */\n  rewards: RewardRuleConfig[]\n  condition?: ConditionType | null\n}\nexport interface CardConfig {\n  name: string\n  description: string | null\n  cardUrl: string | null\n  storeBlackList?: string[]\n  paymentBlackList?: Payment[]\n  plans: PlanConfig[]\n  /** 最後更新卡片權益的時間 */\n  updateAt: DateISOString\n  pointExchangeStrategies: PointExchangeConfig[]\n}\n","import type { UUID } from '@/types'\nimport { removeDuplicates } from '@/utils'\n\nimport { Plan } from './Plan'\nimport type { PointExchangeStrategy } from './PointExchange'\nimport { type TransactionInfo, type RewardInfo, type CardConfig, Payment } from './type'\n\ninterface CardParams {\n  /** 卡片名稱 */\n  readonly name: string\n  readonly description: string | null\n  /** 全部的方案 (如果像旅人卡那樣，只有一種回饋方式這邊選項就會只有一個) */\n  readonly plans: ReadonlyMap<UUID, Plan>\n  /** 信用卡網頁 */\n  readonly cardUrl: string | null\n  /** 不回饋商店清單 */\n  readonly storeBlackList: ReadonlySet<string>\n  /** 不回饋支付方式清單 */\n  readonly paymentBlackList: ReadonlySet<Payment>\n  /** 最後更新卡片回饋設定日期（不包含切換方案等使用者設定） */\n  readonly updateAt: Date\n  /** 點數交換策略 */\n  readonly pointExchangeStrategies: ReadonlyMap<UUID, PointExchangeStrategy>\n}\n\n// TODO\n// 之後要再想看看能怎麼實作讓 card 這邊可以吃 type, pointsPerMile, milesPerUnit 這些資料\n// 目前放在 reward 裡面可能不是好方法（畢竟目前已知的卡片都是固定回饋方式的）\nexport class CreditCard {\n  /** 當前選擇的方案 */\n  private _selectedPlanId: UUID\n  /** 當前選擇的交換方式 */\n  private _selectedPointExchangeStrategyId: UUID\n  /** 卡片名稱 */\n  private readonly _name: string\n  private readonly _description: string | null\n  /** 全部的方案 (如果像旅人卡那樣，只有一種回饋方式這邊選項就會只有一個) */\n  private readonly _plans: ReadonlyMap<UUID, Plan>\n  /** 信用卡的銀行網頁 */\n  private readonly _cardUrl: string | null\n  /** 不回饋商店清單 */\n  private readonly _storeBlackList: ReadonlySet<string>\n  /** 不回饋支付方式清單 */\n  private readonly _paymentBlackList: ReadonlySet<Payment>\n  /** 最後更新卡片回饋設定日期（不包含切換方案等使用者設定） */\n  private readonly _updateAt: Date\n  /** 點數交換策略 */\n  private readonly _pointExchangeStrategies: ReadonlyMap<UUID, PointExchangeStrategy>\n\n  public constructor({\n    name,\n    description,\n    plans,\n    storeBlackList,\n    paymentBlackList,\n    cardUrl,\n    updateAt,\n    pointExchangeStrategies,\n  }: CardParams) {\n    this._name = name\n    this._description = description\n    this._plans = plans\n    this._cardUrl = cardUrl\n    this._storeBlackList = storeBlackList\n    this._paymentBlackList = paymentBlackList\n    this._updateAt = updateAt\n    this._pointExchangeStrategies = pointExchangeStrategies\n\n    const firstPlanKey = this._plans.keys().next().value\n    if (this._plans.size === 0 || firstPlanKey === undefined) {\n      throw new Error('this credit card no any plan')\n    }\n    this._selectedPlanId = firstPlanKey\n\n    const firstExchangeKey = this._pointExchangeStrategies.keys().next().value\n    if (this._plans.size === 0 || firstExchangeKey === undefined) {\n      throw new Error('this credit card no any exchange strategy')\n    }\n    this._selectedPointExchangeStrategyId = firstExchangeKey\n  }\n\n  /** 卡片名稱 */\n  public get name(): string {\n    return this._name\n  }\n  public get description(): string | null {\n    return this._description\n  }\n  public get selectedPlanId(): UUID {\n    return this._selectedPlanId\n  }\n  public get selectedPlan(): Plan {\n    return this._getPlan(this._selectedPlanId)\n  }\n  public get selectedPointExchangeStrategyId(): UUID {\n    return this._selectedPointExchangeStrategyId\n  }\n  public get selectedPointExchangeStrategy(): PointExchangeStrategy {\n    return this._getPointExchangeStrategy(this._selectedPointExchangeStrategyId)\n  }\n  /** 回傳 uuid 跟 plan name */\n  public get selectablePlan(): { id: UUID; name: string | null }[] {\n    return [...this._plans.entries()].map(([id, { name }]) => ({ id, name }))\n  }\n  /** 方便在前端做選單或 autocomplete 用的 */\n  public get storeList(): string[] {\n    return removeDuplicates([\n      ...[...this._plans.values()].flatMap((plan) => plan.storeList),\n      ...this._storeBlackList,\n    ])\n  }\n  public get cardUrl(): string | null {\n    return this._cardUrl\n  }\n\n  private _getPlan(id: UUID): Plan {\n    const plan = this._plans.get(id)\n    if (plan === undefined) {\n      throw new Error(\n        `plan id ${id} not found. Available plans: ${[...this._plans.keys()].join(', ')}`,\n      )\n    }\n    return plan\n  }\n  private _getPointExchangeStrategy(id: UUID): PointExchangeStrategy {\n    const pointExchangeStrategy = this._pointExchangeStrategies.get(id)\n    if (pointExchangeStrategy === undefined) {\n      throw new Error(\n        `pointExchangeStrategy id ${id} not found. Available pointExchangeStrategies: ${[...this._plans.keys()].join(', ')}`,\n      )\n    }\n    return pointExchangeStrategy\n  }\n  private _rewardMilesWithPlan(\n    planId: UUID,\n    pointExchangeStrategyId: UUID,\n    paymentInfo: TransactionInfo,\n  ): RewardInfo {\n    const plan = this._getPlan(planId)\n    const pointExchangeStrategy = this._getPointExchangeStrategy(pointExchangeStrategyId)\n    const noneMatchRewardInfo: RewardInfo = {\n      planId,\n      planName: plan.name,\n      rewardName: null,\n      rewardPoints: 0,\n      payments: [],\n      rewardStrategy: null,\n      pointExchangeStrategy,\n      pointExchangeName: pointExchangeStrategy.name,\n      airlineCode: pointExchangeStrategy.airlineCode,\n      miles: 0,\n    }\n    const inStoreBlackList =\n      paymentInfo.transactionStore !== undefined &&\n      this._storeBlackList.has(paymentInfo.transactionStore)\n    const inPaymentBlackList = paymentInfo.acceptedPayments?.some((payment) =>\n      this._paymentBlackList.has(payment),\n    )\n    if (inStoreBlackList || inPaymentBlackList) {\n      return noneMatchRewardInfo\n    }\n    const rewardInfo = plan.getRewardMiles(paymentInfo)\n    if (rewardInfo === null) {\n      return noneMatchRewardInfo\n    }\n    return {\n      planId,\n      planName: plan.name,\n      pointExchangeStrategy,\n      pointExchangeName: pointExchangeStrategy.name,\n      miles: pointExchangeStrategy.calculateMiles(rewardInfo.rewardPoints),\n      airlineCode: pointExchangeStrategy.airlineCode,\n      ...rewardInfo,\n    }\n  }\n\n  public updatePlan(id: UUID): boolean {\n    const plan = this._plans.get(id)\n    if (plan) {\n      this._selectedPlanId = id\n      return true\n    }\n    return false\n  }\n  public updatePointExchangeStrategy(id: UUID): boolean {\n    const pointExchangeStrategy = this._pointExchangeStrategies.get(id)\n    if (pointExchangeStrategy) {\n      this._selectedPointExchangeStrategyId = id\n      return true\n    }\n    return false\n  }\n  public getRewardInfos(\n    paymentInfo: TransactionInfo,\n    {\n      onlyCurrentPlan = false,\n      onlyCurrentExchangeStrategy = false,\n    }: { onlyCurrentPlan?: boolean; onlyCurrentExchangeStrategy?: boolean } = {},\n  ): RewardInfo[] {\n    const plans: [UUID, Plan][] = onlyCurrentPlan\n      ? [[this._selectedPlanId, this.selectedPlan]]\n      : [...this._plans.entries()]\n    const exchangeIds: UUID[] = onlyCurrentExchangeStrategy\n      ? [this._selectedPointExchangeStrategyId]\n      : [...this._pointExchangeStrategies.keys()]\n    const rewardInfos: RewardInfo[] = []\n    for (const [planId, plan] of plans) {\n      const planIsVisible = plan.checkPlanIsVisible(paymentInfo.currentConditions ?? null)\n      if (!planIsVisible) {\n        continue\n      }\n      for (const pointExchangeStrategyId of exchangeIds) {\n        const rewardInfo = this._rewardMilesWithPlan(planId, pointExchangeStrategyId, paymentInfo)\n        rewardInfos.push(rewardInfo)\n      }\n    }\n    return rewardInfos\n  }\n  public toJSON(): Required<CardConfig> {\n    return {\n      name: this._name,\n      description: this._description,\n      cardUrl: this._cardUrl,\n      storeBlackList: [...this._storeBlackList],\n      paymentBlackList: [...this._paymentBlackList],\n      plans: [...this._plans]\n        .sort(([aId]) => (aId === this._selectedPlanId ? -1 : 1))\n        .map(([_id, plan]) => plan.toJSON()),\n      updateAt: this._updateAt.toISOString(),\n      pointExchangeStrategies: [...this._pointExchangeStrategies]\n        .sort(([aId]) => (aId === this._selectedPointExchangeStrategyId ? -1 : 1))\n        .map(([_id, strategy]) => strategy.toJSON()),\n    }\n  }\n}\n","import { roundByDigits } from '@/utils'\n\nconst roundBy2 = roundByDigits(2)\n\nexport class PointExchangeStrategy {\n  /** 點數交換名稱 */\n  private readonly _name: string | null\n  /** 航空代碼 */\n  private readonly _airlineCode: string\n  /** N 點可以換里程 */\n  private readonly _pointsPerMile: number\n  /** 可以換 M 哩里程 */\n  private readonly _milesPerUnit: number\n\n  public constructor({\n    name,\n    airlineCode,\n    pointsPerMile,\n    milesPerUnit,\n  }: {\n    /** 點數交換名稱 */\n    name: string | null\n    /** 航空代碼 */\n    airlineCode: string\n    /** N 點可以換里程 */\n    pointsPerMile: number\n    /** 可以換 M 哩里程 */\n    milesPerUnit: number\n  }) {\n    this._name = name\n    this._airlineCode = airlineCode\n    this._pointsPerMile = pointsPerMile\n    this._milesPerUnit = milesPerUnit\n  }\n\n  /** 點數交換名稱 */\n  public get name(): string | null {\n    return this._name\n  }\n  public get description(): string {\n    return `${this._pointsPerMile}點可以交換${this._milesPerUnit}哩程`\n  }\n  /** 航空代碼 */\n  public get airlineCode(): string {\n    return this._airlineCode\n  }\n  /** N 點可以換里程 */\n  public get pointsPerMile(): number {\n    return this._pointsPerMile\n  }\n  /** 可以換 M 哩里程 */\n  public get milesPerUnit(): number {\n    return this._milesPerUnit\n  }\n\n  /** input: 點數, output: 哩程 */\n  public calculateMiles(points: number): number {\n    return roundBy2((points * this._milesPerUnit) / this._pointsPerMile)\n  }\n\n  public toJSON(): PointExchangeConfig {\n    return {\n      name: this._name,\n      airlineCode: this._airlineCode,\n      pointsPerMile: this._pointsPerMile,\n      milesPerUnit: this._milesPerUnit,\n    }\n  }\n}\n\nexport type PointExchangeConfig = ConstructorParameters<typeof PointExchangeStrategy>[0]\n","import typia from 'typia'\n\nimport type { UUID } from '@/types'\nimport { generateUuid } from '@/utils'\nimport { PointExchangeStrategy } from '@/views/projects/BestMileageCards/CreditCard/modules/PointExchange'\n\nimport { CreditCard } from './modules/Card'\nimport { Plan } from './modules/Plan'\nimport { rewardStrategyFactory } from './modules/Reward'\nimport type { CardConfig } from './modules/type'\n\nexport function createCard({\n  name,\n  description,\n  storeBlackList,\n  paymentBlackList,\n  cardUrl,\n  plans: planConfigs,\n  updateAt,\n  pointExchangeStrategies,\n}: CardConfig): CreditCard {\n  const plans = new Map<UUID, Plan>(\n    planConfigs.map(({ name, condition, rewards }) => [\n      generateUuid(),\n      new Plan(\n        name,\n        condition ?? null,\n        rewards.map(\n          ({\n            stores,\n            payments,\n            transactionType,\n            rewardStrategy,\n            paymentBlackList,\n            storeBlackList,\n            condition,\n          }) => ({\n            rewardStrategy: rewardStrategyFactory(rewardStrategy),\n            stores: new Set(stores),\n            storeBlackList: new Set(storeBlackList),\n            payments: new Set(payments),\n            paymentBlackList: new Set(paymentBlackList),\n            transactionType: transactionType ?? null,\n            condition: condition ?? null,\n          }),\n        ),\n      ),\n    ]),\n  )\n  return new CreditCard({\n    name,\n    description,\n    plans,\n    storeBlackList: new Set(storeBlackList),\n    paymentBlackList: new Set(paymentBlackList),\n    cardUrl,\n    updateAt: new Date(updateAt),\n    pointExchangeStrategies: new Map(\n      pointExchangeStrategies.map((item) => [generateUuid(), new PointExchangeStrategy(item)]),\n    ),\n  })\n}\n\nexport const isCardConfig = typia.createIs<CardConfig>()\n","import type { CardConfig, Payment } from '../../CreditCard'\n\nconst storeBlackList: string[] = ['分期付款']\nconst paymentBlackList: Payment[] = []\n\nconst payments: Payment[] = [\n  '信用卡',\n  'Apple Pay',\n  'Samsung Pay',\n  'Google Pay',\n  'Fitbit Pay',\n  'Garmin Pay',\n  'Hami Pay',\n]\n\nfunction planSettings(defaultBackRete: number): CardConfig['plans'] {\n  const baseReward: CardConfig['plans'][number]['rewards'][number] = {\n    rewardStrategy: {\n      type: 'RoundedPercentageReward',\n      name: null,\n      pointBackRates: [{ rate: 0.3 }],\n    },\n  }\n\n  return [\n    {\n      name: '集精選',\n      rewards: [\n        {\n          rewardStrategy: {\n            type: 'RoundedPercentageReward',\n            name: null,\n            pointBackRates: [{ rate: 2 }],\n          },\n          stores: [\n            '家樂福',\n            'LOPIA台灣',\n            '全聯福利中心',\n            '台灣中油-直營',\n            '7-ELEVEN',\n            '全家便利商店',\n            'IKEA',\n          ],\n          payments: [...payments, 'PX Pay', 'My FamiPay', 'OPEN錢包'],\n        },\n        baseReward,\n      ],\n    },\n    {\n      name: '玩數位',\n      rewards: [\n        {\n          rewardStrategy: {\n            type: 'RoundedPercentageReward',\n            name: null,\n            pointBackRates: [{ rate: defaultBackRete }],\n          },\n          stores: [\n            'App Store',\n            'Apple Music',\n            'iCloud',\n            'Apple TV+',\n            'Apple Arcade',\n            'Apple One',\n            'iTunes',\n            'Google Play',\n            'Disney+',\n            'Netflix',\n            'Spotify',\n            'KKBOX',\n            'YouTube Premium',\n            '蝦皮購物',\n            'momo購物網',\n            'PChome 24h購物(不含儲值及電子票券)',\n            '博客來',\n            '小樹購',\n            'Coupang 酷澎(台灣)',\n            '淘寶/天貓',\n          ],\n          paymentBlackList: ['Line Pay', '街口支付'],\n        },\n        { ...baseReward, storeBlackList: ['全聯福利中心'] },\n      ],\n    },\n    {\n      name: '樂饗購',\n      rewards: [\n        {\n          rewardStrategy: {\n            type: 'RoundedPercentageReward',\n            name: null,\n            pointBackRates: [{ rate: defaultBackRete }],\n          },\n          stores: [\n            '遠東SOGO百貨',\n            '遠東Garden City',\n            '太平洋百貨',\n            '新光三越',\n            'SKM Park',\n            'BELLAVITA',\n            '微風廣場',\n            '遠東百貨',\n            'Big City遠東巨城購物中心',\n            '誠品生活',\n            '環球購物中心',\n            'CITYLINK',\n            '統一時代',\n            '台北101',\n            'ATT 4 FUN',\n            '明曜百貨',\n            '京站',\n            '美麗華',\n            '大葉高島屋',\n            '比漾廣場',\n            '大江國際購物中心',\n            '中友百貨',\n            '廣三SOGO',\n            'Tiger City',\n            '勤美誠品綠園道',\n            '大魯閣新時代',\n            '耐斯廣場',\n            '南紡購物中心',\n            '夢時代',\n            '漢神百貨',\n            '漢神巨蛋',\n            'MITSUI OUTLET PARK 林口',\n            'MITSUI OUTLET PARK 台中港',\n            'MITSUI OUTLET PARK 台南',\n            'Mitsui Shopping Park LaLaport 台中',\n            '義大世界購物廣場',\n            '華泰名品城',\n            '義享天地',\n            '麗寶OUTLET Mall',\n            '秀泰生活',\n            '台茂購物中心',\n            '新月廣場',\n            '三創生活',\n            '宏匯廣場',\n            '高雄棧貳庫/大港倉',\n            'NOKE忠泰樂生活',\n            'Uber Eats',\n            'foodpanda',\n            'foodomo',\n            '國內餐飲(不含餐券)',\n            '麥當勞',\n            '康是美',\n            '屈臣氏',\n          ],\n          payments,\n        },\n        { ...baseReward, storeBlackList: ['全聯福利中心'] },\n      ],\n    },\n    {\n      name: '趣旅行',\n      rewards: [\n        {\n          rewardStrategy: {\n            type: 'RoundedPercentageReward',\n            name: null,\n            pointBackRates: [{ rate: defaultBackRete }],\n          },\n          stores: [\n            '海外實體消費',\n            '東京迪士尼樂園',\n            '東京華納兄弟哈利波特影城',\n            '大阪環球影城(USJ)',\n            '吉卜力公園',\n            'Apple Wallet SUICA',\n            'Apple Wallet PASMO',\n            'Apple Wallet ICOCA',\n            'Uber',\n            'Grab',\n            '台灣高鐵',\n            'yoxi',\n            '台灣大車隊',\n            'iRent',\n            '和運租車',\n            '格上租車',\n            '中華航空',\n            '長榮航空',\n            '星宇航空',\n            '台灣虎航',\n            '國泰航空',\n            '樂桃航空',\n            '阿聯酋航空',\n            '酷航',\n            '捷星航空',\n            '日本航空',\n            '亞洲航空',\n            '聯合航空',\n            'ANA全日空',\n            '新加坡航空',\n            '越捷航空',\n            '大韓航空',\n            '達美航空',\n            '土耳其航空',\n            '卡達航空',\n            '法國航空',\n            '國內飯店住宿',\n            '星野集團',\n            '全球迪士尼飯店',\n            '東橫INN',\n            'KKday',\n            'Agoda',\n            'Klook',\n            'Airbnb',\n            'Hotels.com',\n            'Expedia',\n            'Booking.com',\n            'Trip.com',\n            'AsiaYo',\n            'ezTravel易遊網',\n            '雄獅旅遊',\n            '可樂旅遊',\n            '東南旅遊',\n            '五福旅遊',\n            '燦星旅遊',\n            '山富旅遊',\n            '長汎假期',\n            '鳳凰旅行社',\n            'Ezfly易飛網',\n            '理想旅遊',\n            '永利旅行社',\n            '三賀旅行社',\n            '173WIFI',\n            'JetFi mobile',\n            '威訊 WaySim',\n            'AIRSIM',\n            'SIM88',\n          ],\n          payments,\n        },\n        { ...baseReward, storeBlackList: ['全聯福利中心'] },\n      ],\n    },\n    {\n      name: '來支付',\n      rewards: [\n        {\n          rewardStrategy: {\n            type: 'RoundedPercentageReward',\n            name: null,\n            pointBackRates: [{ rate: 2 }],\n          },\n          payments: ['Line Pay'],\n        },\n        { ...baseReward, storeBlackList: ['全聯福利中心'] },\n      ],\n    },\n    {\n      name: '慶生月',\n      condition: 'Birthday',\n      rewards: [\n        {\n          rewardStrategy: {\n            type: 'RoundedPercentageReward',\n            name: null,\n            pointBackRates: [{ rate: 10 }],\n          },\n          stores: [\n            '東京迪士尼樂園',\n            '大阪環球影城(USJ)',\n            '名古屋樂高樂園',\n            '紅葉蛋糕官方網站',\n            '法朋烘焙甜點坊',\n            '興波咖啡 華山旗艦店',\n            '海底撈火鍋',\n            '輕井澤鍋物',\n            '老四川巴蜀麻辣燙',\n            '二本松涮涮屋',\n            '橋山.壽喜燒',\n            'Umai屋馬燒肉',\n            '老井極上燒肉',\n            '燒肉中山(台中大墩)',\n            '藏壽司台灣',\n            '貳樓',\n            '膳馨民間創作料理',\n            '馨苑小料理',\n            '雅室牛排 仁愛圓環店',\n            'ABV餐飲集團',\n            'WAT',\n            '臺虎精釀(信義 | 西門 | 臺中 | 啜飲室大安)',\n            'BAR Bodega',\n            'BAR MED',\n            'JiN Her 今鶴',\n            '錢櫃KTV',\n            '好樂迪KTV',\n            '星聚點KTV',\n            '享溫馨KTV',\n            'Nintendo',\n            '巴哈姆特動畫瘋',\n            '閃動格子CyberCube',\n          ],\n        },\n        {\n          rewardStrategy: {\n            type: 'RoundedPercentageReward',\n            name: null,\n            pointBackRates: [{ rate: 3.5 }],\n          },\n          stores: [\n            '新光三越',\n            'Uber Eats (不含 Uber One)',\n            'Agoda',\n            'Trip.com',\n            'Klook',\n            '國內飯店住宿',\n            '星野集團',\n            '全球迪士尼飯店',\n            '東橫INN',\n          ],\n        },\n        { ...baseReward, storeBlackList: ['全聯福利中心'] },\n      ],\n    },\n  ]\n}\n\nconst pointExchangeStrategies: CardConfig['pointExchangeStrategies'] = [\n  {\n    name: '長榮航空哩程',\n    airlineCode: 'EVA',\n    pointsPerMile: 360,\n    milesPerUnit: 1000,\n  },\n  {\n    name: '長榮航空哩程 + 長榮世界卡',\n    airlineCode: 'EVA',\n    pointsPerMile: 300,\n    milesPerUnit: 1000,\n  },\n]\n\nexport const cubeConfigs: CardConfig[] = [\n  {\n    name: 'Cube 卡',\n    description: 'Cube 卡 (Level 1) 回饋方案',\n    cardUrl: 'https://www.cathaybk.com.tw/cathaybk/personal/product/credit-card/cards/cube/',\n    storeBlackList,\n    paymentBlackList,\n    updateAt: '2024-12-01T00:00:00.000Z',\n    plans: planSettings(2),\n    pointExchangeStrategies,\n  },\n  {\n    name: 'Cube 卡',\n    description: 'Cube 卡 (Level 2) 回饋方案',\n    cardUrl: 'https://www.cathaybk.com.tw/cathaybk/personal/product/credit-card/cards/cube/',\n    storeBlackList,\n    paymentBlackList,\n    updateAt: '2024-12-01T00:00:00.000Z',\n    plans: planSettings(3),\n    pointExchangeStrategies,\n  },\n  {\n    name: 'Cube 卡',\n    description: 'Cube 卡 (Level 3) 回饋方案',\n    cardUrl: 'https://www.cathaybk.com.tw/cathaybk/personal/product/credit-card/cards/cube/',\n    storeBlackList,\n    paymentBlackList,\n    updateAt: '2024-12-01T00:00:00.000Z',\n    plans: planSettings(3.3),\n    pointExchangeStrategies,\n  },\n]\n\nexport const exampleCubeConfig: CardConfig = {\n  name: 'Cube 卡',\n  description: 'Cube 卡 (Level 2) 回饋方案',\n  cardUrl: 'https://www.cathaybk.com.tw/cathaybk/personal/product/credit-card/cards/cube/',\n  storeBlackList,\n  paymentBlackList,\n  updateAt: '2024-12-01T00:00:00.000Z',\n  plans: planSettings(3),\n  pointExchangeStrategies: [\n    {\n      name: '長榮航空哩程',\n      airlineCode: 'EVA',\n      pointsPerMile: 360,\n      milesPerUnit: 1000,\n    },\n  ],\n}\n","import type { CardConfig, Payment } from '../../CreditCard'\n\nconst storeBlackList: string[] = [\n  '政府稅款',\n  '公共事業代扣繳',\n  '交通違規罰鍰',\n  '分期付款',\n  '全聯福利中心',\n  '7-ELEVEN',\n  '全家便利商店',\n]\nconst paymentBlackList: Payment[] = []\n\nexport const starLuxConfigs: CardConfig[] = [\n  {\n    name: '星宇世界卡',\n    description: null,\n    cardUrl:\n      'https://www.esunbank.com/zh-tw/personal/credit-card/intro/co-branded-card/starlux-card',\n    storeBlackList,\n    paymentBlackList,\n    pointExchangeStrategies: [\n      {\n        name: '星宇航空哩程',\n        airlineCode: 'SJX',\n        pointsPerMile: 1,\n        milesPerUnit: 1,\n      },\n    ],\n    plans: [\n      {\n        name: null,\n        rewards: [\n          {\n            rewardStrategy: {\n              type: 'FixedRatePointsReward',\n              name: '國外消費',\n              spendingPerPoint: 5,\n            },\n            transactionType: 'Foreign',\n            condition: 'Birthday',\n          },\n          {\n            rewardStrategy: {\n              type: 'FixedRatePointsReward',\n              name: '國外消費',\n              spendingPerPoint: 10,\n            },\n            transactionType: 'Foreign',\n          },\n          {\n            rewardStrategy: {\n              type: 'FixedRatePointsReward',\n              name: '國內消費',\n              spendingPerPoint: 20,\n            },\n            transactionType: 'Domestic',\n          },\n        ],\n      },\n    ],\n    updateAt: new Date('2024/12/01 00:00:00').toISOString(),\n  },\n  {\n    name: '星宇商務鈦金卡',\n    description: null,\n    cardUrl:\n      'https://www.esunbank.com/zh-tw/personal/credit-card/intro/co-branded-card/starlux-card',\n    storeBlackList,\n    paymentBlackList,\n    pointExchangeStrategies: [\n      {\n        name: '星宇航空哩程',\n        airlineCode: 'SJX',\n        pointsPerMile: 1,\n        milesPerUnit: 1,\n      },\n    ],\n    plans: [\n      {\n        name: null,\n        rewards: [\n          {\n            rewardStrategy: {\n              type: 'FixedRatePointsReward',\n              name: '國外消費',\n              spendingPerPoint: 7.5,\n            },\n            transactionType: 'Foreign',\n            condition: 'Birthday',\n          },\n          {\n            rewardStrategy: {\n              type: 'FixedRatePointsReward',\n              name: '國外消費',\n              spendingPerPoint: 15,\n            },\n            transactionType: 'Foreign',\n          },\n          {\n            rewardStrategy: {\n              type: 'FixedRatePointsReward',\n              name: '國內消費',\n              spendingPerPoint: 25,\n            },\n            transactionType: 'Domestic',\n          },\n        ],\n      },\n    ],\n    updateAt: new Date('2024/12/01 00:00:00').toISOString(),\n  },\n  {\n    name: '星宇鈦金卡',\n    description: null,\n    cardUrl:\n      'https://www.esunbank.com/zh-tw/personal/credit-card/intro/co-branded-card/starlux-card',\n    storeBlackList,\n    paymentBlackList,\n    pointExchangeStrategies: [\n      {\n        name: '星宇航空哩程',\n        airlineCode: 'SJX',\n        pointsPerMile: 1,\n        milesPerUnit: 1,\n      },\n    ],\n    plans: [\n      {\n        name: null,\n        rewards: [\n          {\n            rewardStrategy: {\n              type: 'FixedRatePointsReward',\n              name: '國外消費',\n              spendingPerPoint: 20,\n            },\n            transactionType: 'Foreign',\n          },\n          {\n            rewardStrategy: {\n              type: 'FixedRatePointsReward',\n              name: '國內消費',\n              spendingPerPoint: 28,\n            },\n            transactionType: 'Domestic',\n          },\n        ],\n      },\n    ],\n    updateAt: new Date('2024/12/01 00:00:00').toISOString(),\n  },\n]\n\nconst uniCardStoreList = [\n  '台灣中油-直營',\n  '台灣大車隊',\n  '台鐵',\n  '台灣高鐵',\n  'UBER',\n  'Yoxi',\n  'LINEGO',\n  '新光三越',\n  '遠東百貨',\n  '遠東SOGO百貨',\n  '誠品生活',\n  '漢神百貨',\n  '微風廣場',\n  '微風信義',\n  '微風南京',\n  '微風南山',\n  '微風台北車站',\n  '環球購物中心',\n  '台北101',\n  '華泰名品城',\n  'MITSUI OUTLET PARK 林口',\n  'MITSUI OUTLET PARK 台中港',\n  'MITSUI OUTLET PARK 台南',\n  'Big City遠東巨城購物中心',\n  '昇恆昌',\n  '夢時代購物中心',\n  '京站',\n  '美麗華',\n  '南紡購物中心',\n  '秀泰生活',\n  '台茂購物中心',\n  'Mitsui Shopping Park LaLaport 台中',\n  '統領廣場',\n  '采盟',\n  'Uber Eats',\n  'foodpanda',\n  '星巴克',\n  'EZTABLE',\n  '王品瘋美食',\n  '摩斯漢堡',\n  'foodomo',\n  '漢來美食',\n  '饗Joy',\n  '饗食天堂',\n  '果然匯',\n  '小福利',\n  '饗饗',\n  '旭集',\n  '開飯',\n  '饗泰多',\n  '真珠',\n  '瓦城',\n  '非常泰',\n  '大心',\n  '1010',\n  '時時香',\n  'BOBO',\n  '乾杯集團',\n  '路易莎',\n  '中華航空',\n  '長榮航空',\n  '日本航空',\n  '台灣虎航',\n  '樂桃航空',\n  '酷航',\n  '立榮航空',\n  '華信航空',\n  'Agoda',\n  'booking.com',\n  'Hotels.com',\n  'AsiaYo',\n  'Expedia',\n  'KKday',\n  'Klook',\n  '雄獅旅遊',\n  '可樂旅遊',\n  '東南旅行社',\n  'Apple直營店',\n  '小米台灣',\n  '全國電子',\n  '燦坤',\n  '迪卡儂',\n  '屈臣氏',\n  '康是美',\n  'IKEA',\n  '特力屋',\n  '特力和樂',\n  'UNIQLO',\n  'NET',\n  '大樹藥局',\n  '丁丁藥妝',\n  'momo購物網',\n  '蝦皮購物',\n  '淘寶網',\n  'Coupang酷澎',\n  '東森購物',\n  '雅虎奇摩購物中心',\n  '博客來',\n  '玉山Wallet愛心捐款-單筆捐款',\n  '玉山Wallet愛心捐款-定期定額',\n  '特斯拉',\n  'Gogoro電池資費',\n  'YouBike 2.0',\n  '日本實體店',\n  '韓國實體店',\n  '泰國實體店',\n  '越南實體店',\n  '新加坡實體店',\n  '中國實體店',\n  '香港實體店',\n  '澳門實體店',\n  '美國實體店',\n  '英國實體店',\n  '法國實體店',\n  '德國實體店',\n  '義大利實體店',\n]\nconst uniCardBaseReward: CardConfig['plans'][number]['rewards'][number] = {\n  rewardStrategy: {\n    type: 'TruncatedPercentageReward',\n    name: null,\n    pointBackRates: [{ rate: 0.3 }, { rate: 0.7 }],\n  },\n}\nexport const uniCardConfigs: CardConfig[] = [\n  {\n    name: 'UniCard 卡',\n    description: null,\n    cardUrl: 'https://www.esunbank.com/zh-tw/personal/credit-card/intro/bank-card/unicard',\n    storeBlackList,\n    paymentBlackList,\n    pointExchangeStrategies: [\n      {\n        name: '長榮航空哩程',\n        airlineCode: 'EVA',\n        pointsPerMile: 200,\n        milesPerUnit: 300,\n      },\n    ],\n    plans: [\n      {\n        name: '任意選 (需要切換店家)',\n        rewards: [\n          {\n            rewardStrategy: {\n              type: 'TruncatedPercentageReward',\n              name: null,\n              pointBackRates: [{ rate: 0.3 }, { rate: 0.7 }, { rate: 2.5, limit: 500 }],\n            },\n            stores: uniCardStoreList,\n            payments: ['信用卡', 'Apple Pay', 'Samsung Pay', 'Google Pay'],\n          },\n          {\n            rewardStrategy: {\n              type: 'TruncatedPercentageReward',\n              name: null,\n              pointBackRates: [{ rate: 0.3 }, { rate: 0.7 }, { rate: 2.5, limit: 500 }],\n            },\n            payments: ['Line Pay', '街口支付', '悠遊付', '橘子支付', 'icash pay'],\n          },\n          uniCardBaseReward,\n        ],\n      },\n      {\n        name: '簡單選',\n        rewards: [\n          {\n            rewardStrategy: {\n              type: 'TruncatedPercentageReward',\n              name: null,\n              pointBackRates: [{ rate: 0.3 }, { rate: 0.7 }, { rate: 2, limit: 500 }],\n            },\n            stores: uniCardStoreList,\n            payments: ['信用卡', 'Apple Pay', 'Samsung Pay', 'Google Pay'],\n          },\n          {\n            rewardStrategy: {\n              type: 'TruncatedPercentageReward',\n              name: null,\n              pointBackRates: [{ rate: 0.3 }, { rate: 0.7 }, { rate: 2, limit: 500 }],\n            },\n            payments: ['Line Pay', '街口支付', '悠遊付', '橘子支付', 'icash pay'],\n          },\n          uniCardBaseReward,\n        ],\n      },\n      {\n        name: 'UP選',\n        rewards: [\n          {\n            rewardStrategy: {\n              type: 'TruncatedPercentageReward',\n              name: null,\n              pointBackRates: [{ rate: 0.3 }, { rate: 0.7 }, { rate: 3.5, limit: 2000 }],\n            },\n            stores: uniCardStoreList,\n            payments: ['信用卡', 'Apple Pay', 'Samsung Pay', 'Google Pay'],\n          },\n          {\n            rewardStrategy: {\n              type: 'TruncatedPercentageReward',\n              name: null,\n              pointBackRates: [{ rate: 0.3 }, { rate: 0.7 }, { rate: 3.5, limit: 2000 }],\n            },\n            payments: ['Line Pay', '街口支付', '悠遊付', '橘子支付', 'icash pay'],\n          },\n          uniCardBaseReward,\n        ],\n      },\n    ],\n    updateAt: new Date('2024/12/01 00:00:00').toISOString(),\n  },\n]\n\n// eslint-disable-next-line @typescript-eslint/no-non-null-assertion\nexport const exampleUniCardConfig: CardConfig = uniCardConfigs[0]!\n","import type { CardConfig, Payment } from '../../CreditCard'\n\nconst storeBlackList: string[] = ['政府稅款', '公共事業代扣繳', '交通違規罰鍰', '分期付款']\nconst paymentBlackList: Payment[] = ['全盈+PAY', 'icash pay', 'OPEN錢包', 'My FamiPay']\n\nexport const travelConfigs: CardConfig[] = [\n  {\n    name: '旅人無限卡',\n    description: null,\n    cardUrl: 'https://www.hsbc.com.tw/credit-cards/products/travel/visa-infinite/',\n    storeBlackList,\n    paymentBlackList,\n    pointExchangeStrategies: [\n      {\n        name: '長榮航空哩程',\n        airlineCode: 'EVA',\n        pointsPerMile: 1,\n        milesPerUnit: 1,\n      },\n    ],\n    plans: [\n      {\n        name: null,\n        rewards: [\n          {\n            rewardStrategy: {\n              type: 'AccumulatedPointsReward',\n              name: '國外消費',\n              spendingPerPoint: 10,\n            },\n            transactionType: 'Foreign',\n          },\n          {\n            rewardStrategy: {\n              type: 'AccumulatedPointsReward',\n              name: '國內消費',\n              spendingPerPoint: 18,\n            },\n            transactionType: 'Domestic',\n          },\n        ],\n      },\n    ],\n    updateAt: new Date('2024/12/01 00:00:00').toISOString(),\n  },\n  {\n    name: '旅人御璽卡',\n    description: null,\n    cardUrl: 'https://www.hsbc.com.tw/credit-cards/products/travel/visa-signature/',\n    storeBlackList,\n    paymentBlackList,\n    pointExchangeStrategies: [\n      {\n        name: '長榮航空哩程',\n        airlineCode: 'EVA',\n        pointsPerMile: 1,\n        milesPerUnit: 1,\n      },\n    ],\n    plans: [\n      {\n        name: null,\n        rewards: [\n          {\n            rewardStrategy: {\n              type: 'AccumulatedPointsReward',\n              name: '國外消費',\n              spendingPerPoint: 15,\n            },\n            transactionType: 'Foreign',\n          },\n          {\n            rewardStrategy: {\n              type: 'AccumulatedPointsReward',\n              name: '國內消費',\n              spendingPerPoint: 18,\n            },\n            transactionType: 'Domestic',\n          },\n        ],\n      },\n    ],\n    updateAt: new Date('2024/12/01 00:00:00').toISOString(),\n  },\n  {\n    name: '旅人輕旅卡',\n    description: null,\n    cardUrl: 'https://www.hsbc.com.tw/credit-cards/products/travel/visa-light/',\n    storeBlackList,\n    paymentBlackList,\n    pointExchangeStrategies: [\n      {\n        name: '長榮航空哩程',\n        airlineCode: 'EVA',\n        pointsPerMile: 1,\n        milesPerUnit: 1,\n      },\n    ],\n    plans: [\n      {\n        name: null,\n        rewards: [\n          {\n            rewardStrategy: {\n              type: 'AccumulatedPointsReward',\n              name: '國外消費',\n              spendingPerPoint: 20,\n            },\n            transactionType: 'Foreign',\n          },\n          {\n            rewardStrategy: {\n              type: 'AccumulatedPointsReward',\n              name: '國內消費',\n              spendingPerPoint: 20,\n            },\n            transactionType: 'Domestic',\n          },\n        ],\n      },\n    ],\n    updateAt: new Date('2024/12/01 00:00:00').toISOString(),\n  },\n]\n\n// eslint-disable-next-line @typescript-eslint/no-non-null-assertion\nexport const exampleTravelConfig: CardConfig = travelConfigs[2]!\n","import type { CardConfig } from '../../CreditCard'\nimport { cubeConfigs, exampleCubeConfig } from './cathay'\nimport { exampleUniCardConfig, starLuxConfigs, uniCardConfigs } from './esunbank'\nimport { exampleTravelConfig, travelConfigs } from './hsbc'\n\nexport const exampleCardConfigs: CardConfig[] = [\n  exampleCubeConfig,\n  exampleTravelConfig,\n  exampleUniCardConfig,\n]\n\nexport const defaultCardConfigs: CardConfig[] = [\n  ...cubeConfigs,\n  ...travelConfigs,\n  ...starLuxConfigs,\n  ...uniCardConfigs,\n]\n","import typia from 'typia'\n\nexport type StoreAliases = [string, string[]]\nexport const isStoreAliasesList = typia.createIs<StoreAliases[]>()\n\nexport const defaultStoreAliases: readonly [string, readonly string[]][] = [\n  ['7-ELEVEN', ['7-11', 'Seven Eleven', '統一超商', '小7']],\n  ['ANA全日空', ['ANA', '全日空', 'All Nippon Airways', 'NH']],\n  ['ATT 4 FUN', ['ATT4FUN', 'ATT信義']],\n  ['App Store', ['蘋果應用商店']],\n  ['Apple Arcade', ['蘋果遊戲訂閱服務']],\n  ['Apple Music', ['蘋果音樂', 'Apple音樂']],\n  ['Apple One', ['蘋果One訂閱']],\n  ['Apple TV+', ['Apple TV Plus']],\n  ['Apple Wallet ICOCA', ['ICOCA電子票', 'Apple錢包ICOCA']],\n  ['Apple Wallet PASMO', ['PASMO電子票', 'Apple錢包PASMO']],\n  ['Apple Wallet SUICA', ['SUICA電子票', 'Apple錢包SUICA']],\n  ['CITYLINK', ['City Link']],\n  ['Disney+', ['Disney Plus', '迪士尼+']],\n  ['Google Play', ['Google應用商店']],\n  ['Grab', ['Grab Taxi', 'Grab叫車']],\n  ['MITSUI OUTLET PARK 台中港', ['三井台中港', '三井OUTLET台中']],\n  ['MITSUI OUTLET PARK 台南', ['三井台南', '三井OUTLET台南']],\n  ['MITSUI OUTLET PARK 林口', ['三井林口', '三井OUTLET林口']],\n  ['Mitsui Shopping Park LaLaport 台中', ['LaLaport台中', '三井LaLaport台中']],\n  ['Netflix', ['網飛']],\n  ['Nintendo', ['任天堂', 'Switch', '老任']],\n  ['PChome 24h購物(不含儲值及電子票券)', ['PChome', 'PChome購物']],\n  ['Tiger City', ['老虎城', 'Tiger City購物中心']],\n  ['Trip.com', ['攜程']],\n  ['Uber Eats (不含 Uber One)', ['優步外送']],\n  ['foodpanda', ['熊貓外送', 'Food Panda']],\n  ['iCloud', ['蘋果雲端', 'iCloud雲端']],\n  ['iRent', ['i Rent']],\n  ['iTunes', ['蘋果iTunes']],\n  ['中友百貨', ['中友']],\n  ['中華航空', ['China Airlines', 'CAL', 'CI', '華航']],\n  ['亞洲航空', ['AirAsia', '亞航', 'AXM', 'AK']],\n  ['京站', ['Q Square', '京站商場']],\n  ['全家便利商店', ['FamilyMart', '全家']],\n  ['全球迪士尼飯店', ['Disney Hotels']],\n  ['全聯福利中心', ['PX Mart']],\n  ['南紡購物中心', ['Tainan Spinnery Mall', '南紡']],\n  ['博客來', ['Books.com.tw']],\n  ['卡達航空', ['Qatar Airways', '卡航', 'QTR', 'QR']],\n  ['可樂旅遊', ['Cola Travel', '可樂旅行社']],\n  ['台北101', ['Taipei 101', '101大樓']],\n  ['台灣中油-直營', ['中油直營', '直營中油']],\n  ['台灣大車隊', ['Taiwan Taxi', '大車隊']],\n  ['台灣虎航', ['Tigerair Taiwan', '台虎', 'TWA', 'IT']],\n  ['台灣高鐵', ['Taiwan High Speed Rail']],\n  ['台茂購物中心', ['TaiMall']],\n  ['吉卜力公園', ['Ghibli Park']],\n  ['國泰航空', ['Cathay Pacific', '國泰', 'CPA', 'CX', 'Cathay Pacific Airways']],\n  ['土耳其航空', ['Turkish Airlines', '土航', 'THY', 'TK']],\n  ['夢時代', ['Dream Mall']],\n  ['大阪環球影城(USJ)', ['Universal Studios Japan']],\n  ['大韓航空', ['Korean Air', '韓航', 'KAL', 'KE']],\n  ['大魯閣新時代', ['Taroko Mall', '大魯閣']],\n  ['太平洋百貨', ['Pacific Department Store', '太平洋']],\n  ['好樂迪KTV', ['Holiday']],\n  ['家樂福', ['Carrefour']],\n  ['屈臣氏', ['Watsons']],\n  ['康是美', ['Cosmed']],\n  ['捷星航空', ['JST', 'JQ', 'Jetstar Airways']],\n  ['新加坡航空', ['SIA', 'SQ', 'Singapore Airlines']],\n  ['日本航空', ['JAL', 'JL', 'Japan Airlines']],\n  ['星宇航空', ['starlux', 'SJX', 'JX', 'STARLUX Airlines']],\n  ['樂桃航空', ['APJ', 'MM', 'Peach Aviation']],\n  ['法國航空', ['AFR', 'AF', 'Air France']],\n  ['聯合航空', ['UAL', 'UA', 'United Airlines']],\n  ['蝦皮購物', ['shopee']],\n  ['越捷航空', ['VJC', 'VJ', 'VietJet Air']],\n  ['達美航空', ['DAL', 'DL', 'Delta Air Lines']],\n  ['遠東百貨', ['遠百']],\n  ['酷航', ['SCO', 'TR', 'Scoot']],\n  ['長榮航空', ['EVA', 'BR', 'EVA Airlines', 'EVA Air']],\n  ['阿聯酋航空', ['UAE', 'EK', 'Emirates']],\n  ['麥當勞', [\"McDonald's\"]],\n  ['IKEA', ['宜家家居']],\n  ['星巴克', ['starbucks']],\n] satisfies StoreAliases[]\n","import typia from 'typia'\n\nexport type ShowRewardMilesType = 'AllPlanRewardMiles' | 'CurrentPlanRewardMiles'\nexport const isShowRewardMilesType = typia.createIs<ShowRewardMilesType>()\n","import typia from 'typia'\n\nimport { CustomStorageManager } from '@/utils/StorageManager'\n\nimport { isStoreAliasesList, type StoreAliases } from './configs/storeAliases'\nimport { type CardConfig, type ConditionType, type Payment } from './CreditCard'\nimport { isShowRewardMilesType, type ShowRewardMilesType } from './types'\n\nexport const storageManager = new CustomStorageManager<{\n  showRewardMilesType: ShowRewardMilesType\n  commonPaymentMethods: Payment[]\n  cardConfigs: CardConfig[]\n  conditionTypes: ConditionType[]\n  aliasType: AliasType\n  customAliases: StoreAliases[]\n}>(\n  localStorage,\n  {\n    showRewardMilesType: isShowRewardMilesType,\n    commonPaymentMethods: typia.createIs<Payment[]>(),\n    cardConfigs: typia.createIs<CardConfig[]>(),\n    conditionTypes: typia.createIs<ConditionType[]>(),\n    aliasType: typia.createIs<AliasType>(),\n    customAliases: isStoreAliasesList,\n  },\n  'bestMileageCards',\n)\n\nexport const aliasTypeList = ['default', 'additional', 'custom'] as const\nexport type AliasType = (typeof aliasTypeList)[number]\n","import { defineStore } from 'pinia'\nimport { computed, onMounted, readonly, ref } from 'vue'\n\nimport type { UUID } from '@/types'\nimport { generateUuid, removeDuplicates } from '@/utils'\nimport { sortList } from '@/utils/sorts'\n\nimport { exampleCardConfigs } from './configs/defaultCards'\nimport { defaultStoreAliases, type StoreAliases } from './configs/storeAliases'\nimport { createCard, CreditCard, Payment, type CardConfig } from './CreditCard'\nimport type { ConditionType } from './CreditCard/modules/type'\nimport { type ShowRewardMilesType } from './types'\nimport { aliasTypeList, storageManager, type AliasType } from './utils'\n\nexport interface DialogItem {\n  text: string\n  events: {\n    text: string\n    event?: () => Promise<void> | void\n  }[]\n}\n\nexport const useBestMileageCardsStore = defineStore('BestMileageCards', () => {\n  const dialog = ref<DialogItem | null>(null)\n  function openDialog(item: DialogItem): void {\n    dialog.value = item\n  }\n  function closeDialog(): void {\n    dialog.value = null\n  }\n\n  onMounted(() => {\n    const configs = storageManager.get('cardConfigs') ?? []\n    cardConfigs.value = new Map(configs.map((config) => [generateUuid(), config]))\n  })\n\n  const showRewardMilesType = ref<ShowRewardMilesType>(\n    storageManager.get('showRewardMilesType') ?? 'AllPlanRewardMiles',\n  )\n  function updateShowRewardMilesType(type: ShowRewardMilesType): void {\n    storageManager.set('showRewardMilesType', type)\n    showRewardMilesType.value = type\n  }\n\n  const commonPaymentMethods = ref<Payment[]>(\n    storageManager.get('commonPaymentMethods') ?? ['信用卡', 'Apple Pay', 'Line Pay', '街口支付'],\n  )\n  function updateCommonPaymentMethods([...payments]: readonly Payment[]): void {\n    payments = [...new Set(payments)]\n    storageManager.set('commonPaymentMethods', payments)\n    commonPaymentMethods.value = payments\n  }\n\n  // TODO: 有空要再確認看看有沒有必要做 cache 避免浪費效能\n  const cardConfigs = ref(new Map<UUID, CardConfig>())\n  const cards = computed((): CreditCard[] => {\n    const cards =\n      cardConfigs.value.size === 0 ? exampleCardConfigs : [...cardConfigs.value.values()]\n    return cards.map((config) => createCard(config))\n  })\n  function updateCardConfig(id: UUID, config: CardConfig): void {\n    cardConfigs.value.set(id, config)\n    storageManager.set('cardConfigs', [...cardConfigs.value.values()])\n  }\n  function deleteCardConfig(id: UUID): void {\n    cardConfigs.value.delete(id)\n    storageManager.set('cardConfigs', [...cardConfigs.value.values()])\n  }\n  const storeList = computed(() => {\n    return sortList(removeDuplicates(cards.value.flatMap((card) => card.storeList)), 'asc')\n  })\n\n  const conditionTypes = ref<ConditionType[]>(storageManager.get('conditionTypes') ?? [])\n  function updateConditionTypes([...types]: readonly ConditionType[]): void {\n    conditionTypes.value = types\n    storageManager.set('conditionTypes', types)\n  }\n\n  const aliasType = ref<AliasType>(storageManager.get('aliasType') ?? 'default')\n  function updateAliasType(type: AliasType): void {\n    if (aliasTypeList.includes(type)) {\n      aliasType.value = type\n      storageManager.set('aliasType', type)\n    }\n  }\n\n  const customAliases = ref(new Map<string, string[]>(storageManager.get('customAliases') ?? []))\n  function updateCustomAliases(store: string, aliases: string[]): void {\n    if (aliases.length === 0) {\n      customAliases.value.delete(store)\n    } else {\n      customAliases.value.set(store, aliases)\n    }\n    storageManager.set('customAliases', [...customAliases.value])\n  }\n  function updateAllCustomAliases(list: StoreAliases[]): void {\n    customAliases.value = new Map(list)\n    storageManager.set('customAliases', list)\n  }\n\n  const storeAliases = computed(() => {\n    const list: [string, readonly string[]][] = []\n    if (['default', 'additional'].includes(aliasType.value)) {\n      list.push(...defaultStoreAliases)\n    }\n    if (['additional', 'custom'].includes(aliasType.value)) {\n      list.push(...customAliases.value)\n    }\n\n    const storeAliasesMap = new Map<string, Set<string>>()\n    for (const [store, aliases] of list) {\n      const item = storeAliasesMap.get(store) ?? new Set<string>()\n      for (const alias of aliases) {\n        item.add(alias)\n      }\n      storeAliasesMap.set(store, item)\n    }\n    return storeAliasesMap\n  })\n\n  return {\n    dialog: readonly(dialog),\n    openDialog,\n    closeDialog,\n    showRewardMilesType: readonly(showRewardMilesType),\n    updateShowRewardMilesType,\n    commonPaymentMethods: readonly(commonPaymentMethods),\n    updateCommonPaymentMethods,\n    cardConfigs: readonly(cardConfigs),\n    cards,\n    updateCardConfig,\n    deleteCardConfig,\n    storeList: readonly(storeList),\n    conditionTypes: readonly(conditionTypes),\n    updateConditionTypes,\n    aliasType: readonly(aliasType),\n    storeAliases,\n    updateAliasType,\n    customAliases: readonly(customAliases),\n    updateCustomAliases,\n    updateAllCustomAliases,\n  }\n})\n","<template>\n  <div class=\"flex-col gap-24px my-16px\">\n    <div class=\"flex-center gap-8px\">\n      <v-label text=\"回饋顯示\" />\n      <v-radio-group\n        :model-value=\"showRewardMilesType\"\n        hide-details\n        inline\n        @update:model-value=\"\n          (item) => item !== null && bestMileageCardsStore.updateShowRewardMilesType(item)\n        \"\n      >\n        <v-radio density=\"compact\" label=\"全部方案\" value=\"AllPlanRewardMiles\" />\n        <v-radio density=\"compact\" label=\"當前方案\" value=\"CurrentPlanRewardMiles\" />\n      </v-radio-group>\n    </div>\n    <div>\n      <v-select\n        :model-value=\"commonPaymentMethods\"\n        :items=\"sortList(Payment, 'asc')\"\n        label=\"使用中的付款方式\"\n        multiple\n        hide-details\n        @update:model-value=\"\n          (list) => list !== null && bestMileageCardsStore.updateCommonPaymentMethods(list)\n        \"\n      />\n    </div>\n    <div>\n      <v-label text=\"其他設定\" />\n      <div class=\"flex mx-16px\">\n        <v-switch\n          :model-value=\"conditionTypes\"\n          label=\"生日中\"\n          value=\"Birthday\"\n          hide-details\n          color=\"blue\"\n          @update:model-value=\"\n            (list) => list !== null && bestMileageCardsStore.updateConditionTypes(list)\n          \"\n        />\n      </div>\n    </div>\n  </div>\n</template>\n<script lang=\"ts\" setup>\nimport { storeToRefs } from 'pinia'\n\nimport { sortList } from '@/utils/sorts'\n\nimport { Payment } from '../CreditCard'\nimport { useBestMileageCardsStore } from '../store'\n\nconst bestMileageCardsStore = useBestMileageCardsStore()\nconst { showRewardMilesType, commonPaymentMethods, conditionTypes } =\n  storeToRefs(bestMileageCardsStore)\n</script>\n","<template>\n  <v-text-field\n    clearable\n    :rules=\"rules\"\n    :model-value=\"modelValue\"\n    @update:model-value=\"updateModelValue\"\n  >\n    <template #label>\n      <p class=\"relative\">\n        {{ label }}\n        <span v-if=\"required\" class=\"text-red ml-2px\">*</span>\n      </p>\n    </template>\n  </v-text-field>\n</template>\n<script lang=\"ts\" setup>\nimport { computed } from 'vue'\n\nimport { isTruthyString } from '@/utils'\n\nconst modelValue = defineModel<string | null>({ required: true })\n\nconst {\n  required = false,\n  label,\n  isUrl = false,\n} = defineProps<{\n  required?: boolean\n  label: string\n  isUrl?: boolean\n}>()\n\ntype Rule = (value: string | null) => boolean | string\n\nconst rules = computed(() => {\n  const rules: Rule[] = []\n  if (required) {\n    rules.push((text: string | null): boolean | string => !!text || '此欄位為必填')\n  }\n  if (isUrl) {\n    rules.push((text: string | null): boolean | string => {\n      return (\n        Boolean(text === null || text === '' || text.startsWith('https://')) ||\n        '請填寫正確的網址 (需為 https:// 開頭)'\n      )\n    })\n  }\n  return rules\n})\n\nfunction updateModelValue(newValue: string | null): void {\n  newValue = newValue?.trim() ?? null\n  modelValue.value = isTruthyString(newValue) ? newValue : null\n}\n</script>\n","/* eslint-disable @eslint-community/eslint-comments/disable-enable-pair, @typescript-eslint/no-unsafe-function-type, @typescript-eslint/no-explicit-any, @typescript-eslint/no-unsafe-return, @typescript-eslint/no-unsafe-assignment, security/detect-object-injection, @typescript-eslint/no-unsafe-member-access */\ntype DeepWritable<T> = T extends Function\n  ? T\n  : T extends readonly (infer U)[]\n    ? DeepWritable<U>[]\n    : T extends ReadonlyMap<infer K, infer V>\n      ? Map<DeepWritable<K>, DeepWritable<V>>\n      : T extends ReadonlySet<infer U>\n        ? Set<DeepWritable<U>>\n        : T extends object\n          ? { -readonly [K in keyof T]: DeepWritable<T[K]> }\n          : T\n\nexport function cloneDeep<T>(item: T): DeepWritable<T> {\n  if (item === null || typeof item !== 'object') {\n    return item as DeepWritable<T> // 基本類型直接返回\n  }\n\n  if (Array.isArray(item)) {\n    // 處理 ReadonlyArray 或 Array 型別\n    return item.map((i) => cloneDeep(i)) as DeepWritable<T>\n  }\n\n  if (item instanceof Map) {\n    // 處理 ReadonlyMap 或 Map 型別\n    return new Map(\n      Array.from(item.entries()).map(([key, value]) => [cloneDeep(key), cloneDeep(value)]),\n    ) as DeepWritable<T>\n  }\n\n  if (item instanceof Set) {\n    // 處理 ReadonlySet 或 Set 型別\n    return new Set(Array.from(item.values()).map((value) => cloneDeep(value))) as DeepWritable<T>\n  }\n\n  if (item instanceof Date) {\n    // 處理 Date 型別\n    return new Date(item.getTime()) as DeepWritable<T>\n  }\n\n  if (item instanceof RegExp) {\n    // 處理 RegExp 型別\n    return new RegExp(item.source, item.flags) as DeepWritable<T>\n  }\n\n  // 處理普通物件，遞迴拷貝每個屬性\n  const result: any = {}\n  Object.keys(item).forEach((key) => {\n    result[key] = cloneDeep((item as any)[key])\n  })\n\n  return result as DeepWritable<T>\n}\n","<template>\n  <div class=\"flex-col gap-4px h-full overflow-hidden\">\n    <div class=\"flex justify-end\">\n      <v-btn\n        text=\"匯入\"\n        @click=\"\n          () => {\n            needImportCardConfigs = []\n            showDefaultCardDialog = true\n          }\n        \"\n      />\n    </div>\n    <div class=\"flex-1 gap-8px flex-col overflow-y-auto py-8px\">\n      <v-card\n        v-for=\"([id, config], index) of cardConfigs.entries()\"\n        :key=\"index\"\n        density=\"compact\"\n        class=\"mx-auto w-full flex-shrink-0\"\n        variant=\"outlined\"\n        :title=\"config.name\"\n        :text=\"config.description ?? ''\"\n        @click=\"() => (selectedCard = { id, config: cloneDeep(config) })\"\n      />\n    </div>\n  </div>\n  <v-dialog\n    :model-value=\"Boolean(selectedCard)\"\n    fullscreen\n    @update:model-value=\"selectedCard = null\"\n  >\n    <v-card class=\"reward-detail-dialog\">\n      <v-toolbar>\n        <v-btn icon=\"mdi-close\" @click=\"selectedCard = null\" />\n        <v-toolbar-title>編輯卡片</v-toolbar-title>\n        <v-spacer />\n        <v-toolbar-items>\n          <v-btn text=\"Save\" @click=\"saveCardConfig\" />\n        </v-toolbar-items>\n      </v-toolbar>\n      <div v-if=\"selectedCard\" class=\"flex-col gap-2 m-16px\">\n        <TextField v-model=\"selectedCard.config.name\" label=\"卡片名稱\" required />\n        <TextField v-model=\"selectedCard.config.description\" label=\"卡片描述\" />\n        <TextField v-model=\"selectedCard.config.cardUrl\" is-url label=\"信用卡網頁\" />\n        <div>\n          <v-btn\n            text=\"Delete\"\n            @click=\"\n              store.openDialog({\n                text: '確定要刪除嗎？',\n                events: [\n                  {\n                    text: 'cancel',\n                  },\n                  {\n                    text: 'delete',\n                    event: deleteCardConfig,\n                  },\n                ],\n              })\n            \"\n          />\n        </div>\n      </div>\n    </v-card>\n  </v-dialog>\n  <v-dialog v-model=\"showDefaultCardDialog\" fullscreen>\n    <v-card class=\"reward-detail-dialog\">\n      <v-toolbar>\n        <v-btn icon=\"mdi-close\" @click=\"showDefaultCardDialog = false\" />\n        <v-toolbar-title>請選擇卡片</v-toolbar-title>\n        <v-spacer />\n        <v-toolbar-items>\n          <v-btn text=\"匯入\" @click=\"importCardConfigs\" />\n        </v-toolbar-items>\n      </v-toolbar>\n      <div class=\"flex-col gap-4px m-8px\">\n        <v-checkbox\n          v-for=\"(item, index) of defaultCardConfigs\"\n          :key=\"index\"\n          v-model=\"needImportCardConfigs\"\n          :value=\"item\"\n          hide-details\n          density=\"comfortable\"\n        >\n          <template #label>\n            <div class=\"flex-col\">\n              <p class=\"text-1rem\">\n                {{ item.name }}\n              </p>\n              <p class=\"text-0.75rem\">\n                {{ item.description }}\n              </p>\n            </div>\n          </template>\n        </v-checkbox>\n      </div>\n    </v-card>\n  </v-dialog>\n</template>\n<script lang=\"ts\" setup>\nimport { storeToRefs } from 'pinia'\nimport { ref } from 'vue'\n\nimport TextField from '@/components/TextFiled.vue'\nimport type { UUID } from '@/types'\nimport { generateUuid } from '@/utils'\nimport { cloneDeep } from '@/utils/cloneDeep'\n\nimport { defaultCardConfigs } from '../configs/defaultCards'\nimport type { CardConfig } from '../CreditCard'\nimport { useBestMileageCardsStore } from '../store'\n\nconst store = useBestMileageCardsStore()\nconst { cardConfigs } = storeToRefs(store)\nconst selectedCard = ref<{ id: UUID; config: CardConfig } | null>(null)\n\nconst showDefaultCardDialog = ref(false)\nconst needImportCardConfigs = ref<CardConfig[]>([])\nfunction importCardConfigs(): void {\n  for (const item of needImportCardConfigs.value) {\n    store.updateCardConfig(generateUuid(), item)\n    showDefaultCardDialog.value = false\n  }\n}\n\nfunction saveCardConfig(): void {\n  if (selectedCard.value === null) {\n    return\n  }\n  store.updateCardConfig(selectedCard.value.id, selectedCard.value.config)\n  selectedCard.value = null\n}\n\nfunction deleteCardConfig(): void {\n  if (selectedCard.value === null) {\n    return\n  }\n  store.deleteCardConfig(selectedCard.value.id)\n  selectedCard.value = null\n}\n</script>\n","<template>\n  <div class=\"gap-8px h-full flex-col\">\n    <v-text-field\n      :model-value=\"amount\"\n      class=\"flex-grow-0\"\n      density=\"comfortable\"\n      hide-details\n      label=\"交易金額\"\n      inputmode=\"decimal\"\n      :clearable=\"amount !== 0\"\n      @update:model-value=\"\n        (numberString: string) =>\n          (amount = isNaN(parseFloat(numberString)) ? 0 : parseFloat(numberString))\n      \"\n    />\n    <v-autocomplete\n      ref=\"storeAutoComplete\"\n      v-model=\"transactionStore\"\n      :custom-filter=\"customSearchStore\"\n      class=\"flex-grow-0\"\n      density=\"comfortable\"\n      hide-details\n      item-value=\"store\"\n      item-title=\"store\"\n      label=\"消費店家\"\n      :items=\"searchStoreList\"\n      :clearable=\"isTruthyString(transactionStore)\"\n      placeholder=\"全部店家\"\n      @update:menu=\"(status: boolean) => !status && storeAutoCompleteElement?.blur()\"\n    />\n    <div>\n      <v-label text=\"支援的付款方式\" />\n      <div class=\"flex items-center flex-wrap gap-x-8px\">\n        <v-checkbox\n          v-for=\"(payment, index) of commonPaymentMethods\"\n          :key=\"index\"\n          v-model=\"acceptedPayments\"\n          density=\"compact\"\n          :value=\"payment\"\n          hide-details\n          :label=\"payment\"\n        />\n      </div>\n    </div>\n    <div class=\"gap-8px flex-center\">\n      <v-label text=\"交易類型\" />\n      <v-radio-group v-model=\"transactionAttributesType\" hide-details inline>\n        <v-radio density=\"compact\" label=\"國內交易\" value=\"Domestic\" />\n        <v-radio density=\"compact\" label=\"國外交易\" value=\"Foreign\" />\n      </v-radio-group>\n    </div>\n    <div ref=\"rewardCardList\" class=\"flex-col gap-4px flex-grow-1 overflow-y-auto\">\n      <v-card\n        v-for=\"(item, index) of rewardMilesList\"\n        :key=\"index\"\n        density=\"compact\"\n        class=\"mx-auto w-full flex-shrink-0\"\n        variant=\"outlined\"\n        @click=\"() => (selectedRewardItem = item)\"\n      >\n        <template #title>\n          <div class=\"flex items-center justify-between\">\n            <div class=\"flex gap-4px items-end\">\n              {{ item.miles }}\n              <p class=\"text-12px opacity-50 p-4px\">{{ item.airLinesCode }}</p>\n            </div>\n            <i v-if=\"item.isSelectedPlan\" class=\"fa-solid fa-circle-check\" />\n          </div>\n        </template>\n        <template #text>\n          <div class=\"flex-col gap-8px\">\n            <p class=\"text-0.75rem\">\n              {{ `${item.cardName} ${item.planName ?? ''} ${item.rewardName ?? ''}` }}\n              {{ item.payments.length === 0 ? '' : ` (支付方式: ${item.payments.join(', ')})` }}\n            </p>\n          </div>\n        </template>\n      </v-card>\n    </div>\n  </div>\n  <v-dialog\n    :model-value=\"Boolean(selectedRewardItem)\"\n    @update:model-value=\"selectedRewardItem = null\"\n  >\n    <v-card\n      v-if=\"selectedRewardItem\"\n      class=\"mx-auto reward-detail-dialog\"\n      min-width=\"100%\"\n      :title=\"`${selectedRewardItem.cardName} ${selectedRewardItem.planName ?? ''} ${selectedRewardItem.rewardName ?? ''}`\"\n    >\n      <template #subtitle>\n        <p class=\"text-wrap\">\n          {{ selectedRewardItem.description ?? '' }}\n        </p>\n      </template>\n      <template #text>\n        <div class=\"flex-col\">\n          <p class=\"flex justify-between\">\n            卡片說明：\n            <a\n              v-if=\"selectedRewardItem.cardUrl !== null\"\n              target=\"_blank\"\n              class=\"underline\"\n              :href=\"selectedRewardItem.cardUrl\"\n            >\n              網站\n            </a>\n          </p>\n          <p\n            v-if=\"\n              selectedRewardItem.cardDescription !== '' ||\n              selectedRewardItem.cardDescription !== null\n            \"\n          >\n            {{ selectedRewardItem.cardDescription }}\n          </p>\n          <p v-if=\"selectedRewardItem.pointExchangeName !== ''\">\n            {{ selectedRewardItem.pointExchangeName }}\n          </p>\n          <br />\n          <p>消費金額: {{ amount }}</p>\n          <p>哩程預估: {{ selectedRewardItem.miles }}&ensp;{{ selectedRewardItem.airLinesCode }}</p>\n          <br />\n          <p v-for=\"(text, index) of selectedRewardItem.calculateDetail\" :key=\"index\">\n            {{ text }}\n          </p>\n        </div>\n      </template>\n      <template #actions>\n        <v-btn class=\"ms-auto\" text=\"Close\" @click=\"selectedRewardItem = null\" />\n      </template>\n    </v-card>\n  </v-dialog>\n</template>\n<script lang=\"ts\" setup>\nimport { storeToRefs } from 'pinia'\nimport { computed, ref, useTemplateRef } from 'vue'\n\nimport { roundByDigits, floorByDigits, isTruthyString } from '@/utils'\nimport { sortListByField } from '@/utils/sorts'\n\nimport {\n  type Payment,\n  type Reward,\n  type RewardType,\n  type TransactionInfo,\n  type TransactionType,\n  type PointExchangeStrategy,\n} from '../CreditCard'\nimport { useBestMileageCardsStore } from '../store'\n\nconst roundBy0 = roundByDigits(0)\nconst roundBy2 = roundByDigits(2)\nconst floorBy0 = floorByDigits(0)\n\ninterface RewardItem {\n  cardName: string\n  planName: string | null\n  rewardName: string | null\n  miles: number\n  isSelectedPlan: boolean\n  payments: readonly Payment[]\n  airLinesCode: string\n  calculateDetail: string[]\n  cardUrl: string | null\n  cardDescription: string | null\n  description: string | null\n  pointExchangeName: string | null\n}\n\nconst {\n  showRewardMilesType,\n  commonPaymentMethods,\n  cards,\n  conditionTypes,\n  storeAliases,\n  storeList,\n} = storeToRefs(useBestMileageCardsStore())\n\nconst amount = ref<number>(0)\nconst transactionStore = ref<string | null>(null)\nconst otherStore = '其他店家'\nconst transactionAttributesType = ref<TransactionType>('Domestic')\nconst acceptedPayments = ref<Payment[]>([])\nconst rewardCardListElement = useTemplateRef<HTMLElement>('rewardCardList')\nconst storeAutoCompleteElement = useTemplateRef<HTMLElement>('storeAutoComplete')\n\ninterface Item {\n  store: string\n  aliases?: string[]\n}\nconst searchStoreList = computed((): Item[] => {\n  const items = storeList.value.map((store) => ({\n    store,\n    aliases: [...(storeAliases.value.get(store) ?? [])],\n  }))\n  return [{ store: otherStore }, ...items]\n})\n\nfunction customSearchStore(\n  value: string,\n  searchQuery: string,\n  item?: { raw: Item; value: string },\n): boolean {\n  searchQuery = searchQuery.toLowerCase()\n  const list = [value, ...(item?.raw.aliases ?? [])].map((item) => item.toLowerCase())\n  return list.some((item) => item.includes(searchQuery))\n}\n\nconst rewardMilesList = computed((): RewardItem[] => {\n  const paymentInfo: TransactionInfo = {\n    amount: amount.value,\n    acceptedPayments: acceptedPayments.value,\n    transactionAttributesType: transactionAttributesType.value,\n    currentConditions: [...conditionTypes.value],\n  }\n  if (isTruthyString(transactionStore.value)) {\n    paymentInfo.transactionStore = transactionStore.value\n  }\n  const list: RewardItem[] = []\n  for (const card of cards.value) {\n    const rewardMileList = card.getRewardInfos(\n      paymentInfo,\n      showRewardMilesType.value === 'CurrentPlanRewardMiles'\n        ? { onlyCurrentExchangeStrategy: true, onlyCurrentPlan: true }\n        : {},\n    )\n    for (const item of rewardMileList) {\n      const rewardItem: RewardItem = {\n        cardName: card.name,\n        planName: item.planName,\n        rewardName: item.rewardName,\n        miles: item.miles,\n        payments: item.payments,\n        airLinesCode: item.airlineCode,\n        isSelectedPlan:\n          showRewardMilesType.value === 'AllPlanRewardMiles' && item.planId === card.selectedPlanId,\n        calculateDetail: getRewardDetail(item.rewardStrategy, item.pointExchangeStrategy),\n        description:\n          item.rewardStrategy === null\n            ? null\n            : `${item.rewardStrategy.description}，${item.pointExchangeStrategy.description}`,\n        cardUrl: card.cardUrl,\n        cardDescription: card.description,\n        pointExchangeName: item.pointExchangeName,\n      }\n      list.push(rewardItem)\n    }\n  }\n  rewardCardListElement.value?.scrollTo({ top: 0, behavior: 'smooth' })\n  return sortListByField(sortListByField(list, 'isSelectedPlan', 'desc'), 'miles', 'desc')\n})\n\nconst selectedRewardItem = ref<RewardItem | null>(null)\nfunction getRewardDetail(\n  reward: Reward<RewardType> | null,\n  pointExchangeStrategy: PointExchangeStrategy,\n): string[] {\n  const { pointsPerMile, milesPerUnit, airlineCode } = pointExchangeStrategy\n\n  const title = '回饋計算:'\n  switch (reward?.type) {\n    case 'RoundedPercentageReward':\n    case 'TruncatedPercentageReward': {\n      const numberFormatEvent = reward.type === 'RoundedPercentageReward' ? roundBy0 : floorBy0\n      let totalPoints = 0\n      return [\n        title,\n        ...reward.pointBackRates.map(({ rate, limit }) => {\n          const total = Math.min(numberFormatEvent((amount.value * rate) / 100), limit ?? Infinity)\n          totalPoints += total\n          const limitString = limit !== undefined ? ` (limit ${limit})` : ''\n          return `${amount.value} * ${rate}% = ${total}${limitString}`\n        }),\n        `總計 ${totalPoints} points`,\n        `${totalPoints} / ${pointsPerMile} * ${milesPerUnit} = ${pointExchangeStrategy.calculateMiles(totalPoints)} ${airlineCode}`,\n      ]\n    }\n    case 'AccumulatedPointsReward': {\n      const points = roundBy2(amount.value / reward.spendingPerPoint)\n      return [\n        title,\n        `${amount.value} / ${reward.spendingPerPoint} = ${points} points`,\n        `${points} / ${pointsPerMile} * ${milesPerUnit} = ${pointExchangeStrategy.calculateMiles(points)} ${airlineCode}`,\n      ]\n    }\n    case 'FixedRatePointsReward': {\n      const points = floorBy0(amount.value / reward.spendingPerPoint)\n      return [\n        title,\n        `${amount.value} / ${reward.spendingPerPoint} = ${points} points (小數省略)`,\n        `${points} / ${pointsPerMile} * ${milesPerUnit} = ${pointExchangeStrategy.calculateMiles(points)} ${airlineCode}`,\n      ]\n    }\n    default: {\n      return []\n    }\n  }\n}\n</script>\n\n<style scoped>\n.v-card p {\n  @apply line-height-none h-fit;\n}\n\n.reward-detail-dialog p {\n  @apply line-height-125%;\n}\n</style>\n","<template>\n  <div class=\"flex-col h-full overflow-hidden gap-8px\">\n    <div class=\"flex-shrink-0 flex-col gap-8px\">\n      <v-label text=\"別名設定\" />\n      <v-btn-toggle\n        :model-value=\"aliasType\"\n        rounded=\"0\"\n        group\n        class=\"w-full flex justify-center\"\n        :disabled=\"lockShowUISwitch\"\n        @update:model-value=\"updateAliasType\"\n      >\n        <v-btn v-for=\"(item, index) of aliasTypeList\" :key=\"index\" class=\"flex-1\" :value=\"item\">\n          {{ aliasTypeTranslation[item] }}\n        </v-btn>\n      </v-btn-toggle>\n      <div v-if=\"aliasType !== 'default'\" class=\"flex justify-between items-center\">\n        <div class=\"flex gap-8px\">\n          <v-btn v-if=\"showUI\" @click=\"editStoreAlias(null)\"> Add </v-btn>\n          <v-btn v-else @click=\"saveStoreAliasesJson\"> Save </v-btn>\n        </div>\n        <v-switch v-model=\"showUI\" :disabled=\"lockShowUISwitch\" hide-details label=\"圖示\" />\n      </div>\n    </div>\n    <div v-if=\"showUI\" class=\"gap-4px flex-col flex-grow-1 overflow-y-auto\">\n      <v-card\n        v-for=\"(item, index) of aliasList\"\n        :key=\"index\"\n        density=\"compact\"\n        class=\"mx-auto w-full flex-shrink-0\"\n        variant=\"outlined\"\n        @click=\"editStoreAlias(item.title)\"\n      >\n        <template #text>\n          <p class=\"text-1rem\">{{ item.title }}</p>\n          <p class=\"text-0.8rem\">\n            {{ item.aliases.join(', ') }}\n          </p>\n        </template>\n      </v-card>\n    </div>\n    <div v-else class=\"flex-grow-1\">\n      <v-textarea\n        :model-value=\"tempCustomAliases\"\n        :clearable=\"tempCustomAliases !== ''\"\n        auto-grow\n        :disabled=\"aliasType === 'default'\"\n        :max-rows=\"15\"\n        :messages=\"lockShowUISwitch ? '上方儲存完成後才能執行其他動作，離開這頁不會存檔' : ''\"\n        :error-messages=\"configIsValid ? '' : 'json 無效'\"\n        label=\"自定義別名設定檔\"\n        @update:model-value=\"checkAndUpdateCustomAliasesJson\"\n      />\n    </div>\n  </div>\n  <v-dialog\n    :model-value=\"Boolean(editStoreAliasData)\"\n    fullscreen\n    @update:model-value=\"editStoreAliasData = null\"\n  >\n    <v-card v-if=\"editStoreAliasData\" class=\"reward-detail-dialog\">\n      <v-toolbar>\n        <v-btn icon=\"mdi-close\" @click=\"editStoreAliasData = null\"></v-btn>\n        <v-toolbar-title>編輯商店別名</v-toolbar-title>\n        <v-spacer></v-spacer>\n        <v-toolbar-items>\n          <v-btn text=\"Save\" variant=\"text\" @click=\"saveStoreAlias\"></v-btn>\n        </v-toolbar-items>\n      </v-toolbar>\n      <div class=\"flex-col gap-24px m-8px\">\n        <v-autocomplete\n          ref=\"storeList\"\n          v-model=\"editStoreAliasData.title\"\n          class=\"flex-grow-0\"\n          hide-details\n          label=\"目標店家\"\n          :items=\"bestMileageCardsStore.storeList\"\n          placeholder=\"選擇店家\"\n          @update:menu=\"(status: boolean) => !status && storeListElement?.blur()\"\n        />\n        <div class=\"flex-col gap-4px\">\n          <v-label text=\"自定義別名列表\" />\n          <v-text-field\n            v-for=\"(alias, index) of editStoreAliasData.aliases\"\n            :key=\"index\"\n            hide-details\n            clearable\n            :model-value=\"alias\"\n            @update:model-value=\"(text) => updateAliases(text, index)\"\n            @click:clear=\"() => editStoreAliasData?.aliases.splice(index, 1)\"\n          />\n        </div>\n      </div>\n    </v-card>\n  </v-dialog>\n</template>\n<script lang=\"ts\" setup>\nimport { storeToRefs } from 'pinia'\nimport { computed, onActivated, ref, useTemplateRef, watch } from 'vue'\n\nimport { isTruthyString } from '@/utils'\n\nimport { defaultStoreAliases, isStoreAliasesList } from '../configs/storeAliases'\nimport { useBestMileageCardsStore } from '../store'\nimport { aliasTypeList, type AliasType } from '../utils'\n\n// TODO: 後面有空再 refactor 吧，感覺沒想好設計就做事，思考很混亂，而且先做卡片意義比較大\nconst bestMileageCardsStore = useBestMileageCardsStore()\nconst { aliasType, customAliases, storeAliases } = storeToRefs(bestMileageCardsStore)\n\nconst storeListElement = useTemplateRef<HTMLElement>('storeList')\n\nconst aliasTypeTranslation: Record<AliasType, string> = {\n  default: '系統預設',\n  additional: '預設+自定義',\n  custom: '自定義',\n}\n\ninterface AliasItem {\n  title: string | null\n  aliases: string[]\n}\n\nconst showUI = ref<boolean>(true)\nconst lockShowUISwitch = ref<boolean>(false)\nconst configIsValid = ref(true)\nconst tempCustomAliases = ref<string>('[]')\nconst editStoreAliasData = ref<AliasItem | null>(null)\n\nconst aliasList = computed((): AliasItem[] => {\n  let list: readonly [string, readonly string[]][]\n  if (aliasType.value === 'default') {\n    list = defaultStoreAliases\n  } else if (aliasType.value === 'additional') {\n    list = [...storeAliases.value].map(([key, value]) => [key, [...value]])\n  } else {\n    list = [...customAliases.value]\n  }\n  return list.map(([title, aliases]) => ({ title, aliases: [...aliases] }))\n})\n\nwatch(\n  () => editStoreAliasData.value?.title,\n  (storeName) => {\n    if (storeName === undefined || storeName === null || editStoreAliasData.value === null) {\n      return\n    }\n    const aliases = [...(customAliases.value.get(storeName) ?? [])]\n    if (aliases[aliases.length - 1] !== '') {\n      aliases.push('')\n    }\n    editStoreAliasData.value.aliases = aliases\n  },\n)\nwatch(showUI, resetTempCustomAliases)\n\nonActivated(() => {\n  resetTempCustomAliases()\n  lockShowUISwitch.value = false\n  configIsValid.value = true\n  showUI.value = true\n})\n\nfunction updateAliases(text: string, index: number): void {\n  if (editStoreAliasData.value === null) {\n    return\n  }\n  let aliases = editStoreAliasData.value.aliases\n  aliases[index] = text\n  if (aliases[aliases.length - 1] !== '') {\n    aliases.push('')\n  }\n}\n\n/** UI 操作上新增或編輯別名 */\nfunction editStoreAlias(title: string | null): void {\n  if (aliasType.value === 'default') {\n    return\n  }\n  if (title === null) {\n    editStoreAliasData.value = {\n      title: null,\n      aliases: [],\n    }\n  } else {\n    const aliases = [...(customAliases.value.get(title) ?? [])]\n    if (aliases[aliases.length - 1] !== '') {\n      aliases.push('')\n    }\n    editStoreAliasData.value = {\n      title,\n      aliases,\n    }\n  }\n}\n\n/** 儲存自定義別名資料 */\nfunction saveStoreAlias(): void {\n  const { title: storeName, aliases } = editStoreAliasData.value ?? {}\n  if (storeName === null || storeName === undefined || aliases === undefined) {\n    return\n  }\n  bestMileageCardsStore.updateCustomAliases(storeName, [...new Set(aliases)].filter(isTruthyString))\n  editStoreAliasData.value = null\n}\n\nfunction checkAndUpdateCustomAliasesJson(str: string): void {\n  str = str.trim()\n  tempCustomAliases.value = str\n  lockShowUISwitch.value = true\n  if (str === '') {\n    configIsValid.value = true\n    return\n  }\n  try {\n    const config: unknown = JSON.parse(str)\n    configIsValid.value = isStoreAliasesList(config)\n  } catch (error) {\n    console.error(error)\n    configIsValid.value = false\n  }\n}\n\nfunction saveStoreAliasesJson(): void {\n  let status\n  if (showUI.value) {\n    status = true\n  } else {\n    if (tempCustomAliases.value === '') {\n      tempCustomAliases.value = '[]'\n    }\n    try {\n      const config: unknown = JSON.parse(tempCustomAliases.value)\n      if (isStoreAliasesList(config)) {\n        bestMileageCardsStore.updateAllCustomAliases(config)\n        status = true\n      } else {\n        status = false\n      }\n    } catch (error) {\n      console.error(error)\n      status = false\n    }\n  }\n  if (status) {\n    alert('儲存成功')\n    lockShowUISwitch.value = false\n  } else {\n    alert(`儲存失敗${!showUI.value ? '，JSON 不符合規則' : ''}`)\n  }\n}\n\nfunction resetTempCustomAliases(): void {\n  tempCustomAliases.value = JSON.stringify([...customAliases.value], null, 2)\n}\n\nfunction updateAliasType(type: AliasType): void {\n  if (lockShowUISwitch.value) {\n    return\n  }\n  if (type === 'default') {\n    showUI.value = true\n  }\n  bestMileageCardsStore.updateAliasType(type)\n}\n</script>\n","<template>\n  <v-app>\n    <v-app-bar density=\"comfortable\" :elevation=\"2\">\n      <template #prepend>\n        <v-app-bar-nav-icon @click=\"openNavigation = !openNavigation\">\n          <i class=\"fa-solid fa-bars\" />\n        </v-app-bar-nav-icon>\n        <v-app-bar-title>{{ currentPage }}</v-app-bar-title>\n      </template>\n    </v-app-bar>\n    <v-navigation-drawer v-model=\"openNavigation\">\n      <template v-for=\"(item, index) of pageList\" :key=\"index\">\n        <v-list-item\n          :title=\"item\"\n          class=\"h-48px\"\n          :class=\"{ 'text-emphasis': currentPage === item }\"\n          @click=\"\n            () => {\n              currentPage = item\n              openNavigation = false\n            }\n          \"\n        />\n        <v-divider />\n      </template>\n    </v-navigation-drawer>\n    <main style=\"height: calc(100dvh - 56px)\" class=\"overflow-hidden mt-56px p-8px\">\n      <KeepAlive>\n        <component :is=\"componentList[currentPage]\" />\n      </KeepAlive>\n    </main>\n  </v-app>\n  <v-dialog :model-value=\"Boolean(dialog)\" @update:model-value=\"store.closeDialog\">\n    <v-card v-if=\"dialog !== null\" class=\"mx-auto\" min-width=\"100%\" :text=\"dialog.text\">\n      <template #actions>\n        <v-btn\n          v-for=\"(event, index) of dialog.events\"\n          :key=\"index\"\n          :text=\"event.text\"\n          @click=\"\n            async () => {\n              if ('event' in event) {\n                await event.event()\n              }\n              store.closeDialog()\n            }\n          \"\n        />\n      </template>\n    </v-card>\n  </v-dialog>\n</template>\n<script lang=\"ts\" setup>\nimport { storeToRefs } from 'pinia'\nimport { ref } from 'vue'\n\nimport CommonSettings from './containers/CommonSettings.vue'\nimport CreditCardManagement from './containers/CreditCardManagement.vue'\nimport SearchReward from './containers/SearchReward.vue'\nimport StoreAliasManagement from './containers/StoreAliasManagement.vue'\nimport { useBestMileageCardsStore } from './store'\n\nconst store = useBestMileageCardsStore()\nconst { dialog } = storeToRefs(store)\n\nconst componentList = {\n  // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment\n  查詢回饋: SearchReward,\n  // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment\n  信用卡管理: CreditCardManagement,\n  // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment\n  商家別名: StoreAliasManagement,\n  // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment\n  喜好設定: CommonSettings,\n} as const\ntype PageList = keyof typeof componentList\nconst pageList = Object.keys(componentList) as unknown as PageList[]\n\nconst openNavigation = ref(false)\n// eslint-disable-next-line @typescript-eslint/no-non-null-assertion\nconst currentPage = ref<PageList>(pageList[0]!)\n</script>\n","import { createPinia } from 'pinia'\n\nimport { createBaseApp } from '@/base/index'\nimport { vuetify } from '@/base/vuetify'\n\nimport App from './App.vue'\n\n// eslint-disable-next-line @typescript-eslint/no-unsafe-argument\nconst app = createBaseApp(App)\n\napp.use(vuetify)\napp.use(createPinia())\n\napp.mount('#app')\n"],"names":["floorBy0","floorByDigits","roundBy0","roundByDigits","roundBy2","BaseRewardStrategy","type","name","__publicField","minAmount","maxAmount","list","amount","data","a","b","max","min","average","previousValue","currentValue","RoundedPercentageReward","pointBackRates","superParams","total","rate","points","limit","TruncatedPercentageReward","AccumulatedPointsReward","spendingPerPoint","FixedRatePointsReward","rewards","rewardStrategyFactory","params","Plan","condition","removeDuplicates","reward","currentConditions","transactionStore","acceptedPayments","transactionAttributesType","stores","payments","transactionType","paymentBlackList","storeBlackList","isStoreValid","isStoreNotBlackListed","isPaymentValid","payment","isPaymentNotBlackListed","item","isTransactionTypeMatch","conditionValid","rewardStrategy","Payment","CreditCard","description","plans","cardUrl","updateAt","pointExchangeStrategies","firstPlanKey","firstExchangeKey","id","plan","pointExchangeStrategy","planId","pointExchangeStrategyId","paymentInfo","noneMatchRewardInfo","inStoreBlackList","inPaymentBlackList","_a","rewardInfo","onlyCurrentPlan","onlyCurrentExchangeStrategy","exchangeIds","rewardInfos","aId","_id","strategy","PointExchangeStrategy","airlineCode","pointsPerMile","milesPerUnit","createCard","planConfigs","generateUuid","planSettings","defaultBackRete","baseReward","cubeConfigs","exampleCubeConfig","starLuxConfigs","uniCardStoreList","uniCardBaseReward","uniCardConfigs","exampleUniCardConfig","travelConfigs","exampleTravelConfig","exampleCardConfigs","defaultCardConfigs","isStoreAliasesList","defaultStoreAliases","isShowRewardMilesType","input","storageManager","CustomStorageManager","_iv2","elem","_iv4","_iv11","_iv13","_io0","_io1","_io8","_io2","_iu0","_io3","_io4","_io5","_io6","_io7","aliasTypeList","useBestMileageCardsStore","defineStore","dialog","ref","openDialog","closeDialog","onMounted","configs","cardConfigs","config","showRewardMilesType","updateShowRewardMilesType","commonPaymentMethods","updateCommonPaymentMethods","cards","computed","updateCardConfig","deleteCardConfig","storeList","sortList","card","conditionTypes","updateConditionTypes","types","aliasType","updateAliasType","customAliases","updateCustomAliases","store","aliases","updateAllCustomAliases","storeAliases","storeAliasesMap","alias","readonly","bestMileageCardsStore","storeToRefs","modelValue","_useModel","__props","rules","text","updateModelValue","newValue","isTruthyString","cloneDeep","i","key","value","result","selectedCard","showDefaultCardDialog","needImportCardConfigs","importCardConfigs","saveCardConfig","otherStore","rewardCardListElement","useTemplateRef","storeAutoCompleteElement","searchStoreList","items","customSearchStore","searchQuery","rewardMilesList","rewardMileList","rewardItem","getRewardDetail","sortListByField","selectedRewardItem","title","numberFormatEvent","totalPoints","limitString","storeListElement","aliasTypeTranslation","showUI","lockShowUISwitch","configIsValid","tempCustomAliases","editStoreAliasData","aliasList","watch","storeName","resetTempCustomAliases","onActivated","updateAliases","index","editStoreAlias","saveStoreAlias","checkAndUpdateCustomAliasesJson","str","error","saveStoreAliasesJson","status","componentList","SearchReward","CreditCardManagement","StoreAliasManagement","CommonSettings","pageList","openNavigation","currentPage","app","createBaseApp","App","vuetify","createPinia"],"mappings":"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gCACEC,EAAwF,IAAAV,GAAA,CAAAqC,KAAA,IAAAN,GAAA/B,CAAA,CAAA,CAAA,CAAA,CAAA,CAE9F,CACA,CC3DA,MAAMN,GAA2B,CAAC,MAAM,EAClCD,GAA8B,CAAC,EAE/BF,GAAsB,CAC1B,MACA,YACA,cACA,aACA,aACA,aACA,UACF,EAEA,SAAS+C,GAAaC,EAA8C,CAClE,MAAMC,EAA6D,CACjE,eAAgB,CACd,KAAM,0BACN,KAAM,KACN,eAAgB,CAAC,CAAE,KAAM,EAAK,CAAA,CAAA,CAElC,EAEO,MAAA,CACL,CACE,KAAM,MACN,QAAS,CACP,CACE,eAAgB,CACd,KAAM,0BACN,KAAM,KACN,eAAgB,CAAC,CAAE,KAAM,CAAG,CAAA,CAC9B,EACA,OAAQ,CACN,MACA,UACA,SACA,UACA,WACA,SACA,MACF,EACA,SAAU,CAAC,GAAGjD,GAAU,SAAU,aAAc,QAAQ,CAC1D,EACAiD,CAAA,CAEJ,EACA,CACE,KAAM,MACN,QAAS,CACP,CACE,eAAgB,CACd,KAAM,0BACN,KAAM,KACN,eAAgB,CAAC,CAAE,KAAMD,CAAiB,CAAA,CAC5C,EACA,OAAQ,CACN,YACA,cACA,SACA,YACA,eACA,YACA,SACA,cACA,UACA,UACA,UACA,QACA,kBACA,OACA,UACA,0BACA,MACA,MACA,iBACA,OACF,EACA,iBAAkB,CAAC,WAAY,MAAM,CACvC,EACA,CAAE,GAAGC,EAAY,eAAgB,CAAC,QAAQ,CAAE,CAAA,CAEhD,EACA,CACE,KAAM,MACN,QAAS,CACP,CACE,eAAgB,CACd,KAAM,0BACN,KAAM,KACN,eAAgB,CAAC,CAAE,KAAMD,CAAiB,CAAA,CAC5C,EACA,OAAQ,CACN,WACA,gBACA,QACA,OACA,WACA,YACA,OACA,OACA,mBACA,OACA,SACA,WACA,OACA,QACA,YACA,OACA,KACA,MACA,QACA,OACA,WACA,OACA,SACA,aACA,UACA,SACA,OACA,SACA,MACA,OACA,OACA,wBACA,yBACA,wBACA,mCACA,WACA,QACA,OACA,gBACA,OACA,SACA,OACA,OACA,OACA,YACA,YACA,YACA,YACA,UACA,aACA,MACA,MACA,KACF,EACA,SAAAhD,EACF,EACA,CAAE,GAAGiD,EAAY,eAAgB,CAAC,QAAQ,CAAE,CAAA,CAEhD,EACA,CACE,KAAM,MACN,QAAS,CACP,CACE,eAAgB,CACd,KAAM,0BACN,KAAM,KACN,eAAgB,CAAC,CAAE,KAAMD,CAAiB,CAAA,CAC5C,EACA,OAAQ,CACN,SACA,UACA,eACA,cACA,QACA,qBACA,qBACA,qBACA,OACA,OACA,OACA,OACA,QACA,QACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,QACA,KACA,OACA,OACA,OACA,OACA,SACA,QACA,OACA,OACA,OACA,QACA,OACA,OACA,SACA,OACA,UACA,QACA,QACA,QACA,QACA,SACA,aACA,UACA,cACA,WACA,SACA,cACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,QACA,WACA,OACA,QACA,QACA,UACA,eACA,YACA,SACA,OACF,EACA,SAAAhD,EACF,EACA,CAAE,GAAGiD,EAAY,eAAgB,CAAC,QAAQ,CAAE,CAAA,CAEhD,EACA,CACE,KAAM,MACN,QAAS,CACP,CACE,eAAgB,CACd,KAAM,0BACN,KAAM,KACN,eAAgB,CAAC,CAAE,KAAM,CAAG,CAAA,CAC9B,EACA,SAAU,CAAC,UAAU,CACvB,EACA,CAAE,GAAGA,EAAY,eAAgB,CAAC,QAAQ,CAAE,CAAA,CAEhD,EACA,CACE,KAAM,MACN,UAAW,WACX,QAAS,CACP,CACE,eAAgB,CACd,KAAM,0BACN,KAAM,KACN,eAAgB,CAAC,CAAE,KAAM,EAAI,CAAA,CAC/B,EACA,OAAQ,CACN,UACA,cACA,UACA,WACA,UACA,aACA,QACA,QACA,WACA,SACA,SACA,WACA,SACA,aACA,QACA,KACA,WACA,QACA,aACA,UACA,MACA,6BACA,aACA,UACA,aACA,QACA,SACA,SACA,SACA,WACA,UACA,eAAA,CAEJ,EACA,CACE,eAAgB,CACd,KAAM,0BACN,KAAM,KACN,eAAgB,CAAC,CAAE,KAAM,GAAK,CAAA,CAChC,EACA,OAAQ,CACN,OACA,0BACA,QACA,WACA,QACA,SACA,OACA,UACA,OAAA,CAEJ,EACA,CAAE,GAAGA,EAAY,eAAgB,CAAC,QAAQ,CAAE,CAAA,CAC9C,CAEJ,CACF,CAEA,MAAM9B,GAAiE,CACrE,CACE,KAAM,SACN,YAAa,MACb,cAAe,IACf,aAAc,GAChB,EACA,CACE,KAAM,iBACN,YAAa,MACb,cAAe,IACf,aAAc,GAAA,CAElB,EAEa+B,GAA4B,CACvC,CACE,KAAM,SACN,YAAa,wBACb,QAAS,gFAAA,eACT/C,GAAA,iBACAD,GACA,SAAU,2BACV,MAAO6C,GAAa,CAAC,EACrB,wBAAA5B,EACF,EACA,CACE,KAAM,SACN,YAAa,wBACb,QAAS,gFAAA,eACThB,GAAA,iBACAD,GACA,SAAU,2BACV,MAAO6C,GAAa,CAAC,EACrB,wBAAA5B,EACF,EACA,CACE,KAAM,SACN,YAAa,wBACb,QAAS,gFAAA,eACThB,GAAA,iBACAD,GACA,SAAU,2BACV,MAAO6C,GAAa,GAAG,EACvB,wBAAA5B,EAAA,CAEJ,EAEagC,GAAgC,CAC3C,KAAM,SACN,YAAa,wBACb,QAAS,gFAAA,eACThD,GAAA,iBACAD,GACA,SAAU,2BACV,MAAO6C,GAAa,CAAC,EACrB,wBAAyB,CACvB,CACE,KAAM,SACN,YAAa,MACb,cAAe,IACf,aAAc,GAAA,CAChB,CAEJ,EC7XM5C,GAA2B,CAC/B,OACA,UACA,SACA,OACA,SACA,WACA,QACF,EACMD,GAA8B,CAAC,EAExBkD,GAA+B,CAC1C,CACE,KAAM,QACN,YAAa,KACb,QACE,yFAAA,eACFjD,GAAA,iBACAD,GACA,wBAAyB,CACvB,CACE,KAAM,SACN,YAAa,MACb,cAAe,EACf,aAAc,CAAA,CAElB,EACA,MAAO,CACL,CACE,KAAM,KACN,QAAS,CACP,CACE,eAAgB,CACd,KAAM,wBACN,KAAM,OACN,iBAAkB,CACpB,EACA,gBAAiB,UACjB,UAAW,UACb,EACA,CACE,eAAgB,CACd,KAAM,wBACN,KAAM,OACN,iBAAkB,EACpB,EACA,gBAAiB,SACnB,EACA,CACE,eAAgB,CACd,KAAM,wBACN,KAAM,OACN,iBAAkB,EACpB,EACA,gBAAiB,UAAA,CACnB,CACF,CAEJ,EACA,SAAU,IAAI,KAAK,qBAAqB,EAAE,YAAY,CACxD,EACA,CACE,KAAM,UACN,YAAa,KACb,QACE,yFAAA,eACFC,GAAA,iBACAD,GACA,wBAAyB,CACvB,CACE,KAAM,SACN,YAAa,MACb,cAAe,EACf,aAAc,CAAA,CAElB,EACA,MAAO,CACL,CACE,KAAM,KACN,QAAS,CACP,CACE,eAAgB,CACd,KAAM,wBACN,KAAM,OACN,iBAAkB,GACpB,EACA,gBAAiB,UACjB,UAAW,UACb,EACA,CACE,eAAgB,CACd,KAAM,wBACN,KAAM,OACN,iBAAkB,EACpB,EACA,gBAAiB,SACnB,EACA,CACE,eAAgB,CACd,KAAM,wBACN,KAAM,OACN,iBAAkB,EACpB,EACA,gBAAiB,UAAA,CACnB,CACF,CAEJ,EACA,SAAU,IAAI,KAAK,qBAAqB,EAAE,YAAY,CACxD,EACA,CACE,KAAM,QACN,YAAa,KACb,QACE,yFAAA,eACFC,GAAA,iBACAD,GACA,wBAAyB,CACvB,CACE,KAAM,SACN,YAAa,MACb,cAAe,EACf,aAAc,CAAA,CAElB,EACA,MAAO,CACL,CACE,KAAM,KACN,QAAS,CACP,CACE,eAAgB,CACd,KAAM,wBACN,KAAM,OACN,iBAAkB,EACpB,EACA,gBAAiB,SACnB,EACA,CACE,eAAgB,CACd,KAAM,wBACN,KAAM,OACN,iBAAkB,EACpB,EACA,gBAAiB,UAAA,CACnB,CACF,CAEJ,EACA,SAAU,IAAI,KAAK,qBAAqB,EAAE,YAAY,CAAA,CAE1D,EAEMmD,GAAmB,CACvB,UACA,QACA,KACA,OACA,OACA,OACA,SACA,OACA,OACA,WACA,OACA,OACA,OACA,OACA,OACA,OACA,SACA,SACA,QACA,QACA,wBACA,yBACA,wBACA,mBACA,MACA,UACA,KACA,MACA,SACA,OACA,SACA,mCACA,OACA,KACA,YACA,YACA,MACA,UACA,QACA,OACA,UACA,OACA,OACA,OACA,MACA,MACA,KACA,KACA,KACA,MACA,KACA,KACA,MACA,KACA,OACA,MACA,OACA,OACA,MACA,OACA,OACA,OACA,OACA,OACA,KACA,OACA,OACA,QACA,cACA,aACA,SACA,UACA,QACA,QACA,OACA,OACA,QACA,WACA,OACA,OACA,KACA,MACA,MACA,MACA,OACA,MACA,OACA,SACA,MACA,OACA,OACA,UACA,OACA,MACA,YACA,OACA,WACA,MACA,oBACA,oBACA,MACA,aACA,cACA,QACA,QACA,QACA,QACA,SACA,QACA,QACA,QACA,QACA,QACA,QACA,QACA,QACF,EACMC,GAAoE,CACxE,eAAgB,CACd,KAAM,4BACN,KAAM,KACN,eAAgB,CAAC,CAAE,KAAM,IAAO,CAAE,KAAM,EAAK,CAAA,CAAA,CAEjD,EACaC,GAA+B,CAC1C,CACE,KAAM,YACN,YAAa,KACb,QAAS,8EAAA,eACTpD,GAAA,iBACAD,GACA,wBAAyB,CACvB,CACE,KAAM,SACN,YAAa,MACb,cAAe,IACf,aAAc,GAAA,CAElB,EACA,MAAO,CACL,CACE,KAAM,eACN,QAAS,CACP,CACE,eAAgB,CACd,KAAM,4BACN,KAAM,KACN,eAAgB,CAAC,CAAE,KAAM,EAAO,EAAA,CAAE,KAAM,EAAA,EAAO,CAAE,KAAM,IAAK,MAAO,GAAK,CAAA,CAC1E,EACA,OAAQmD,GACR,SAAU,CAAC,MAAO,YAAa,cAAe,YAAY,CAC5D,EACA,CACE,eAAgB,CACd,KAAM,4BACN,KAAM,KACN,eAAgB,CAAC,CAAE,KAAM,EAAO,EAAA,CAAE,KAAM,EAAA,EAAO,CAAE,KAAM,IAAK,MAAO,GAAK,CAAA,CAC1E,EACA,SAAU,CAAC,WAAY,OAAQ,MAAO,OAAQ,WAAW,CAC3D,EACAC,EAAA,CAEJ,EACA,CACE,KAAM,MACN,QAAS,CACP,CACE,eAAgB,CACd,KAAM,4BACN,KAAM,KACN,eAAgB,CAAC,CAAE,KAAM,EAAO,EAAA,CAAE,KAAM,EAAA,EAAO,CAAE,KAAM,EAAG,MAAO,GAAK,CAAA,CACxE,EACA,OAAQD,GACR,SAAU,CAAC,MAAO,YAA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"}